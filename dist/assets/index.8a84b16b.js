var FA=(t,o)=>()=>(o||t((o={exports:{}}).exports,o),o.exports);var nj=FA((gs,_s)=>{(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))f(g);new MutationObserver(g=>{for(const x of g)if(x.type==="childList")for(const E of x.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&f(E)}).observe(document,{childList:!0,subtree:!0});function l(g){const x={};return g.integrity&&(x.integrity=g.integrity),g.referrerpolicy&&(x.referrerPolicy=g.referrerpolicy),g.crossorigin==="use-credentials"?x.credentials="include":g.crossorigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function f(g){if(g.ep)return;g.ep=!0;const x=l(g);fetch(g.href,x)}})();function Fy(t,o){const l=Object.create(null),f=t.split(",");for(let g=0;g<f.length;g++)l[f[g]]=!0;return o?g=>!!l[g.toLowerCase()]:g=>!!l[g]}const jA="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",NA=Fy(jA);function P2(t){return!!t||t===""}function jy(t){if(_n(t)){const o={};for(let l=0;l<t.length;l++){const f=t[l],g=Oi(f)?$A(f):jy(f);if(g)for(const x in g)o[x]=g[x]}return o}else{if(Oi(t))return t;if(di(t))return t}}const UA=/;(?![^(]*\))/g,VA=/:(.+)/;function $A(t){const o={};return t.split(UA).forEach(l=>{if(l){const f=l.split(VA);f.length>1&&(o[f[0].trim()]=f[1].trim())}}),o}function Ny(t){let o="";if(Oi(t))o=t;else if(_n(t))for(let l=0;l<t.length;l++){const f=Ny(t[l]);f&&(o+=f+" ")}else if(di(t))for(const l in t)t[l]&&(o+=l+" ");return o.trim()}const h_=t=>Oi(t)?t:t==null?"":_n(t)||di(t)&&(t.toString===D2||!Sn(t.toString))?JSON.stringify(t,z2,2):String(t),z2=(t,o)=>o&&o.__v_isRef?z2(t,o.value):qc(o)?{[`Map(${o.size})`]:[...o.entries()].reduce((l,[f,g])=>(l[`${f} =>`]=g,l),{})}:O2(o)?{[`Set(${o.size})`]:[...o.values()]}:di(o)&&!_n(o)&&!L2(o)?String(o):o,li={},Zc=[],fo=()=>{},GA=()=>!1,ZA=/^on[^a-z]/,pm=t=>ZA.test(t),Uy=t=>t.startsWith("onUpdate:"),$i=Object.assign,Vy=(t,o)=>{const l=t.indexOf(o);l>-1&&t.splice(l,1)},qA=Object.prototype.hasOwnProperty,Rn=(t,o)=>qA.call(t,o),_n=Array.isArray,qc=t=>mm(t)==="[object Map]",O2=t=>mm(t)==="[object Set]",Sn=t=>typeof t=="function",Oi=t=>typeof t=="string",$y=t=>typeof t=="symbol",di=t=>t!==null&&typeof t=="object",k2=t=>di(t)&&Sn(t.then)&&Sn(t.catch),D2=Object.prototype.toString,mm=t=>D2.call(t),WA=t=>mm(t).slice(8,-1),L2=t=>mm(t)==="[object Object]",Gy=t=>Oi(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Bp=Fy(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),gm=t=>{const o=Object.create(null);return l=>o[l]||(o[l]=t(l))},HA=/-(\w)/g,$o=gm(t=>t.replace(HA,(o,l)=>l?l.toUpperCase():"")),XA=/\B([A-Z])/g,cu=gm(t=>t.replace(XA,"-$1").toLowerCase()),_m=gm(t=>t.charAt(0).toUpperCase()+t.slice(1)),f_=gm(t=>t?`on${_m(t)}`:""),yf=(t,o)=>!Object.is(t,o),d_=(t,o)=>{for(let l=0;l<t.length;l++)t[l](o)},em=(t,o,l)=>{Object.defineProperty(t,o,{configurable:!0,enumerable:!1,value:l})},R2=t=>{const o=parseFloat(t);return isNaN(o)?t:o};let w1;const KA=()=>w1||(w1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Ro;class B2{constructor(o=!1){this.detached=o,this.active=!0,this.effects=[],this.cleanups=[],this.parent=Ro,!o&&Ro&&(this.index=(Ro.scopes||(Ro.scopes=[])).push(this)-1)}run(o){if(this.active){const l=Ro;try{return Ro=this,o()}finally{Ro=l}}}on(){Ro=this}off(){Ro=this.parent}stop(o){if(this.active){let l,f;for(l=0,f=this.effects.length;l<f;l++)this.effects[l].stop();for(l=0,f=this.cleanups.length;l<f;l++)this.cleanups[l]();if(this.scopes)for(l=0,f=this.scopes.length;l<f;l++)this.scopes[l].stop(!0);if(!this.detached&&this.parent&&!o){const g=this.parent.scopes.pop();g&&g!==this&&(this.parent.scopes[this.index]=g,g.index=this.index)}this.parent=void 0,this.active=!1}}}function F2(t){return new B2(t)}function YA(t,o=Ro){o&&o.active&&o.effects.push(t)}const Zy=t=>{const o=new Set(t);return o.w=0,o.n=0,o},j2=t=>(t.w&va)>0,N2=t=>(t.n&va)>0,JA=({deps:t})=>{if(t.length)for(let o=0;o<t.length;o++)t[o].w|=va},QA=t=>{const{deps:o}=t;if(o.length){let l=0;for(let f=0;f<o.length;f++){const g=o[f];j2(g)&&!N2(g)?g.delete(t):o[l++]=g,g.w&=~va,g.n&=~va}o.length=l}},$_=new WeakMap;let tf=0,va=1;const G_=30;let uo;const El=Symbol(""),Z_=Symbol("");class qy{constructor(o,l=null,f){this.fn=o,this.scheduler=l,this.active=!0,this.deps=[],this.parent=void 0,YA(this,f)}run(){if(!this.active)return this.fn();let o=uo,l=ha;for(;o;){if(o===this)return;o=o.parent}try{return this.parent=uo,uo=this,ha=!0,va=1<<++tf,tf<=G_?JA(this):T1(this),this.fn()}finally{tf<=G_&&QA(this),va=1<<--tf,uo=this.parent,ha=l,this.parent=void 0,this.deferStop&&this.stop()}}stop(){uo===this?this.deferStop=!0:this.active&&(T1(this),this.onStop&&this.onStop(),this.active=!1)}}function T1(t){const{deps:o}=t;if(o.length){for(let l=0;l<o.length;l++)o[l].delete(t);o.length=0}}let ha=!0;const U2=[];function uu(){U2.push(ha),ha=!1}function hu(){const t=U2.pop();ha=t===void 0?!0:t}function Rr(t,o,l){if(ha&&uo){let f=$_.get(t);f||$_.set(t,f=new Map);let g=f.get(l);g||f.set(l,g=Zy()),V2(g)}}function V2(t,o){let l=!1;tf<=G_?N2(t)||(t.n|=va,l=!j2(t)):l=!t.has(uo),l&&(t.add(uo),uo.deps.push(t))}function ys(t,o,l,f,g,x){const E=$_.get(t);if(!E)return;let s=[];if(o==="clear")s=[...E.values()];else if(l==="length"&&_n(t))E.forEach((A,k)=>{(k==="length"||k>=f)&&s.push(A)});else switch(l!==void 0&&s.push(E.get(l)),o){case"add":_n(t)?Gy(l)&&s.push(E.get("length")):(s.push(E.get(El)),qc(t)&&s.push(E.get(Z_)));break;case"delete":_n(t)||(s.push(E.get(El)),qc(t)&&s.push(E.get(Z_)));break;case"set":qc(t)&&s.push(E.get(El));break}if(s.length===1)s[0]&&q_(s[0]);else{const A=[];for(const k of s)k&&A.push(...k);q_(Zy(A))}}function q_(t,o){const l=_n(t)?t:[...t];for(const f of l)f.computed&&E1(f);for(const f of l)f.computed||E1(f)}function E1(t,o){(t!==uo||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const eI=Fy("__proto__,__v_isRef,__isVue"),$2=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter($y)),tI=Wy(),nI=Wy(!1,!0),iI=Wy(!0),C1=rI();function rI(){const t={};return["includes","indexOf","lastIndexOf"].forEach(o=>{t[o]=function(...l){const f=Bn(this);for(let x=0,E=this.length;x<E;x++)Rr(f,"get",x+"");const g=f[o](...l);return g===-1||g===!1?f[o](...l.map(Bn)):g}}),["push","pop","shift","unshift","splice"].forEach(o=>{t[o]=function(...l){uu();const f=Bn(this)[o].apply(this,l);return hu(),f}}),t}function Wy(t=!1,o=!1){return function(f,g,x){if(g==="__v_isReactive")return!t;if(g==="__v_isReadonly")return t;if(g==="__v_isShallow")return o;if(g==="__v_raw"&&x===(t?o?xI:H2:o?W2:q2).get(f))return f;const E=_n(f);if(!t&&E&&Rn(C1,g))return Reflect.get(C1,g,x);const s=Reflect.get(f,g,x);return($y(g)?$2.has(g):eI(g))||(t||Rr(f,"get",g),o)?s:Ei(s)?E&&Gy(g)?s:s.value:di(s)?t?X2(s):mr(s):s}}const oI=G2(),sI=G2(!0);function G2(t=!1){return function(l,f,g,x){let E=l[f];if(Yc(E)&&Ei(E)&&!Ei(g))return!1;if(!t&&(!tm(g)&&!Yc(g)&&(E=Bn(E),g=Bn(g)),!_n(l)&&Ei(E)&&!Ei(g)))return E.value=g,!0;const s=_n(l)&&Gy(f)?Number(f)<l.length:Rn(l,f),A=Reflect.set(l,f,g,x);return l===Bn(x)&&(s?yf(g,E)&&ys(l,"set",f,g):ys(l,"add",f,g)),A}}function aI(t,o){const l=Rn(t,o);t[o];const f=Reflect.deleteProperty(t,o);return f&&l&&ys(t,"delete",o,void 0),f}function lI(t,o){const l=Reflect.has(t,o);return(!$y(o)||!$2.has(o))&&Rr(t,"has",o),l}function cI(t){return Rr(t,"iterate",_n(t)?"length":El),Reflect.ownKeys(t)}const Z2={get:tI,set:oI,deleteProperty:aI,has:lI,ownKeys:cI},uI={get:iI,set(t,o){return!0},deleteProperty(t,o){return!0}},hI=$i({},Z2,{get:nI,set:sI}),Hy=t=>t,ym=t=>Reflect.getPrototypeOf(t);function xp(t,o,l=!1,f=!1){t=t.__v_raw;const g=Bn(t),x=Bn(o);l||(o!==x&&Rr(g,"get",o),Rr(g,"get",x));const{has:E}=ym(g),s=f?Hy:l?Yy:vf;if(E.call(g,o))return s(t.get(o));if(E.call(g,x))return s(t.get(x));t!==g&&t.get(o)}function bp(t,o=!1){const l=this.__v_raw,f=Bn(l),g=Bn(t);return o||(t!==g&&Rr(f,"has",t),Rr(f,"has",g)),t===g?l.has(t):l.has(t)||l.has(g)}function wp(t,o=!1){return t=t.__v_raw,!o&&Rr(Bn(t),"iterate",El),Reflect.get(t,"size",t)}function S1(t){t=Bn(t);const o=Bn(this);return ym(o).has.call(o,t)||(o.add(t),ys(o,"add",t,t)),this}function M1(t,o){o=Bn(o);const l=Bn(this),{has:f,get:g}=ym(l);let x=f.call(l,t);x||(t=Bn(t),x=f.call(l,t));const E=g.call(l,t);return l.set(t,o),x?yf(o,E)&&ys(l,"set",t,o):ys(l,"add",t,o),this}function A1(t){const o=Bn(this),{has:l,get:f}=ym(o);let g=l.call(o,t);g||(t=Bn(t),g=l.call(o,t)),f&&f.call(o,t);const x=o.delete(t);return g&&ys(o,"delete",t,void 0),x}function I1(){const t=Bn(this),o=t.size!==0,l=t.clear();return o&&ys(t,"clear",void 0,void 0),l}function Tp(t,o){return function(f,g){const x=this,E=x.__v_raw,s=Bn(E),A=o?Hy:t?Yy:vf;return!t&&Rr(s,"iterate",El),E.forEach((k,R)=>f.call(g,A(k),A(R),x))}}function Ep(t,o,l){return function(...f){const g=this.__v_raw,x=Bn(g),E=qc(x),s=t==="entries"||t===Symbol.iterator&&E,A=t==="keys"&&E,k=g[t](...f),R=l?Hy:o?Yy:vf;return!o&&Rr(x,"iterate",A?Z_:El),{next(){const{value:D,done:F}=k.next();return F?{value:D,done:F}:{value:s?[R(D[0]),R(D[1])]:R(D),done:F}},[Symbol.iterator](){return this}}}}function ta(t){return function(...o){return t==="delete"?!1:this}}function fI(){const t={get(x){return xp(this,x)},get size(){return wp(this)},has:bp,add:S1,set:M1,delete:A1,clear:I1,forEach:Tp(!1,!1)},o={get(x){return xp(this,x,!1,!0)},get size(){return wp(this)},has:bp,add:S1,set:M1,delete:A1,clear:I1,forEach:Tp(!1,!0)},l={get(x){return xp(this,x,!0)},get size(){return wp(this,!0)},has(x){return bp.call(this,x,!0)},add:ta("add"),set:ta("set"),delete:ta("delete"),clear:ta("clear"),forEach:Tp(!0,!1)},f={get(x){return xp(this,x,!0,!0)},get size(){return wp(this,!0)},has(x){return bp.call(this,x,!0)},add:ta("add"),set:ta("set"),delete:ta("delete"),clear:ta("clear"),forEach:Tp(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(x=>{t[x]=Ep(x,!1,!1),l[x]=Ep(x,!0,!1),o[x]=Ep(x,!1,!0),f[x]=Ep(x,!0,!0)}),[t,l,o,f]}const[dI,pI,mI,gI]=fI();function Xy(t,o){const l=o?t?gI:mI:t?pI:dI;return(f,g,x)=>g==="__v_isReactive"?!t:g==="__v_isReadonly"?t:g==="__v_raw"?f:Reflect.get(Rn(l,g)&&g in f?l:f,g,x)}const _I={get:Xy(!1,!1)},yI={get:Xy(!1,!0)},vI={get:Xy(!0,!1)},q2=new WeakMap,W2=new WeakMap,H2=new WeakMap,xI=new WeakMap;function bI(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function wI(t){return t.__v_skip||!Object.isExtensible(t)?0:bI(WA(t))}function mr(t){return Yc(t)?t:Ky(t,!1,Z2,_I,q2)}function TI(t){return Ky(t,!1,hI,yI,W2)}function X2(t){return Ky(t,!0,uI,vI,H2)}function Ky(t,o,l,f,g){if(!di(t)||t.__v_raw&&!(o&&t.__v_isReactive))return t;const x=g.get(t);if(x)return x;const E=wI(t);if(E===0)return t;const s=new Proxy(t,E===2?f:l);return g.set(t,s),s}function fa(t){return Yc(t)?fa(t.__v_raw):!!(t&&t.__v_isReactive)}function Yc(t){return!!(t&&t.__v_isReadonly)}function tm(t){return!!(t&&t.__v_isShallow)}function K2(t){return fa(t)||Yc(t)}function Bn(t){const o=t&&t.__v_raw;return o?Bn(o):t}function Jc(t){return em(t,"__v_skip",!0),t}const vf=t=>di(t)?mr(t):t,Yy=t=>di(t)?X2(t):t;function Y2(t){ha&&uo&&(t=Bn(t),V2(t.dep||(t.dep=Zy())))}function J2(t,o){t=Bn(t),t.dep&&q_(t.dep)}function Ei(t){return!!(t&&t.__v_isRef===!0)}function Gt(t){return Q2(t,!1)}function EI(t){return Q2(t,!0)}function Q2(t,o){return Ei(t)?t:new CI(t,o)}class CI{constructor(o,l){this.__v_isShallow=l,this.dep=void 0,this.__v_isRef=!0,this._rawValue=l?o:Bn(o),this._value=l?o:vf(o)}get value(){return Y2(this),this._value}set value(o){const l=this.__v_isShallow||tm(o)||Yc(o);o=l?o:Bn(o),yf(o,this._rawValue)&&(this._rawValue=o,this._value=l?o:vf(o),J2(this))}}function No(t){return Ei(t)?t.value:t}const SI={get:(t,o,l)=>No(Reflect.get(t,o,l)),set:(t,o,l,f)=>{const g=t[o];return Ei(g)&&!Ei(l)?(g.value=l,!0):Reflect.set(t,o,l,f)}};function eT(t){return fa(t)?t:new Proxy(t,SI)}function tT(t){const o=_n(t)?new Array(t.length):{};for(const l in t)o[l]=af(t,l);return o}class MI{constructor(o,l,f){this._object=o,this._key=l,this._defaultValue=f,this.__v_isRef=!0}get value(){const o=this._object[this._key];return o===void 0?this._defaultValue:o}set value(o){this._object[this._key]=o}}function af(t,o,l){const f=t[o];return Ei(f)?f:new MI(t,o,l)}var nT;class AI{constructor(o,l,f,g){this._setter=l,this.dep=void 0,this.__v_isRef=!0,this[nT]=!1,this._dirty=!0,this.effect=new qy(o,()=>{this._dirty||(this._dirty=!0,J2(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!g,this.__v_isReadonly=f}get value(){const o=Bn(this);return Y2(o),(o._dirty||!o._cacheable)&&(o._dirty=!1,o._value=o.effect.run()),o._value}set value(o){this._setter(o)}}nT="__v_isReadonly";function II(t,o,l=!1){let f,g;const x=Sn(t);return x?(f=t,g=fo):(f=t.get,g=t.set),new AI(f,g,x||!g,l)}function da(t,o,l,f){let g;try{g=f?t(...f):t()}catch(x){vm(x,o,l)}return g}function Hr(t,o,l,f){if(Sn(t)){const x=da(t,o,l,f);return x&&k2(x)&&x.catch(E=>{vm(E,o,l)}),x}const g=[];for(let x=0;x<t.length;x++)g.push(Hr(t[x],o,l,f));return g}function vm(t,o,l,f=!0){const g=o?o.vnode:null;if(o){let x=o.parent;const E=o.proxy,s=l;for(;x;){const k=x.ec;if(k){for(let R=0;R<k.length;R++)if(k[R](t,E,s)===!1)return}x=x.parent}const A=o.appContext.config.errorHandler;if(A){da(A,null,10,[t,E,s]);return}}PI(t,l,g,f)}function PI(t,o,l,f=!0){console.error(t)}let xf=!1,W_=!1;const or=[];let jo=0;const Wc=[];let ms=null,_l=0;const iT=Promise.resolve();let Jy=null;function vs(t){const o=Jy||iT;return t?o.then(this?t.bind(this):t):o}function zI(t){let o=jo+1,l=or.length;for(;o<l;){const f=o+l>>>1;bf(or[f])<t?o=f+1:l=f}return o}function Qy(t){(!or.length||!or.includes(t,xf&&t.allowRecurse?jo+1:jo))&&(t.id==null?or.push(t):or.splice(zI(t.id),0,t),rT())}function rT(){!xf&&!W_&&(W_=!0,Jy=iT.then(sT))}function OI(t){const o=or.indexOf(t);o>jo&&or.splice(o,1)}function kI(t){_n(t)?Wc.push(...t):(!ms||!ms.includes(t,t.allowRecurse?_l+1:_l))&&Wc.push(t),rT()}function P1(t,o=xf?jo+1:0){for(;o<or.length;o++){const l=or[o];l&&l.pre&&(or.splice(o,1),o--,l())}}function oT(t){if(Wc.length){const o=[...new Set(Wc)];if(Wc.length=0,ms){ms.push(...o);return}for(ms=o,ms.sort((l,f)=>bf(l)-bf(f)),_l=0;_l<ms.length;_l++)ms[_l]();ms=null,_l=0}}const bf=t=>t.id==null?1/0:t.id,DI=(t,o)=>{const l=bf(t)-bf(o);if(l===0){if(t.pre&&!o.pre)return-1;if(o.pre&&!t.pre)return 1}return l};function sT(t){W_=!1,xf=!0,or.sort(DI);const o=fo;try{for(jo=0;jo<or.length;jo++){const l=or[jo];l&&l.active!==!1&&da(l,null,14)}}finally{jo=0,or.length=0,oT(),xf=!1,Jy=null,(or.length||Wc.length)&&sT()}}function LI(t,o,...l){if(t.isUnmounted)return;const f=t.vnode.props||li;let g=l;const x=o.startsWith("update:"),E=x&&o.slice(7);if(E&&E in f){const R=`${E==="modelValue"?"model":E}Modifiers`,{number:D,trim:F}=f[R]||li;F&&(g=l.map(G=>G.trim())),D&&(g=l.map(R2))}let s,A=f[s=f_(o)]||f[s=f_($o(o))];!A&&x&&(A=f[s=f_(cu(o))]),A&&Hr(A,t,6,g);const k=f[s+"Once"];if(k){if(!t.emitted)t.emitted={};else if(t.emitted[s])return;t.emitted[s]=!0,Hr(k,t,6,g)}}function aT(t,o,l=!1){const f=o.emitsCache,g=f.get(t);if(g!==void 0)return g;const x=t.emits;let E={},s=!1;if(!Sn(t)){const A=k=>{const R=aT(k,o,!0);R&&(s=!0,$i(E,R))};!l&&o.mixins.length&&o.mixins.forEach(A),t.extends&&A(t.extends),t.mixins&&t.mixins.forEach(A)}return!x&&!s?(di(t)&&f.set(t,null),null):(_n(x)?x.forEach(A=>E[A]=null):$i(E,x),di(t)&&f.set(t,E),E)}function xm(t,o){return!t||!pm(o)?!1:(o=o.slice(2).replace(/Once$/,""),Rn(t,o[0].toLowerCase()+o.slice(1))||Rn(t,cu(o))||Rn(t,o))}let Wr=null,lT=null;function nm(t){const o=Wr;return Wr=t,lT=t&&t.type.__scopeId||null,o}function co(t,o=Wr,l){if(!o||t._n)return t;const f=(...g)=>{f._d&&$1(-1);const x=nm(o);let E;try{E=t(...g)}finally{nm(x),f._d&&$1(1)}return E};return f._n=!0,f._c=!0,f._d=!0,f}function p_(t){const{type:o,vnode:l,proxy:f,withProxy:g,props:x,propsOptions:[E],slots:s,attrs:A,emit:k,render:R,renderCache:D,data:F,setupState:G,ctx:oe,inheritAttrs:se}=t;let we,xe;const Te=nm(t);try{if(l.shapeFlag&4){const Be=g||f;we=Fo(R.call(Be,Be,D,x,G,F,oe)),xe=A}else{const Be=o;we=Fo(Be.length>1?Be(x,{attrs:A,slots:s,emit:k}):Be(x,null)),xe=o.props?A:RI(A)}}catch(Be){cf.length=0,vm(Be,t,1),we=Me(Vo)}let Ue=we;if(xe&&se!==!1){const Be=Object.keys(xe),{shapeFlag:Pe}=Ue;Be.length&&Pe&7&&(E&&Be.some(Uy)&&(xe=BI(xe,E)),Ue=bs(Ue,xe))}return l.dirs&&(Ue=bs(Ue),Ue.dirs=Ue.dirs?Ue.dirs.concat(l.dirs):l.dirs),l.transition&&(Ue.transition=l.transition),we=Ue,nm(Te),we}const RI=t=>{let o;for(const l in t)(l==="class"||l==="style"||pm(l))&&((o||(o={}))[l]=t[l]);return o},BI=(t,o)=>{const l={};for(const f in t)(!Uy(f)||!(f.slice(9)in o))&&(l[f]=t[f]);return l};function FI(t,o,l){const{props:f,children:g,component:x}=t,{props:E,children:s,patchFlag:A}=o,k=x.emitsOptions;if(o.dirs||o.transition)return!0;if(l&&A>=0){if(A&1024)return!0;if(A&16)return f?z1(f,E,k):!!E;if(A&8){const R=o.dynamicProps;for(let D=0;D<R.length;D++){const F=R[D];if(E[F]!==f[F]&&!xm(k,F))return!0}}}else return(g||s)&&(!s||!s.$stable)?!0:f===E?!1:f?E?z1(f,E,k):!0:!!E;return!1}function z1(t,o,l){const f=Object.keys(o);if(f.length!==Object.keys(t).length)return!0;for(let g=0;g<f.length;g++){const x=f[g];if(o[x]!==t[x]&&!xm(l,x))return!0}return!1}function jI({vnode:t,parent:o},l){for(;o&&o.subTree===t;)(t=o.vnode).el=l,o=o.parent}const NI=t=>t.__isSuspense;function UI(t,o){o&&o.pendingBranch?_n(t)?o.effects.push(...t):o.effects.push(t):kI(t)}function Xi(t,o){if(Vi){let l=Vi.provides;const f=Vi.parent&&Vi.parent.provides;f===l&&(l=Vi.provides=Object.create(f)),l[t]=o}}function vi(t,o,l=!1){const f=Vi||Wr;if(f){const g=f.parent==null?f.vnode.appContext&&f.vnode.appContext.provides:f.parent.provides;if(g&&t in g)return g[t];if(arguments.length>1)return l&&Sn(o)?o.call(f.proxy):o}}function Cl(t,o){return ev(t,null,o)}const O1={};function Wn(t,o,l){return ev(t,o,l)}function ev(t,o,{immediate:l,deep:f,flush:g,onTrack:x,onTrigger:E}=li){const s=Vi;let A,k=!1,R=!1;if(Ei(t)?(A=()=>t.value,k=tm(t)):fa(t)?(A=()=>t,f=!0):_n(t)?(R=!0,k=t.some(xe=>fa(xe)||tm(xe)),A=()=>t.map(xe=>{if(Ei(xe))return xe.value;if(fa(xe))return bl(xe);if(Sn(xe))return da(xe,s,2)})):Sn(t)?o?A=()=>da(t,s,2):A=()=>{if(!(s&&s.isUnmounted))return D&&D(),Hr(t,s,3,[F])}:A=fo,o&&f){const xe=A;A=()=>bl(xe())}let D,F=xe=>{D=we.onStop=()=>{da(xe,s,4)}};if(Cf)return F=fo,o?l&&Hr(o,s,3,[A(),R?[]:void 0,F]):A(),fo;let G=R?[]:O1;const oe=()=>{if(!!we.active)if(o){const xe=we.run();(f||k||(R?xe.some((Te,Ue)=>yf(Te,G[Ue])):yf(xe,G)))&&(D&&D(),Hr(o,s,3,[xe,G===O1?void 0:G,F]),G=xe)}else we.run()};oe.allowRecurse=!!o;let se;g==="sync"?se=oe:g==="post"?se=()=>Tr(oe,s&&s.suspense):(oe.pre=!0,s&&(oe.id=s.uid),se=()=>Qy(oe));const we=new qy(A,se);return o?l?oe():G=we.run():g==="post"?Tr(we.run.bind(we),s&&s.suspense):we.run(),()=>{we.stop(),s&&s.scope&&Vy(s.scope.effects,we)}}function VI(t,o,l){const f=this.proxy,g=Oi(t)?t.includes(".")?cT(f,t):()=>f[t]:t.bind(f,f);let x;Sn(o)?x=o:(x=o.handler,l=o);const E=Vi;eu(this);const s=ev(g,x.bind(f),l);return E?eu(E):Sl(),s}function cT(t,o){const l=o.split(".");return()=>{let f=t;for(let g=0;g<l.length&&f;g++)f=f[l[g]];return f}}function bl(t,o){if(!di(t)||t.__v_skip||(o=o||new Set,o.has(t)))return t;if(o.add(t),Ei(t))bl(t.value,o);else if(_n(t))for(let l=0;l<t.length;l++)bl(t[l],o);else if(O2(t)||qc(t))t.forEach(l=>{bl(l,o)});else if(L2(t))for(const l in t)bl(t[l],o);return t}function uT(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Zo(()=>{t.isMounted=!0}),xs(()=>{t.isUnmounting=!0}),t}const $r=[Function,Array],$I={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:$r,onEnter:$r,onAfterEnter:$r,onEnterCancelled:$r,onBeforeLeave:$r,onLeave:$r,onAfterLeave:$r,onLeaveCancelled:$r,onBeforeAppear:$r,onAppear:$r,onAfterAppear:$r,onAppearCancelled:$r},setup(t,{slots:o}){const l=kl(),f=uT();let g;return()=>{const x=o.default&&tv(o.default(),!0);if(!x||!x.length)return;let E=x[0];if(x.length>1){for(const se of x)if(se.type!==Vo){E=se;break}}const s=Bn(t),{mode:A}=s;if(f.isLeaving)return m_(E);const k=k1(E);if(!k)return m_(E);const R=wf(k,s,f,l);Tf(k,R);const D=l.subTree,F=D&&k1(D);let G=!1;const{getTransitionKey:oe}=k.type;if(oe){const se=oe();g===void 0?g=se:se!==g&&(g=se,G=!0)}if(F&&F.type!==Vo&&(!yl(k,F)||G)){const se=wf(F,s,f,l);if(Tf(F,se),A==="out-in")return f.isLeaving=!0,se.afterLeave=()=>{f.isLeaving=!1,l.update()},m_(E);A==="in-out"&&k.type!==Vo&&(se.delayLeave=(we,xe,Te)=>{const Ue=fT(f,F);Ue[String(F.key)]=F,we._leaveCb=()=>{xe(),we._leaveCb=void 0,delete R.delayedLeave},R.delayedLeave=Te})}return E}}},hT=$I;function fT(t,o){const{leavingVNodes:l}=t;let f=l.get(o.type);return f||(f=Object.create(null),l.set(o.type,f)),f}function wf(t,o,l,f){const{appear:g,mode:x,persisted:E=!1,onBeforeEnter:s,onEnter:A,onAfterEnter:k,onEnterCancelled:R,onBeforeLeave:D,onLeave:F,onAfterLeave:G,onLeaveCancelled:oe,onBeforeAppear:se,onAppear:we,onAfterAppear:xe,onAppearCancelled:Te}=o,Ue=String(t.key),Be=fT(l,t),Pe=(ke,We)=>{ke&&Hr(ke,f,9,We)},Oe=(ke,We)=>{const ct=We[1];Pe(ke,We),_n(ke)?ke.every(Tt=>Tt.length<=1)&&ct():ke.length<=1&&ct()},Le={mode:x,persisted:E,beforeEnter(ke){let We=s;if(!l.isMounted)if(g)We=se||s;else return;ke._leaveCb&&ke._leaveCb(!0);const ct=Be[Ue];ct&&yl(t,ct)&&ct.el._leaveCb&&ct.el._leaveCb(),Pe(We,[ke])},enter(ke){let We=A,ct=k,Tt=R;if(!l.isMounted)if(g)We=we||A,ct=xe||k,Tt=Te||R;else return;let st=!1;const Ge=ke._enterCb=Ne=>{st||(st=!0,Ne?Pe(Tt,[ke]):Pe(ct,[ke]),Le.delayedLeave&&Le.delayedLeave(),ke._enterCb=void 0)};We?Oe(We,[ke,Ge]):Ge()},leave(ke,We){const ct=String(t.key);if(ke._enterCb&&ke._enterCb(!0),l.isUnmounting)return We();Pe(D,[ke]);let Tt=!1;const st=ke._leaveCb=Ge=>{Tt||(Tt=!0,We(),Ge?Pe(oe,[ke]):Pe(G,[ke]),ke._leaveCb=void 0,Be[ct]===t&&delete Be[ct])};Be[ct]=t,F?Oe(F,[ke,st]):st()},clone(ke){return wf(ke,o,l,f)}};return Le}function m_(t){if(bm(t))return t=bs(t),t.children=null,t}function k1(t){return bm(t)?t.children?t.children[0]:void 0:t}function Tf(t,o){t.shapeFlag&6&&t.component?Tf(t.component.subTree,o):t.shapeFlag&128?(t.ssContent.transition=o.clone(t.ssContent),t.ssFallback.transition=o.clone(t.ssFallback)):t.transition=o}function tv(t,o=!1,l){let f=[],g=0;for(let x=0;x<t.length;x++){let E=t[x];const s=l==null?E.key:String(l)+String(E.key!=null?E.key:x);E.type===yi?(E.patchFlag&128&&g++,f=f.concat(tv(E.children,o,s))):(o||E.type!==Vo)&&f.push(s!=null?bs(E,{key:s}):E)}if(g>1)for(let x=0;x<f.length;x++)f[x].patchFlag=-2;return f}function On(t){return Sn(t)?{setup:t,name:t.name}:t}const Fp=t=>!!t.type.__asyncLoader,bm=t=>t.type.__isKeepAlive;function GI(t,o){dT(t,"a",o)}function ZI(t,o){dT(t,"da",o)}function dT(t,o,l=Vi){const f=t.__wdc||(t.__wdc=()=>{let g=l;for(;g;){if(g.isDeactivated)return;g=g.parent}return t()});if(wm(o,f,l),l){let g=l.parent;for(;g&&g.parent;)bm(g.parent.vnode)&&qI(f,o,l,g),g=g.parent}}function qI(t,o,l,f){const g=wm(o,t,f,!0);Ol(()=>{Vy(f[o],g)},l)}function wm(t,o,l=Vi,f=!1){if(l){const g=l[t]||(l[t]=[]),x=o.__weh||(o.__weh=(...E)=>{if(l.isUnmounted)return;uu(),eu(l);const s=Hr(o,l,t,E);return Sl(),hu(),s});return f?g.unshift(x):g.push(x),x}}const Ts=t=>(o,l=Vi)=>(!Cf||t==="sp")&&wm(t,(...f)=>o(...f),l),pT=Ts("bm"),Zo=Ts("m"),WI=Ts("bu"),Uf=Ts("u"),xs=Ts("bum"),Ol=Ts("um"),HI=Ts("sp"),XI=Ts("rtg"),KI=Ts("rtc");function YI(t,o=Vi){wm("ec",t,o)}function Qc(t,o){const l=Wr;if(l===null)return t;const f=Cm(l)||l.proxy,g=t.dirs||(t.dirs=[]);for(let x=0;x<o.length;x++){let[E,s,A,k=li]=o[x];Sn(E)&&(E={mounted:E,updated:E}),E.deep&&bl(s),g.push({dir:E,instance:f,value:s,oldValue:void 0,arg:A,modifiers:k})}return t}function hl(t,o,l,f){const g=t.dirs,x=o&&o.dirs;for(let E=0;E<g.length;E++){const s=g[E];x&&(s.oldValue=x[E].value);let A=s.dir[f];A&&(uu(),Hr(A,l,8,[t.el,s,t,o]),hu())}}const mT="components",JI="directives";function jp(t,o){return gT(mT,t,!0,o)||t}const QI=Symbol();function nv(t){return gT(JI,t)}function gT(t,o,l=!0,f=!1){const g=Wr||Vi;if(g){const x=g.type;if(t===mT){const s=PP(x,!1);if(s&&(s===o||s===$o(o)||s===_m($o(o))))return x}const E=D1(g[t]||x[t],o)||D1(g.appContext[t],o);return!E&&f?x:E}}function D1(t,o){return t&&(t[o]||t[$o(o)]||t[_m($o(o))])}function L1(t,o,l,f){let g;const x=l&&l[f];if(_n(t)||Oi(t)){g=new Array(t.length);for(let E=0,s=t.length;E<s;E++)g[E]=o(t[E],E,void 0,x&&x[E])}else if(typeof t=="number"){g=new Array(t);for(let E=0;E<t;E++)g[E]=o(E+1,E,void 0,x&&x[E])}else if(di(t))if(t[Symbol.iterator])g=Array.from(t,(E,s)=>o(E,s,void 0,x&&x[s]));else{const E=Object.keys(t);g=new Array(E.length);for(let s=0,A=E.length;s<A;s++){const k=E[s];g[s]=o(t[k],k,s,x&&x[s])}}else g=[];return l&&(l[f]=g),g}const H_=t=>t?ST(t)?Cm(t)||t.proxy:H_(t.parent):null,im=$i(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>H_(t.parent),$root:t=>H_(t.root),$emit:t=>t.emit,$options:t=>iv(t),$forceUpdate:t=>t.f||(t.f=()=>Qy(t.update)),$nextTick:t=>t.n||(t.n=vs.bind(t.proxy)),$watch:t=>VI.bind(t)}),eP={get({_:t},o){const{ctx:l,setupState:f,data:g,props:x,accessCache:E,type:s,appContext:A}=t;let k;if(o[0]!=="$"){const G=E[o];if(G!==void 0)switch(G){case 1:return f[o];case 2:return g[o];case 4:return l[o];case 3:return x[o]}else{if(f!==li&&Rn(f,o))return E[o]=1,f[o];if(g!==li&&Rn(g,o))return E[o]=2,g[o];if((k=t.propsOptions[0])&&Rn(k,o))return E[o]=3,x[o];if(l!==li&&Rn(l,o))return E[o]=4,l[o];X_&&(E[o]=0)}}const R=im[o];let D,F;if(R)return o==="$attrs"&&Rr(t,"get",o),R(t);if((D=s.__cssModules)&&(D=D[o]))return D;if(l!==li&&Rn(l,o))return E[o]=4,l[o];if(F=A.config.globalProperties,Rn(F,o))return F[o]},set({_:t},o,l){const{data:f,setupState:g,ctx:x}=t;return g!==li&&Rn(g,o)?(g[o]=l,!0):f!==li&&Rn(f,o)?(f[o]=l,!0):Rn(t.props,o)||o[0]==="$"&&o.slice(1)in t?!1:(x[o]=l,!0)},has({_:{data:t,setupState:o,accessCache:l,ctx:f,appContext:g,propsOptions:x}},E){let s;return!!l[E]||t!==li&&Rn(t,E)||o!==li&&Rn(o,E)||(s=x[0])&&Rn(s,E)||Rn(f,E)||Rn(im,E)||Rn(g.config.globalProperties,E)},defineProperty(t,o,l){return l.get!=null?t._.accessCache[o]=0:Rn(l,"value")&&this.set(t,o,l.value,null),Reflect.defineProperty(t,o,l)}};let X_=!0;function tP(t){const o=iv(t),l=t.proxy,f=t.ctx;X_=!1,o.beforeCreate&&R1(o.beforeCreate,t,"bc");const{data:g,computed:x,methods:E,watch:s,provide:A,inject:k,created:R,beforeMount:D,mounted:F,beforeUpdate:G,updated:oe,activated:se,deactivated:we,beforeDestroy:xe,beforeUnmount:Te,destroyed:Ue,unmounted:Be,render:Pe,renderTracked:Oe,renderTriggered:Le,errorCaptured:ke,serverPrefetch:We,expose:ct,inheritAttrs:Tt,components:st,directives:Ge,filters:Ne}=o;if(k&&nP(k,f,null,t.appContext.config.unwrapInjectedRef),E)for(const at in E){const ht=E[at];Sn(ht)&&(f[at]=ht.bind(l))}if(g){const at=g.call(l,l);di(at)&&(t.data=mr(at))}if(X_=!0,x)for(const at in x){const ht=x[at],Ft=Sn(ht)?ht.bind(l,l):Sn(ht.get)?ht.get.bind(l,l):fo,ln=!Sn(ht)&&Sn(ht.set)?ht.set.bind(l):fo,pn=yt({get:Ft,set:ln});Object.defineProperty(f,at,{enumerable:!0,configurable:!0,get:()=>pn.value,set:Lt=>pn.value=Lt})}if(s)for(const at in s)_T(s[at],f,l,at);if(A){const at=Sn(A)?A.call(l):A;Reflect.ownKeys(at).forEach(ht=>{Xi(ht,at[ht])})}R&&R1(R,t,"c");function rt(at,ht){_n(ht)?ht.forEach(Ft=>at(Ft.bind(l))):ht&&at(ht.bind(l))}if(rt(pT,D),rt(Zo,F),rt(WI,G),rt(Uf,oe),rt(GI,se),rt(ZI,we),rt(YI,ke),rt(KI,Oe),rt(XI,Le),rt(xs,Te),rt(Ol,Be),rt(HI,We),_n(ct))if(ct.length){const at=t.exposed||(t.exposed={});ct.forEach(ht=>{Object.defineProperty(at,ht,{get:()=>l[ht],set:Ft=>l[ht]=Ft})})}else t.exposed||(t.exposed={});Pe&&t.render===fo&&(t.render=Pe),Tt!=null&&(t.inheritAttrs=Tt),st&&(t.components=st),Ge&&(t.directives=Ge)}function nP(t,o,l=fo,f=!1){_n(t)&&(t=K_(t));for(const g in t){const x=t[g];let E;di(x)?"default"in x?E=vi(x.from||g,x.default,!0):E=vi(x.from||g):E=vi(x),Ei(E)&&f?Object.defineProperty(o,g,{enumerable:!0,configurable:!0,get:()=>E.value,set:s=>E.value=s}):o[g]=E}}function R1(t,o,l){Hr(_n(t)?t.map(f=>f.bind(o.proxy)):t.bind(o.proxy),o,l)}function _T(t,o,l,f){const g=f.includes(".")?cT(l,f):()=>l[f];if(Oi(t)){const x=o[t];Sn(x)&&Wn(g,x)}else if(Sn(t))Wn(g,t.bind(l));else if(di(t))if(_n(t))t.forEach(x=>_T(x,o,l,f));else{const x=Sn(t.handler)?t.handler.bind(l):o[t.handler];Sn(x)&&Wn(g,x,t)}}function iv(t){const o=t.type,{mixins:l,extends:f}=o,{mixins:g,optionsCache:x,config:{optionMergeStrategies:E}}=t.appContext,s=x.get(o);let A;return s?A=s:!g.length&&!l&&!f?A=o:(A={},g.length&&g.forEach(k=>rm(A,k,E,!0)),rm(A,o,E)),di(o)&&x.set(o,A),A}function rm(t,o,l,f=!1){const{mixins:g,extends:x}=o;x&&rm(t,x,l,!0),g&&g.forEach(E=>rm(t,E,l,!0));for(const E in o)if(!(f&&E==="expose")){const s=iP[E]||l&&l[E];t[E]=s?s(t[E],o[E]):o[E]}return t}const iP={data:B1,props:ml,emits:ml,methods:ml,computed:ml,beforeCreate:hr,created:hr,beforeMount:hr,mounted:hr,beforeUpdate:hr,updated:hr,beforeDestroy:hr,beforeUnmount:hr,destroyed:hr,unmounted:hr,activated:hr,deactivated:hr,errorCaptured:hr,serverPrefetch:hr,components:ml,directives:ml,watch:oP,provide:B1,inject:rP};function B1(t,o){return o?t?function(){return $i(Sn(t)?t.call(this,this):t,Sn(o)?o.call(this,this):o)}:o:t}function rP(t,o){return ml(K_(t),K_(o))}function K_(t){if(_n(t)){const o={};for(let l=0;l<t.length;l++)o[t[l]]=t[l];return o}return t}function hr(t,o){return t?[...new Set([].concat(t,o))]:o}function ml(t,o){return t?$i($i(Object.create(null),t),o):o}function oP(t,o){if(!t)return o;if(!o)return t;const l=$i(Object.create(null),t);for(const f in o)l[f]=hr(t[f],o[f]);return l}function sP(t,o,l,f=!1){const g={},x={};em(x,Em,1),t.propsDefaults=Object.create(null),yT(t,o,g,x);for(const E in t.propsOptions[0])E in g||(g[E]=void 0);l?t.props=f?g:TI(g):t.type.props?t.props=g:t.props=x,t.attrs=x}function aP(t,o,l,f){const{props:g,attrs:x,vnode:{patchFlag:E}}=t,s=Bn(g),[A]=t.propsOptions;let k=!1;if((f||E>0)&&!(E&16)){if(E&8){const R=t.vnode.dynamicProps;for(let D=0;D<R.length;D++){let F=R[D];if(xm(t.emitsOptions,F))continue;const G=o[F];if(A)if(Rn(x,F))G!==x[F]&&(x[F]=G,k=!0);else{const oe=$o(F);g[oe]=Y_(A,s,oe,G,t,!1)}else G!==x[F]&&(x[F]=G,k=!0)}}}else{yT(t,o,g,x)&&(k=!0);let R;for(const D in s)(!o||!Rn(o,D)&&((R=cu(D))===D||!Rn(o,R)))&&(A?l&&(l[D]!==void 0||l[R]!==void 0)&&(g[D]=Y_(A,s,D,void 0,t,!0)):delete g[D]);if(x!==s)for(const D in x)(!o||!Rn(o,D)&&!0)&&(delete x[D],k=!0)}k&&ys(t,"set","$attrs")}function yT(t,o,l,f){const[g,x]=t.propsOptions;let E=!1,s;if(o)for(let A in o){if(Bp(A))continue;const k=o[A];let R;g&&Rn(g,R=$o(A))?!x||!x.includes(R)?l[R]=k:(s||(s={}))[R]=k:xm(t.emitsOptions,A)||(!(A in f)||k!==f[A])&&(f[A]=k,E=!0)}if(x){const A=Bn(l),k=s||li;for(let R=0;R<x.length;R++){const D=x[R];l[D]=Y_(g,A,D,k[D],t,!Rn(k,D))}}return E}function Y_(t,o,l,f,g,x){const E=t[l];if(E!=null){const s=Rn(E,"default");if(s&&f===void 0){const A=E.default;if(E.type!==Function&&Sn(A)){const{propsDefaults:k}=g;l in k?f=k[l]:(eu(g),f=k[l]=A.call(null,o),Sl())}else f=A}E[0]&&(x&&!s?f=!1:E[1]&&(f===""||f===cu(l))&&(f=!0))}return f}function vT(t,o,l=!1){const f=o.propsCache,g=f.get(t);if(g)return g;const x=t.props,E={},s=[];let A=!1;if(!Sn(t)){const R=D=>{A=!0;const[F,G]=vT(D,o,!0);$i(E,F),G&&s.push(...G)};!l&&o.mixins.length&&o.mixins.forEach(R),t.extends&&R(t.extends),t.mixins&&t.mixins.forEach(R)}if(!x&&!A)return di(t)&&f.set(t,Zc),Zc;if(_n(x))for(let R=0;R<x.length;R++){const D=$o(x[R]);F1(D)&&(E[D]=li)}else if(x)for(const R in x){const D=$o(R);if(F1(D)){const F=x[R],G=E[D]=_n(F)||Sn(F)?{type:F}:F;if(G){const oe=U1(Boolean,G.type),se=U1(String,G.type);G[0]=oe>-1,G[1]=se<0||oe<se,(oe>-1||Rn(G,"default"))&&s.push(D)}}}const k=[E,s];return di(t)&&f.set(t,k),k}function F1(t){return t[0]!=="$"}function j1(t){const o=t&&t.toString().match(/^\s*function (\w+)/);return o?o[1]:t===null?"null":""}function N1(t,o){return j1(t)===j1(o)}function U1(t,o){return _n(o)?o.findIndex(l=>N1(l,t)):Sn(o)&&N1(o,t)?0:-1}const xT=t=>t[0]==="_"||t==="$stable",rv=t=>_n(t)?t.map(Fo):[Fo(t)],lP=(t,o,l)=>{if(o._n)return o;const f=co((...g)=>rv(o(...g)),l);return f._c=!1,f},bT=(t,o,l)=>{const f=t._ctx;for(const g in t){if(xT(g))continue;const x=t[g];if(Sn(x))o[g]=lP(g,x,f);else if(x!=null){const E=rv(x);o[g]=()=>E}}},wT=(t,o)=>{const l=rv(o);t.slots.default=()=>l},cP=(t,o)=>{if(t.vnode.shapeFlag&32){const l=o._;l?(t.slots=Bn(o),em(o,"_",l)):bT(o,t.slots={})}else t.slots={},o&&wT(t,o);em(t.slots,Em,1)},uP=(t,o,l)=>{const{vnode:f,slots:g}=t;let x=!0,E=li;if(f.shapeFlag&32){const s=o._;s?l&&s===1?x=!1:($i(g,o),!l&&s===1&&delete g._):(x=!o.$stable,bT(o,g)),E=o}else o&&(wT(t,o),E={default:1});if(x)for(const s in g)!xT(s)&&!(s in E)&&delete g[s]};function TT(){return{app:null,config:{isNativeTag:GA,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let hP=0;function fP(t,o){return function(f,g=null){Sn(f)||(f=Object.assign({},f)),g!=null&&!di(g)&&(g=null);const x=TT(),E=new Set;let s=!1;const A=x.app={_uid:hP++,_component:f,_props:g,_container:null,_context:x,_instance:null,version:OP,get config(){return x.config},set config(k){},use(k,...R){return E.has(k)||(k&&Sn(k.install)?(E.add(k),k.install(A,...R)):Sn(k)&&(E.add(k),k(A,...R))),A},mixin(k){return x.mixins.includes(k)||x.mixins.push(k),A},component(k,R){return R?(x.components[k]=R,A):x.components[k]},directive(k,R){return R?(x.directives[k]=R,A):x.directives[k]},mount(k,R,D){if(!s){const F=Me(f,g);return F.appContext=x,R&&o?o(F,k):t(F,k,D),s=!0,A._container=k,k.__vue_app__=A,Cm(F.component)||F.component.proxy}},unmount(){s&&(t(null,A._container),delete A._container.__vue_app__)},provide(k,R){return x.provides[k]=R,A}};return A}}function J_(t,o,l,f,g=!1){if(_n(t)){t.forEach((F,G)=>J_(F,o&&(_n(o)?o[G]:o),l,f,g));return}if(Fp(f)&&!g)return;const x=f.shapeFlag&4?Cm(f.component)||f.component.proxy:f.el,E=g?null:x,{i:s,r:A}=t,k=o&&o.r,R=s.refs===li?s.refs={}:s.refs,D=s.setupState;if(k!=null&&k!==A&&(Oi(k)?(R[k]=null,Rn(D,k)&&(D[k]=null)):Ei(k)&&(k.value=null)),Sn(A))da(A,s,12,[E,R]);else{const F=Oi(A),G=Ei(A);if(F||G){const oe=()=>{if(t.f){const se=F?Rn(D,A)?D[A]:R[A]:A.value;g?_n(se)&&Vy(se,x):_n(se)?se.includes(x)||se.push(x):F?(R[A]=[x],Rn(D,A)&&(D[A]=R[A])):(A.value=[x],t.k&&(R[t.k]=A.value))}else F?(R[A]=E,Rn(D,A)&&(D[A]=E)):G&&(A.value=E,t.k&&(R[t.k]=E))};E?(oe.id=-1,Tr(oe,l)):oe()}}}const Tr=UI;function dP(t){return pP(t)}function pP(t,o){const l=KA();l.__VUE__=!0;const{insert:f,remove:g,patchProp:x,createElement:E,createText:s,createComment:A,setText:k,setElementText:R,parentNode:D,nextSibling:F,setScopeId:G=fo,insertStaticContent:oe}=t,se=(ie,ye,Ae,qe=null,ot=null,Et=null,wt=!1,ft=null,Qe=!!ye.dynamicChildren)=>{if(ie===ye)return;ie&&!yl(ie,ye)&&(qe=ut(ie),Lt(ie,ot,Et,!0),ie=null),ye.patchFlag===-2&&(Qe=!1,ye.dynamicChildren=null);const{type:dt,ref:Rt,shapeFlag:Ct}=ye;switch(dt){case Tm:we(ie,ye,Ae,qe);break;case Vo:xe(ie,ye,Ae,qe);break;case g_:ie==null&&Te(ye,Ae,qe,wt);break;case yi:st(ie,ye,Ae,qe,ot,Et,wt,ft,Qe);break;default:Ct&1?Pe(ie,ye,Ae,qe,ot,Et,wt,ft,Qe):Ct&6?Ge(ie,ye,Ae,qe,ot,Et,wt,ft,Qe):(Ct&64||Ct&128)&&dt.process(ie,ye,Ae,qe,ot,Et,wt,ft,Qe,Yt)}Rt!=null&&ot&&J_(Rt,ie&&ie.ref,Et,ye||ie,!ye)},we=(ie,ye,Ae,qe)=>{if(ie==null)f(ye.el=s(ye.children),Ae,qe);else{const ot=ye.el=ie.el;ye.children!==ie.children&&k(ot,ye.children)}},xe=(ie,ye,Ae,qe)=>{ie==null?f(ye.el=A(ye.children||""),Ae,qe):ye.el=ie.el},Te=(ie,ye,Ae,qe)=>{[ie.el,ie.anchor]=oe(ie.children,ye,Ae,qe,ie.el,ie.anchor)},Ue=({el:ie,anchor:ye},Ae,qe)=>{let ot;for(;ie&&ie!==ye;)ot=F(ie),f(ie,Ae,qe),ie=ot;f(ye,Ae,qe)},Be=({el:ie,anchor:ye})=>{let Ae;for(;ie&&ie!==ye;)Ae=F(ie),g(ie),ie=Ae;g(ye)},Pe=(ie,ye,Ae,qe,ot,Et,wt,ft,Qe)=>{wt=wt||ye.type==="svg",ie==null?Oe(ye,Ae,qe,ot,Et,wt,ft,Qe):We(ie,ye,ot,Et,wt,ft,Qe)},Oe=(ie,ye,Ae,qe,ot,Et,wt,ft)=>{let Qe,dt;const{type:Rt,props:Ct,shapeFlag:jt,transition:Xt,dirs:sn}=ie;if(Qe=ie.el=E(ie.type,Et,Ct&&Ct.is,Ct),jt&8?R(Qe,ie.children):jt&16&&ke(ie.children,Qe,null,qe,ot,Et&&Rt!=="foreignObject",wt,ft),sn&&hl(ie,null,qe,"created"),Ct){for(const yn in Ct)yn!=="value"&&!Bp(yn)&&x(Qe,yn,null,Ct[yn],Et,ie.children,qe,ot,Xe);"value"in Ct&&x(Qe,"value",null,Ct.value),(dt=Ct.onVnodeBeforeMount)&&Lo(dt,qe,ie)}Le(Qe,ie,ie.scopeId,wt,qe),sn&&hl(ie,null,qe,"beforeMount");const Pn=(!ot||ot&&!ot.pendingBranch)&&Xt&&!Xt.persisted;Pn&&Xt.beforeEnter(Qe),f(Qe,ye,Ae),((dt=Ct&&Ct.onVnodeMounted)||Pn||sn)&&Tr(()=>{dt&&Lo(dt,qe,ie),Pn&&Xt.enter(Qe),sn&&hl(ie,null,qe,"mounted")},ot)},Le=(ie,ye,Ae,qe,ot)=>{if(Ae&&G(ie,Ae),qe)for(let Et=0;Et<qe.length;Et++)G(ie,qe[Et]);if(ot){let Et=ot.subTree;if(ye===Et){const wt=ot.vnode;Le(ie,wt,wt.scopeId,wt.slotScopeIds,ot.parent)}}},ke=(ie,ye,Ae,qe,ot,Et,wt,ft,Qe=0)=>{for(let dt=Qe;dt<ie.length;dt++){const Rt=ie[dt]=ft?oa(ie[dt]):Fo(ie[dt]);se(null,Rt,ye,Ae,qe,ot,Et,wt,ft)}},We=(ie,ye,Ae,qe,ot,Et,wt)=>{const ft=ye.el=ie.el;let{patchFlag:Qe,dynamicChildren:dt,dirs:Rt}=ye;Qe|=ie.patchFlag&16;const Ct=ie.props||li,jt=ye.props||li;let Xt;Ae&&fl(Ae,!1),(Xt=jt.onVnodeBeforeUpdate)&&Lo(Xt,Ae,ye,ie),Rt&&hl(ye,ie,Ae,"beforeUpdate"),Ae&&fl(Ae,!0);const sn=ot&&ye.type!=="foreignObject";if(dt?ct(ie.dynamicChildren,dt,ft,Ae,qe,sn,Et):wt||ht(ie,ye,ft,null,Ae,qe,sn,Et,!1),Qe>0){if(Qe&16)Tt(ft,ye,Ct,jt,Ae,qe,ot);else if(Qe&2&&Ct.class!==jt.class&&x(ft,"class",null,jt.class,ot),Qe&4&&x(ft,"style",Ct.style,jt.style,ot),Qe&8){const Pn=ye.dynamicProps;for(let yn=0;yn<Pn.length;yn++){const Nn=Pn[yn],bi=Ct[Nn],Sr=jt[Nn];(Sr!==bi||Nn==="value")&&x(ft,Nn,bi,Sr,ot,ie.children,Ae,qe,Xe)}}Qe&1&&ie.children!==ye.children&&R(ft,ye.children)}else!wt&&dt==null&&Tt(ft,ye,Ct,jt,Ae,qe,ot);((Xt=jt.onVnodeUpdated)||Rt)&&Tr(()=>{Xt&&Lo(Xt,Ae,ye,ie),Rt&&hl(ye,ie,Ae,"updated")},qe)},ct=(ie,ye,Ae,qe,ot,Et,wt)=>{for(let ft=0;ft<ye.length;ft++){const Qe=ie[ft],dt=ye[ft],Rt=Qe.el&&(Qe.type===yi||!yl(Qe,dt)||Qe.shapeFlag&70)?D(Qe.el):Ae;se(Qe,dt,Rt,null,qe,ot,Et,wt,!0)}},Tt=(ie,ye,Ae,qe,ot,Et,wt)=>{if(Ae!==qe){if(Ae!==li)for(const ft in Ae)!Bp(ft)&&!(ft in qe)&&x(ie,ft,Ae[ft],null,wt,ye.children,ot,Et,Xe);for(const ft in qe){if(Bp(ft))continue;const Qe=qe[ft],dt=Ae[ft];Qe!==dt&&ft!=="value"&&x(ie,ft,dt,Qe,wt,ye.children,ot,Et,Xe)}"value"in qe&&x(ie,"value",Ae.value,qe.value)}},st=(ie,ye,Ae,qe,ot,Et,wt,ft,Qe)=>{const dt=ye.el=ie?ie.el:s(""),Rt=ye.anchor=ie?ie.anchor:s("");let{patchFlag:Ct,dynamicChildren:jt,slotScopeIds:Xt}=ye;Xt&&(ft=ft?ft.concat(Xt):Xt),ie==null?(f(dt,Ae,qe),f(Rt,Ae,qe),ke(ye.children,Ae,Rt,ot,Et,wt,ft,Qe)):Ct>0&&Ct&64&&jt&&ie.dynamicChildren?(ct(ie.dynamicChildren,jt,Ae,ot,Et,wt,ft),(ye.key!=null||ot&&ye===ot.subTree)&&ov(ie,ye,!0)):ht(ie,ye,Ae,Rt,ot,Et,wt,ft,Qe)},Ge=(ie,ye,Ae,qe,ot,Et,wt,ft,Qe)=>{ye.slotScopeIds=ft,ie==null?ye.shapeFlag&512?ot.ctx.activate(ye,Ae,qe,wt,Qe):Ne(ye,Ae,qe,ot,Et,wt,Qe):vt(ie,ye,Qe)},Ne=(ie,ye,Ae,qe,ot,Et,wt)=>{const ft=ie.component=CP(ie,qe,ot);if(bm(ie)&&(ft.ctx.renderer=Yt),SP(ft),ft.asyncDep){if(ot&&ot.registerDep(ft,rt),!ie.el){const Qe=ft.subTree=Me(Vo);xe(null,Qe,ye,Ae)}return}rt(ft,ie,ye,Ae,ot,Et,wt)},vt=(ie,ye,Ae)=>{const qe=ye.component=ie.component;if(FI(ie,ye,Ae))if(qe.asyncDep&&!qe.asyncResolved){at(qe,ye,Ae);return}else qe.next=ye,OI(qe.update),qe.update();else ye.el=ie.el,qe.vnode=ye},rt=(ie,ye,Ae,qe,ot,Et,wt)=>{const ft=()=>{if(ie.isMounted){let{next:Rt,bu:Ct,u:jt,parent:Xt,vnode:sn}=ie,Pn=Rt,yn;fl(ie,!1),Rt?(Rt.el=sn.el,at(ie,Rt,wt)):Rt=sn,Ct&&d_(Ct),(yn=Rt.props&&Rt.props.onVnodeBeforeUpdate)&&Lo(yn,Xt,Rt,sn),fl(ie,!0);const Nn=p_(ie),bi=ie.subTree;ie.subTree=Nn,se(bi,Nn,D(bi.el),ut(bi),ie,ot,Et),Rt.el=Nn.el,Pn===null&&jI(ie,Nn.el),jt&&Tr(jt,ot),(yn=Rt.props&&Rt.props.onVnodeUpdated)&&Tr(()=>Lo(yn,Xt,Rt,sn),ot)}else{let Rt;const{el:Ct,props:jt}=ye,{bm:Xt,m:sn,parent:Pn}=ie,yn=Fp(ye);if(fl(ie,!1),Xt&&d_(Xt),!yn&&(Rt=jt&&jt.onVnodeBeforeMount)&&Lo(Rt,Pn,ye),fl(ie,!0),Ct&&qt){const Nn=()=>{ie.subTree=p_(ie),qt(Ct,ie.subTree,ie,ot,null)};yn?ye.type.__asyncLoader().then(()=>!ie.isUnmounted&&Nn()):Nn()}else{const Nn=ie.subTree=p_(ie);se(null,Nn,Ae,qe,ie,ot,Et),ye.el=Nn.el}if(sn&&Tr(sn,ot),!yn&&(Rt=jt&&jt.onVnodeMounted)){const Nn=ye;Tr(()=>Lo(Rt,Pn,Nn),ot)}(ye.shapeFlag&256||Pn&&Fp(Pn.vnode)&&Pn.vnode.shapeFlag&256)&&ie.a&&Tr(ie.a,ot),ie.isMounted=!0,ye=Ae=qe=null}},Qe=ie.effect=new qy(ft,()=>Qy(dt),ie.scope),dt=ie.update=()=>Qe.run();dt.id=ie.uid,fl(ie,!0),dt()},at=(ie,ye,Ae)=>{ye.component=ie;const qe=ie.vnode.props;ie.vnode=ye,ie.next=null,aP(ie,ye.props,qe,Ae),uP(ie,ye.children,Ae),uu(),P1(),hu()},ht=(ie,ye,Ae,qe,ot,Et,wt,ft,Qe=!1)=>{const dt=ie&&ie.children,Rt=ie?ie.shapeFlag:0,Ct=ye.children,{patchFlag:jt,shapeFlag:Xt}=ye;if(jt>0){if(jt&128){ln(dt,Ct,Ae,qe,ot,Et,wt,ft,Qe);return}else if(jt&256){Ft(dt,Ct,Ae,qe,ot,Et,wt,ft,Qe);return}}Xt&8?(Rt&16&&Xe(dt,ot,Et),Ct!==dt&&R(Ae,Ct)):Rt&16?Xt&16?ln(dt,Ct,Ae,qe,ot,Et,wt,ft,Qe):Xe(dt,ot,Et,!0):(Rt&8&&R(Ae,""),Xt&16&&ke(Ct,Ae,qe,ot,Et,wt,ft,Qe))},Ft=(ie,ye,Ae,qe,ot,Et,wt,ft,Qe)=>{ie=ie||Zc,ye=ye||Zc;const dt=ie.length,Rt=ye.length,Ct=Math.min(dt,Rt);let jt;for(jt=0;jt<Ct;jt++){const Xt=ye[jt]=Qe?oa(ye[jt]):Fo(ye[jt]);se(ie[jt],Xt,Ae,null,ot,Et,wt,ft,Qe)}dt>Rt?Xe(ie,ot,Et,!0,!1,Ct):ke(ye,Ae,qe,ot,Et,wt,ft,Qe,Ct)},ln=(ie,ye,Ae,qe,ot,Et,wt,ft,Qe)=>{let dt=0;const Rt=ye.length;let Ct=ie.length-1,jt=Rt-1;for(;dt<=Ct&&dt<=jt;){const Xt=ie[dt],sn=ye[dt]=Qe?oa(ye[dt]):Fo(ye[dt]);if(yl(Xt,sn))se(Xt,sn,Ae,null,ot,Et,wt,ft,Qe);else break;dt++}for(;dt<=Ct&&dt<=jt;){const Xt=ie[Ct],sn=ye[jt]=Qe?oa(ye[jt]):Fo(ye[jt]);if(yl(Xt,sn))se(Xt,sn,Ae,null,ot,Et,wt,ft,Qe);else break;Ct--,jt--}if(dt>Ct){if(dt<=jt){const Xt=jt+1,sn=Xt<Rt?ye[Xt].el:qe;for(;dt<=jt;)se(null,ye[dt]=Qe?oa(ye[dt]):Fo(ye[dt]),Ae,sn,ot,Et,wt,ft,Qe),dt++}}else if(dt>jt)for(;dt<=Ct;)Lt(ie[dt],ot,Et,!0),dt++;else{const Xt=dt,sn=dt,Pn=new Map;for(dt=sn;dt<=jt;dt++){const wi=ye[dt]=Qe?oa(ye[dt]):Fo(ye[dt]);wi.key!=null&&Pn.set(wi.key,dt)}let yn,Nn=0;const bi=jt-sn+1;let Sr=!1,Di=0;const Gi=new Array(bi);for(dt=0;dt<bi;dt++)Gi[dt]=0;for(dt=Xt;dt<=Ct;dt++){const wi=ie[dt];if(Nn>=bi){Lt(wi,ot,Et,!0);continue}let Li;if(wi.key!=null)Li=Pn.get(wi.key);else for(yn=sn;yn<=jt;yn++)if(Gi[yn-sn]===0&&yl(wi,ye[yn])){Li=yn;break}Li===void 0?Lt(wi,ot,Et,!0):(Gi[Li-sn]=dt+1,Li>=Di?Di=Li:Sr=!0,se(wi,ye[Li],Ae,null,ot,Et,wt,ft,Qe),Nn++)}const Wo=Sr?mP(Gi):Zc;for(yn=Wo.length-1,dt=bi-1;dt>=0;dt--){const wi=sn+dt,Li=ye[wi],mo=wi+1<Rt?ye[wi+1].el:qe;Gi[dt]===0?se(null,Li,Ae,mo,ot,Et,wt,ft,Qe):Sr&&(yn<0||dt!==Wo[yn]?pn(Li,Ae,mo,2):yn--)}}},pn=(ie,ye,Ae,qe,ot=null)=>{const{el:Et,type:wt,transition:ft,children:Qe,shapeFlag:dt}=ie;if(dt&6){pn(ie.component.subTree,ye,Ae,qe);return}if(dt&128){ie.suspense.move(ye,Ae,qe);return}if(dt&64){wt.move(ie,ye,Ae,Yt);return}if(wt===yi){f(Et,ye,Ae);for(let Ct=0;Ct<Qe.length;Ct++)pn(Qe[Ct],ye,Ae,qe);f(ie.anchor,ye,Ae);return}if(wt===g_){Ue(ie,ye,Ae);return}if(qe!==2&&dt&1&&ft)if(qe===0)ft.beforeEnter(Et),f(Et,ye,Ae),Tr(()=>ft.enter(Et),ot);else{const{leave:Ct,delayLeave:jt,afterLeave:Xt}=ft,sn=()=>f(Et,ye,Ae),Pn=()=>{Ct(Et,()=>{sn(),Xt&&Xt()})};jt?jt(Et,sn,Pn):Pn()}else f(Et,ye,Ae)},Lt=(ie,ye,Ae,qe=!1,ot=!1)=>{const{type:Et,props:wt,ref:ft,children:Qe,dynamicChildren:dt,shapeFlag:Rt,patchFlag:Ct,dirs:jt}=ie;if(ft!=null&&J_(ft,null,Ae,ie,!0),Rt&256){ye.ctx.deactivate(ie);return}const Xt=Rt&1&&jt,sn=!Fp(ie);let Pn;if(sn&&(Pn=wt&&wt.onVnodeBeforeUnmount)&&Lo(Pn,ye,ie),Rt&6)be(ie.component,Ae,qe);else{if(Rt&128){ie.suspense.unmount(Ae,qe);return}Xt&&hl(ie,null,ye,"beforeUnmount"),Rt&64?ie.type.remove(ie,ye,Ae,ot,Yt,qe):dt&&(Et!==yi||Ct>0&&Ct&64)?Xe(dt,ye,Ae,!1,!0):(Et===yi&&Ct&384||!ot&&Rt&16)&&Xe(Qe,ye,Ae),qe&&nn(ie)}(sn&&(Pn=wt&&wt.onVnodeUnmounted)||Xt)&&Tr(()=>{Pn&&Lo(Pn,ye,ie),Xt&&hl(ie,null,ye,"unmounted")},Ae)},nn=ie=>{const{type:ye,el:Ae,anchor:qe,transition:ot}=ie;if(ye===yi){xt(Ae,qe);return}if(ye===g_){Be(ie);return}const Et=()=>{g(Ae),ot&&!ot.persisted&&ot.afterLeave&&ot.afterLeave()};if(ie.shapeFlag&1&&ot&&!ot.persisted){const{leave:wt,delayLeave:ft}=ot,Qe=()=>wt(Ae,Et);ft?ft(ie.el,Et,Qe):Qe()}else Et()},xt=(ie,ye)=>{let Ae;for(;ie!==ye;)Ae=F(ie),g(ie),ie=Ae;g(ye)},be=(ie,ye,Ae)=>{const{bum:qe,scope:ot,update:Et,subTree:wt,um:ft}=ie;qe&&d_(qe),ot.stop(),Et&&(Et.active=!1,Lt(wt,ie,ye,Ae)),ft&&Tr(ft,ye),Tr(()=>{ie.isUnmounted=!0},ye),ye&&ye.pendingBranch&&!ye.isUnmounted&&ie.asyncDep&&!ie.asyncResolved&&ie.suspenseId===ye.pendingId&&(ye.deps--,ye.deps===0&&ye.resolve())},Xe=(ie,ye,Ae,qe=!1,ot=!1,Et=0)=>{for(let wt=Et;wt<ie.length;wt++)Lt(ie[wt],ye,Ae,qe,ot)},ut=ie=>ie.shapeFlag&6?ut(ie.component.subTree):ie.shapeFlag&128?ie.suspense.next():F(ie.anchor||ie.el),bt=(ie,ye,Ae)=>{ie==null?ye._vnode&&Lt(ye._vnode,null,null,!0):se(ye._vnode||null,ie,ye,null,null,null,Ae),P1(),oT(),ye._vnode=ie},Yt={p:se,um:Lt,m:pn,r:nn,mt:Ne,mc:ke,pc:ht,pbc:ct,n:ut,o:t};let en,qt;return o&&([en,qt]=o(Yt)),{render:bt,hydrate:en,createApp:fP(bt,en)}}function fl({effect:t,update:o},l){t.allowRecurse=o.allowRecurse=l}function ov(t,o,l=!1){const f=t.children,g=o.children;if(_n(f)&&_n(g))for(let x=0;x<f.length;x++){const E=f[x];let s=g[x];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=g[x]=oa(g[x]),s.el=E.el),l||ov(E,s))}}function mP(t){const o=t.slice(),l=[0];let f,g,x,E,s;const A=t.length;for(f=0;f<A;f++){const k=t[f];if(k!==0){if(g=l[l.length-1],t[g]<k){o[f]=g,l.push(f);continue}for(x=0,E=l.length-1;x<E;)s=x+E>>1,t[l[s]]<k?x=s+1:E=s;k<t[l[x]]&&(x>0&&(o[f]=l[x-1]),l[x]=f)}}for(x=l.length,E=l[x-1];x-- >0;)l[x]=E,E=o[E];return l}const gP=t=>t.__isTeleport,lf=t=>t&&(t.disabled||t.disabled===""),V1=t=>typeof SVGElement<"u"&&t instanceof SVGElement,Q_=(t,o)=>{const l=t&&t.to;return Oi(l)?o?o(l):null:l},_P={__isTeleport:!0,process(t,o,l,f,g,x,E,s,A,k){const{mc:R,pc:D,pbc:F,o:{insert:G,querySelector:oe,createText:se,createComment:we}}=k,xe=lf(o.props);let{shapeFlag:Te,children:Ue,dynamicChildren:Be}=o;if(t==null){const Pe=o.el=se(""),Oe=o.anchor=se("");G(Pe,l,f),G(Oe,l,f);const Le=o.target=Q_(o.props,oe),ke=o.targetAnchor=se("");Le&&(G(ke,Le),E=E||V1(Le));const We=(ct,Tt)=>{Te&16&&R(Ue,ct,Tt,g,x,E,s,A)};xe?We(l,Oe):Le&&We(Le,ke)}else{o.el=t.el;const Pe=o.anchor=t.anchor,Oe=o.target=t.target,Le=o.targetAnchor=t.targetAnchor,ke=lf(t.props),We=ke?l:Oe,ct=ke?Pe:Le;if(E=E||V1(Oe),Be?(F(t.dynamicChildren,Be,We,g,x,E,s),ov(t,o,!0)):A||D(t,o,We,ct,g,x,E,s,!1),xe)ke||Cp(o,l,Pe,k,1);else if((o.props&&o.props.to)!==(t.props&&t.props.to)){const Tt=o.target=Q_(o.props,oe);Tt&&Cp(o,Tt,null,k,0)}else ke&&Cp(o,Oe,Le,k,1)}},remove(t,o,l,f,{um:g,o:{remove:x}},E){const{shapeFlag:s,children:A,anchor:k,targetAnchor:R,target:D,props:F}=t;if(D&&x(R),(E||!lf(F))&&(x(k),s&16))for(let G=0;G<A.length;G++){const oe=A[G];g(oe,o,l,!0,!!oe.dynamicChildren)}},move:Cp,hydrate:yP};function Cp(t,o,l,{o:{insert:f},m:g},x=2){x===0&&f(t.targetAnchor,o,l);const{el:E,anchor:s,shapeFlag:A,children:k,props:R}=t,D=x===2;if(D&&f(E,o,l),(!D||lf(R))&&A&16)for(let F=0;F<k.length;F++)g(k[F],o,l,2);D&&f(s,o,l)}function yP(t,o,l,f,g,x,{o:{nextSibling:E,parentNode:s,querySelector:A}},k){const R=o.target=Q_(o.props,A);if(R){const D=R._lpa||R.firstChild;if(o.shapeFlag&16)if(lf(o.props))o.anchor=k(E(t),o,s(t),l,f,g,x),o.targetAnchor=D;else{o.anchor=E(t);let F=D;for(;F;)if(F=E(F),F&&F.nodeType===8&&F.data==="teleport anchor"){o.targetAnchor=F,R._lpa=o.targetAnchor&&E(o.targetAnchor);break}k(D,o,R,l,f,g,x)}}return o.anchor&&E(o.anchor)}const sv=_P,yi=Symbol(void 0),Tm=Symbol(void 0),Vo=Symbol(void 0),g_=Symbol(void 0),cf=[];let ho=null;function fr(t=!1){cf.push(ho=t?null:[])}function vP(){cf.pop(),ho=cf[cf.length-1]||null}let Ef=1;function $1(t){Ef+=t}function ET(t){return t.dynamicChildren=Ef>0?ho||Zc:null,vP(),Ef>0&&ho&&ho.push(t),t}function pa(t,o,l,f,g,x){return ET(la(t,o,l,f,g,x,!0))}function wl(t,o,l,f,g){return ET(Me(t,o,l,f,g,!0))}function xa(t){return t?t.__v_isVNode===!0:!1}function yl(t,o){return t.type===o.type&&t.key===o.key}const Em="__vInternal",CT=({key:t})=>t!=null?t:null,Np=({ref:t,ref_key:o,ref_for:l})=>t!=null?Oi(t)||Ei(t)||Sn(t)?{i:Wr,r:t,k:o,f:!!l}:t:null;function la(t,o=null,l=null,f=0,g=null,x=t===yi?0:1,E=!1,s=!1){const A={__v_isVNode:!0,__v_skip:!0,type:t,props:o,key:o&&CT(o),ref:o&&Np(o),scopeId:lT,slotScopeIds:null,children:l,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:x,patchFlag:f,dynamicProps:g,dynamicChildren:null,appContext:null};return s?(av(A,l),x&128&&t.normalize(A)):l&&(A.shapeFlag|=Oi(l)?8:16),Ef>0&&!E&&ho&&(A.patchFlag>0||x&6)&&A.patchFlag!==32&&ho.push(A),A}const Me=xP;function xP(t,o=null,l=null,f=0,g=null,x=!1){if((!t||t===QI)&&(t=Vo),xa(t)){const s=bs(t,o,!0);return l&&av(s,l),Ef>0&&!x&&ho&&(s.shapeFlag&6?ho[ho.indexOf(t)]=s:ho.push(s)),s.patchFlag|=-2,s}if(zP(t)&&(t=t.__vccOpts),o){o=bP(o);let{class:s,style:A}=o;s&&!Oi(s)&&(o.class=Ny(s)),di(A)&&(K2(A)&&!_n(A)&&(A=$i({},A)),o.style=jy(A))}const E=Oi(t)?1:NI(t)?128:gP(t)?64:di(t)?4:Sn(t)?2:0;return la(t,o,l,f,g,E,x,!0)}function bP(t){return t?K2(t)||Em in t?$i({},t):t:null}function bs(t,o,l=!1){const{props:f,ref:g,patchFlag:x,children:E}=t,s=o?wP(f||{},o):f;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:s,key:s&&CT(s),ref:o&&o.ref?l&&g?_n(g)?g.concat(Np(o)):[g,Np(o)]:Np(o):g,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:E,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:o&&t.type!==yi?x===-1?16:x|16:x,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&bs(t.ssContent),ssFallback:t.ssFallback&&bs(t.ssFallback),el:t.el,anchor:t.anchor}}function Up(t=" ",o=0){return Me(Tm,null,t,o)}function Fo(t){return t==null||typeof t=="boolean"?Me(Vo):_n(t)?Me(yi,null,t.slice()):typeof t=="object"?oa(t):Me(Tm,null,String(t))}function oa(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:bs(t)}function av(t,o){let l=0;const{shapeFlag:f}=t;if(o==null)o=null;else if(_n(o))l=16;else if(typeof o=="object")if(f&65){const g=o.default;g&&(g._c&&(g._d=!1),av(t,g()),g._c&&(g._d=!0));return}else{l=32;const g=o._;!g&&!(Em in o)?o._ctx=Wr:g===3&&Wr&&(Wr.slots._===1?o._=1:(o._=2,t.patchFlag|=1024))}else Sn(o)?(o={default:o,_ctx:Wr},l=32):(o=String(o),f&64?(l=16,o=[Up(o)]):l=8);t.children=o,t.shapeFlag|=l}function wP(...t){const o={};for(let l=0;l<t.length;l++){const f=t[l];for(const g in f)if(g==="class")o.class!==f.class&&(o.class=Ny([o.class,f.class]));else if(g==="style")o.style=jy([o.style,f.style]);else if(pm(g)){const x=o[g],E=f[g];E&&x!==E&&!(_n(x)&&x.includes(E))&&(o[g]=x?[].concat(x,E):E)}else g!==""&&(o[g]=f[g])}return o}function Lo(t,o,l,f=null){Hr(t,o,7,[l,f])}const TP=TT();let EP=0;function CP(t,o,l){const f=t.type,g=(o?o.appContext:t.appContext)||TP,x={uid:EP++,vnode:t,type:f,parent:o,appContext:g,root:null,next:null,subTree:null,effect:null,update:null,scope:new B2(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:o?o.provides:Object.create(g.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:vT(f,g),emitsOptions:aT(f,g),emit:null,emitted:null,propsDefaults:li,inheritAttrs:f.inheritAttrs,ctx:li,data:li,props:li,attrs:li,slots:li,refs:li,setupState:li,setupContext:null,suspense:l,suspenseId:l?l.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return x.ctx={_:x},x.root=o?o.root:x,x.emit=LI.bind(null,x),t.ce&&t.ce(x),x}let Vi=null;const kl=()=>Vi||Wr,eu=t=>{Vi=t,t.scope.on()},Sl=()=>{Vi&&Vi.scope.off(),Vi=null};function ST(t){return t.vnode.shapeFlag&4}let Cf=!1;function SP(t,o=!1){Cf=o;const{props:l,children:f}=t.vnode,g=ST(t);sP(t,l,g,o),cP(t,f);const x=g?MP(t,o):void 0;return Cf=!1,x}function MP(t,o){const l=t.type;t.accessCache=Object.create(null),t.proxy=Jc(new Proxy(t.ctx,eP));const{setup:f}=l;if(f){const g=t.setupContext=f.length>1?IP(t):null;eu(t),uu();const x=da(f,t,0,[t.props,g]);if(hu(),Sl(),k2(x)){if(x.then(Sl,Sl),o)return x.then(E=>{G1(t,E,o)}).catch(E=>{vm(E,t,0)});t.asyncDep=x}else G1(t,x,o)}else MT(t,o)}function G1(t,o,l){Sn(o)?t.type.__ssrInlineRender?t.ssrRender=o:t.render=o:di(o)&&(t.setupState=eT(o)),MT(t,l)}let Z1;function MT(t,o,l){const f=t.type;if(!t.render){if(!o&&Z1&&!f.render){const g=f.template||iv(t).template;if(g){const{isCustomElement:x,compilerOptions:E}=t.appContext.config,{delimiters:s,compilerOptions:A}=f,k=$i($i({isCustomElement:x,delimiters:s},E),A);f.render=Z1(g,k)}}t.render=f.render||fo}eu(t),uu(),tP(t),hu(),Sl()}function AP(t){return new Proxy(t.attrs,{get(o,l){return Rr(t,"get","$attrs"),o[l]}})}function IP(t){const o=f=>{t.exposed=f||{}};let l;return{get attrs(){return l||(l=AP(t))},slots:t.slots,emit:t.emit,expose:o}}function Cm(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(eT(Jc(t.exposed)),{get(o,l){if(l in o)return o[l];if(l in im)return im[l](t)}}))}function PP(t,o=!0){return Sn(t)?t.displayName||t.name:t.name||o&&t.__name}function zP(t){return Sn(t)&&"__vccOpts"in t}const yt=(t,o)=>II(t,o,Cf);function Ml(t,o,l){const f=arguments.length;return f===2?di(o)&&!_n(o)?xa(o)?Me(t,null,[o]):Me(t,o):Me(t,null,o):(f>3?l=Array.prototype.slice.call(arguments,2):f===3&&xa(l)&&(l=[l]),Me(t,o,l))}const OP="3.2.41",kP="http://www.w3.org/2000/svg",vl=typeof document<"u"?document:null,q1=vl&&vl.createElement("template"),DP={insert:(t,o,l)=>{o.insertBefore(t,l||null)},remove:t=>{const o=t.parentNode;o&&o.removeChild(t)},createElement:(t,o,l,f)=>{const g=o?vl.createElementNS(kP,t):vl.createElement(t,l?{is:l}:void 0);return t==="select"&&f&&f.multiple!=null&&g.setAttribute("multiple",f.multiple),g},createText:t=>vl.createTextNode(t),createComment:t=>vl.createComment(t),setText:(t,o)=>{t.nodeValue=o},setElementText:(t,o)=>{t.textContent=o},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>vl.querySelector(t),setScopeId(t,o){t.setAttribute(o,"")},insertStaticContent(t,o,l,f,g,x){const E=l?l.previousSibling:o.lastChild;if(g&&(g===x||g.nextSibling))for(;o.insertBefore(g.cloneNode(!0),l),!(g===x||!(g=g.nextSibling)););else{q1.innerHTML=f?`<svg>${t}</svg>`:t;const s=q1.content;if(f){const A=s.firstChild;for(;A.firstChild;)s.appendChild(A.firstChild);s.removeChild(A)}o.insertBefore(s,l)}return[E?E.nextSibling:o.firstChild,l?l.previousSibling:o.lastChild]}};function LP(t,o,l){const f=t._vtc;f&&(o=(o?[o,...f]:[...f]).join(" ")),o==null?t.removeAttribute("class"):l?t.setAttribute("class",o):t.className=o}function RP(t,o,l){const f=t.style,g=Oi(l);if(l&&!g){for(const x in l)ey(f,x,l[x]);if(o&&!Oi(o))for(const x in o)l[x]==null&&ey(f,x,"")}else{const x=f.display;g?o!==l&&(f.cssText=l):o&&t.removeAttribute("style"),"_vod"in t&&(f.display=x)}}const W1=/\s*!important$/;function ey(t,o,l){if(_n(l))l.forEach(f=>ey(t,o,f));else if(l==null&&(l=""),o.startsWith("--"))t.setProperty(o,l);else{const f=BP(t,o);W1.test(l)?t.setProperty(cu(f),l.replace(W1,""),"important"):t[f]=l}}const H1=["Webkit","Moz","ms"],__={};function BP(t,o){const l=__[o];if(l)return l;let f=$o(o);if(f!=="filter"&&f in t)return __[o]=f;f=_m(f);for(let g=0;g<H1.length;g++){const x=H1[g]+f;if(x in t)return __[o]=x}return o}const X1="http://www.w3.org/1999/xlink";function FP(t,o,l,f,g){if(f&&o.startsWith("xlink:"))l==null?t.removeAttributeNS(X1,o.slice(6,o.length)):t.setAttributeNS(X1,o,l);else{const x=NA(o);l==null||x&&!P2(l)?t.removeAttribute(o):t.setAttribute(o,x?"":l)}}function jP(t,o,l,f,g,x,E){if(o==="innerHTML"||o==="textContent"){f&&E(f,g,x),t[o]=l==null?"":l;return}if(o==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=l;const A=l==null?"":l;(t.value!==A||t.tagName==="OPTION")&&(t.value=A),l==null&&t.removeAttribute(o);return}let s=!1;if(l===""||l==null){const A=typeof t[o];A==="boolean"?l=P2(l):l==null&&A==="string"?(l="",s=!0):A==="number"&&(l=0,s=!0)}try{t[o]=l}catch{}s&&t.removeAttribute(o)}function NP(t,o,l,f){t.addEventListener(o,l,f)}function UP(t,o,l,f){t.removeEventListener(o,l,f)}function VP(t,o,l,f,g=null){const x=t._vei||(t._vei={}),E=x[o];if(f&&E)E.value=f;else{const[s,A]=$P(o);if(f){const k=x[o]=qP(f,g);NP(t,s,k,A)}else E&&(UP(t,s,E,A),x[o]=void 0)}}const K1=/(?:Once|Passive|Capture)$/;function $P(t){let o;if(K1.test(t)){o={};let f;for(;f=t.match(K1);)t=t.slice(0,t.length-f[0].length),o[f[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):cu(t.slice(2)),o]}let y_=0;const GP=Promise.resolve(),ZP=()=>y_||(GP.then(()=>y_=0),y_=Date.now());function qP(t,o){const l=f=>{if(!f._vts)f._vts=Date.now();else if(f._vts<=l.attached)return;Hr(WP(f,l.value),o,5,[f])};return l.value=t,l.attached=ZP(),l}function WP(t,o){if(_n(o)){const l=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{l.call(t),t._stopped=!0},o.map(f=>g=>!g._stopped&&f&&f(g))}else return o}const Y1=/^on[a-z]/,HP=(t,o,l,f,g=!1,x,E,s,A)=>{o==="class"?LP(t,f,g):o==="style"?RP(t,l,f):pm(o)?Uy(o)||VP(t,o,l,f,E):(o[0]==="."?(o=o.slice(1),!0):o[0]==="^"?(o=o.slice(1),!1):XP(t,o,f,g))?jP(t,o,f,x,E,s,A):(o==="true-value"?t._trueValue=f:o==="false-value"&&(t._falseValue=f),FP(t,o,f,g))};function XP(t,o,l,f){return f?!!(o==="innerHTML"||o==="textContent"||o in t&&Y1.test(o)&&Sn(l)):o==="spellcheck"||o==="draggable"||o==="translate"||o==="form"||o==="list"&&t.tagName==="INPUT"||o==="type"&&t.tagName==="TEXTAREA"||Y1.test(o)&&Oi(l)?!1:o in t}const na="transition",qh="animation",fu=(t,{slots:o})=>Ml(hT,IT(t),o);fu.displayName="Transition";const AT={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},KP=fu.props=$i({},hT.props,AT),dl=(t,o=[])=>{_n(t)?t.forEach(l=>l(...o)):t&&t(...o)},J1=t=>t?_n(t)?t.some(o=>o.length>1):t.length>1:!1;function IT(t){const o={};for(const st in t)st in AT||(o[st]=t[st]);if(t.css===!1)return o;const{name:l="v",type:f,duration:g,enterFromClass:x=`${l}-enter-from`,enterActiveClass:E=`${l}-enter-active`,enterToClass:s=`${l}-enter-to`,appearFromClass:A=x,appearActiveClass:k=E,appearToClass:R=s,leaveFromClass:D=`${l}-leave-from`,leaveActiveClass:F=`${l}-leave-active`,leaveToClass:G=`${l}-leave-to`}=t,oe=YP(g),se=oe&&oe[0],we=oe&&oe[1],{onBeforeEnter:xe,onEnter:Te,onEnterCancelled:Ue,onLeave:Be,onLeaveCancelled:Pe,onBeforeAppear:Oe=xe,onAppear:Le=Te,onAppearCancelled:ke=Ue}=o,We=(st,Ge,Ne)=>{ra(st,Ge?R:s),ra(st,Ge?k:E),Ne&&Ne()},ct=(st,Ge)=>{st._isLeaving=!1,ra(st,D),ra(st,G),ra(st,F),Ge&&Ge()},Tt=st=>(Ge,Ne)=>{const vt=st?Le:Te,rt=()=>We(Ge,st,Ne);dl(vt,[Ge,rt]),Q1(()=>{ra(Ge,st?A:x),ps(Ge,st?R:s),J1(vt)||eb(Ge,f,se,rt)})};return $i(o,{onBeforeEnter(st){dl(xe,[st]),ps(st,x),ps(st,E)},onBeforeAppear(st){dl(Oe,[st]),ps(st,A),ps(st,k)},onEnter:Tt(!1),onAppear:Tt(!0),onLeave(st,Ge){st._isLeaving=!0;const Ne=()=>ct(st,Ge);ps(st,D),zT(),ps(st,F),Q1(()=>{!st._isLeaving||(ra(st,D),ps(st,G),J1(Be)||eb(st,f,we,Ne))}),dl(Be,[st,Ne])},onEnterCancelled(st){We(st,!1),dl(Ue,[st])},onAppearCancelled(st){We(st,!0),dl(ke,[st])},onLeaveCancelled(st){ct(st),dl(Pe,[st])}})}function YP(t){if(t==null)return null;if(di(t))return[v_(t.enter),v_(t.leave)];{const o=v_(t);return[o,o]}}function v_(t){return R2(t)}function ps(t,o){o.split(/\s+/).forEach(l=>l&&t.classList.add(l)),(t._vtc||(t._vtc=new Set)).add(o)}function ra(t,o){o.split(/\s+/).forEach(f=>f&&t.classList.remove(f));const{_vtc:l}=t;l&&(l.delete(o),l.size||(t._vtc=void 0))}function Q1(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let JP=0;function eb(t,o,l,f){const g=t._endId=++JP,x=()=>{g===t._endId&&f()};if(l)return setTimeout(x,l);const{type:E,timeout:s,propCount:A}=PT(t,o);if(!E)return f();const k=E+"end";let R=0;const D=()=>{t.removeEventListener(k,F),x()},F=G=>{G.target===t&&++R>=A&&D()};setTimeout(()=>{R<A&&D()},s+1),t.addEventListener(k,F)}function PT(t,o){const l=window.getComputedStyle(t),f=oe=>(l[oe]||"").split(", "),g=f(na+"Delay"),x=f(na+"Duration"),E=tb(g,x),s=f(qh+"Delay"),A=f(qh+"Duration"),k=tb(s,A);let R=null,D=0,F=0;o===na?E>0&&(R=na,D=E,F=x.length):o===qh?k>0&&(R=qh,D=k,F=A.length):(D=Math.max(E,k),R=D>0?E>k?na:qh:null,F=R?R===na?x.length:A.length:0);const G=R===na&&/\b(transform|all)(,|$)/.test(l[na+"Property"]);return{type:R,timeout:D,propCount:F,hasTransform:G}}function tb(t,o){for(;t.length<o.length;)t=t.concat(t);return Math.max(...o.map((l,f)=>nb(l)+nb(t[f])))}function nb(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function zT(){return document.body.offsetHeight}const OT=new WeakMap,kT=new WeakMap,QP={name:"TransitionGroup",props:$i({},KP,{tag:String,moveClass:String}),setup(t,{slots:o}){const l=kl(),f=uT();let g,x;return Uf(()=>{if(!g.length)return;const E=t.moveClass||`${t.name||"v"}-move`;if(!r3(g[0].el,l.vnode.el,E))return;g.forEach(t3),g.forEach(n3);const s=g.filter(i3);zT(),s.forEach(A=>{const k=A.el,R=k.style;ps(k,E),R.transform=R.webkitTransform=R.transitionDuration="";const D=k._moveCb=F=>{F&&F.target!==k||(!F||/transform$/.test(F.propertyName))&&(k.removeEventListener("transitionend",D),k._moveCb=null,ra(k,E))};k.addEventListener("transitionend",D)})}),()=>{const E=Bn(t),s=IT(E);let A=E.tag||yi;g=x,x=o.default?tv(o.default()):[];for(let k=0;k<x.length;k++){const R=x[k];R.key!=null&&Tf(R,wf(R,s,f,l))}if(g)for(let k=0;k<g.length;k++){const R=g[k];Tf(R,wf(R,s,f,l)),OT.set(R,R.el.getBoundingClientRect())}return Me(A,null,x)}}},e3=QP;function t3(t){const o=t.el;o._moveCb&&o._moveCb(),o._enterCb&&o._enterCb()}function n3(t){kT.set(t,t.el.getBoundingClientRect())}function i3(t){const o=OT.get(t),l=kT.get(t),f=o.left-l.left,g=o.top-l.top;if(f||g){const x=t.el.style;return x.transform=x.webkitTransform=`translate(${f}px,${g}px)`,x.transitionDuration="0s",t}}function r3(t,o,l){const f=t.cloneNode();t._vtc&&t._vtc.forEach(E=>{E.split(/\s+/).forEach(s=>s&&f.classList.remove(s))}),l.split(/\s+/).forEach(E=>E&&f.classList.add(E)),f.style.display="none";const g=o.nodeType===1?o:o.parentNode;g.appendChild(f);const{hasTransform:x}=PT(f);return g.removeChild(f),x}const o3=["ctrl","shift","alt","meta"],s3={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,o)=>o3.some(l=>t[`${l}Key`]&&!o.includes(l))},ib=(t,o)=>(l,...f)=>{for(let g=0;g<o.length;g++){const x=s3[o[g]];if(x&&x(l,o))return}return t(l,...f)},DT={beforeMount(t,{value:o},{transition:l}){t._vod=t.style.display==="none"?"":t.style.display,l&&o?l.beforeEnter(t):Wh(t,o)},mounted(t,{value:o},{transition:l}){l&&o&&l.enter(t)},updated(t,{value:o,oldValue:l},{transition:f}){!o!=!l&&(f?o?(f.beforeEnter(t),Wh(t,!0),f.enter(t)):f.leave(t,()=>{Wh(t,!1)}):Wh(t,o))},beforeUnmount(t,{value:o}){Wh(t,o)}};function Wh(t,o){t.style.display=o?t._vod:"none"}const a3=$i({patchProp:HP},DP);let rb;function LT(){return rb||(rb=dP(a3))}const ob=(...t)=>{LT().render(...t)},l3=(...t)=>{const o=LT().createApp(...t),{mount:l}=o;return o.mount=f=>{const g=c3(f);if(!g)return;const x=o._component;!Sn(x)&&!x.render&&!x.template&&(x.template=g.innerHTML),g.innerHTML="";const E=l(g,!1,g instanceof SVGElement);return g instanceof Element&&(g.removeAttribute("v-cloak"),g.setAttribute("data-v-app","")),E},o};function c3(t){return Oi(t)?document.querySelector(t):t}function Cn(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}function sb(t,o){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);o&&(f=f.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),l.push.apply(l,f)}return l}function Ve(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?arguments[o]:{};o%2?sb(Object(l),!0).forEach(function(f){Cn(t,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):sb(Object(l)).forEach(function(f){Object.defineProperty(t,f,Object.getOwnPropertyDescriptor(l,f))})}return t}function ws(){return ws=Object.assign?Object.assign.bind():function(t){for(var o=1;o<arguments.length;o++){var l=arguments[o];for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(t[f]=l[f])}return t},ws.apply(this,arguments)}function Yi(t){return Yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Yi(t)}var u3=function(o){return typeof o=="function"},h3=Array.isArray,f3=function(o){return typeof o=="string"},d3=function(o){return o!==null&&Yi(o)==="object"},p3=/^on[^a-z]/,m3=function(o){return p3.test(o)},RT=function(o){var l=Object.create(null);return function(f){var g=l[f];return g||(l[f]=o(f))}},g3=/-(\w)/g,lv=RT(function(t){return t.replace(g3,function(o,l){return l?l.toUpperCase():""})}),_3=/\B([A-Z])/g,y3=RT(function(t){return t.replace(_3,"-$1").toLowerCase()}),v3=Object.prototype.hasOwnProperty,ab=function(o,l){return v3.call(o,l)};function x3(t,o,l,f){var g=t[l];if(g!=null){var x=ab(g,"default");if(x&&f===void 0){var E=g.default;f=g.type!==Function&&u3(E)?E():E}g.type===Boolean&&(!ab(o,l)&&!x?f=!1:f===""&&(f=!0))}return f}function nf(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;return typeof t=="function"?t(o):t!=null?t:l}function ki(){for(var t=[],o=0;o<arguments.length;o++){var l=o<0||arguments.length<=o?void 0:arguments[o];if(!!l){if(f3(l))t.push(l);else if(h3(l))for(var f=0;f<l.length;f++){var g=ki(l[f]);g&&t.push(g)}else if(d3(l))for(var x in l)l[x]&&t.push(x)}}return t.join(" ")}var BT=function(){if(typeof Map<"u")return Map;function t(o,l){var f=-1;return o.some(function(g,x){return g[0]===l?(f=x,!0):!1}),f}return function(){function o(){this.__entries__=[]}return Object.defineProperty(o.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),o.prototype.get=function(l){var f=t(this.__entries__,l),g=this.__entries__[f];return g&&g[1]},o.prototype.set=function(l,f){var g=t(this.__entries__,l);~g?this.__entries__[g][1]=f:this.__entries__.push([l,f])},o.prototype.delete=function(l){var f=this.__entries__,g=t(f,l);~g&&f.splice(g,1)},o.prototype.has=function(l){return!!~t(this.__entries__,l)},o.prototype.clear=function(){this.__entries__.splice(0)},o.prototype.forEach=function(l,f){f===void 0&&(f=null);for(var g=0,x=this.__entries__;g<x.length;g++){var E=x[g];l.call(f,E[1],E[0])}},o}()}(),ty=typeof window<"u"&&typeof document<"u"&&window.document===document,om=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),b3=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(om):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),w3=2;function T3(t,o){var l=!1,f=!1,g=0;function x(){l&&(l=!1,t()),f&&s()}function E(){b3(x)}function s(){var A=Date.now();if(l){if(A-g<w3)return;f=!0}else l=!0,f=!1,setTimeout(E,o);g=A}return s}var E3=20,C3=["top","right","bottom","left","width","height","size","weight"],S3=typeof MutationObserver<"u",M3=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=T3(this.refresh.bind(this),E3)}return t.prototype.addObserver=function(o){~this.observers_.indexOf(o)||this.observers_.push(o),this.connected_||this.connect_()},t.prototype.removeObserver=function(o){var l=this.observers_,f=l.indexOf(o);~f&&l.splice(f,1),!l.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){var o=this.updateObservers_();o&&this.refresh()},t.prototype.updateObservers_=function(){var o=this.observers_.filter(function(l){return l.gatherActive(),l.hasActive()});return o.forEach(function(l){return l.broadcastActive()}),o.length>0},t.prototype.connect_=function(){!ty||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),S3?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){!ty||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(o){var l=o.propertyName,f=l===void 0?"":l,g=C3.some(function(x){return!!~f.indexOf(x)});g&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),FT=function(t,o){for(var l=0,f=Object.keys(o);l<f.length;l++){var g=f[l];Object.defineProperty(t,g,{value:o[g],enumerable:!1,writable:!1,configurable:!0})}return t},tu=function(t){var o=t&&t.ownerDocument&&t.ownerDocument.defaultView;return o||om},jT=Sm(0,0,0,0);function sm(t){return parseFloat(t)||0}function lb(t){for(var o=[],l=1;l<arguments.length;l++)o[l-1]=arguments[l];return o.reduce(function(f,g){var x=t["border-"+g+"-width"];return f+sm(x)},0)}function A3(t){for(var o=["top","right","bottom","left"],l={},f=0,g=o;f<g.length;f++){var x=g[f],E=t["padding-"+x];l[x]=sm(E)}return l}function I3(t){var o=t.getBBox();return Sm(0,0,o.width,o.height)}function P3(t){var o=t.clientWidth,l=t.clientHeight;if(!o&&!l)return jT;var f=tu(t).getComputedStyle(t),g=A3(f),x=g.left+g.right,E=g.top+g.bottom,s=sm(f.width),A=sm(f.height);if(f.boxSizing==="border-box"&&(Math.round(s+x)!==o&&(s-=lb(f,"left","right")+x),Math.round(A+E)!==l&&(A-=lb(f,"top","bottom")+E)),!O3(t)){var k=Math.round(s+x)-o,R=Math.round(A+E)-l;Math.abs(k)!==1&&(s-=k),Math.abs(R)!==1&&(A-=R)}return Sm(g.left,g.top,s,A)}var z3=function(){return typeof SVGGraphicsElement<"u"?function(t){return t instanceof tu(t).SVGGraphicsElement}:function(t){return t instanceof tu(t).SVGElement&&typeof t.getBBox=="function"}}();function O3(t){return t===tu(t).document.documentElement}function k3(t){return ty?z3(t)?I3(t):P3(t):jT}function D3(t){var o=t.x,l=t.y,f=t.width,g=t.height,x=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,E=Object.create(x.prototype);return FT(E,{x:o,y:l,width:f,height:g,top:l,right:o+f,bottom:g+l,left:o}),E}function Sm(t,o,l,f){return{x:t,y:o,width:l,height:f}}var L3=function(){function t(o){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Sm(0,0,0,0),this.target=o}return t.prototype.isActive=function(){var o=k3(this.target);return this.contentRect_=o,o.width!==this.broadcastWidth||o.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var o=this.contentRect_;return this.broadcastWidth=o.width,this.broadcastHeight=o.height,o},t}(),R3=function(){function t(o,l){var f=D3(l);FT(this,{target:o,contentRect:f})}return t}(),B3=function(){function t(o,l,f){if(this.activeObservations_=[],this.observations_=new BT,typeof o!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=o,this.controller_=l,this.callbackCtx_=f}return t.prototype.observe=function(o){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(o instanceof tu(o).Element))throw new TypeError('parameter 1 is not of type "Element".');var l=this.observations_;l.has(o)||(l.set(o,new L3(o)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(o){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(o instanceof tu(o).Element))throw new TypeError('parameter 1 is not of type "Element".');var l=this.observations_;!l.has(o)||(l.delete(o),l.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var o=this;this.clearActive(),this.observations_.forEach(function(l){l.isActive()&&o.activeObservations_.push(l)})},t.prototype.broadcastActive=function(){if(!!this.hasActive()){var o=this.callbackCtx_,l=this.activeObservations_.map(function(f){return new R3(f.target,f.broadcastRect())});this.callback_.call(o,l,o),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),NT=typeof WeakMap<"u"?new WeakMap:new BT,UT=function(){function t(o){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var l=M3.getInstance(),f=new B3(o,l,this);NT.set(this,f)}return t}();["observe","unobserve","disconnect"].forEach(function(t){UT.prototype[t]=function(){var o;return(o=NT.get(this))[t].apply(o,arguments)}});var VT=function(){return typeof om.ResizeObserver<"u"?om.ResizeObserver:UT}();function F3(t){if(Array.isArray(t))return t}function j3(t,o){var l=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(l!=null){var f=[],g=!0,x=!1,E,s;try{for(l=l.call(t);!(g=(E=l.next()).done)&&(f.push(E.value),!(o&&f.length===o));g=!0);}catch(A){x=!0,s=A}finally{try{!g&&l.return!=null&&l.return()}finally{if(x)throw s}}return f}}function ny(t,o){(o==null||o>t.length)&&(o=t.length);for(var l=0,f=new Array(o);l<o;l++)f[l]=t[l];return f}function $T(t,o){if(!!t){if(typeof t=="string")return ny(t,o);var l=Object.prototype.toString.call(t).slice(8,-1);if(l==="Object"&&t.constructor&&(l=t.constructor.name),l==="Map"||l==="Set")return Array.from(t);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return ny(t,o)}}function N3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nu(t,o){return F3(t)||j3(t,o)||$T(t,o)||N3()}function U3(t){if(Array.isArray(t))return ny(t)}function V3(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function $3(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Er(t){return U3(t)||V3(t)||$T(t)||$3()}var G3=typeof global=="object"&&global&&global.Object===Object&&global;const GT=G3;var Z3=typeof self=="object"&&self&&self.Object===Object&&self,q3=GT||Z3||Function("return this")();const Es=q3;var W3=Es.Symbol;const iu=W3;var ZT=Object.prototype,H3=ZT.hasOwnProperty,X3=ZT.toString,Hh=iu?iu.toStringTag:void 0;function K3(t){var o=H3.call(t,Hh),l=t[Hh];try{t[Hh]=void 0;var f=!0}catch{}var g=X3.call(t);return f&&(o?t[Hh]=l:delete t[Hh]),g}var Y3=Object.prototype,J3=Y3.toString;function Q3(t){return J3.call(t)}var ez="[object Null]",tz="[object Undefined]",cb=iu?iu.toStringTag:void 0;function Vf(t){return t==null?t===void 0?tz:ez:cb&&cb in Object(t)?K3(t):Q3(t)}function nz(t,o){return function(l){return t(o(l))}}function Sf(t){return t!=null&&typeof t=="object"}var iz=function(o){return o!=null&&o!==""};const iy=iz;var rz=function(o,l){var f=Ve({},o);return Object.keys(l).forEach(function(g){var x=f[g];if(x)x.type||x.default?x.default=l[g]:x.def?x.def(l[g]):f[g]={type:x,default:l[g]};else throw new Error("not have ".concat(g," prop"))}),f};const qT=rz;var oz=function(o){for(var l=Object.keys(o),f={},g={},x={},E=0,s=l.length;E<s;E++){var A=l[E];m3(A)?(f[A[2].toLowerCase()+A.slice(3)]=o[A],g[A]=o[A]):x[A]=o[A]}return{onEvents:g,events:f,extraAttrs:x}},sz=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",l=arguments.length>1?arguments[1]:void 0,f={},g=/;(?![^(]*\))/g,x=/:(.+)/;return Yi(o)==="object"?o:(o.split(g).forEach(function(E){if(E){var s=E.split(x);if(s.length>1){var A=l?lv(s[0].trim()):s[0].trim();f[A]=s[1].trim()}}}),f)},az=function(o,l){return o[l]!==void 0},ma=function t(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,f=Array.isArray(o)?o:[o],g=[];return f.forEach(function(x){Array.isArray(x)?g.push.apply(g,Er(t(x,l))):x&&x.type===yi?g.push.apply(g,Er(t(x.children,l))):x&&xa(x)?l&&!WT(x)?g.push(x):l||g.push(x):iy(x)&&g.push(x)}),g},lz=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"default",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(xa(o))return o.type===yi?l==="default"?ma(o.children):[]:o.children&&o.children[l]?ma(o.children[l](f)):[];var g=o.$slots[l]&&o.$slots[l](f);return ma(g)},rf=function(o){for(var l,f=(o==null||(l=o.vnode)===null||l===void 0?void 0:l.el)||o&&(o.$el||o);f&&!f.tagName;)f=f.nextSibling;return f},cz=function(o){var l={};if(o.$&&o.$.vnode){var f=o.$.vnode.props||{};Object.keys(o.$props).forEach(function(s){var A=o.$props[s],k=y3(s);(A!==void 0||k in f)&&(l[s]=A)})}else if(xa(o)&&Yi(o.type)==="object"){var g=o.props||{},x={};Object.keys(g).forEach(function(s){x[lv(s)]=g[s]});var E=o.type.props||{};Object.keys(E).forEach(function(s){var A=x3(E,x,s,x[s]);(A!==void 0||s in x)&&(l[s]=A)})}return l},uz=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"default",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,x=void 0;if(o.$){var E=o[l];if(E!==void 0)return typeof E=="function"&&g?E(f):E;x=o.$slots[l],x=g&&x?x(f):x}else if(xa(o)){var s=o.props&&o.props[l];if(s!==void 0&&o.props!==null)return typeof s=="function"&&g?s(f):s;o.type===yi?x=o.children:o.children&&o.children[l]&&(x=o.children[l],x=g&&x?x(f):x)}return Array.isArray(x)&&(x=ma(x),x=x.length===1?x[0]:x,x=x.length===0?void 0:x),x};function ub(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l={};return t.$?l=Ve(Ve({},l),t.$attrs):l=Ve(Ve({},l),t.props),oz(l)[o?"onEvents":"events"]}function hz(t,o){var l=(xa(t)?t.props:t.$attrs)||{},f=l.style||{};if(typeof f=="string")f=sz(f,o);else if(o&&f){var g={};return Object.keys(f).forEach(function(x){return g[lv(x)]=f[x]}),g}return f}function WT(t){return t&&(t.type===Vo||t.type===yi&&t.children.length===0||t.type===Tm&&t.children.trim()==="")}function $f(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=[];return t.forEach(function(l){Array.isArray(l)?o.push.apply(o,Er(l)):(l==null?void 0:l.type)===yi?o.push.apply(o,Er($f(l.children))):o.push(l)}),o.filter(function(l){return!WT(l)})}function cv(t){return Array.isArray(t)&&t.length===1&&(t=t[0]),t&&t.__v_isVNode&&Yi(t.type)!=="symbol"}function Mf(t,o){var l,f,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"default";return(l=o[g])!==null&&l!==void 0?l:(f=t[g])===null||f===void 0?void 0:f.call(t)}const HT=On({compatConfig:{MODE:3},name:"ResizeObserver",props:{disabled:Boolean,onResize:Function},emits:["resize"],setup:function(o,l){var f=l.slots,g=mr({width:0,height:0,offsetHeight:0,offsetWidth:0}),x=null,E=null,s=function(){E&&(E.disconnect(),E=null)},A=function(F){var G=o.onResize,oe=F[0].target,se=oe.getBoundingClientRect(),we=se.width,xe=se.height,Te=oe.offsetWidth,Ue=oe.offsetHeight,Be=Math.floor(we),Pe=Math.floor(xe);if(g.width!==Be||g.height!==Pe||g.offsetWidth!==Te||g.offsetHeight!==Ue){var Oe={width:Be,height:Pe,offsetWidth:Te,offsetHeight:Ue};ws(g,Oe),G&&Promise.resolve().then(function(){G(Ve(Ve({},Oe),{},{offsetWidth:Te,offsetHeight:Ue}),oe)})}},k=kl(),R=function(){var F=o.disabled;if(F){s();return}var G=rf(k),oe=G!==x;oe&&(s(),x=G),!E&&G&&(E=new VT(A),E.observe(G))};return Zo(function(){R()}),Uf(function(){R()}),Ol(function(){s()}),Wn(function(){return o.disabled},function(){R()},{flush:"post"}),function(){var D;return(D=f.default)===null||D===void 0?void 0:D.call(f)[0]}}});var XT=function(o){return setTimeout(o,16)},KT=function(o){return clearTimeout(o)};typeof window<"u"&&"requestAnimationFrame"in window&&(XT=function(o){return window.requestAnimationFrame(o)},KT=function(o){return window.cancelAnimationFrame(o)});var hb=0,uv=new Map;function YT(t){uv.delete(t)}function Xr(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;hb+=1;var l=hb;function f(g){if(g===0)YT(l),t();else{var x=XT(function(){f(g-1)});uv.set(l,x)}}return f(o),l}Xr.cancel=function(t){var o=uv.get(t);return YT(o),KT(o)};var Af=function(){for(var o=arguments.length,l=new Array(o),f=0;f<o;f++)l[f]=arguments[f];return l},hv=function(o){var l=o;return l.install=function(f){f.component(l.displayName||l.name,o)},o},JT=!1;try{var fb=Object.defineProperty({},"passive",{get:function(){JT=!0}});window.addEventListener("testPassive",null,fb),window.removeEventListener("testPassive",null,fb)}catch{}const Gc=JT;function of(t,o,l,f){if(t&&t.addEventListener){var g=f;g===void 0&&Gc&&(o==="touchstart"||o==="touchmove"||o==="wheel")&&(g={passive:!1}),t.addEventListener(o,l,g)}return{remove:function(){t&&t.removeEventListener&&t.removeEventListener(o,l)}}}function fz(t,o){if(t==null)return{};var l={},f=Object.keys(t),g,x;for(x=0;x<f.length;x++)g=f[x],!(o.indexOf(g)>=0)&&(l[g]=t[g]);return l}function ga(t,o){if(t==null)return{};var l=fz(t,o),f,g;if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(t);for(g=0;g<x.length;g++)f=x[g],!(o.indexOf(f)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,f)||(l[f]=t[f]))}return l}const dz={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages"};var pz={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"};const mz=pz;var gz={placeholder:"Select time",rangePlaceholder:["Start time","End time"]};const QT=gz;var _z={lang:Ve({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},mz),timePickerLocale:Ve({},QT)};const db=_z;var Dr="${label} is not a valid ${type}",yz={locale:"en",Pagination:dz,DatePicker:db,TimePicker:QT,Calendar:db,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No Data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:Dr,method:Dr,array:Dr,object:Dr,number:Dr,date:Dr,boolean:Dr,integer:Dr,float:Dr,regexp:Dr,email:Dr,url:Dr,hex:Dr},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"}};const ry=yz,eE=On({compatConfig:{MODE:3},name:"LocaleReceiver",props:{componentName:String,defaultLocale:{type:[Object,Function]},children:{type:Function}},setup:function(o,l){var f=l.slots,g=vi("localeData",{}),x=yt(function(){var s=o.componentName,A=s===void 0?"global":s,k=o.defaultLocale,R=k||ry[A||"global"],D=g.antLocale,F=A&&D?D[A]:{};return Ve(Ve({},typeof R=="function"?R():R),F||{})}),E=yt(function(){var s=g.antLocale,A=s&&s.locale;return s&&s.exist&&!A?ry.locale:A});return function(){var s=o.children||f.default,A=g.antLocale;return s==null?void 0:s(x.value,E.value,A)}}});var tE=function(){var o=qo("empty",{}),l=o.getPrefixCls,f=l("empty-img-default");return Me("svg",{class:f,width:"184",height:"152",viewBox:"0 0 184 152"},[Me("g",{fill:"none","fill-rule":"evenodd"},[Me("g",{transform:"translate(24 31.67)"},[Me("ellipse",{class:"".concat(f,"-ellipse"),cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"},null),Me("path",{class:"".concat(f,"-path-1"),d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z"},null),Me("path",{class:"".concat(f,"-path-2"),d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",transform:"translate(13.56)"},null),Me("path",{class:"".concat(f,"-path-3"),d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z"},null),Me("path",{class:"".concat(f,"-path-4"),d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z"},null)]),Me("path",{class:"".concat(f,"-path-5"),d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z"},null),Me("g",{class:"".concat(f,"-g"),transform:"translate(149.65 15.383)"},[Me("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"},null),Me("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"},null)])])])};tE.PRESENTED_IMAGE_DEFAULT=!0;const vz=tE;var nE=function(){var o=qo("empty",{}),l=o.getPrefixCls,f=l("empty-img-simple");return Me("svg",{class:f,width:"64",height:"41",viewBox:"0 0 64 41"},[Me("g",{transform:"translate(0 1)",fill:"none","fill-rule":"evenodd"},[Me("ellipse",{class:"".concat(f,"-ellipse"),fill:"#F5F5F5",cx:"32",cy:"33",rx:"32",ry:"7"},null),Me("g",{class:"".concat(f,"-g"),"fill-rule":"nonzero",stroke:"#D9D9D9"},[Me("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"},null),Me("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",fill:"#FAFAFA",class:"".concat(f,"-path")},null)])])])};nE.PRESENTED_IMAGE_SIMPLE=!0;const xz=nE;function pb(t,o){for(var l=0;l<o.length;l++){var f=o[l];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(t,f.key,f)}}function iE(t,o,l){return o&&pb(t.prototype,o),l&&pb(t,l),t}function Vp(){return(Vp=Object.assign||function(t){for(var o=1;o<arguments.length;o++){var l=arguments[o];for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(t[f]=l[f])}return t}).apply(this,arguments)}function rE(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,t.__proto__=o}function oE(t,o){if(t==null)return{};var l,f,g={},x=Object.keys(t);for(f=0;f<x.length;f++)o.indexOf(l=x[f])>=0||(g[l]=t[l]);return g}function mb(t){return((o=t)!=null&&typeof o=="object"&&Array.isArray(o)===!1)==1&&Object.prototype.toString.call(t)==="[object Object]";var o}var sE=Object.prototype,aE=sE.toString,bz=sE.hasOwnProperty,lE=/^\s*function (\w+)/;function gb(t){var o,l=(o=t==null?void 0:t.type)!==null&&o!==void 0?o:t;if(l){var f=l.toString().match(lE);return f?f[1]:""}return""}var Al=function(t){var o,l;return mb(t)!==!1&&typeof(o=t.constructor)=="function"&&mb(l=o.prototype)!==!1&&l.hasOwnProperty("isPrototypeOf")!==!1},wz=function(t){return t},dr=wz,If=function(t,o){return bz.call(t,o)},Tz=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t},ru=Array.isArray||function(t){return aE.call(t)==="[object Array]"},ou=function(t){return aE.call(t)==="[object Function]"},am=function(t){return Al(t)&&If(t,"_vueTypes_name")},cE=function(t){return Al(t)&&(If(t,"type")||["_vueTypes_name","validator","default","required"].some(function(o){return If(t,o)}))};function fv(t,o){return Object.defineProperty(t.bind(o),"__original",{value:t})}function Dl(t,o,l){var f;l===void 0&&(l=!1);var g=!0,x="";f=Al(t)?t:{type:t};var E=am(f)?f._vueTypes_name+" - ":"";if(cE(f)&&f.type!==null){if(f.type===void 0||f.type===!0||!f.required&&o===void 0)return g;ru(f.type)?(g=f.type.some(function(D){return Dl(D,o,!0)===!0}),x=f.type.map(function(D){return gb(D)}).join(" or ")):g=(x=gb(f))==="Array"?ru(o):x==="Object"?Al(o):x==="String"||x==="Number"||x==="Boolean"||x==="Function"?function(D){if(D==null)return"";var F=D.constructor.toString().match(lE);return F?F[1]:""}(o)===x:o instanceof f.type}if(!g){var s=E+'value "'+o+'" should be of type "'+x+'"';return l===!1?(dr(s),!1):s}if(If(f,"validator")&&ou(f.validator)){var A=dr,k=[];if(dr=function(D){k.push(D)},g=f.validator(o),dr=A,!g){var R=(k.length>1?"* ":"")+k.join(`
* `);return k.length=0,l===!1?(dr(R),g):R}}return g}function Br(t,o){var l=Object.defineProperties(o,{_vueTypes_name:{value:t,writable:!0},isRequired:{get:function(){return this.required=!0,this}},def:{value:function(g){return g!==void 0||this.default?ou(g)||Dl(this,g,!0)===!0?(this.default=ru(g)?function(){return[].concat(g)}:Al(g)?function(){return Object.assign({},g)}:g,this):(dr(this._vueTypes_name+' - invalid default value: "'+g+'"'),this):this}}}),f=l.validator;return ou(f)&&(l.validator=fv(f,l)),l}function Go(t,o){var l=Br(t,o);return Object.defineProperty(l,"validate",{value:function(f){return ou(this.validator)&&dr(this._vueTypes_name+` - calling .validate() will overwrite the current custom validator function. Validator info:
`+JSON.stringify(this)),this.validator=fv(f,this),this}})}function _b(t,o,l){var f,g,x=(f=o,g={},Object.getOwnPropertyNames(f).forEach(function(D){g[D]=Object.getOwnPropertyDescriptor(f,D)}),Object.defineProperties({},g));if(x._vueTypes_name=t,!Al(l))return x;var E,s,A=l.validator,k=oE(l,["validator"]);if(ou(A)){var R=x.validator;R&&(R=(s=(E=R).__original)!==null&&s!==void 0?s:E),x.validator=fv(R?function(D){return R.call(this,D)&&A.call(this,D)}:A,x)}return Object.assign(x,k)}function Mm(t){return t.replace(/^(?!\s*$)/gm,"  ")}var Ez=function(){return Go("any",{})},Cz=function(){return Go("function",{type:Function})},Sz=function(){return Go("boolean",{type:Boolean})},Mz=function(){return Go("string",{type:String})},Az=function(){return Go("number",{type:Number})},Iz=function(){return Go("array",{type:Array})},Pz=function(){return Go("object",{type:Object})},zz=function(){return Br("integer",{type:Number,validator:function(t){return Tz(t)}})},Oz=function(){return Br("symbol",{validator:function(t){return typeof t=="symbol"}})};function kz(t,o){if(o===void 0&&(o="custom validation failed"),typeof t!="function")throw new TypeError("[VueTypes error]: You must provide a function as argument");return Br(t.name||"<<anonymous function>>",{validator:function(l){var f=t(l);return f||dr(this._vueTypes_name+" - "+o),f}})}function Dz(t){if(!ru(t))throw new TypeError("[VueTypes error]: You must provide an array as argument.");var o='oneOf - value should be one of "'+t.join('", "')+'".',l=t.reduce(function(f,g){if(g!=null){var x=g.constructor;f.indexOf(x)===-1&&f.push(x)}return f},[]);return Br("oneOf",{type:l.length>0?l:void 0,validator:function(f){var g=t.indexOf(f)!==-1;return g||dr(o),g}})}function Lz(t){if(!ru(t))throw new TypeError("[VueTypes error]: You must provide an array as argument");for(var o=!1,l=[],f=0;f<t.length;f+=1){var g=t[f];if(cE(g)){if(am(g)&&g._vueTypes_name==="oneOf"){l=l.concat(g.type);continue}if(ou(g.validator)&&(o=!0),g.type!==!0&&g.type){l=l.concat(g.type);continue}}l.push(g)}return l=l.filter(function(x,E){return l.indexOf(x)===E}),Br("oneOfType",o?{type:l,validator:function(x){var E=[],s=t.some(function(A){var k=Dl(am(A)&&A._vueTypes_name==="oneOf"?A.type||null:A,x,!0);return typeof k=="string"&&E.push(k),k===!0});return s||dr("oneOfType - provided value does not match any of the "+E.length+` passed-in validators:
`+Mm(E.join(`
`))),s}}:{type:l})}function Rz(t){return Br("arrayOf",{type:Array,validator:function(o){var l,f=o.every(function(g){return(l=Dl(t,g,!0))===!0});return f||dr(`arrayOf - value validation error:
`+Mm(l)),f}})}function Bz(t){return Br("instanceOf",{type:t})}function Fz(t){return Br("objectOf",{type:Object,validator:function(o){var l,f=Object.keys(o).every(function(g){return(l=Dl(t,o[g],!0))===!0});return f||dr(`objectOf - value validation error:
`+Mm(l)),f}})}function jz(t){var o=Object.keys(t),l=o.filter(function(g){var x;return!!(!((x=t[g])===null||x===void 0)&&x.required)}),f=Br("shape",{type:Object,validator:function(g){var x=this;if(!Al(g))return!1;var E=Object.keys(g);if(l.length>0&&l.some(function(A){return E.indexOf(A)===-1})){var s=l.filter(function(A){return E.indexOf(A)===-1});return dr(s.length===1?'shape - required property "'+s[0]+'" is not defined.':'shape - required properties "'+s.join('", "')+'" are not defined.'),!1}return E.every(function(A){if(o.indexOf(A)===-1)return x._vueTypes_isLoose===!0||(dr('shape - shape definition does not include a "'+A+'" property. Allowed keys: "'+o.join('", "')+'".'),!1);var k=Dl(t[A],g[A],!0);return typeof k=="string"&&dr('shape - "'+A+`" property validation error:
 `+Mm(k)),k===!0})}});return Object.defineProperty(f,"_vueTypes_isLoose",{writable:!0,value:!1}),Object.defineProperty(f,"loose",{get:function(){return this._vueTypes_isLoose=!0,this}}),f}var Bo=function(){function t(){}return t.extend=function(o){var l=this;if(ru(o))return o.forEach(function(D){return l.extend(D)}),this;var f=o.name,g=o.validate,x=g!==void 0&&g,E=o.getter,s=E!==void 0&&E,A=oE(o,["name","validate","getter"]);if(If(this,f))throw new TypeError('[VueTypes error]: Type "'+f+'" already defined');var k,R=A.type;return am(R)?(delete A.type,Object.defineProperty(this,f,s?{get:function(){return _b(f,R,A)}}:{value:function(){var D,F=_b(f,R,A);return F.validator&&(F.validator=(D=F.validator).bind.apply(D,[F].concat([].slice.call(arguments)))),F}})):(k=s?{get:function(){var D=Object.assign({},A);return x?Go(f,D):Br(f,D)},enumerable:!0}:{value:function(){var D,F,G=Object.assign({},A);return D=x?Go(f,G):Br(f,G),G.validator&&(D.validator=(F=G.validator).bind.apply(F,[D].concat([].slice.call(arguments)))),D},enumerable:!0},Object.defineProperty(this,f,k))},iE(t,null,[{key:"any",get:function(){return Ez()}},{key:"func",get:function(){return Cz().def(this.defaults.func)}},{key:"bool",get:function(){return Sz().def(this.defaults.bool)}},{key:"string",get:function(){return Mz().def(this.defaults.string)}},{key:"number",get:function(){return Az().def(this.defaults.number)}},{key:"array",get:function(){return Iz().def(this.defaults.array)}},{key:"object",get:function(){return Pz().def(this.defaults.object)}},{key:"integer",get:function(){return zz().def(this.defaults.integer)}},{key:"symbol",get:function(){return Oz()}}]),t}();function uE(t){var o;return t===void 0&&(t={func:function(){},bool:!0,string:"",number:0,array:function(){return[]},object:function(){return{}},integer:0}),(o=function(l){function f(){return l.apply(this,arguments)||this}return rE(f,l),iE(f,null,[{key:"sensibleDefaults",get:function(){return Vp({},this.defaults)},set:function(g){this.defaults=g!==!1?Vp({},g!==!0?g:t):{}}}]),f}(Bo)).defaults=Vp({},t),o}Bo.defaults={},Bo.custom=kz,Bo.oneOf=Dz,Bo.instanceOf=Bz,Bo.oneOfType=Lz,Bo.arrayOf=Rz,Bo.objectOf=Fz,Bo.shape=jz,Bo.utils={validate:function(t,o){return Dl(o,t,!0)===!0},toType:function(t,o,l){return l===void 0&&(l=!1),l?Go(t,o):Br(t,o)}};(function(t){function o(){return t.apply(this,arguments)||this}return rE(o,t),o})(uE());var hE=uE({func:void 0,bool:void 0,string:void 0,number:void 0,array:void 0,object:void 0,integer:void 0});hE.extend([{name:"looseBool",getter:!0,type:Boolean,default:void 0},{name:"style",getter:!0,type:[String,Object],default:void 0},{name:"VueNode",getter:!0,type:null}]);const on=hE;var Nz=["image","description","imageStyle","class"],fE=Me(vz,null,null),dE=Me(xz,null,null),du=function(o,l){var f,g=l.slots,x=g===void 0?{}:g,E=l.attrs,s=qo("empty",o),A=s.direction,k=s.prefixCls,R=k.value,D=Ve(Ve({},o),E),F=D.image,G=F===void 0?fE:F,oe=D.description,se=oe===void 0?((f=x.description)===null||f===void 0?void 0:f.call(x))||void 0:oe,we=D.imageStyle,xe=D.class,Te=xe===void 0?"":xe,Ue=ga(D,Nz);return Me(eE,{componentName:"Empty",children:function(Pe){var Oe,Le=typeof se<"u"?se:Pe.description,ke=typeof Le=="string"?Le:"empty",We=null;return typeof G=="string"?We=Me("img",{alt:ke,src:G},null):We=G,Me("div",Ve({class:ki(R,Te,(Oe={},Cn(Oe,"".concat(R,"-normal"),G===dE),Cn(Oe,"".concat(R,"-rtl"),A.value==="rtl"),Oe))},Ue),[Me("div",{class:"".concat(R,"-image"),style:we},[We]),Le&&Me("p",{class:"".concat(R,"-description")},[Le]),x.default&&Me("div",{class:"".concat(R,"-footer")},[$f(x.default())])])}},null)};du.displayName="AEmpty";du.PRESENTED_IMAGE_DEFAULT=fE;du.PRESENTED_IMAGE_SIMPLE=dE;du.inheritAttrs=!1;du.props={prefixCls:String,image:on.any,description:on.any,imageStyle:{type:Object,default:void 0}};const Xh=hv(du);var Uz=function(o){var l=qo("empty",o),f=l.prefixCls,g=function(E){switch(E){case"Table":case"List":return Me(Xh,{image:Xh.PRESENTED_IMAGE_SIMPLE},null);case"Select":case"TreeSelect":case"Cascader":case"Transfer":case"Mentions":return Me(Xh,{image:Xh.PRESENTED_IMAGE_SIMPLE,class:"".concat(f.value,"-small")},null);default:return Me(Xh,null,null)}};return g(o.componentName)};function pE(t){return Me(Uz,{componentName:t},null)}var yb={};function Vz(t,o){}function $z(t,o,l){!o&&!yb[l]&&(t(!1,l),yb[l]=!0)}function mE(t,o){$z(Vz,t,o)}const dv=function(t,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";mE(t,"[antdv: ".concat(o,"] ").concat(l))};var oy="internalMark",$p=On({compatConfig:{MODE:3},name:"ALocaleProvider",props:{locale:{type:Object},ANT_MARK__:String},setup:function(o,l){var f=l.slots;dv(o.ANT_MARK__===oy,"LocaleProvider","`LocaleProvider` is deprecated. Please use `locale` with `ConfigProvider` instead");var g=mr({antLocale:Ve(Ve({},o.locale),{},{exist:!0}),ANT_MARK__:oy});return Xi("localeData",g),Wn(function(){return o.locale},function(){g.antLocale=Ve(Ve({},o.locale),{},{exist:!0})},{immediate:!0}),function(){var x;return(x=f.default)===null||x===void 0?void 0:x.call(f)}}});$p.install=function(t){return t.component($p.name,$p),t};const Gz=hv($p);Af("bottomLeft","bottomRight","topLeft","topRight");var gE=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=Ve(o?{name:o,appear:!0,enterFromClass:"".concat(o,"-enter ").concat(o,"-enter-prepare"),enterActiveClass:"".concat(o,"-enter ").concat(o,"-enter-prepare"),enterToClass:"".concat(o,"-enter ").concat(o,"-enter-active"),leaveFromClass:" ".concat(o,"-leave"),leaveActiveClass:"".concat(o,"-leave ").concat(o,"-leave-active"),leaveToClass:"".concat(o,"-leave ").concat(o,"-leave-active")}:{css:!1},l);return f},Zz=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=Ve(o?{name:o,appear:!0,appearActiveClass:"".concat(o),appearToClass:"".concat(o,"-appear ").concat(o,"-appear-active"),enterFromClass:"".concat(o,"-appear ").concat(o,"-enter ").concat(o,"-appear-prepare ").concat(o,"-enter-prepare"),enterActiveClass:"".concat(o),enterToClass:"".concat(o,"-enter ").concat(o,"-appear ").concat(o,"-appear-active ").concat(o,"-enter-active"),leaveActiveClass:"".concat(o," ").concat(o,"-leave"),leaveToClass:"".concat(o,"-leave-active")}:{css:!1},l);return f};const qz=On({name:"Notice",inheritAttrs:!1,props:["prefixCls","duration","updateMark","noticeKey","closeIcon","closable","props","onClick","onClose","holder","visible"],setup:function(o,l){var f=l.attrs,g=l.slots,x,E=yt(function(){return o.duration===void 0?1.5:o.duration}),s=function(){E.value&&(x=setTimeout(function(){k()},E.value*1e3))},A=function(){x&&(clearTimeout(x),x=null)},k=function(F){F&&F.stopPropagation(),A();var G=o.onClose,oe=o.noticeKey;G&&G(oe)},R=function(){A(),s()};return Zo(function(){s()}),Ol(function(){A()}),Wn([E,function(){return o.updateMark},function(){return o.visible}],function(D,F){var G=nu(D,3),oe=G[0],se=G[1],we=G[2],xe=nu(F,3),Te=xe[0],Ue=xe[1],Be=xe[2];(oe!==Te||se!==Ue||we!==Be&&Be)&&R()},{flush:"post"}),function(){var D,F,G=o.prefixCls,oe=o.closable,se=o.closeIcon,we=se===void 0?(D=g.closeIcon)===null||D===void 0?void 0:D.call(g):se,xe=o.onClick,Te=o.holder,Ue=f.class,Be=f.style,Pe="".concat(G,"-notice"),Oe=Object.keys(f).reduce(function(ke,We){return(We.substr(0,5)==="data-"||We.substr(0,5)==="aria-"||We==="role")&&(ke[We]=f[We]),ke},{}),Le=Me("div",Ve({class:ki(Pe,Ue,Cn({},"".concat(Pe,"-closable"),oe)),style:Be,onMouseenter:A,onMouseleave:s,onClick:xe},Oe),[Me("div",{class:"".concat(Pe,"-content")},[(F=g.default)===null||F===void 0?void 0:F.call(g)]),oe?Me("a",{tabindex:0,onClick:k,class:"".concat(Pe,"-close")},[we||Me("span",{class:"".concat(Pe,"-close-x")},null)]):null]);return Te?Me(sv,{to:Te},{default:function(){return Le}}):Le}}});var Wz=["name","getContainer","appContext","prefixCls","rootPrefixCls","transitionName","hasTransitionName"],vb=0,Hz=Date.now();function xb(){var t=vb;return vb+=1,"rcNotification_".concat(Hz,"_").concat(t)}var sy=On({name:"Notification",inheritAttrs:!1,props:["prefixCls","transitionName","animation","maxCount","closeIcon"],setup:function(o,l){var f=l.attrs,g=l.expose,x=l.slots,E=new Map,s=Gt([]),A=yt(function(){var D=o.prefixCls,F=o.animation,G=F===void 0?"fade":F,oe=o.transitionName;return!oe&&G&&(oe="".concat(D,"-").concat(G)),Zz(oe)}),k=function(F,G){var oe=F.key||xb(),se=Ve(Ve({},F),{},{key:oe}),we=o.maxCount,xe=s.value.map(function(Ue){return Ue.notice.key}).indexOf(oe),Te=s.value.concat();xe!==-1?Te.splice(xe,1,{notice:se,holderCallback:G}):(we&&s.value.length>=we&&(se.key=Te[0].notice.key,se.updateMark=xb(),se.userPassKey=oe,Te.shift()),Te.push({notice:se,holderCallback:G})),s.value=Te},R=function(F){s.value=s.value.filter(function(G){var oe=G.notice,se=oe.key,we=oe.userPassKey,xe=we||se;return xe!==F})};return g({add:k,remove:R,notices:s}),function(){var D,F,G=o.prefixCls,oe=o.closeIcon,se=oe===void 0?(D=x.closeIcon)===null||D===void 0?void 0:D.call(x,{prefixCls:G}):oe,we=s.value.map(function(Te,Ue){var Be=Te.notice,Pe=Te.holderCallback,Oe=Ue===s.value.length-1?Be.updateMark:void 0,Le=Be.key,ke=Be.userPassKey,We=Be.content,ct=Ve(Ve(Ve({prefixCls:G,closeIcon:typeof se=="function"?se({prefixCls:G}):se},Be),Be.props),{},{key:Le,noticeKey:ke||Le,updateMark:Oe,onClose:function(st){var Ge;R(st),(Ge=Be.onClose)===null||Ge===void 0||Ge.call(Be)},onClick:Be.onClick});return Pe?Me("div",{key:Le,class:"".concat(G,"-hook-holder"),ref:function(st){typeof Le>"u"||(st?(E.set(Le,st),Pe(st,ct)):E.delete(Le))}},null):Me(qz,ct,{default:function(){return[typeof We=="function"?We({prefixCls:G}):We]}})}),xe=(F={},Cn(F,G,1),Cn(F,f.class,!!f.class),F);return Me("div",{class:xe,style:f.style||{top:"65px",left:"50%"}},[Me(e3,Ve({tag:"div"},A.value),{default:function(){return[we]}})])}}});sy.newInstance=function(o,l){var f=o||{},g=f.name,x=g===void 0?"notification":g,E=f.getContainer,s=f.appContext,A=f.prefixCls,k=f.rootPrefixCls,R=f.transitionName,D=f.hasTransitionName,F=ga(f,Wz),G=document.createElement("div");if(E){var oe=E();oe.appendChild(G)}else document.body.appendChild(G);var se=On({compatConfig:{MODE:3},name:"NotificationWrapper",setup:function(Te,Ue){var Be=Ue.attrs,Pe=Gt();return Zo(function(){l({notice:function(Le){var ke;(ke=Pe.value)===null||ke===void 0||ke.add(Le)},removeNotice:function(Le){var ke;(ke=Pe.value)===null||ke===void 0||ke.remove(Le)},destroy:function(){ob(null,G),G.parentNode&&G.parentNode.removeChild(G)},component:Pe})}),function(){var Oe=qr,Le=Oe.getPrefixCls(x,A),ke=Oe.getRootPrefixCls(k,Le),We=D?R:"".concat(ke,"-").concat(R);return Me(hf,Ve(Ve({},Oe),{},{notUpdateGlobalConfig:!0,prefixCls:ke}),{default:function(){return[Me(sy,Ve(Ve({ref:Pe},Be),{},{prefixCls:Le,transitionName:We}),null)]}})}}}),we=Me(se,F);we.appContext=s||we.appContext,ob(we,G)};const _E=sy;var Xz={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"};const Kz=Xz;function Ki(t,o){Yz(t)&&(t="100%");var l=Jz(t);return t=o===360?t:Math.min(o,Math.max(0,parseFloat(t))),l&&(t=parseInt(String(t*o),10)/100),Math.abs(t-o)<1e-6?1:(o===360?t=(t<0?t%o+o:t%o)/parseFloat(String(o)):t=t%o/parseFloat(String(o)),t)}function Sp(t){return Math.min(1,Math.max(0,t))}function Yz(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function Jz(t){return typeof t=="string"&&t.indexOf("%")!==-1}function yE(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Mp(t){return t<=1?"".concat(Number(t)*100,"%"):t}function Tl(t){return t.length===1?"0"+t:String(t)}function Qz(t,o,l){return{r:Ki(t,255)*255,g:Ki(o,255)*255,b:Ki(l,255)*255}}function bb(t,o,l){t=Ki(t,255),o=Ki(o,255),l=Ki(l,255);var f=Math.max(t,o,l),g=Math.min(t,o,l),x=0,E=0,s=(f+g)/2;if(f===g)E=0,x=0;else{var A=f-g;switch(E=s>.5?A/(2-f-g):A/(f+g),f){case t:x=(o-l)/A+(o<l?6:0);break;case o:x=(l-t)/A+2;break;case l:x=(t-o)/A+4;break}x/=6}return{h:x,s:E,l:s}}function x_(t,o,l){return l<0&&(l+=1),l>1&&(l-=1),l<1/6?t+(o-t)*(6*l):l<1/2?o:l<2/3?t+(o-t)*(2/3-l)*6:t}function eO(t,o,l){var f,g,x;if(t=Ki(t,360),o=Ki(o,100),l=Ki(l,100),o===0)g=l,x=l,f=l;else{var E=l<.5?l*(1+o):l+o-l*o,s=2*l-E;f=x_(s,E,t+1/3),g=x_(s,E,t),x=x_(s,E,t-1/3)}return{r:f*255,g:g*255,b:x*255}}function ay(t,o,l){t=Ki(t,255),o=Ki(o,255),l=Ki(l,255);var f=Math.max(t,o,l),g=Math.min(t,o,l),x=0,E=f,s=f-g,A=f===0?0:s/f;if(f===g)x=0;else{switch(f){case t:x=(o-l)/s+(o<l?6:0);break;case o:x=(l-t)/s+2;break;case l:x=(t-o)/s+4;break}x/=6}return{h:x,s:A,v:E}}function tO(t,o,l){t=Ki(t,360)*6,o=Ki(o,100),l=Ki(l,100);var f=Math.floor(t),g=t-f,x=l*(1-o),E=l*(1-g*o),s=l*(1-(1-g)*o),A=f%6,k=[l,E,x,x,s,l][A],R=[s,l,l,E,x,x][A],D=[x,x,s,l,l,E][A];return{r:k*255,g:R*255,b:D*255}}function ly(t,o,l,f){var g=[Tl(Math.round(t).toString(16)),Tl(Math.round(o).toString(16)),Tl(Math.round(l).toString(16))];return f&&g[0].startsWith(g[0].charAt(1))&&g[1].startsWith(g[1].charAt(1))&&g[2].startsWith(g[2].charAt(1))?g[0].charAt(0)+g[1].charAt(0)+g[2].charAt(0):g.join("")}function nO(t,o,l,f,g){var x=[Tl(Math.round(t).toString(16)),Tl(Math.round(o).toString(16)),Tl(Math.round(l).toString(16)),Tl(iO(f))];return g&&x[0].startsWith(x[0].charAt(1))&&x[1].startsWith(x[1].charAt(1))&&x[2].startsWith(x[2].charAt(1))&&x[3].startsWith(x[3].charAt(1))?x[0].charAt(0)+x[1].charAt(0)+x[2].charAt(0)+x[3].charAt(0):x.join("")}function iO(t){return Math.round(parseFloat(t)*255).toString(16)}function wb(t){return Lr(t)/255}function Lr(t){return parseInt(t,16)}function rO(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var cy={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Uc(t){var o={r:0,g:0,b:0},l=1,f=null,g=null,x=null,E=!1,s=!1;return typeof t=="string"&&(t=aO(t)),typeof t=="object"&&(fs(t.r)&&fs(t.g)&&fs(t.b)?(o=Qz(t.r,t.g,t.b),E=!0,s=String(t.r).substr(-1)==="%"?"prgb":"rgb"):fs(t.h)&&fs(t.s)&&fs(t.v)?(f=Mp(t.s),g=Mp(t.v),o=tO(t.h,f,g),E=!0,s="hsv"):fs(t.h)&&fs(t.s)&&fs(t.l)&&(f=Mp(t.s),x=Mp(t.l),o=eO(t.h,f,x),E=!0,s="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(l=t.a)),l=yE(l),{ok:E,format:t.format||s,r:Math.min(255,Math.max(o.r,0)),g:Math.min(255,Math.max(o.g,0)),b:Math.min(255,Math.max(o.b,0)),a:l}}var oO="[-\\+]?\\d+%?",sO="[-\\+]?\\d*\\.\\d+%?",ca="(?:".concat(sO,")|(?:").concat(oO,")"),b_="[\\s|\\(]+(".concat(ca,")[,|\\s]+(").concat(ca,")[,|\\s]+(").concat(ca,")\\s*\\)?"),w_="[\\s|\\(]+(".concat(ca,")[,|\\s]+(").concat(ca,")[,|\\s]+(").concat(ca,")[,|\\s]+(").concat(ca,")\\s*\\)?"),lo={CSS_UNIT:new RegExp(ca),rgb:new RegExp("rgb"+b_),rgba:new RegExp("rgba"+w_),hsl:new RegExp("hsl"+b_),hsla:new RegExp("hsla"+w_),hsv:new RegExp("hsv"+b_),hsva:new RegExp("hsva"+w_),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function aO(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var o=!1;if(cy[t])t=cy[t],o=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var l=lo.rgb.exec(t);return l?{r:l[1],g:l[2],b:l[3]}:(l=lo.rgba.exec(t),l?{r:l[1],g:l[2],b:l[3],a:l[4]}:(l=lo.hsl.exec(t),l?{h:l[1],s:l[2],l:l[3]}:(l=lo.hsla.exec(t),l?{h:l[1],s:l[2],l:l[3],a:l[4]}:(l=lo.hsv.exec(t),l?{h:l[1],s:l[2],v:l[3]}:(l=lo.hsva.exec(t),l?{h:l[1],s:l[2],v:l[3],a:l[4]}:(l=lo.hex8.exec(t),l?{r:Lr(l[1]),g:Lr(l[2]),b:Lr(l[3]),a:wb(l[4]),format:o?"name":"hex8"}:(l=lo.hex6.exec(t),l?{r:Lr(l[1]),g:Lr(l[2]),b:Lr(l[3]),format:o?"name":"hex"}:(l=lo.hex4.exec(t),l?{r:Lr(l[1]+l[1]),g:Lr(l[2]+l[2]),b:Lr(l[3]+l[3]),a:wb(l[4]+l[4]),format:o?"name":"hex8"}:(l=lo.hex3.exec(t),l?{r:Lr(l[1]+l[1]),g:Lr(l[2]+l[2]),b:Lr(l[3]+l[3]),format:o?"name":"hex"}:!1)))))))))}function fs(t){return Boolean(lo.CSS_UNIT.exec(String(t)))}var T_=function(){function t(o,l){o===void 0&&(o=""),l===void 0&&(l={});var f;if(o instanceof t)return o;typeof o=="number"&&(o=rO(o)),this.originalInput=o;var g=Uc(o);this.originalInput=o,this.r=g.r,this.g=g.g,this.b=g.b,this.a=g.a,this.roundA=Math.round(100*this.a)/100,this.format=(f=l.format)!==null&&f!==void 0?f:g.format,this.gradientType=l.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=g.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var o=this.toRgb();return(o.r*299+o.g*587+o.b*114)/1e3},t.prototype.getLuminance=function(){var o=this.toRgb(),l,f,g,x=o.r/255,E=o.g/255,s=o.b/255;return x<=.03928?l=x/12.92:l=Math.pow((x+.055)/1.055,2.4),E<=.03928?f=E/12.92:f=Math.pow((E+.055)/1.055,2.4),s<=.03928?g=s/12.92:g=Math.pow((s+.055)/1.055,2.4),.2126*l+.7152*f+.0722*g},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(o){return this.a=yE(o),this.roundA=Math.round(100*this.a)/100,this},t.prototype.toHsv=function(){var o=ay(this.r,this.g,this.b);return{h:o.h*360,s:o.s,v:o.v,a:this.a}},t.prototype.toHsvString=function(){var o=ay(this.r,this.g,this.b),l=Math.round(o.h*360),f=Math.round(o.s*100),g=Math.round(o.v*100);return this.a===1?"hsv(".concat(l,", ").concat(f,"%, ").concat(g,"%)"):"hsva(".concat(l,", ").concat(f,"%, ").concat(g,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var o=bb(this.r,this.g,this.b);return{h:o.h*360,s:o.s,l:o.l,a:this.a}},t.prototype.toHslString=function(){var o=bb(this.r,this.g,this.b),l=Math.round(o.h*360),f=Math.round(o.s*100),g=Math.round(o.l*100);return this.a===1?"hsl(".concat(l,", ").concat(f,"%, ").concat(g,"%)"):"hsla(".concat(l,", ").concat(f,"%, ").concat(g,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(o){return o===void 0&&(o=!1),ly(this.r,this.g,this.b,o)},t.prototype.toHexString=function(o){return o===void 0&&(o=!1),"#"+this.toHex(o)},t.prototype.toHex8=function(o){return o===void 0&&(o=!1),nO(this.r,this.g,this.b,this.a,o)},t.prototype.toHex8String=function(o){return o===void 0&&(o=!1),"#"+this.toHex8(o)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var o=Math.round(this.r),l=Math.round(this.g),f=Math.round(this.b);return this.a===1?"rgb(".concat(o,", ").concat(l,", ").concat(f,")"):"rgba(".concat(o,", ").concat(l,", ").concat(f,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var o=function(l){return"".concat(Math.round(Ki(l,255)*100),"%")};return{r:o(this.r),g:o(this.g),b:o(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var o=function(l){return Math.round(Ki(l,255)*100)};return this.a===1?"rgb(".concat(o(this.r),"%, ").concat(o(this.g),"%, ").concat(o(this.b),"%)"):"rgba(".concat(o(this.r),"%, ").concat(o(this.g),"%, ").concat(o(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var o="#"+ly(this.r,this.g,this.b,!1),l=0,f=Object.entries(cy);l<f.length;l++){var g=f[l],x=g[0],E=g[1];if(o===E)return x}return!1},t.prototype.toString=function(o){var l=Boolean(o);o=o!=null?o:this.format;var f=!1,g=this.a<1&&this.a>=0,x=!l&&g&&(o.startsWith("hex")||o==="name");return x?o==="name"&&this.a===0?this.toName():this.toRgbString():(o==="rgb"&&(f=this.toRgbString()),o==="prgb"&&(f=this.toPercentageRgbString()),(o==="hex"||o==="hex6")&&(f=this.toHexString()),o==="hex3"&&(f=this.toHexString(!0)),o==="hex4"&&(f=this.toHex8String(!0)),o==="hex8"&&(f=this.toHex8String()),o==="name"&&(f=this.toName()),o==="hsl"&&(f=this.toHslString()),o==="hsv"&&(f=this.toHsvString()),f||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(o){o===void 0&&(o=10);var l=this.toHsl();return l.l+=o/100,l.l=Sp(l.l),new t(l)},t.prototype.brighten=function(o){o===void 0&&(o=10);var l=this.toRgb();return l.r=Math.max(0,Math.min(255,l.r-Math.round(255*-(o/100)))),l.g=Math.max(0,Math.min(255,l.g-Math.round(255*-(o/100)))),l.b=Math.max(0,Math.min(255,l.b-Math.round(255*-(o/100)))),new t(l)},t.prototype.darken=function(o){o===void 0&&(o=10);var l=this.toHsl();return l.l-=o/100,l.l=Sp(l.l),new t(l)},t.prototype.tint=function(o){return o===void 0&&(o=10),this.mix("white",o)},t.prototype.shade=function(o){return o===void 0&&(o=10),this.mix("black",o)},t.prototype.desaturate=function(o){o===void 0&&(o=10);var l=this.toHsl();return l.s-=o/100,l.s=Sp(l.s),new t(l)},t.prototype.saturate=function(o){o===void 0&&(o=10);var l=this.toHsl();return l.s+=o/100,l.s=Sp(l.s),new t(l)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(o){var l=this.toHsl(),f=(l.h+o)%360;return l.h=f<0?360+f:f,new t(l)},t.prototype.mix=function(o,l){l===void 0&&(l=50);var f=this.toRgb(),g=new t(o).toRgb(),x=l/100,E={r:(g.r-f.r)*x+f.r,g:(g.g-f.g)*x+f.g,b:(g.b-f.b)*x+f.b,a:(g.a-f.a)*x+f.a};return new t(E)},t.prototype.analogous=function(o,l){o===void 0&&(o=6),l===void 0&&(l=30);var f=this.toHsl(),g=360/l,x=[this];for(f.h=(f.h-(g*o>>1)+720)%360;--o;)f.h=(f.h+g)%360,x.push(new t(f));return x},t.prototype.complement=function(){var o=this.toHsl();return o.h=(o.h+180)%360,new t(o)},t.prototype.monochromatic=function(o){o===void 0&&(o=6);for(var l=this.toHsv(),f=l.h,g=l.s,x=l.v,E=[],s=1/o;o--;)E.push(new t({h:f,s:g,v:x})),x=(x+s)%1;return E},t.prototype.splitcomplement=function(){var o=this.toHsl(),l=o.h;return[this,new t({h:(l+72)%360,s:o.s,l:o.l}),new t({h:(l+216)%360,s:o.s,l:o.l})]},t.prototype.onBackground=function(o){var l=this.toRgb(),f=new t(o).toRgb();return new t({r:f.r+(l.r-f.r)*l.a,g:f.g+(l.g-f.g)*l.a,b:f.b+(l.b-f.b)*l.a})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(o){for(var l=this.toHsl(),f=l.h,g=[this],x=360/o,E=1;E<o;E++)g.push(new t({h:(f+E*x)%360,s:l.s,l:l.l}));return g},t.prototype.equals=function(o){return this.toRgbString()===new t(o).toRgbString()},t}(),Ap=2,Tb=.16,lO=.05,cO=.05,uO=.15,vE=5,xE=4,hO=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function Eb(t){var o=t.r,l=t.g,f=t.b,g=ay(o,l,f);return{h:g.h*360,s:g.s,v:g.v}}function Ip(t){var o=t.r,l=t.g,f=t.b;return"#".concat(ly(o,l,f,!1))}function fO(t,o,l){var f=l/100,g={r:(o.r-t.r)*f+t.r,g:(o.g-t.g)*f+t.g,b:(o.b-t.b)*f+t.b};return g}function Cb(t,o,l){var f;return Math.round(t.h)>=60&&Math.round(t.h)<=240?f=l?Math.round(t.h)-Ap*o:Math.round(t.h)+Ap*o:f=l?Math.round(t.h)+Ap*o:Math.round(t.h)-Ap*o,f<0?f+=360:f>=360&&(f-=360),f}function Sb(t,o,l){if(t.h===0&&t.s===0)return t.s;var f;return l?f=t.s-Tb*o:o===xE?f=t.s+Tb:f=t.s+lO*o,f>1&&(f=1),l&&o===vE&&f>.1&&(f=.1),f<.06&&(f=.06),Number(f.toFixed(2))}function Mb(t,o,l){var f;return l?f=t.v+cO*o:f=t.v-uO*o,f>1&&(f=1),Number(f.toFixed(2))}function Pf(t){for(var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=[],f=Uc(t),g=vE;g>0;g-=1){var x=Eb(f),E=Ip(Uc({h:Cb(x,g,!0),s:Sb(x,g,!0),v:Mb(x,g,!0)}));l.push(E)}l.push(Ip(f));for(var s=1;s<=xE;s+=1){var A=Eb(f),k=Ip(Uc({h:Cb(A,s),s:Sb(A,s),v:Mb(A,s)}));l.push(k)}return o.theme==="dark"?hO.map(function(R){var D=R.index,F=R.opacity,G=Ip(fO(Uc(o.backgroundColor||"#141414"),Uc(l[D]),F*100));return G}):l}var E_={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},C_={},S_={};Object.keys(E_).forEach(function(t){C_[t]=Pf(E_[t]),C_[t].primary=C_[t][5],S_[t]=Pf(E_[t],{theme:"dark",backgroundColor:"#141414"}),S_[t].primary=S_[t][5]});var Ab=[],Kh=[],dO="insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).";function pO(){var t=document.createElement("style");return t.setAttribute("type","text/css"),t}function mO(t,o){if(o=o||{},t===void 0)throw new Error(dO);var l=o.prepend===!0?"prepend":"append",f=o.container!==void 0?o.container:document.querySelector("head"),g=Ab.indexOf(f);g===-1&&(g=Ab.push(f)-1,Kh[g]={});var x;return Kh[g]!==void 0&&Kh[g][l]!==void 0?x=Kh[g][l]:(x=Kh[g][l]=pO(),l==="prepend"?f.insertBefore(x,f.childNodes[0]):f.appendChild(x)),t.charCodeAt(0)===65279&&(t=t.substr(1,t.length)),x.styleSheet?x.styleSheet.cssText+=t:x.textContent+=t,x}function Ib(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){gO(t,g,l[g])})}return t}function gO(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}function Pb(t){return typeof t=="object"&&typeof t.name=="string"&&typeof t.theme=="string"&&(typeof t.icon=="object"||typeof t.icon=="function")}function uy(t,o,l){return l?Ml(t.tag,Ib({key:o},l,t.attrs),(t.children||[]).map(function(f,g){return uy(f,"".concat(o,"-").concat(t.tag,"-").concat(g))})):Ml(t.tag,Ib({key:o},t.attrs),(t.children||[]).map(function(f,g){return uy(f,"".concat(o,"-").concat(t.tag,"-").concat(g))}))}function bE(t){return Pf(t)[0]}function wE(t){return t?Array.isArray(t)?t:[t]:[]}var _O=`
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,zb=!1,yO=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_O;vs(function(){zb||(typeof window<"u"&&window.document&&window.document.documentElement&&mO(o,{prepend:!0}),zb=!0)})},vO=["icon","primaryColor","secondaryColor"];function xO(t,o){if(t==null)return{};var l=bO(t,o),f,g;if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(t);for(g=0;g<x.length;g++)f=x[g],!(o.indexOf(f)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,f)||(l[f]=t[f]))}return l}function bO(t,o){if(t==null)return{};var l={},f=Object.keys(t),g,x;for(x=0;x<f.length;x++)g=f[x],!(o.indexOf(g)>=0)&&(l[g]=t[g]);return l}function Gp(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){wO(t,g,l[g])})}return t}function wO(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var uf={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function TO(t){var o=t.primaryColor,l=t.secondaryColor;uf.primaryColor=o,uf.secondaryColor=l||bE(o),uf.calculated=!!l}function EO(){return Gp({},uf)}var pu=function(o,l){var f=Gp({},o,l.attrs),g=f.icon,x=f.primaryColor,E=f.secondaryColor,s=xO(f,vO),A=uf;if(x&&(A={primaryColor:x,secondaryColor:E||bE(x)}),yO(),Pb(g),!Pb(g))return null;var k=g;return k&&typeof k.icon=="function"&&(k=Gp({},k,{icon:k.icon(A.primaryColor,A.secondaryColor)})),uy(k.icon,"svg-".concat(k.name),Gp({},s,{"data-icon":k.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"}))};pu.props={icon:Object,primaryColor:String,secondaryColor:String,focusable:String};pu.inheritAttrs=!1;pu.displayName="IconBase";pu.getTwoToneColors=EO;pu.setTwoToneColors=TO;const pv=pu;function CO(t,o){return IO(t)||AO(t,o)||MO(t,o)||SO()}function SO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MO(t,o){if(!!t){if(typeof t=="string")return Ob(t,o);var l=Object.prototype.toString.call(t).slice(8,-1);if(l==="Object"&&t.constructor&&(l=t.constructor.name),l==="Map"||l==="Set")return Array.from(t);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return Ob(t,o)}}function Ob(t,o){(o==null||o>t.length)&&(o=t.length);for(var l=0,f=new Array(o);l<o;l++)f[l]=t[l];return f}function AO(t,o){var l=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(l!=null){var f=[],g=!0,x=!1,E,s;try{for(l=l.call(t);!(g=(E=l.next()).done)&&(f.push(E.value),!(o&&f.length===o));g=!0);}catch(A){x=!0,s=A}finally{try{!g&&l.return!=null&&l.return()}finally{if(x)throw s}}return f}}function IO(t){if(Array.isArray(t))return t}function TE(t){var o=wE(t),l=CO(o,2),f=l[0],g=l[1];return pv.setTwoToneColors({primaryColor:f,secondaryColor:g})}function PO(){var t=pv.getTwoToneColors();return t.calculated?[t.primaryColor,t.secondaryColor]:t.primaryColor}var zO=["class","icon","spin","rotate","tabindex","twoToneColor","onClick"];function OO(t,o){return RO(t)||LO(t,o)||DO(t,o)||kO()}function kO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DO(t,o){if(!!t){if(typeof t=="string")return kb(t,o);var l=Object.prototype.toString.call(t).slice(8,-1);if(l==="Object"&&t.constructor&&(l=t.constructor.name),l==="Map"||l==="Set")return Array.from(t);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return kb(t,o)}}function kb(t,o){(o==null||o>t.length)&&(o=t.length);for(var l=0,f=new Array(o);l<o;l++)f[l]=t[l];return f}function LO(t,o){var l=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(l!=null){var f=[],g=!0,x=!1,E,s;try{for(l=l.call(t);!(g=(E=l.next()).done)&&(f.push(E.value),!(o&&f.length===o));g=!0);}catch(A){x=!0,s=A}finally{try{!g&&l.return!=null&&l.return()}finally{if(x)throw s}}return f}}function RO(t){if(Array.isArray(t))return t}function Db(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){hy(t,g,l[g])})}return t}function hy(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}function BO(t,o){if(t==null)return{};var l=FO(t,o),f,g;if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(t);for(g=0;g<x.length;g++)f=x[g],!(o.indexOf(f)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,f)||(l[f]=t[f]))}return l}function FO(t,o){if(t==null)return{};var l={},f=Object.keys(t),g,x;for(x=0;x<f.length;x++)g=f[x],!(o.indexOf(g)>=0)&&(l[g]=t[g]);return l}TE("#1890ff");var mu=function(o,l){var f,g=Db({},o,l.attrs),x=g.class,E=g.icon,s=g.spin,A=g.rotate,k=g.tabindex,R=g.twoToneColor,D=g.onClick,F=BO(g,zO),G=(f={anticon:!0},hy(f,"anticon-".concat(E.name),Boolean(E.name)),hy(f,x,x),f),oe=s===""||!!s||E.name==="loading"?"anticon-spin":"",se=k;se===void 0&&D&&(se=-1,F.tabindex=se);var we=A?{msTransform:"rotate(".concat(A,"deg)"),transform:"rotate(".concat(A,"deg)")}:void 0,xe=wE(R),Te=OO(xe,2),Ue=Te[0],Be=Te[1];return Me("span",Db({role:"img","aria-label":E.name},F,{onClick:D,class:G}),[Me(pv,{class:oe,icon:E,primaryColor:Ue,secondaryColor:Be,style:we},null)])};mu.props={spin:Boolean,rotate:Number,icon:Object,twoToneColor:String};mu.displayName="AntdIcon";mu.inheritAttrs=!1;mu.getTwoToneColor=PO;mu.setTwoToneColor=TE;const Cr=mu;function Lb(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){jO(t,g,l[g])})}return t}function jO(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var mv=function(o,l){var f=Lb({},o,l.attrs);return Me(Cr,Lb({},f,{icon:Kz}),null)};mv.displayName="LoadingOutlined";mv.inheritAttrs=!1;const NO=mv;var UO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"};const VO=UO;function Rb(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){$O(t,g,l[g])})}return t}function $O(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var gv=function(o,l){var f=Rb({},o,l.attrs);return Me(Cr,Rb({},f,{icon:VO}),null)};gv.displayName="ExclamationCircleFilled";gv.inheritAttrs=!1;const GO=gv;var ZO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 01-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z"}}]},name:"close-circle",theme:"filled"};const qO=ZO;function Bb(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){WO(t,g,l[g])})}return t}function WO(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var _v=function(o,l){var f=Bb({},o,l.attrs);return Me(Cr,Bb({},f,{icon:qO}),null)};_v.displayName="CloseCircleFilled";_v.inheritAttrs=!1;const HO=_v;var XO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"};const KO=XO;function Fb(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){YO(t,g,l[g])})}return t}function YO(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var yv=function(o,l){var f=Fb({},o,l.attrs);return Me(Cr,Fb({},f,{icon:KO}),null)};yv.displayName="CheckCircleFilled";yv.inheritAttrs=!1;const JO=yv;var QO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"};const ek=QO;function jb(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){tk(t,g,l[g])})}return t}function tk(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var vv=function(o,l){var f=jb({},o,l.attrs);return Me(Cr,jb({},f,{icon:ek}),null)};vv.displayName="InfoCircleFilled";vv.inheritAttrs=!1;const nk=vv;var EE=3,CE,pr,ik=1,SE="",ME="move-up",AE=!1,IE=function(){return document.body},PE,zE=!1;function rk(){return ik++}function ok(t){t.top!==void 0&&(CE=t.top,pr=null),t.duration!==void 0&&(EE=t.duration),t.prefixCls!==void 0&&(SE=t.prefixCls),t.getContainer!==void 0&&(IE=t.getContainer,pr=null),t.transitionName!==void 0&&(ME=t.transitionName,pr=null,AE=!0),t.maxCount!==void 0&&(PE=t.maxCount,pr=null),t.rtl!==void 0&&(zE=t.rtl)}function sk(t,o){if(pr){o(pr);return}_E.newInstance({appContext:t.appContext,prefixCls:t.prefixCls||SE,rootPrefixCls:t.rootPrefixCls,transitionName:ME,hasTransitionName:AE,style:{top:CE},getContainer:IE||t.getPopupContainer,maxCount:PE,name:"message"},function(l){if(pr){o(pr);return}pr=l,o(l)})}var ak={info:nk,success:JO,error:HO,warning:GO,loading:NO};function lk(t){var o=t.duration!==void 0?t.duration:EE,l=t.key||rk(),f=new Promise(function(x){var E=function(){return typeof t.onClose=="function"&&t.onClose(),x(!0)};sk(t,function(s){s.notice({key:l,duration:o,style:t.style||{},class:t.class,content:function(k){var R,D=k.prefixCls,F=ak[t.type],G=F?Me(F,null,null):"",oe=ki("".concat(D,"-custom-content"),(R={},Cn(R,"".concat(D,"-").concat(t.type),t.type),Cn(R,"".concat(D,"-rtl"),zE===!0),R));return Me("div",{class:oe},[typeof t.icon=="function"?t.icon():t.icon||G,Me("span",null,[typeof t.content=="function"?t.content():t.content])])},onClose:E,onClick:t.onClick})})}),g=function(){pr&&pr.removeNotice(l)};return g.then=function(x,E){return f.then(x,E)},g.promise=f,g}function ck(t){return Object.prototype.toString.call(t)==="[object Object]"&&!!t.content}var lm={open:lk,config:ok,destroy:function(o){if(pr)if(o){var l=pr,f=l.removeNotice;f(o)}else{var g=pr,x=g.destroy;x(),pr=null}}};function uk(t,o){t[o]=function(l,f,g){return ck(l)?t.open(Ve(Ve({},l),{},{type:o})):(typeof f=="function"&&(g=f,f=void 0),t.open({content:l,duration:f,type:o,onClose:g}))}}["success","info","warning","error","loading"].forEach(function(t){return uk(lm,t)});lm.warn=lm.warning;const hk=lm;function Nb(t,o,l,f,g,x,E){try{var s=t[x](E),A=s.value}catch(k){l(k);return}s.done?o(A):Promise.resolve(A).then(f,g)}function fk(t){return function(){var o=this,l=arguments;return new Promise(function(f,g){var x=t.apply(o,l);function E(A){Nb(x,f,g,E,s,"next",A)}function s(A){Nb(x,f,g,E,s,"throw",A)}E(void 0)})}}var dk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},OE={exports:{}},kE={exports:{}};(function(t){function o(l){return t.exports=o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},t.exports.__esModule=!0,t.exports.default=t.exports,o(l)}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports})(kE);(function(t){var o=kE.exports.default;function l(){t.exports=l=function(){return f},t.exports.__esModule=!0,t.exports.default=t.exports;var f={},g=Object.prototype,x=g.hasOwnProperty,E=typeof Symbol=="function"?Symbol:{},s=E.iterator||"@@iterator",A=E.asyncIterator||"@@asyncIterator",k=E.toStringTag||"@@toStringTag";function R(Ge,Ne,vt){return Object.defineProperty(Ge,Ne,{value:vt,enumerable:!0,configurable:!0,writable:!0}),Ge[Ne]}try{R({},"")}catch{R=function(vt,rt,at){return vt[rt]=at}}function D(Ge,Ne,vt,rt){var at=Ne&&Ne.prototype instanceof oe?Ne:oe,ht=Object.create(at.prototype),Ft=new ct(rt||[]);return ht._invoke=function(ln,pn,Lt){var nn="suspendedStart";return function(xt,be){if(nn==="executing")throw new Error("Generator is already running");if(nn==="completed"){if(xt==="throw")throw be;return st()}for(Lt.method=xt,Lt.arg=be;;){var Xe=Lt.delegate;if(Xe){var ut=Le(Xe,Lt);if(ut){if(ut===G)continue;return ut}}if(Lt.method==="next")Lt.sent=Lt._sent=Lt.arg;else if(Lt.method==="throw"){if(nn==="suspendedStart")throw nn="completed",Lt.arg;Lt.dispatchException(Lt.arg)}else Lt.method==="return"&&Lt.abrupt("return",Lt.arg);nn="executing";var bt=F(ln,pn,Lt);if(bt.type==="normal"){if(nn=Lt.done?"completed":"suspendedYield",bt.arg===G)continue;return{value:bt.arg,done:Lt.done}}bt.type==="throw"&&(nn="completed",Lt.method="throw",Lt.arg=bt.arg)}}}(Ge,vt,Ft),ht}function F(Ge,Ne,vt){try{return{type:"normal",arg:Ge.call(Ne,vt)}}catch(rt){return{type:"throw",arg:rt}}}f.wrap=D;var G={};function oe(){}function se(){}function we(){}var xe={};R(xe,s,function(){return this});var Te=Object.getPrototypeOf,Ue=Te&&Te(Te(Tt([])));Ue&&Ue!==g&&x.call(Ue,s)&&(xe=Ue);var Be=we.prototype=oe.prototype=Object.create(xe);function Pe(Ge){["next","throw","return"].forEach(function(Ne){R(Ge,Ne,function(vt){return this._invoke(Ne,vt)})})}function Oe(Ge,Ne){function vt(at,ht,Ft,ln){var pn=F(Ge[at],Ge,ht);if(pn.type!=="throw"){var Lt=pn.arg,nn=Lt.value;return nn&&o(nn)=="object"&&x.call(nn,"__await")?Ne.resolve(nn.__await).then(function(xt){vt("next",xt,Ft,ln)},function(xt){vt("throw",xt,Ft,ln)}):Ne.resolve(nn).then(function(xt){Lt.value=xt,Ft(Lt)},function(xt){return vt("throw",xt,Ft,ln)})}ln(pn.arg)}var rt;this._invoke=function(at,ht){function Ft(){return new Ne(function(ln,pn){vt(at,ht,ln,pn)})}return rt=rt?rt.then(Ft,Ft):Ft()}}function Le(Ge,Ne){var vt=Ge.iterator[Ne.method];if(vt===void 0){if(Ne.delegate=null,Ne.method==="throw"){if(Ge.iterator.return&&(Ne.method="return",Ne.arg=void 0,Le(Ge,Ne),Ne.method==="throw"))return G;Ne.method="throw",Ne.arg=new TypeError("The iterator does not provide a 'throw' method")}return G}var rt=F(vt,Ge.iterator,Ne.arg);if(rt.type==="throw")return Ne.method="throw",Ne.arg=rt.arg,Ne.delegate=null,G;var at=rt.arg;return at?at.done?(Ne[Ge.resultName]=at.value,Ne.next=Ge.nextLoc,Ne.method!=="return"&&(Ne.method="next",Ne.arg=void 0),Ne.delegate=null,G):at:(Ne.method="throw",Ne.arg=new TypeError("iterator result is not an object"),Ne.delegate=null,G)}function ke(Ge){var Ne={tryLoc:Ge[0]};1 in Ge&&(Ne.catchLoc=Ge[1]),2 in Ge&&(Ne.finallyLoc=Ge[2],Ne.afterLoc=Ge[3]),this.tryEntries.push(Ne)}function We(Ge){var Ne=Ge.completion||{};Ne.type="normal",delete Ne.arg,Ge.completion=Ne}function ct(Ge){this.tryEntries=[{tryLoc:"root"}],Ge.forEach(ke,this),this.reset(!0)}function Tt(Ge){if(Ge){var Ne=Ge[s];if(Ne)return Ne.call(Ge);if(typeof Ge.next=="function")return Ge;if(!isNaN(Ge.length)){var vt=-1,rt=function at(){for(;++vt<Ge.length;)if(x.call(Ge,vt))return at.value=Ge[vt],at.done=!1,at;return at.value=void 0,at.done=!0,at};return rt.next=rt}}return{next:st}}function st(){return{value:void 0,done:!0}}return se.prototype=we,R(Be,"constructor",we),R(we,"constructor",se),se.displayName=R(we,k,"GeneratorFunction"),f.isGeneratorFunction=function(Ge){var Ne=typeof Ge=="function"&&Ge.constructor;return!!Ne&&(Ne===se||(Ne.displayName||Ne.name)==="GeneratorFunction")},f.mark=function(Ge){return Object.setPrototypeOf?Object.setPrototypeOf(Ge,we):(Ge.__proto__=we,R(Ge,k,"GeneratorFunction")),Ge.prototype=Object.create(Be),Ge},f.awrap=function(Ge){return{__await:Ge}},Pe(Oe.prototype),R(Oe.prototype,A,function(){return this}),f.AsyncIterator=Oe,f.async=function(Ge,Ne,vt,rt,at){at===void 0&&(at=Promise);var ht=new Oe(D(Ge,Ne,vt,rt),at);return f.isGeneratorFunction(Ne)?ht:ht.next().then(function(Ft){return Ft.done?Ft.value:ht.next()})},Pe(Be),R(Be,k,"Generator"),R(Be,s,function(){return this}),R(Be,"toString",function(){return"[object Generator]"}),f.keys=function(Ge){var Ne=[];for(var vt in Ge)Ne.push(vt);return Ne.reverse(),function rt(){for(;Ne.length;){var at=Ne.pop();if(at in Ge)return rt.value=at,rt.done=!1,rt}return rt.done=!0,rt}},f.values=Tt,ct.prototype={constructor:ct,reset:function(Ne){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(We),!Ne)for(var vt in this)vt.charAt(0)==="t"&&x.call(this,vt)&&!isNaN(+vt.slice(1))&&(this[vt]=void 0)},stop:function(){this.done=!0;var Ne=this.tryEntries[0].completion;if(Ne.type==="throw")throw Ne.arg;return this.rval},dispatchException:function(Ne){if(this.done)throw Ne;var vt=this;function rt(Lt,nn){return Ft.type="throw",Ft.arg=Ne,vt.next=Lt,nn&&(vt.method="next",vt.arg=void 0),!!nn}for(var at=this.tryEntries.length-1;at>=0;--at){var ht=this.tryEntries[at],Ft=ht.completion;if(ht.tryLoc==="root")return rt("end");if(ht.tryLoc<=this.prev){var ln=x.call(ht,"catchLoc"),pn=x.call(ht,"finallyLoc");if(ln&&pn){if(this.prev<ht.catchLoc)return rt(ht.catchLoc,!0);if(this.prev<ht.finallyLoc)return rt(ht.finallyLoc)}else if(ln){if(this.prev<ht.catchLoc)return rt(ht.catchLoc,!0)}else{if(!pn)throw new Error("try statement without catch or finally");if(this.prev<ht.finallyLoc)return rt(ht.finallyLoc)}}}},abrupt:function(Ne,vt){for(var rt=this.tryEntries.length-1;rt>=0;--rt){var at=this.tryEntries[rt];if(at.tryLoc<=this.prev&&x.call(at,"finallyLoc")&&this.prev<at.finallyLoc){var ht=at;break}}ht&&(Ne==="break"||Ne==="continue")&&ht.tryLoc<=vt&&vt<=ht.finallyLoc&&(ht=null);var Ft=ht?ht.completion:{};return Ft.type=Ne,Ft.arg=vt,ht?(this.method="next",this.next=ht.finallyLoc,G):this.complete(Ft)},complete:function(Ne,vt){if(Ne.type==="throw")throw Ne.arg;return Ne.type==="break"||Ne.type==="continue"?this.next=Ne.arg:Ne.type==="return"?(this.rval=this.arg=Ne.arg,this.method="return",this.next="end"):Ne.type==="normal"&&vt&&(this.next=vt),G},finish:function(Ne){for(var vt=this.tryEntries.length-1;vt>=0;--vt){var rt=this.tryEntries[vt];if(rt.finallyLoc===Ne)return this.complete(rt.completion,rt.afterLoc),We(rt),G}},catch:function(Ne){for(var vt=this.tryEntries.length-1;vt>=0;--vt){var rt=this.tryEntries[vt];if(rt.tryLoc===Ne){var at=rt.completion;if(at.type==="throw"){var ht=at.arg;We(rt)}return ht}}throw new Error("illegal catch attempt")},delegateYield:function(Ne,vt,rt){return this.delegate={iterator:Tt(Ne),resultName:vt,nextLoc:rt},this.method==="next"&&(this.arg=void 0),G}},f}t.exports=l,t.exports.__esModule=!0,t.exports.default=t.exports})(OE);var Zp=OE.exports(),pk=Zp;try{regeneratorRuntime=Zp}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=Zp:Function("r","regeneratorRuntime = r")(Zp)}const Ub=pk;var mk={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"};const gk=mk;function Vb(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){_k(t,g,l[g])})}return t}function _k(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var xv=function(o,l){var f=Vb({},o,l.attrs);return Me(Cr,Vb({},f,{icon:gk}),null)};xv.displayName="CheckCircleOutlined";xv.inheritAttrs=!1;const yk=xv;var vk={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"};const xk=vk;function $b(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){bk(t,g,l[g])})}return t}function bk(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var bv=function(o,l){var f=$b({},o,l.attrs);return Me(Cr,$b({},f,{icon:xk}),null)};bv.displayName="InfoCircleOutlined";bv.inheritAttrs=!1;const wk=bv;var Tk={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 00-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4 66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z"}},{tag:"path",attrs:{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"close-circle",theme:"outlined"};const Ek=Tk;function Gb(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){Ck(t,g,l[g])})}return t}function Ck(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var wv=function(o,l){var f=Gb({},o,l.attrs);return Me(Cr,Gb({},f,{icon:Ek}),null)};wv.displayName="CloseCircleOutlined";wv.inheritAttrs=!1;const Sk=wv;var Mk={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};const Ak=Mk;function Zb(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){Ik(t,g,l[g])})}return t}function Ik(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var Tv=function(o,l){var f=Zb({},o,l.attrs);return Me(Cr,Zb({},f,{icon:Ak}),null)};Tv.displayName="ExclamationCircleOutlined";Tv.inheritAttrs=!1;const Pk=Tv;var zk={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"}}]},name:"close",theme:"outlined"};const Ok=zk;function qb(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){kk(t,g,l[g])})}return t}function kk(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var Ev=function(o,l){var f=qb({},o,l.attrs);return Me(Cr,qb({},f,{icon:Ok}),null)};Ev.displayName="CloseOutlined";Ev.inheritAttrs=!1;const Dk=Ev;var xl={},DE=4.5,LE="24px",RE="24px",fy="",BE="topRight",FE=function(){return document.body},jE=null,dy=!1,NE;function Lk(t){var o=t.duration,l=t.placement,f=t.bottom,g=t.top,x=t.getContainer,E=t.closeIcon,s=t.prefixCls;s!==void 0&&(fy=s),o!==void 0&&(DE=o),l!==void 0&&(BE=l),f!==void 0&&(RE=typeof f=="number"?"".concat(f,"px"):f),g!==void 0&&(LE=typeof g=="number"?"".concat(g,"px"):g),x!==void 0&&(FE=x),E!==void 0&&(jE=E),t.rtl!==void 0&&(dy=t.rtl),t.maxCount!==void 0&&(NE=t.maxCount)}function Rk(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:LE,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:RE,f;switch(t){case"topLeft":f={left:"0px",top:o,bottom:"auto"};break;case"topRight":f={right:"0px",top:o,bottom:"auto"};break;case"bottomLeft":f={left:"0px",top:"auto",bottom:l};break;default:f={right:"0px",top:"auto",bottom:l};break}return f}function Bk(t,o){var l=t.prefixCls,f=t.placement,g=f===void 0?BE:f,x=t.getContainer,E=x===void 0?FE:x,s=t.top,A=t.bottom,k=t.closeIcon,R=k===void 0?jE:k,D=t.appContext,F=Jk(),G=F.getPrefixCls,oe=G("notification",l||fy),se="".concat(oe,"-").concat(g,"-").concat(dy),we=xl[se];if(we){Promise.resolve(we).then(function(Te){o(Te)});return}var xe=ki("".concat(oe,"-").concat(g),Cn({},"".concat(oe,"-rtl"),dy===!0));_E.newInstance({name:"notification",prefixCls:l||fy,class:xe,style:Rk(g,s,A),appContext:D,getContainer:E,closeIcon:function(Ue){var Be=Ue.prefixCls,Pe=Me("span",{class:"".concat(Be,"-close-x")},[nf(R,{},Me(Dk,{class:"".concat(Be,"-close-icon")},null))]);return Pe},maxCount:NE,hasTransitionName:!0},function(Te){xl[se]=Te,o(Te)})}var Fk={success:yk,info:wk,error:Sk,warning:Pk};function jk(t){var o=t.icon,l=t.type,f=t.description,g=t.message,x=t.btn,E=t.duration===void 0?DE:t.duration;Bk(t,function(s){s.notice({content:function(k){var R=k.prefixCls,D="".concat(R,"-notice"),F=null;if(o)F=function(){return Me("span",{class:"".concat(D,"-icon")},[nf(o)])};else if(l){var G=Fk[l];F=function(){return Me(G,{class:"".concat(D,"-icon ").concat(D,"-icon-").concat(l)},null)}}return Me("div",{class:F?"".concat(D,"-with-icon"):""},[F&&F(),Me("div",{class:"".concat(D,"-message")},[!f&&F?Me("span",{class:"".concat(D,"-message-single-line-auto-margin")},null):null,nf(g)]),Me("div",{class:"".concat(D,"-description")},[nf(f)]),x?Me("span",{class:"".concat(D,"-btn")},[nf(x)]):null])},duration:E,closable:!0,onClose:t.onClose,onClick:t.onClick,key:t.key,style:t.style||{},class:t.class})})}var zf={open:jk,close:function(o){Object.keys(xl).forEach(function(l){return Promise.resolve(xl[l]).then(function(f){f.removeNotice(o)})})},config:Lk,destroy:function(){Object.keys(xl).forEach(function(o){Promise.resolve(xl[o]).then(function(l){l.destroy()}),delete xl[o]})}},Nk=["success","info","warning","error"];Nk.forEach(function(t){zf[t]=function(o){return zf.open(Ve(Ve({},o),{},{type:t}))}});zf.warn=zf.warning;const Uk=zf;function UE(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Vk="vc-util-key";function VE(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=t.mark;return o?o.startsWith("data-")?o:"data-".concat(o):Vk}function Cv(t){if(t.attachTo)return t.attachTo;var o=document.querySelector("head");return o||document.body}function Wb(t){var o,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!UE())return null;var f=document.createElement("style");if((o=l.csp)!==null&&o!==void 0&&o.nonce){var g;f.nonce=(g=l.csp)===null||g===void 0?void 0:g.nonce}f.innerHTML=t;var x=Cv(l),E=x.firstChild;return l.prepend&&x.prepend?x.prepend(f):l.prepend&&E?x.insertBefore(f,E):x.appendChild(f),f}var py=new Map;function $k(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=Cv(o);return Array.from(py.get(l).children).find(function(f){return f.tagName==="STYLE"&&f.getAttribute(VE(o))===t})}function Gk(t,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},f=Cv(l);if(!py.has(f)){var g=Wb("",l),x=g.parentNode;py.set(f,x),x.removeChild(g)}var E=$k(o,l);if(E){var s,A;if((s=l.csp)!==null&&s!==void 0&&s.nonce&&E.nonce!==((A=l.csp)===null||A===void 0?void 0:A.nonce)){var k;E.nonce=(k=l.csp)===null||k===void 0?void 0:k.nonce}return E.innerHTML!==t&&(E.innerHTML=t),E}var R=Wb(t,l);return R.setAttribute(VE(l),o),R}const Of=function(t,o,l){mE(t,"[ant-design-vue: ".concat(o,"] ").concat(l))};var Zk="-ant-".concat(Date.now(),"-").concat(Math.random());function qk(t,o){var l={},f=function(R,D){var F=R.clone();return F=(D==null?void 0:D(F))||F,F.toRgbString()},g=function(R,D){var F=new T_(R),G=Pf(F.toRgbString());l["".concat(D,"-color")]=f(F),l["".concat(D,"-color-disabled")]=G[1],l["".concat(D,"-color-hover")]=G[4],l["".concat(D,"-color-active")]=G[6],l["".concat(D,"-color-outline")]=F.clone().setAlpha(.2).toRgbString(),l["".concat(D,"-color-deprecated-bg")]=G[1],l["".concat(D,"-color-deprecated-border")]=G[3]};if(o.primaryColor){g(o.primaryColor,"primary");var x=new T_(o.primaryColor),E=Pf(x.toRgbString());E.forEach(function(k,R){l["primary-".concat(R+1)]=k}),l["primary-color-deprecated-l-35"]=f(x,function(k){return k.lighten(35)}),l["primary-color-deprecated-l-20"]=f(x,function(k){return k.lighten(20)}),l["primary-color-deprecated-t-20"]=f(x,function(k){return k.tint(20)}),l["primary-color-deprecated-t-50"]=f(x,function(k){return k.tint(50)}),l["primary-color-deprecated-f-12"]=f(x,function(k){return k.setAlpha(k.getAlpha()*.12)});var s=new T_(E[0]);l["primary-color-active-deprecated-f-30"]=f(s,function(k){return k.setAlpha(k.getAlpha()*.3)}),l["primary-color-active-deprecated-d-02"]=f(s,function(k){return k.darken(2)})}o.successColor&&g(o.successColor,"success"),o.warningColor&&g(o.warningColor,"warning"),o.errorColor&&g(o.errorColor,"error"),o.infoColor&&g(o.infoColor,"info");var A=Object.keys(l).map(function(k){return"--".concat(t,"-").concat(k,": ").concat(l[k],";")});UE()?Gk(`
  :root {
    `.concat(A.join(`
`),`
  }
  `),"".concat(Zk,"-dynamic-theme")):Of(!1,"ConfigProvider","SSR do not support dynamic theme with css variables.")}var Wk=Symbol("GlobalFormContextKey"),Hk=function(o){Xi(Wk,o)},Xk=function(){return{getTargetContainer:{type:Function},getPopupContainer:{type:Function},prefixCls:String,getPrefixCls:{type:Function},renderEmpty:{type:Function},transformCellText:{type:Function},csp:{type:Object,default:void 0},input:{type:Object},autoInsertSpaceInButton:{type:Boolean,default:void 0},locale:{type:Object,default:void 0},pageHeader:{type:Object},componentSize:{type:String},direction:{type:String},space:{type:Object},virtual:{type:Boolean,default:void 0},dropdownMatchSelectWidth:{type:[Number,Boolean],default:!0},form:{type:Object,default:void 0},notUpdateGlobalConfig:Boolean}},Kk="ant";function Hc(){return qr.prefixCls||Kk}var my=mr({}),$E=mr({}),qr=mr({});Cl(function(){ws(qr,my,$E),qr.prefixCls=Hc(),qr.getPrefixCls=function(t,o){return o||(t?"".concat(qr.prefixCls,"-").concat(t):qr.prefixCls)},qr.getRootPrefixCls=function(t,o){return t||(qr.prefixCls?qr.prefixCls:o&&o.includes("-")?o.replace(/^(.*)-[^-]*$/,"$1"):Hc())}});var M_,Yk=function(o){M_&&M_(),M_=Cl(function(){ws($E,mr(o))}),o.theme&&qk(Hc(),o.theme)},Jk=function(){return{getPrefixCls:function(l,f){return f||(l?"".concat(Hc(),"-").concat(l):Hc())},getRootPrefixCls:function(l,f){return l||(qr.prefixCls?qr.prefixCls:f&&f.includes("-")?f.replace(/^(.*)-[^-]*$/,"$1"):Hc())}}},hf=On({compatConfig:{MODE:3},name:"AConfigProvider",inheritAttrs:!1,props:Xk(),setup:function(o,l){var f=l.slots,g=function(D,F){var G=o.prefixCls,oe=G===void 0?"ant":G;return F||(D?"".concat(oe,"-").concat(D):oe)},x=function(D){var F=o.renderEmpty||f.renderEmpty||pE;return F(D)},E=function(D,F){var G=o.prefixCls;if(F)return F;var oe=G||g("");return D?"".concat(oe,"-").concat(D):oe},s=mr(Ve(Ve({},o),{},{getPrefixCls:E,renderEmpty:x}));Object.keys(o).forEach(function(R){Wn(function(){return o[R]},function(){s[R]=o[R]})}),o.notUpdateGlobalConfig||(ws(my,s),Wn(s,function(){ws(my,s)}));var A=yt(function(){var R={};if(o.locale){var D,F;R=((D=o.locale.Form)===null||D===void 0?void 0:D.defaultValidateMessages)||((F=ry.Form)===null||F===void 0?void 0:F.defaultValidateMessages)||{}}return o.form&&o.form.validateMessages&&(R=Ve(Ve({},R),o.form.validateMessages)),R});Hk({validateMessages:A}),Xi("configProvider",s);var k=function(D){var F;return Me(Gz,{locale:o.locale||D,ANT_MARK__:oy},{default:function(){return[(F=f.default)===null||F===void 0?void 0:F.call(f)]}})};return Cl(function(){o.direction&&(hk.config({rtl:o.direction==="rtl"}),Uk.config({rtl:o.direction==="rtl"}))}),function(){return Me(eE,{children:function(D,F,G){return k(G)}},null)}}}),Qk=mr({getPrefixCls:function(o,l){return l||(o?"ant-".concat(o):"ant")},renderEmpty:pE,direction:"ltr"});hf.config=Yk;hf.install=function(t){t.component(hf.name,hf)};const qo=function(t,o){var l=vi("configProvider",Qk),f=yt(function(){return l.getPrefixCls(t,o.prefixCls)}),g=yt(function(){var Te;return(Te=o.direction)!==null&&Te!==void 0?Te:l.direction}),x=yt(function(){return l.getPrefixCls()}),E=yt(function(){return l.autoInsertSpaceInButton}),s=yt(function(){return l.renderEmpty}),A=yt(function(){return l.space}),k=yt(function(){return l.pageHeader}),R=yt(function(){return l.form}),D=yt(function(){return o.getTargetContainer||l.getTargetContainer}),F=yt(function(){return o.getPopupContainer||l.getPopupContainer}),G=yt(function(){var Te;return(Te=o.dropdownMatchSelectWidth)!==null&&Te!==void 0?Te:l.dropdownMatchSelectWidth}),oe=yt(function(){return(o.virtual===void 0?l.virtual!==!1:o.virtual!==!1)&&G.value!==!1}),se=yt(function(){return o.size||l.componentSize}),we=yt(function(){var Te;return o.autocomplete||((Te=l.input)===null||Te===void 0?void 0:Te.autocomplete)}),xe=yt(function(){return l.csp});return{configProvider:l,prefixCls:f,direction:g,size:se,getTargetContainer:D,getPopupContainer:F,space:A,pageHeader:k,form:R,autoInsertSpaceInButton:E,renderEmpty:s,virtual:oe,dropdownMatchSelectWidth:G,rootPrefixCls:x,getPrefixCls:l.getPrefixCls,autocomplete:we,csp:xe}};function Vc(t,o){return t?t.contains(o):!1}var GE=["moz","ms","webkit"];function eD(){var t=0;return function(o){var l=new Date().getTime(),f=Math.max(0,16-(l-t)),g=window.setTimeout(function(){o(l+f)},f);return t=l+f,g}}function tD(){if(typeof window>"u")return function(){};if(window.requestAnimationFrame)return window.requestAnimationFrame.bind(window);var t=GE.filter(function(o){return"".concat(o,"RequestAnimationFrame")in window})[0];return t?window["".concat(t,"RequestAnimationFrame")]:eD()}function nD(t){if(typeof window>"u")return null;if(window.cancelAnimationFrame)return window.cancelAnimationFrame(t);var o=GE.filter(function(l){return"".concat(l,"CancelAnimationFrame")in window||"".concat(l,"CancelRequestAnimationFrame")in window})[0];return o?(window["".concat(o,"CancelAnimationFrame")]||window["".concat(o,"CancelRequestAnimationFrame")]).call(this,t):clearTimeout(t)}var Hb=tD(),iD=function(o){return nD(o.id)},rD=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=Date.now();function g(){Date.now()-f>=l?o.call():x.id=Hb(g)}var x={id:Hb(g)};return x},Sv={visible:Boolean,prefixCls:String,zIndex:Number,destroyPopupOnHide:Boolean,forceRender:Boolean,animation:[String,Object],transitionName:String,stretch:{type:String},align:{type:Object},point:{type:Object},getRootDomNode:{type:Function},getClassNameFromAlign:{type:Function},onMouseenter:{type:Function},onMouseleave:{type:Function},onMousedown:{type:Function},onTouchstart:{type:Function}},oD=Ve(Ve({},Sv),{},{mobile:{type:Object}}),sD=Ve(Ve({},Sv),{},{mask:Boolean,mobile:{type:Object},maskAnimation:String,maskTransitionName:String});function ZE(t){var o=t.prefixCls,l=t.animation,f=t.transitionName;return l?{name:"".concat(o,"-").concat(l)}:f?{name:f}:{}}function qE(t){var o=t.prefixCls,l=t.visible,f=t.zIndex,g=t.mask,x=t.maskAnimation,E=t.maskTransitionName;if(!g)return null;var s={};return(E||x)&&(s=ZE({prefixCls:o,transitionName:E,animation:x})),Me(fu,Ve({appear:!0},s),{default:function(){return[Qc(Me("div",{style:{zIndex:f},class:"".concat(o,"-mask")},null),[[nv("if"),l]])]}})}qE.displayName="Mask";const aD=On({compatConfig:{MODE:3},name:"MobilePopupInner",inheritAttrs:!1,props:oD,emits:["mouseenter","mouseleave","mousedown","touchstart","align"],setup:function(o,l){var f=l.expose,g=l.slots,x=Gt();return f({forceAlign:function(){},getElement:function(){return x.value}}),function(){var E,s=o.zIndex,A=o.visible,k=o.prefixCls,R=o.mobile;R=R===void 0?{}:R;var D=R.popupClassName,F=R.popupStyle,G=R.popupMotion,oe=G===void 0?{}:G,se=R.popupRender,we=Ve({zIndex:s},F),xe=ma((E=g.default)===null||E===void 0?void 0:E.call(g));xe.length>1&&(xe=Me("div",{class:"".concat(k,"-content")},[xe])),se&&(xe=se(xe));var Te=ki(k,D);return Me(fu,Ve({ref:x},oe),{default:function(){return[A?Me("div",{class:Te,style:we},[xe]):null]}})}}});var Xb=["measure","align",null,"motion"];const lD=function(t,o){var l=Gt(null),f=Gt(),g=Gt(!1);function x(A){g.value||(l.value=A)}function E(){Xr.cancel(f.value)}function s(A){E(),f.value=Xr(function(){var k=l.value;switch(l.value){case"align":k="motion";break;case"motion":k="stable";break}x(k),A==null||A()})}return Wn(t,function(){x("measure")},{immediate:!0,flush:"post"}),Zo(function(){Wn(l,function(){switch(l.value){case"measure":o();break}l.value&&(f.value=Xr(fk(Ub.mark(function A(){var k,R;return Ub.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:k=Xb.indexOf(l.value),R=Xb[k+1],R&&k!==-1&&x(R);case 3:case"end":return F.stop()}},A)}))))},{immediate:!0,flush:"post"})}),xs(function(){g.value=!0,E()}),[l,s]},cD=function(t){var o=Gt({width:0,height:0});function l(g){o.value={width:g.offsetWidth,height:g.offsetHeight}}var f=yt(function(){var g={};if(t.value){var x=o.value,E=x.width,s=x.height;t.value.indexOf("height")!==-1&&s?g.height="".concat(s,"px"):t.value.indexOf("minHeight")!==-1&&s&&(g.minHeight="".concat(s,"px")),t.value.indexOf("width")!==-1&&E?g.width="".concat(E,"px"):t.value.indexOf("minWidth")!==-1&&E&&(g.minWidth="".concat(E,"px"))}return g});return[f,l]};function Kb(t,o){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);o&&(f=f.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),l.push.apply(l,f)}return l}function Yb(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?arguments[o]:{};o%2?Kb(Object(l),!0).forEach(function(f){uD(t,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):Kb(Object(l)).forEach(function(f){Object.defineProperty(t,f,Object.getOwnPropertyDescriptor(l,f))})}return t}function qp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?qp=function(o){return typeof o}:qp=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},qp(t)}function uD(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var Yh,hD={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-",O:"-o-"};function cm(){if(Yh!==void 0)return Yh;Yh="";var t=document.createElement("p").style,o="Transform";for(var l in hD)l+o in t&&(Yh=l);return Yh}function WE(){return cm()?"".concat(cm(),"TransitionProperty"):"transitionProperty"}function Am(){return cm()?"".concat(cm(),"Transform"):"transform"}function Jb(t,o){var l=WE();l&&(t.style[l]=o,l!=="transitionProperty"&&(t.style.transitionProperty=o))}function A_(t,o){var l=Am();l&&(t.style[l]=o,l!=="transform"&&(t.style.transform=o))}function fD(t){return t.style.transitionProperty||t.style[WE()]}function dD(t){var o=window.getComputedStyle(t,null),l=o.getPropertyValue("transform")||o.getPropertyValue(Am());if(l&&l!=="none"){var f=l.replace(/[^0-9\-.,]/g,"").split(",");return{x:parseFloat(f[12]||f[4],0),y:parseFloat(f[13]||f[5],0)}}return{x:0,y:0}}var pD=/matrix\((.*)\)/,mD=/matrix3d\((.*)\)/;function gD(t,o){var l=window.getComputedStyle(t,null),f=l.getPropertyValue("transform")||l.getPropertyValue(Am());if(f&&f!=="none"){var g,x=f.match(pD);if(x)x=x[1],g=x.split(",").map(function(s){return parseFloat(s,10)}),g[4]=o.x,g[5]=o.y,A_(t,"matrix(".concat(g.join(","),")"));else{var E=f.match(mD)[1];g=E.split(",").map(function(s){return parseFloat(s,10)}),g[12]=o.x,g[13]=o.y,A_(t,"matrix3d(".concat(g.join(","),")"))}}else A_(t,"translateX(".concat(o.x,"px) translateY(").concat(o.y,"px) translateZ(0)"))}var _D=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,Gf;function Qb(t){var o=t.style.display;t.style.display="none",t.offsetHeight,t.style.display=o}function Xc(t,o,l){var f=l;if(qp(o)==="object"){for(var g in o)o.hasOwnProperty(g)&&Xc(t,g,o[g]);return}if(typeof f<"u"){typeof f=="number"&&(f="".concat(f,"px")),t.style[o]=f;return}return Gf(t,o)}function yD(t){var o,l,f,g=t.ownerDocument,x=g.body,E=g&&g.documentElement;return o=t.getBoundingClientRect(),l=Math.floor(o.left),f=Math.floor(o.top),l-=E.clientLeft||x.clientLeft||0,f-=E.clientTop||x.clientTop||0,{left:l,top:f}}function HE(t,o){var l=t["page".concat(o?"Y":"X","Offset")],f="scroll".concat(o?"Top":"Left");if(typeof l!="number"){var g=t.document;l=g.documentElement[f],typeof l!="number"&&(l=g.body[f])}return l}function XE(t){return HE(t)}function KE(t){return HE(t,!0)}function kf(t){var o=yD(t),l=t.ownerDocument,f=l.defaultView||l.parentWindow;return o.left+=XE(f),o.top+=KE(f),o}function Mv(t){return t!=null&&t==t.window}function YE(t){return Mv(t)?t.document:t.nodeType===9?t:t.ownerDocument}function vD(t,o,l){var f=l,g="",x=YE(t);return f=f||x.defaultView.getComputedStyle(t,null),f&&(g=f.getPropertyValue(o)||f[o]),g}var xD=new RegExp("^(".concat(_D,")(?!px)[a-z%]+$"),"i"),bD=/^(top|right|bottom|left)$/,I_="currentStyle",P_="runtimeStyle",pl="left",wD="px";function TD(t,o){var l=t[I_]&&t[I_][o];if(xD.test(l)&&!bD.test(o)){var f=t.style,g=f[pl],x=t[P_][pl];t[P_][pl]=t[I_][pl],f[pl]=o==="fontSize"?"1em":l||0,l=f.pixelLeft+wD,f[pl]=g,t[P_][pl]=x}return l===""?"auto":l}typeof window<"u"&&(Gf=window.getComputedStyle?vD:TD);function Pp(t,o){return t==="left"?o.useCssRight?"right":t:o.useCssBottom?"bottom":t}function ew(t){if(t==="left")return"right";if(t==="right")return"left";if(t==="top")return"bottom";if(t==="bottom")return"top"}function tw(t,o,l){Xc(t,"position")==="static"&&(t.style.position="relative");var f=-999,g=-999,x=Pp("left",l),E=Pp("top",l),s=ew(x),A=ew(E);x!=="left"&&(f=999),E!=="top"&&(g=999);var k="",R=kf(t);("left"in o||"top"in o)&&(k=fD(t)||"",Jb(t,"none")),"left"in o&&(t.style[s]="",t.style[x]="".concat(f,"px")),"top"in o&&(t.style[A]="",t.style[E]="".concat(g,"px")),Qb(t);var D=kf(t),F={};for(var G in o)if(o.hasOwnProperty(G)){var oe=Pp(G,l),se=G==="left"?f:g,we=R[G]-D[G];oe===G?F[oe]=se+we:F[oe]=se-we}Xc(t,F),Qb(t),("left"in o||"top"in o)&&Jb(t,k);var xe={};for(var Te in o)if(o.hasOwnProperty(Te)){var Ue=Pp(Te,l),Be=o[Te]-R[Te];Te===Ue?xe[Ue]=F[Ue]+Be:xe[Ue]=F[Ue]-Be}Xc(t,xe)}function ED(t,o){var l=kf(t),f=dD(t),g={x:f.x,y:f.y};"left"in o&&(g.x=f.x+o.left-l.left),"top"in o&&(g.y=f.y+o.top-l.top),gD(t,g)}function CD(t,o,l){if(l.ignoreShake){var f=kf(t),g=f.left.toFixed(0),x=f.top.toFixed(0),E=o.left.toFixed(0),s=o.top.toFixed(0);if(g===E&&x===s)return}l.useCssRight||l.useCssBottom?tw(t,o,l):l.useCssTransform&&Am()in document.body.style?ED(t,o):tw(t,o,l)}function Av(t,o){for(var l=0;l<t.length;l++)o(t[l])}function JE(t){return Gf(t,"boxSizing")==="border-box"}var SD=["margin","border","padding"],gy=-1,MD=2,_y=1,AD=0;function ID(t,o,l){var f={},g=t.style,x;for(x in o)o.hasOwnProperty(x)&&(f[x]=g[x],g[x]=o[x]);l.call(t);for(x in o)o.hasOwnProperty(x)&&(g[x]=f[x])}function sf(t,o,l){var f=0,g,x,E;for(x=0;x<o.length;x++)if(g=o[x],g)for(E=0;E<l.length;E++){var s=void 0;g==="border"?s="".concat(g).concat(l[E],"Width"):s=g+l[E],f+=parseFloat(Gf(t,s))||0}return f}var Uo={getParent:function(o){var l=o;do l.nodeType===11&&l.host?l=l.host:l=l.parentNode;while(l&&l.nodeType!==1&&l.nodeType!==9);return l}};Av(["Width","Height"],function(t){Uo["doc".concat(t)]=function(o){var l=o.document;return Math.max(l.documentElement["scroll".concat(t)],l.body["scroll".concat(t)],Uo["viewport".concat(t)](l))},Uo["viewport".concat(t)]=function(o){var l="client".concat(t),f=o.document,g=f.body,x=f.documentElement,E=x[l];return f.compatMode==="CSS1Compat"&&E||g&&g[l]||E}});function nw(t,o,l){var f=l;if(Mv(t))return o==="width"?Uo.viewportWidth(t):Uo.viewportHeight(t);if(t.nodeType===9)return o==="width"?Uo.docWidth(t):Uo.docHeight(t);var g=o==="width"?["Left","Right"]:["Top","Bottom"],x=Math.floor(o==="width"?t.getBoundingClientRect().width:t.getBoundingClientRect().height),E=JE(t),s=0;(x==null||x<=0)&&(x=void 0,s=Gf(t,o),(s==null||Number(s)<0)&&(s=t.style[o]||0),s=parseFloat(s)||0),f===void 0&&(f=E?_y:gy);var A=x!==void 0||E,k=x||s;return f===gy?A?k-sf(t,["border","padding"],g):s:A?f===_y?k:k+(f===MD?-sf(t,["border"],g):sf(t,["margin"],g)):s+sf(t,SD.slice(f),g)}var PD={position:"absolute",visibility:"hidden",display:"block"};function iw(){for(var t=arguments.length,o=new Array(t),l=0;l<t;l++)o[l]=arguments[l];var f,g=o[0];return g.offsetWidth!==0?f=nw.apply(void 0,o):ID(g,PD,function(){f=nw.apply(void 0,o)}),f}Av(["width","height"],function(t){var o=t.charAt(0).toUpperCase()+t.slice(1);Uo["outer".concat(o)]=function(f,g){return f&&iw(f,t,g?AD:_y)};var l=t==="width"?["Left","Right"]:["Top","Bottom"];Uo[t]=function(f,g){var x=g;if(x!==void 0){if(f){var E=JE(f);return E&&(x+=sf(f,["padding","border"],l)),Xc(f,t,x)}return}return f&&iw(f,t,gy)}});function QE(t,o){for(var l in o)o.hasOwnProperty(l)&&(t[l]=o[l]);return t}var Tn={getWindow:function(o){if(o&&o.document&&o.setTimeout)return o;var l=o.ownerDocument||o;return l.defaultView||l.parentWindow},getDocument:YE,offset:function(o,l,f){if(typeof l<"u")CD(o,l,f||{});else return kf(o)},isWindow:Mv,each:Av,css:Xc,clone:function(o){var l,f={};for(l in o)o.hasOwnProperty(l)&&(f[l]=o[l]);var g=o.overflow;if(g)for(l in o)o.hasOwnProperty(l)&&(f.overflow[l]=o.overflow[l]);return f},mix:QE,getWindowScrollLeft:function(o){return XE(o)},getWindowScrollTop:function(o){return KE(o)},merge:function(){for(var o={},l=0;l<arguments.length;l++)Tn.mix(o,l<0||arguments.length<=l?void 0:arguments[l]);return o},viewportWidth:0,viewportHeight:0};QE(Tn,Uo);var z_=Tn.getParent;function yy(t){if(Tn.isWindow(t)||t.nodeType===9)return null;var o=Tn.getDocument(t),l=o.body,f,g=Tn.css(t,"position"),x=g==="fixed"||g==="absolute";if(!x)return t.nodeName.toLowerCase()==="html"?null:z_(t);for(f=z_(t);f&&f!==l&&f.nodeType!==9;f=z_(f))if(g=Tn.css(f,"position"),g!=="static")return f;return null}var rw=Tn.getParent;function zD(t){if(Tn.isWindow(t)||t.nodeType===9)return!1;var o=Tn.getDocument(t),l=o.body,f=null;for(f=rw(t);f&&f!==l&&f!==o;f=rw(f)){var g=Tn.css(f,"position");if(g==="fixed")return!0}return!1}function Iv(t,o){for(var l={left:0,right:1/0,top:0,bottom:1/0},f=yy(t),g=Tn.getDocument(t),x=g.defaultView||g.parentWindow,E=g.body,s=g.documentElement;f;){if((navigator.userAgent.indexOf("MSIE")===-1||f.clientWidth!==0)&&f!==E&&f!==s&&Tn.css(f,"overflow")!=="visible"){var A=Tn.offset(f);A.left+=f.clientLeft,A.top+=f.clientTop,l.top=Math.max(l.top,A.top),l.right=Math.min(l.right,A.left+f.clientWidth),l.bottom=Math.min(l.bottom,A.top+f.clientHeight),l.left=Math.max(l.left,A.left)}else if(f===E||f===s)break;f=yy(f)}var k=null;if(!Tn.isWindow(t)&&t.nodeType!==9){k=t.style.position;var R=Tn.css(t,"position");R==="absolute"&&(t.style.position="fixed")}var D=Tn.getWindowScrollLeft(x),F=Tn.getWindowScrollTop(x),G=Tn.viewportWidth(x),oe=Tn.viewportHeight(x),se=s.scrollWidth,we=s.scrollHeight,xe=window.getComputedStyle(E);if(xe.overflowX==="hidden"&&(se=x.innerWidth),xe.overflowY==="hidden"&&(we=x.innerHeight),t.style&&(t.style.position=k),o||zD(t))l.left=Math.max(l.left,D),l.top=Math.max(l.top,F),l.right=Math.min(l.right,D+G),l.bottom=Math.min(l.bottom,F+oe);else{var Te=Math.max(se,D+G);l.right=Math.min(l.right,Te);var Ue=Math.max(we,F+oe);l.bottom=Math.min(l.bottom,Ue)}return l.top>=0&&l.left>=0&&l.bottom>l.top&&l.right>l.left?l:null}function OD(t,o,l,f){var g=Tn.clone(t),x={width:o.width,height:o.height};return f.adjustX&&g.left<l.left&&(g.left=l.left),f.resizeWidth&&g.left>=l.left&&g.left+x.width>l.right&&(x.width-=g.left+x.width-l.right),f.adjustX&&g.left+x.width>l.right&&(g.left=Math.max(l.right-x.width,l.left)),f.adjustY&&g.top<l.top&&(g.top=l.top),f.resizeHeight&&g.top>=l.top&&g.top+x.height>l.bottom&&(x.height-=g.top+x.height-l.bottom),f.adjustY&&g.top+x.height>l.bottom&&(g.top=Math.max(l.bottom-x.height,l.top)),Tn.mix(g,x)}function Pv(t){var o,l,f;if(!Tn.isWindow(t)&&t.nodeType!==9)o=Tn.offset(t),l=Tn.outerWidth(t),f=Tn.outerHeight(t);else{var g=Tn.getWindow(t);o={left:Tn.getWindowScrollLeft(g),top:Tn.getWindowScrollTop(g)},l=Tn.viewportWidth(g),f=Tn.viewportHeight(g)}return o.width=l,o.height=f,o}function ow(t,o){var l=o.charAt(0),f=o.charAt(1),g=t.width,x=t.height,E=t.left,s=t.top;return l==="c"?s+=x/2:l==="b"&&(s+=x),f==="c"?E+=g/2:f==="r"&&(E+=g),{left:E,top:s}}function zp(t,o,l,f,g){var x=ow(o,l[1]),E=ow(t,l[0]),s=[E.left-x.left,E.top-x.top];return{left:Math.round(t.left-s[0]+f[0]-g[0]),top:Math.round(t.top-s[1]+f[1]-g[1])}}function sw(t,o,l){return t.left<l.left||t.left+o.width>l.right}function aw(t,o,l){return t.top<l.top||t.top+o.height>l.bottom}function kD(t,o,l){return t.left>l.right||t.left+o.width<l.left}function DD(t,o,l){return t.top>l.bottom||t.top+o.height<l.top}function Op(t,o,l){var f=[];return Tn.each(t,function(g){f.push(g.replace(o,function(x){return l[x]}))}),f}function kp(t,o){return t[o]=-t[o],t}function lw(t,o){var l;return/%$/.test(t)?l=parseInt(t.substring(0,t.length-1),10)/100*o:l=parseInt(t,10),l||0}function cw(t,o){t[0]=lw(t[0],o.width),t[1]=lw(t[1],o.height)}function eC(t,o,l,f){var g=l.points,x=l.offset||[0,0],E=l.targetOffset||[0,0],s=l.overflow,A=l.source||t;x=[].concat(x),E=[].concat(E),s=s||{};var k={},R=0,D=!!(s&&s.alwaysByViewport),F=Iv(A,D),G=Pv(A);cw(x,G),cw(E,o);var oe=zp(G,o,g,x,E),se=Tn.merge(G,oe);if(F&&(s.adjustX||s.adjustY)&&f){if(s.adjustX&&sw(oe,G,F)){var we=Op(g,/[lr]/gi,{l:"r",r:"l"}),xe=kp(x,0),Te=kp(E,0),Ue=zp(G,o,we,xe,Te);kD(Ue,G,F)||(R=1,g=we,x=xe,E=Te)}if(s.adjustY&&aw(oe,G,F)){var Be=Op(g,/[tb]/gi,{t:"b",b:"t"}),Pe=kp(x,1),Oe=kp(E,1),Le=zp(G,o,Be,Pe,Oe);DD(Le,G,F)||(R=1,g=Be,x=Pe,E=Oe)}R&&(oe=zp(G,o,g,x,E),Tn.mix(se,oe));var ke=sw(oe,G,F),We=aw(oe,G,F);if(ke||We){var ct=g;ke&&(ct=Op(g,/[lr]/gi,{l:"r",r:"l"})),We&&(ct=Op(g,/[tb]/gi,{t:"b",b:"t"})),g=ct,x=l.offset||[0,0],E=l.targetOffset||[0,0]}k.adjustX=s.adjustX&&ke,k.adjustY=s.adjustY&&We,(k.adjustX||k.adjustY)&&(se=OD(oe,G,F,k))}return se.width!==G.width&&Tn.css(A,"width",Tn.width(A)+se.width-G.width),se.height!==G.height&&Tn.css(A,"height",Tn.height(A)+se.height-G.height),Tn.offset(A,{left:se.left,top:se.top},{useCssRight:l.useCssRight,useCssBottom:l.useCssBottom,useCssTransform:l.useCssTransform,ignoreShake:l.ignoreShake}),{points:g,offset:x,targetOffset:E,overflow:k}}function LD(t,o){var l=Iv(t,o),f=Pv(t);return!l||f.left+f.width<=l.left||f.top+f.height<=l.top||f.left>=l.right||f.top>=l.bottom}function zv(t,o,l){var f=l.target||o,g=Pv(f),x=!LD(f,l.overflow&&l.overflow.alwaysByViewport);return eC(t,g,l,x)}zv.__getOffsetParent=yy;zv.__getVisibleRectForElement=Iv;function RD(t,o,l){var f,g,x=Tn.getDocument(t),E=x.defaultView||x.parentWindow,s=Tn.getWindowScrollLeft(E),A=Tn.getWindowScrollTop(E),k=Tn.viewportWidth(E),R=Tn.viewportHeight(E);"pageX"in o?f=o.pageX:f=s+o.clientX,"pageY"in o?g=o.pageY:g=A+o.clientY;var D={left:f,top:g,width:0,height:0},F=f>=0&&f<=s+k&&g>=0&&g<=A+R,G=[l.points[0],"cc"];return eC(t,D,Yb(Yb({},l),{},{points:G}),F)}function Il(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,g=t;if(Array.isArray(t)&&(g=$f(t)[0]),!g)return null;var x=bs(g,o,f);return x.props=l?Ve(Ve({},x.props),o):x.props,dv(Yi(x.props.class)!=="object","class must be string"),x}const BD=function(t){if(!t)return!1;if(t.offsetParent)return!0;if(t.getBBox){var o=t.getBBox();if(o.width||o.height)return!0}if(t.getBoundingClientRect){var l=t.getBoundingClientRect();if(l.width||l.height)return!0}return!1};function FD(t,o){return t===o?!0:!t||!o?!1:"pageX"in o&&"pageY"in o?t.pageX===o.pageX&&t.pageY===o.pageY:"clientX"in o&&"clientY"in o?t.clientX===o.clientX&&t.clientY===o.clientY:!1}function jD(t,o){t!==document.activeElement&&Vc(o,t)&&typeof t.focus=="function"&&t.focus()}function uw(t,o){var l=null,f=null;function g(E){var s=nu(E,1),A=s[0].target;if(!!document.documentElement.contains(A)){var k=A.getBoundingClientRect(),R=k.width,D=k.height,F=Math.floor(R),G=Math.floor(D);(l!==F||f!==G)&&Promise.resolve().then(function(){o({width:F,height:G})}),l=F,f=G}}var x=new VT(g);return t&&x.observe(t),function(){x.disconnect()}}const ND=function(t,o){var l=!1,f=null;function g(){clearTimeout(f)}function x(E){if(!l||E===!0){if(t()===!1)return;l=!0,g(),f=setTimeout(function(){l=!1},o.value)}else g(),f=setTimeout(function(){l=!1,x()},o.value)}return[x,function(){l=!1,g()}]};function UD(){this.__data__=[],this.size=0}function tC(t,o){return t===o||t!==t&&o!==o}function Im(t,o){for(var l=t.length;l--;)if(tC(t[l][0],o))return l;return-1}var VD=Array.prototype,$D=VD.splice;function GD(t){var o=this.__data__,l=Im(o,t);if(l<0)return!1;var f=o.length-1;return l==f?o.pop():$D.call(o,l,1),--this.size,!0}function ZD(t){var o=this.__data__,l=Im(o,t);return l<0?void 0:o[l][1]}function qD(t){return Im(this.__data__,t)>-1}function WD(t,o){var l=this.__data__,f=Im(l,t);return f<0?(++this.size,l.push([t,o])):l[f][1]=o,this}function Cs(t){var o=-1,l=t==null?0:t.length;for(this.clear();++o<l;){var f=t[o];this.set(f[0],f[1])}}Cs.prototype.clear=UD;Cs.prototype.delete=GD;Cs.prototype.get=ZD;Cs.prototype.has=qD;Cs.prototype.set=WD;function HD(){this.__data__=new Cs,this.size=0}function XD(t){var o=this.__data__,l=o.delete(t);return this.size=o.size,l}function KD(t){return this.__data__.get(t)}function YD(t){return this.__data__.has(t)}function nC(t){var o=typeof t;return t!=null&&(o=="object"||o=="function")}var JD="[object AsyncFunction]",QD="[object Function]",eL="[object GeneratorFunction]",tL="[object Proxy]";function iC(t){if(!nC(t))return!1;var o=Vf(t);return o==QD||o==eL||o==JD||o==tL}var nL=Es["__core-js_shared__"];const O_=nL;var hw=function(){var t=/[^.]+$/.exec(O_&&O_.keys&&O_.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function iL(t){return!!hw&&hw in t}var rL=Function.prototype,oL=rL.toString;function Ll(t){if(t!=null){try{return oL.call(t)}catch{}try{return t+""}catch{}}return""}var sL=/[\\^$.*+?()[\]{}|]/g,aL=/^\[object .+?Constructor\]$/,lL=Function.prototype,cL=Object.prototype,uL=lL.toString,hL=cL.hasOwnProperty,fL=RegExp("^"+uL.call(hL).replace(sL,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function dL(t){if(!nC(t)||iL(t))return!1;var o=iC(t)?fL:aL;return o.test(Ll(t))}function pL(t,o){return t==null?void 0:t[o]}function gu(t,o){var l=pL(t,o);return dL(l)?l:void 0}var mL=gu(Es,"Map");const Df=mL;var gL=gu(Object,"create");const Lf=gL;function _L(){this.__data__=Lf?Lf(null):{},this.size=0}function yL(t){var o=this.has(t)&&delete this.__data__[t];return this.size-=o?1:0,o}var vL="__lodash_hash_undefined__",xL=Object.prototype,bL=xL.hasOwnProperty;function wL(t){var o=this.__data__;if(Lf){var l=o[t];return l===vL?void 0:l}return bL.call(o,t)?o[t]:void 0}var TL=Object.prototype,EL=TL.hasOwnProperty;function CL(t){var o=this.__data__;return Lf?o[t]!==void 0:EL.call(o,t)}var SL="__lodash_hash_undefined__";function ML(t,o){var l=this.__data__;return this.size+=this.has(t)?0:1,l[t]=Lf&&o===void 0?SL:o,this}function Pl(t){var o=-1,l=t==null?0:t.length;for(this.clear();++o<l;){var f=t[o];this.set(f[0],f[1])}}Pl.prototype.clear=_L;Pl.prototype.delete=yL;Pl.prototype.get=wL;Pl.prototype.has=CL;Pl.prototype.set=ML;function AL(){this.size=0,this.__data__={hash:new Pl,map:new(Df||Cs),string:new Pl}}function IL(t){var o=typeof t;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?t!=="__proto__":t===null}function Pm(t,o){var l=t.__data__;return IL(o)?l[typeof o=="string"?"string":"hash"]:l.map}function PL(t){var o=Pm(this,t).delete(t);return this.size-=o?1:0,o}function zL(t){return Pm(this,t).get(t)}function OL(t){return Pm(this,t).has(t)}function kL(t,o){var l=Pm(this,t),f=l.size;return l.set(t,o),this.size+=l.size==f?0:1,this}function Rl(t){var o=-1,l=t==null?0:t.length;for(this.clear();++o<l;){var f=t[o];this.set(f[0],f[1])}}Rl.prototype.clear=AL;Rl.prototype.delete=PL;Rl.prototype.get=zL;Rl.prototype.has=OL;Rl.prototype.set=kL;var DL=200;function LL(t,o){var l=this.__data__;if(l instanceof Cs){var f=l.__data__;if(!Df||f.length<DL-1)return f.push([t,o]),this.size=++l.size,this;l=this.__data__=new Rl(f)}return l.set(t,o),this.size=l.size,this}function _a(t){var o=this.__data__=new Cs(t);this.size=o.size}_a.prototype.clear=HD;_a.prototype.delete=XD;_a.prototype.get=KD;_a.prototype.has=YD;_a.prototype.set=LL;var RL="__lodash_hash_undefined__";function BL(t){return this.__data__.set(t,RL),this}function FL(t){return this.__data__.has(t)}function Rf(t){var o=-1,l=t==null?0:t.length;for(this.__data__=new Rl;++o<l;)this.add(t[o])}Rf.prototype.add=Rf.prototype.push=BL;Rf.prototype.has=FL;function jL(t,o){for(var l=-1,f=t==null?0:t.length;++l<f;)if(o(t[l],l,t))return!0;return!1}function rC(t,o){return t.has(o)}var NL=1,UL=2;function oC(t,o,l,f,g,x){var E=l&NL,s=t.length,A=o.length;if(s!=A&&!(E&&A>s))return!1;var k=x.get(t),R=x.get(o);if(k&&R)return k==o&&R==t;var D=-1,F=!0,G=l&UL?new Rf:void 0;for(x.set(t,o),x.set(o,t);++D<s;){var oe=t[D],se=o[D];if(f)var we=E?f(se,oe,D,o,t,x):f(oe,se,D,t,o,x);if(we!==void 0){if(we)continue;F=!1;break}if(G){if(!jL(o,function(xe,Te){if(!rC(G,Te)&&(oe===xe||g(oe,xe,l,f,x)))return G.push(Te)})){F=!1;break}}else if(!(oe===se||g(oe,se,l,f,x))){F=!1;break}}return x.delete(t),x.delete(o),F}var VL=Es.Uint8Array;const fw=VL;function $L(t){var o=-1,l=Array(t.size);return t.forEach(function(f,g){l[++o]=[g,f]}),l}function Ov(t){var o=-1,l=Array(t.size);return t.forEach(function(f){l[++o]=f}),l}var GL=1,ZL=2,qL="[object Boolean]",WL="[object Date]",HL="[object Error]",XL="[object Map]",KL="[object Number]",YL="[object RegExp]",JL="[object Set]",QL="[object String]",e4="[object Symbol]",t4="[object ArrayBuffer]",n4="[object DataView]",dw=iu?iu.prototype:void 0,k_=dw?dw.valueOf:void 0;function i4(t,o,l,f,g,x,E){switch(l){case n4:if(t.byteLength!=o.byteLength||t.byteOffset!=o.byteOffset)return!1;t=t.buffer,o=o.buffer;case t4:return!(t.byteLength!=o.byteLength||!x(new fw(t),new fw(o)));case qL:case WL:case KL:return tC(+t,+o);case HL:return t.name==o.name&&t.message==o.message;case YL:case QL:return t==o+"";case XL:var s=$L;case JL:var A=f&GL;if(s||(s=Ov),t.size!=o.size&&!A)return!1;var k=E.get(t);if(k)return k==o;f|=ZL,E.set(t,o);var R=oC(s(t),s(o),f,g,x,E);return E.delete(t),R;case e4:if(k_)return k_.call(t)==k_.call(o)}return!1}function r4(t,o){for(var l=-1,f=o.length,g=t.length;++l<f;)t[g+l]=o[l];return t}var o4=Array.isArray;const um=o4;function s4(t,o,l){var f=o(t);return um(t)?f:r4(f,l(t))}function a4(t,o){for(var l=-1,f=t==null?0:t.length,g=0,x=[];++l<f;){var E=t[l];o(E,l,t)&&(x[g++]=E)}return x}function l4(){return[]}var c4=Object.prototype,u4=c4.propertyIsEnumerable,pw=Object.getOwnPropertySymbols,h4=pw?function(t){return t==null?[]:(t=Object(t),a4(pw(t),function(o){return u4.call(t,o)}))}:l4;const f4=h4;function d4(t,o){for(var l=-1,f=Array(t);++l<t;)f[l]=o(l);return f}var p4="[object Arguments]";function mw(t){return Sf(t)&&Vf(t)==p4}var sC=Object.prototype,m4=sC.hasOwnProperty,g4=sC.propertyIsEnumerable,_4=mw(function(){return arguments}())?mw:function(t){return Sf(t)&&m4.call(t,"callee")&&!g4.call(t,"callee")};const y4=_4;function v4(){return!1}var aC=typeof gs=="object"&&gs&&!gs.nodeType&&gs,gw=aC&&typeof _s=="object"&&_s&&!_s.nodeType&&_s,x4=gw&&gw.exports===aC,_w=x4?Es.Buffer:void 0,b4=_w?_w.isBuffer:void 0,w4=b4||v4;const vy=w4;var T4=9007199254740991,E4=/^(?:0|[1-9]\d*)$/;function C4(t,o){var l=typeof t;return o=o==null?T4:o,!!o&&(l=="number"||l!="symbol"&&E4.test(t))&&t>-1&&t%1==0&&t<o}var S4=9007199254740991;function lC(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=S4}var M4="[object Arguments]",A4="[object Array]",I4="[object Boolean]",P4="[object Date]",z4="[object Error]",O4="[object Function]",k4="[object Map]",D4="[object Number]",L4="[object Object]",R4="[object RegExp]",B4="[object Set]",F4="[object String]",j4="[object WeakMap]",N4="[object ArrayBuffer]",U4="[object DataView]",V4="[object Float32Array]",$4="[object Float64Array]",G4="[object Int8Array]",Z4="[object Int16Array]",q4="[object Int32Array]",W4="[object Uint8Array]",H4="[object Uint8ClampedArray]",X4="[object Uint16Array]",K4="[object Uint32Array]",fi={};fi[V4]=fi[$4]=fi[G4]=fi[Z4]=fi[q4]=fi[W4]=fi[H4]=fi[X4]=fi[K4]=!0;fi[M4]=fi[A4]=fi[N4]=fi[I4]=fi[U4]=fi[P4]=fi[z4]=fi[O4]=fi[k4]=fi[D4]=fi[L4]=fi[R4]=fi[B4]=fi[F4]=fi[j4]=!1;function Y4(t){return Sf(t)&&lC(t.length)&&!!fi[Vf(t)]}function J4(t){return function(o){return t(o)}}var cC=typeof gs=="object"&&gs&&!gs.nodeType&&gs,ff=cC&&typeof _s=="object"&&_s&&!_s.nodeType&&_s,Q4=ff&&ff.exports===cC,D_=Q4&&GT.process,eR=function(){try{var t=ff&&ff.require&&ff.require("util").types;return t||D_&&D_.binding&&D_.binding("util")}catch{}}();const yw=eR;var vw=yw&&yw.isTypedArray,tR=vw?J4(vw):Y4;const uC=tR;var nR=Object.prototype,iR=nR.hasOwnProperty;function rR(t,o){var l=um(t),f=!l&&y4(t),g=!l&&!f&&vy(t),x=!l&&!f&&!g&&uC(t),E=l||f||g||x,s=E?d4(t.length,String):[],A=s.length;for(var k in t)(o||iR.call(t,k))&&!(E&&(k=="length"||g&&(k=="offset"||k=="parent")||x&&(k=="buffer"||k=="byteLength"||k=="byteOffset")||C4(k,A)))&&s.push(k);return s}var oR=Object.prototype;function sR(t){var o=t&&t.constructor,l=typeof o=="function"&&o.prototype||oR;return t===l}var aR=nz(Object.keys,Object);const lR=aR;var cR=Object.prototype,uR=cR.hasOwnProperty;function hR(t){if(!sR(t))return lR(t);var o=[];for(var l in Object(t))uR.call(t,l)&&l!="constructor"&&o.push(l);return o}function fR(t){return t!=null&&lC(t.length)&&!iC(t)}function dR(t){return fR(t)?rR(t):hR(t)}function xw(t){return s4(t,dR,f4)}var pR=1,mR=Object.prototype,gR=mR.hasOwnProperty;function _R(t,o,l,f,g,x){var E=l&pR,s=xw(t),A=s.length,k=xw(o),R=k.length;if(A!=R&&!E)return!1;for(var D=A;D--;){var F=s[D];if(!(E?F in o:gR.call(o,F)))return!1}var G=x.get(t),oe=x.get(o);if(G&&oe)return G==o&&oe==t;var se=!0;x.set(t,o),x.set(o,t);for(var we=E;++D<A;){F=s[D];var xe=t[F],Te=o[F];if(f)var Ue=E?f(Te,xe,F,o,t,x):f(xe,Te,F,t,o,x);if(!(Ue===void 0?xe===Te||g(xe,Te,l,f,x):Ue)){se=!1;break}we||(we=F=="constructor")}if(se&&!we){var Be=t.constructor,Pe=o.constructor;Be!=Pe&&"constructor"in t&&"constructor"in o&&!(typeof Be=="function"&&Be instanceof Be&&typeof Pe=="function"&&Pe instanceof Pe)&&(se=!1)}return x.delete(t),x.delete(o),se}var yR=gu(Es,"DataView");const xy=yR;var vR=gu(Es,"Promise");const by=vR;var xR=gu(Es,"Set");const Kc=xR;var bR=gu(Es,"WeakMap");const wy=bR;var bw="[object Map]",wR="[object Object]",ww="[object Promise]",Tw="[object Set]",Ew="[object WeakMap]",Cw="[object DataView]",TR=Ll(xy),ER=Ll(Df),CR=Ll(by),SR=Ll(Kc),MR=Ll(wy),gl=Vf;(xy&&gl(new xy(new ArrayBuffer(1)))!=Cw||Df&&gl(new Df)!=bw||by&&gl(by.resolve())!=ww||Kc&&gl(new Kc)!=Tw||wy&&gl(new wy)!=Ew)&&(gl=function(t){var o=Vf(t),l=o==wR?t.constructor:void 0,f=l?Ll(l):"";if(f)switch(f){case TR:return Cw;case ER:return bw;case CR:return ww;case SR:return Tw;case MR:return Ew}return o});const Sw=gl;var AR=1,Mw="[object Arguments]",Aw="[object Array]",Dp="[object Object]",IR=Object.prototype,Iw=IR.hasOwnProperty;function PR(t,o,l,f,g,x){var E=um(t),s=um(o),A=E?Aw:Sw(t),k=s?Aw:Sw(o);A=A==Mw?Dp:A,k=k==Mw?Dp:k;var R=A==Dp,D=k==Dp,F=A==k;if(F&&vy(t)){if(!vy(o))return!1;E=!0,R=!1}if(F&&!R)return x||(x=new _a),E||uC(t)?oC(t,o,l,f,g,x):i4(t,o,A,l,f,g,x);if(!(l&AR)){var G=R&&Iw.call(t,"__wrapped__"),oe=D&&Iw.call(o,"__wrapped__");if(G||oe){var se=G?t.value():t,we=oe?o.value():o;return x||(x=new _a),g(se,we,l,f,x)}}return F?(x||(x=new _a),_R(t,o,l,f,g,x)):!1}function hC(t,o,l,f,g){return t===o?!0:t==null||o==null||!Sf(t)&&!Sf(o)?t!==t&&o!==o:PR(t,o,l,f,hC,g)}function zR(t,o){return hC(t,o)}var OR={align:Object,target:[Object,Function],onAlign:Function,monitorBufferTime:Number,monitorWindowResize:Boolean,disabled:Boolean};function Pw(t){return typeof t!="function"?null:t()}function zw(t){return Yi(t)!=="object"||!t?null:t}const kR=On({compatConfig:{MODE:3},name:"Align",props:OR,emits:["align"],setup:function(o,l){var f=l.expose,g=l.slots,x=Gt({}),E=Gt(),s=ND(function(){var se=o.disabled,we=o.target,xe=o.align,Te=o.onAlign;if(!se&&we&&E.value){var Ue=E.value,Be,Pe=Pw(we),Oe=zw(we);x.value.element=Pe,x.value.point=Oe,x.value.align=xe;var Le=document,ke=Le.activeElement;return Pe&&BD(Pe)?Be=zv(Ue,Pe,xe):Oe&&(Be=RD(Ue,Oe,xe)),jD(ke,Ue),Te&&Be&&Te(Ue,Be),!0}return!1},yt(function(){return o.monitorBufferTime})),A=nu(s,2),k=A[0],R=A[1],D=Gt({cancel:function(){}}),F=Gt({cancel:function(){}}),G=function(){var we=o.target,xe=Pw(we),Te=zw(we);E.value!==F.value.element&&(F.value.cancel(),F.value.element=E.value,F.value.cancel=uw(E.value,k)),(x.value.element!==xe||!FD(x.value.point,Te)||!zR(x.value.align,o.align))&&(k(),D.value.element!==xe&&(D.value.cancel(),D.value.element=xe,D.value.cancel=uw(xe,k)))};Zo(function(){vs(function(){G()})}),Uf(function(){vs(function(){G()})}),Wn(function(){return o.disabled},function(se){se?R():k()},{immediate:!0,flush:"post"});var oe=Gt(null);return Wn(function(){return o.monitorWindowResize},function(se){se?oe.value||(oe.value=of(window,"resize",k)):oe.value&&(oe.value.remove(),oe.value=null)},{flush:"post"}),Ol(function(){D.value.cancel(),F.value.cancel(),oe.value&&oe.value.remove(),R()}),f({forceAlign:function(){return k(!0)}}),function(){var se=g==null?void 0:g.default();return se?Il(se[0],{ref:E},!0,!0):null}}}),DR=On({compatConfig:{MODE:3},name:"PopupInner",inheritAttrs:!1,props:Sv,emits:["mouseenter","mouseleave","mousedown","touchstart","align"],setup:function(o,l){var f=l.expose,g=l.attrs,x=l.slots,E=Gt(),s=Gt(),A=Gt(),k=cD(af(o,"stretch")),R=nu(k,2),D=R[0],F=R[1],G=function(){o.stretch&&F(o.getRootDomNode())},oe=Gt(!1),se;Wn(function(){return o.visible},function(Tt){clearTimeout(se),Tt?se=setTimeout(function(){oe.value=o.visible}):oe.value=!1},{immediate:!0});var we=lD(oe,G),xe=nu(we,2),Te=xe[0],Ue=xe[1],Be=Gt(),Pe=function(){return o.point?o.point:o.getRootDomNode},Oe=function(){var st;(st=E.value)===null||st===void 0||st.forceAlign()},Le=function(st,Ge){var Ne=o.getClassNameFromAlign(Ge),vt=A.value;if(A.value!==Ne&&(A.value=Ne),Te.value==="align"){var rt;vt!==Ne?Promise.resolve().then(function(){Oe()}):Ue(function(){var at;(at=Be.value)===null||at===void 0||at.call(Be)}),(rt=o.onAlign)===null||rt===void 0||rt.call(o,st,Ge)}},ke=yt(function(){var Tt=Yi(o.animation)==="object"?o.animation:ZE(o);return["onAfterEnter","onAfterLeave"].forEach(function(st){var Ge=Tt[st];Tt[st]=function(Ne){Ue(),Te.value="stable",Ge==null||Ge(Ne)}}),Tt}),We=function(){return new Promise(function(st){Be.value=st})};Wn([ke,Te],function(){!ke.value&&Te.value==="motion"&&Ue()},{immediate:!0}),f({forceAlign:Oe,getElement:function(){return s.value.$el||s.value}});var ct=yt(function(){var Tt;return!((Tt=o.align)!==null&&Tt!==void 0&&Tt.points&&(Te.value==="align"||Te.value==="stable"))});return function(){var Tt,st=o.zIndex,Ge=o.align,Ne=o.prefixCls,vt=o.destroyPopupOnHide,rt=o.onMouseenter,at=o.onMouseleave,ht=o.onTouchstart,Ft=ht===void 0?function(){}:ht,ln=o.onMousedown,pn=Te.value,Lt=[Ve(Ve({},D.value),{},{zIndex:st,opacity:pn==="motion"||pn==="stable"||!oe.value?null:0,pointerEvents:!oe.value&&pn!=="stable"?"none":null}),g.style],nn=ma((Tt=x.default)===null||Tt===void 0?void 0:Tt.call(x,{visible:o.visible}));nn.length>1&&(nn=Me("div",{class:"".concat(Ne,"-content")},[nn]));var xt=ki(Ne,g.class,A.value),be=oe.value||!o.visible,Xe=be?gE(ke.value.name,ke.value):{};return Me(fu,Ve(Ve({ref:s},Xe),{},{onBeforeEnter:We}),{default:function(){return!vt||o.visible?Qc(Me(kR,{target:Pe(),key:"popup",ref:E,monitorWindowResize:!0,disabled:ct.value,align:Ge,onAlign:Le},{default:function(){return Me("div",Ve(Ve({class:xt,onMouseenter:rt,onMouseleave:at,onMousedown:ib(ln,["capture"])},Cn({},Gc?"onTouchstartPassive":"onTouchstart",ib(Ft,["capture"]))),{},{style:Lt}),[nn])}}),[[DT,oe.value]]):null}})}}}),LR=On({compatConfig:{MODE:3},name:"Popup",inheritAttrs:!1,props:sD,setup:function(o,l){var f=l.attrs,g=l.slots,x=l.expose,E=Gt(!1),s=Gt(!1),A=Gt();return Wn([function(){return o.visible},function(){return o.mobile}],function(){E.value=o.visible,o.visible&&o.mobile&&(s.value=!0)},{immediate:!0,flush:"post"}),x({forceAlign:function(){var R;(R=A.value)===null||R===void 0||R.forceAlign()},getElement:function(){var R;return(R=A.value)===null||R===void 0?void 0:R.getElement()}}),function(){var k=Ve(Ve(Ve({},o),f),{},{visible:E.value}),R=s.value?Me(aD,Ve(Ve({},k),{},{mobile:o.mobile,ref:A}),{default:g.default}):Me(DR,Ve(Ve({},k),{},{ref:A}),{default:g.default});return Me("div",null,[Me(qE,k,null),R])}}});function RR(t,o,l){return l?t[0]===o[0]:t[0]===o[0]&&t[1]===o[1]}function Ow(t,o,l){var f=t[o]||{};return Ve(Ve({},f),l)}function BR(t,o,l,f){for(var g=l.points,x=Object.keys(t),E=0;E<x.length;E+=1){var s=x[E];if(RR(t[s].points,g,f))return"".concat(o,"-placement-").concat(s)}return""}const FR={methods:{setState:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=arguments.length>1?arguments[1]:void 0,f=typeof o=="function"?o(this.$data,this.$props):o;if(this.getDerivedStateFromProps){var g=this.getDerivedStateFromProps(cz(this),Ve(Ve({},this.$data),f));if(g===null)return;f=Ve(Ve({},f),g||{})}ws(this.$data,f),this._.isMounted&&this.$forceUpdate(),vs(function(){l&&l()})},__emit:function(){var o=[].slice.call(arguments,0),l=o[0];l="on".concat(l[0].toUpperCase()).concat(l.substring(1));var f=this.$props[l]||this.$attrs[l];if(o.length&&f)if(Array.isArray(f))for(var g=0,x=f.length;g<x;g++)f[g].apply(f,Er(o.slice(1)));else f.apply(void 0,Er(o.slice(1)))}}};var jR=Symbol("TriggerContextKey"),NR=function(){return vi(jR,{setPortal:function(){},popPortal:!1})},fC=Symbol("PortalContextKey"),dC=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{inTriggerContext:!0};Xi(fC,{inTriggerContext:l.inTriggerContext,shouldRender:yt(function(){var f=o||{},g=f.sPopupVisible,x=f.popupRef,E=f.forceRender,s=f.autoDestroy,A=!1;return(g||x||E)&&(A=!0),!g&&s&&(A=!1),A})})},UR=function(){dC({},{inTriggerContext:!1});var o=vi(fC,{shouldRender:yt(function(){return!1}),inTriggerContext:!1});return{shouldRender:yt(function(){return o.shouldRender.value||o.inTriggerContext===!1})}};const kw=On({compatConfig:{MODE:3},name:"Portal",inheritAttrs:!1,props:{getContainer:on.func.isRequired,didUpdate:Function},setup:function(o,l){var f=l.slots,g=!0,x,E=UR(),s=E.shouldRender;pT(function(){g=!1,s.value&&(x=o.getContainer())});var A=Wn(s,function(){s.value&&!x&&(x=o.getContainer()),x&&A()});return Uf(function(){vs(function(){if(s.value){var k;(k=o.didUpdate)===null||k===void 0||k.call(o,o)}})}),xs(function(){x&&x.parentNode&&x.parentNode.removeChild(x)}),function(){if(!s.value)return null;if(g){var k;return(k=f.default)===null||k===void 0?void 0:k.call(f)}return x?Me(sv,{to:x},f):null}}});function Dw(){}function VR(){return""}function $R(t){return t?t.ownerDocument:window.document}var GR=["onClick","onMousedown","onTouchstart","onMouseenter","onMouseleave","onFocus","onBlur","onContextmenu"];const pC=On({compatConfig:{MODE:3},name:"Trigger",mixins:[FR],inheritAttrs:!1,props:{action:on.oneOfType([on.string,on.arrayOf(on.string)]).def([]),showAction:on.any.def([]),hideAction:on.any.def([]),getPopupClassNameFromAlign:on.any.def(VR),onPopupVisibleChange:Function,afterPopupVisibleChange:on.func.def(Dw),popup:on.any,popupStyle:{type:Object,default:void 0},prefixCls:on.string.def("rc-trigger-popup"),popupClassName:on.string.def(""),popupPlacement:String,builtinPlacements:on.object,popupTransitionName:String,popupAnimation:on.any,mouseEnterDelay:on.number.def(0),mouseLeaveDelay:on.number.def(.1),zIndex:Number,focusDelay:on.number.def(0),blurDelay:on.number.def(.15),getPopupContainer:Function,getDocument:on.func.def($R),forceRender:{type:Boolean,default:void 0},destroyPopupOnHide:{type:Boolean,default:!1},mask:{type:Boolean,default:!1},maskClosable:{type:Boolean,default:!0},popupAlign:on.object.def(function(){return{}}),popupVisible:{type:Boolean,default:void 0},defaultPopupVisible:{type:Boolean,default:!1},maskTransitionName:String,maskAnimation:String,stretch:String,alignPoint:{type:Boolean,default:void 0},autoDestroy:{type:Boolean,default:!1},mobile:Object,getTriggerDOMNode:Function},setup:function(o){var l=yt(function(){var A=o.popupPlacement,k=o.popupAlign,R=o.builtinPlacements;return A&&R?Ow(R,A,k):k}),f=NR(),g=f.setPortal,x=f.popPortal,E=Gt(null),s=function(k){E.value=k};return{popPortal:x,setPortal:g,vcTriggerContext:vi("vcTriggerContext",{}),popupRef:E,setPopupRef:s,triggerRef:Gt(null),align:l,focusTime:null,clickOutsideHandler:null,contextmenuOutsideHandler1:null,contextmenuOutsideHandler2:null,touchOutsideHandler:null,attachId:null,delayTimer:null,hasPopupMouseDown:!1,preClickTime:null,preTouchTime:null,mouseDownTimeout:null,childOriginEvents:{}}},data:function(){var o=this,l,f=this.$props,g;return this.popupVisible!==void 0?g=!!f.popupVisible:g=!!f.defaultPopupVisible,GR.forEach(function(x){o["fire".concat(x)]=function(E){o.fireEvents(x,E)}}),(l=this.setPortal)===null||l===void 0||l.call(this,Me(kw,{key:"portal",getContainer:this.getContainer,didUpdate:this.handlePortalUpdate},{default:this.getComponent})),{prevPopupVisible:g,sPopupVisible:g,point:null}},watch:{popupVisible:function(o){o!==void 0&&(this.prevPopupVisible=this.sPopupVisible,this.sPopupVisible=o)}},created:function(){Xi("vcTriggerContext",{onPopupMouseDown:this.onPopupMouseDown}),dC(this)},deactivated:function(){this.setPopupVisible(!1)},mounted:function(){var o=this;this.$nextTick(function(){o.updatedCal()})},updated:function(){var o=this;this.$nextTick(function(){o.updatedCal()})},beforeUnmount:function(){this.clearDelayTimer(),this.clearOutsideHandler(),clearTimeout(this.mouseDownTimeout),Xr.cancel(this.attachId)},methods:{updatedCal:function(){var o=this.$props,l=this.$data;if(l.sPopupVisible){var f;!this.clickOutsideHandler&&(this.isClickToHide()||this.isContextmenuToShow())&&(f=o.getDocument(this.getRootDomNode()),this.clickOutsideHandler=of(f,"mousedown",this.onDocumentClick)),this.touchOutsideHandler||(f=f||o.getDocument(this.getRootDomNode()),this.touchOutsideHandler=of(f,"touchstart",this.onDocumentClick,Gc?{passive:!1}:!1)),!this.contextmenuOutsideHandler1&&this.isContextmenuToShow()&&(f=f||o.getDocument(this.getRootDomNode()),this.contextmenuOutsideHandler1=of(f,"scroll",this.onContextmenuClose)),!this.contextmenuOutsideHandler2&&this.isContextmenuToShow()&&(this.contextmenuOutsideHandler2=of(window,"blur",this.onContextmenuClose))}else this.clearOutsideHandler()},onMouseenter:function(o){var l=this.$props.mouseEnterDelay;this.fireEvents("onMouseenter",o),this.delaySetPopupVisible(!0,l,l?null:o)},onMouseMove:function(o){this.fireEvents("onMousemove",o),this.setPoint(o)},onMouseleave:function(o){this.fireEvents("onMouseleave",o),this.delaySetPopupVisible(!1,this.$props.mouseLeaveDelay)},onPopupMouseenter:function(){this.clearDelayTimer()},onPopupMouseleave:function(o){var l;o&&o.relatedTarget&&!o.relatedTarget.setTimeout&&Vc((l=this.popupRef)===null||l===void 0?void 0:l.getElement(),o.relatedTarget)||this.delaySetPopupVisible(!1,this.$props.mouseLeaveDelay)},onFocus:function(o){this.fireEvents("onFocus",o),this.clearDelayTimer(),this.isFocusToShow()&&(this.focusTime=Date.now(),this.delaySetPopupVisible(!0,this.$props.focusDelay))},onMousedown:function(o){this.fireEvents("onMousedown",o),this.preClickTime=Date.now()},onTouchstart:function(o){this.fireEvents("onTouchstart",o),this.preTouchTime=Date.now()},onBlur:function(o){Vc(o.target,o.relatedTarget||document.activeElement)||(this.fireEvents("onBlur",o),this.clearDelayTimer(),this.isBlurToHide()&&this.delaySetPopupVisible(!1,this.$props.blurDelay))},onContextmenu:function(o){o.preventDefault(),this.fireEvents("onContextmenu",o),this.setPopupVisible(!0,o)},onContextmenuClose:function(){this.isContextmenuToShow()&&this.close()},onClick:function(o){if(this.fireEvents("onClick",o),this.focusTime){var l;if(this.preClickTime&&this.preTouchTime?l=Math.min(this.preClickTime,this.preTouchTime):this.preClickTime?l=this.preClickTime:this.preTouchTime&&(l=this.preTouchTime),Math.abs(l-this.focusTime)<20)return;this.focusTime=0}this.preClickTime=0,this.preTouchTime=0,this.isClickToShow()&&(this.isClickToHide()||this.isBlurToHide())&&o&&o.preventDefault&&o.preventDefault(),o&&o.domEvent&&o.domEvent.preventDefault();var f=!this.$data.sPopupVisible;(this.isClickToHide()&&!f||f&&this.isClickToShow())&&this.setPopupVisible(!this.$data.sPopupVisible,o)},onPopupMouseDown:function(){var o=this,l=this.vcTriggerContext,f=l===void 0?{}:l;this.hasPopupMouseDown=!0,clearTimeout(this.mouseDownTimeout),this.mouseDownTimeout=setTimeout(function(){o.hasPopupMouseDown=!1},0),f.onPopupMouseDown&&f.onPopupMouseDown.apply(f,arguments)},onDocumentClick:function(o){if(!(this.$props.mask&&!this.$props.maskClosable)){var l=o.target,f=this.getRootDomNode(),g=this.getPopupDomNode();(!Vc(f,l)||this.isContextMenuOnly())&&!Vc(g,l)&&!this.hasPopupMouseDown&&this.delaySetPopupVisible(!1,.1)}},getPopupDomNode:function(){var o;return((o=this.popupRef)===null||o===void 0?void 0:o.getElement())||null},getRootDomNode:function(){var o=this.$props.getTriggerDOMNode;if(o){var l=rf(this.triggerRef);return rf(o(l))}try{var f=rf(this.triggerRef);if(f)return f}catch{}return rf(this)},handleGetPopupClassFromAlign:function(o){var l=[],f=this.$props,g=f.popupPlacement,x=f.builtinPlacements,E=f.prefixCls,s=f.alignPoint,A=f.getPopupClassNameFromAlign;return g&&x&&l.push(BR(x,E,o,s)),A&&l.push(A(o)),l.join(" ")},getPopupAlign:function(){var o=this.$props,l=o.popupPlacement,f=o.popupAlign,g=o.builtinPlacements;return l&&g?Ow(g,l,f):f},getComponent:function(){var o=this,l={};this.isMouseEnterToShow()&&(l.onMouseenter=this.onPopupMouseenter),this.isMouseLeaveToHide()&&(l.onMouseleave=this.onPopupMouseleave),l.onMousedown=this.onPopupMouseDown,l[Gc?"onTouchstartPassive":"onTouchstart"]=this.onPopupMouseDown;var f=this.handleGetPopupClassFromAlign,g=this.getRootDomNode,x=this.getContainer,E=this.$attrs,s=this.$props,A=s.prefixCls,k=s.destroyPopupOnHide,R=s.popupClassName,D=s.popupAnimation,F=s.popupTransitionName,G=s.popupStyle,oe=s.mask,se=s.maskAnimation,we=s.maskTransitionName,xe=s.zIndex,Te=s.stretch,Ue=s.alignPoint,Be=s.mobile,Pe=s.forceRender,Oe=this.$data,Le=Oe.sPopupVisible,ke=Oe.point,We=Ve(Ve({prefixCls:A,destroyPopupOnHide:k,visible:Le,point:Ue?ke:null,align:this.align,animation:D,getClassNameFromAlign:f,stretch:Te,getRootDomNode:g,mask:oe,zIndex:xe,transitionName:F,maskAnimation:se,maskTransitionName:we,getContainer:x,class:R,style:G,onAlign:E.onPopupAlign||Dw},l),{},{ref:this.setPopupRef,mobile:Be,forceRender:Pe});return Me(LR,We,{default:this.$slots.popup||function(){return uz(o,"popup")}})},attachParent:function(o){var l=this;Xr.cancel(this.attachId);var f=this.$props,g=f.getPopupContainer,x=f.getDocument,E=this.getRootDomNode(),s;g?(E||g.length===0)&&(s=g(E)):s=x(this.getRootDomNode()).body,s?s.appendChild(o):this.attachId=Xr(function(){l.attachParent(o)})},getContainer:function(){var o=this.$props,l=o.getDocument,f=l(this.getRootDomNode()).createElement("div");return f.style.position="absolute",f.style.top="0",f.style.left="0",f.style.width="100%",this.attachParent(f),f},setPopupVisible:function(o,l){var f=this.alignPoint,g=this.sPopupVisible,x=this.onPopupVisibleChange;this.clearDelayTimer(),g!==o&&(az(this,"popupVisible")||this.setState({sPopupVisible:o,prevPopupVisible:g}),x&&x(o)),f&&l&&o&&this.setPoint(l)},setPoint:function(o){var l=this.$props.alignPoint;!l||!o||this.setState({point:{pageX:o.pageX,pageY:o.pageY}})},handlePortalUpdate:function(){this.prevPopupVisible!==this.sPopupVisible&&this.afterPopupVisibleChange(this.sPopupVisible)},delaySetPopupVisible:function(o,l,f){var g=this,x=l*1e3;if(this.clearDelayTimer(),x){var E=f?{pageX:f.pageX,pageY:f.pageY}:null;this.delayTimer=rD(function(){g.setPopupVisible(o,E),g.clearDelayTimer()},x)}else this.setPopupVisible(o,f)},clearDelayTimer:function(){this.delayTimer&&(iD(this.delayTimer),this.delayTimer=null)},clearOutsideHandler:function(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.contextmenuOutsideHandler1&&(this.contextmenuOutsideHandler1.remove(),this.contextmenuOutsideHandler1=null),this.contextmenuOutsideHandler2&&(this.contextmenuOutsideHandler2.remove(),this.contextmenuOutsideHandler2=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)},createTwoChains:function(o){var l=function(){},f=ub(this);return this.childOriginEvents[o]&&f[o]?this["fire".concat(o)]:(l=this.childOriginEvents[o]||f[o]||l,l)},isClickToShow:function(){var o=this.$props,l=o.action,f=o.showAction;return l.indexOf("click")!==-1||f.indexOf("click")!==-1},isContextMenuOnly:function(){var o=this.$props.action;return o==="contextmenu"||o.length===1&&o[0]==="contextmenu"},isContextmenuToShow:function(){var o=this.$props,l=o.action,f=o.showAction;return l.indexOf("contextmenu")!==-1||f.indexOf("contextmenu")!==-1},isClickToHide:function(){var o=this.$props,l=o.action,f=o.hideAction;return l.indexOf("click")!==-1||f.indexOf("click")!==-1},isMouseEnterToShow:function(){var o=this.$props,l=o.action,f=o.showAction;return l.indexOf("hover")!==-1||f.indexOf("mouseenter")!==-1},isMouseLeaveToHide:function(){var o=this.$props,l=o.action,f=o.hideAction;return l.indexOf("hover")!==-1||f.indexOf("mouseleave")!==-1},isFocusToShow:function(){var o=this.$props,l=o.action,f=o.showAction;return l.indexOf("focus")!==-1||f.indexOf("focus")!==-1},isBlurToHide:function(){var o=this.$props,l=o.action,f=o.hideAction;return l.indexOf("focus")!==-1||f.indexOf("blur")!==-1},forcePopupAlign:function(){if(this.$data.sPopupVisible){var o;(o=this.popupRef)===null||o===void 0||o.forceAlign()}},fireEvents:function(o,l){this.childOriginEvents[o]&&this.childOriginEvents[o](l);var f=this.$props[o]||this.$attrs[o];f&&f(l)},close:function(){this.setPopupVisible(!1)}},render:function(){var o=this,l=this.$attrs,f=$f(lz(this)),g=this.$props.alignPoint,x=f[0];this.childOriginEvents=ub(x);var E={key:"trigger"};this.isContextmenuToShow()?E.onContextmenu=this.onContextmenu:E.onContextmenu=this.createTwoChains("onContextmenu"),this.isClickToHide()||this.isClickToShow()?(E.onClick=this.onClick,E.onMousedown=this.onMousedown,E[Gc?"onTouchstartPassive":"onTouchstart"]=this.onTouchstart):(E.onClick=this.createTwoChains("onClick"),E.onMousedown=this.createTwoChains("onMousedown"),E[Gc?"onTouchstartPassive":"onTouchstart"]=this.createTwoChains("onTouchstart")),this.isMouseEnterToShow()?(E.onMouseenter=this.onMouseenter,g&&(E.onMousemove=this.onMouseMove)):E.onMouseenter=this.createTwoChains("onMouseenter"),this.isMouseLeaveToHide()?E.onMouseleave=this.onMouseleave:E.onMouseleave=this.createTwoChains("onMouseleave"),this.isFocusToShow()||this.isBlurToHide()?(E.onFocus=this.onFocus,E.onBlur=this.onBlur):(E.onFocus=this.createTwoChains("onFocus"),E.onBlur=function(R){R&&(!R.relatedTarget||!Vc(R.target,R.relatedTarget))&&o.createTwoChains("onBlur")(R)});var s=ki(x&&x.props&&x.props.class,l.class);s&&(E.class=s);var A=Il(x,Ve(Ve({},E),{},{ref:"triggerRef"}),!0,!0);if(this.popPortal)return A;var k=Me(kw,{key:"portal",getContainer:this.getContainer,didUpdate:this.handlePortalUpdate},{default:this.getComponent});return Me(yi,null,[k,A])}});var fn={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(o){var l=o.keyCode;if(o.altKey&&!o.ctrlKey||o.metaKey||l>=fn.F1&&l<=fn.F12)return!1;switch(l){case fn.ALT:case fn.CAPS_LOCK:case fn.CONTEXT_MENU:case fn.CTRL:case fn.DOWN:case fn.END:case fn.ESC:case fn.HOME:case fn.INSERT:case fn.LEFT:case fn.MAC_FF_META:case fn.META:case fn.NUMLOCK:case fn.NUM_CENTER:case fn.PAGE_DOWN:case fn.PAGE_UP:case fn.PAUSE:case fn.PRINT_SCREEN:case fn.RIGHT:case fn.SHIFT:case fn.UP:case fn.WIN_KEY:case fn.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(o){if(o>=fn.ZERO&&o<=fn.NINE||o>=fn.NUM_ZERO&&o<=fn.NUM_MULTIPLY||o>=fn.A&&o<=fn.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&o===0)return!0;switch(o){case fn.SPACE:case fn.QUESTION_MARK:case fn.NUM_PLUS:case fn.NUM_MINUS:case fn.NUM_PERIOD:case fn.NUM_DIVISION:case fn.SEMICOLON:case fn.DASH:case fn.EQUALS:case fn.COMMA:case fn.PERIOD:case fn.SLASH:case fn.APOSTROPHE:case fn.SINGLE_QUOTE:case fn.OPEN_SQUARE_BRACKET:case fn.BACKSLASH:case fn.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}};const ZR=fn;var mC=Symbol("OverflowContextProviderKey"),Ty=On({compatConfig:{MODE:3},name:"OverflowContextProvider",inheritAttrs:!1,props:{value:{type:Object}},setup:function(o,l){var f=l.slots;return Xi(mC,yt(function(){return o.value})),function(){var g;return(g=f.default)===null||g===void 0?void 0:g.call(f)}}}),qR=function(){return vi(mC,yt(function(){return null}))},WR=["prefixCls","invalidate","item","renderItem","responsive","registerSize","itemKey","display","order","component"],Fc=void 0;const Wp=On({compatConfig:{MODE:3},name:"Item",props:{prefixCls:String,item:on.any,renderItem:Function,responsive:Boolean,itemKey:{type:[String,Number]},registerSize:Function,display:Boolean,order:Number,component:on.any,invalidate:Boolean},setup:function(o,l){var f=l.slots,g=l.expose,x=yt(function(){return o.responsive&&!o.display}),E=Gt();g({itemNodeRef:E});function s(A){o.registerSize(o.itemKey,A)}return Ol(function(){s(null)}),function(){var A,k=o.prefixCls,R=o.invalidate,D=o.item,F=o.renderItem,G=o.responsive;o.registerSize,o.itemKey,o.display;var oe=o.order,se=o.component,we=se===void 0?"div":se,xe=ga(o,WR),Te=(A=f.default)===null||A===void 0?void 0:A.call(f),Ue=F&&D!==Fc?F(D):Te,Be;R||(Be={opacity:x.value?0:1,height:x.value?0:Fc,overflowY:x.value?"hidden":Fc,order:G?oe:Fc,pointerEvents:x.value?"none":Fc,position:x.value?"absolute":Fc});var Pe={};return x.value&&(Pe["aria-hidden"]=!0),Me(HT,{disabled:!G,onResize:function(Le){var ke=Le.offsetWidth;s(ke)}},{default:function(){return Me(we,Ve(Ve(Ve({class:ki(!R&&k),style:Be},Pe),xe),{},{ref:E}),{default:function(){return[Ue]}})}})}}});var HR=["component"],XR=["className"],KR=["class"];const YR=On({compatConfig:{MODE:3},name:"RawItem",inheritAttrs:!1,props:{component:on.any,title:on.any,id:String,onMouseenter:{type:Function},onMouseleave:{type:Function},onClick:{type:Function},onKeydown:{type:Function},onFocus:{type:Function}},setup:function(o,l){var f=l.slots,g=l.attrs,x=qR();return function(){if(!x.value){var E,s=o.component,A=s===void 0?"div":s,k=ga(o,HR);return Me(A,Ve(Ve({},k),g),{default:function(){return[(E=f.default)===null||E===void 0?void 0:E.call(f)]}})}var R=x.value,D=R.className,F=ga(R,XR),G=g.class,oe=ga(g,KR);return Me(Ty,{value:null},{default:function(){return[Me(Wp,Ve(Ve(Ve({class:ki(D,G)},F),oe),o),f)]}})}}});var JR=["class","style"],gC="responsive",_C="invalidate";function QR(t){return"+ ".concat(t.length," ...")}var e5=function(){return{id:String,prefixCls:String,data:Array,itemKey:[String,Number,Function],itemWidth:{type:Number,default:10},renderItem:Function,renderRawItem:Function,maxCount:[Number,String],renderRest:Function,renderRawRest:Function,suffix:on.any,component:String,itemComponent:on.any,onVisibleChange:Function,ssr:String,onMousedown:Function}},zm=On({name:"Overflow",inheritAttrs:!1,props:e5(),emits:["visibleChange"],setup:function(o,l){var f=l.attrs,g=l.emit,x=l.slots,E=yt(function(){return o.ssr==="full"}),s=Gt(null),A=yt(function(){return s.value||0}),k=Gt(new Map),R=Gt(0),D=Gt(0),F=Gt(0),G=Gt(null),oe=Gt(null),se=yt(function(){return oe.value===null&&E.value?Number.MAX_SAFE_INTEGER:oe.value||0}),we=Gt(!1),xe=yt(function(){return"".concat(o.prefixCls,"-item")}),Te=yt(function(){return Math.max(R.value,D.value)}),Ue=yt(function(){return!!(o.data.length&&o.maxCount===gC)}),Be=yt(function(){return o.maxCount===_C}),Pe=yt(function(){return Ue.value||typeof o.maxCount=="number"&&o.data.length>o.maxCount}),Oe=yt(function(){var rt=o.data;return Ue.value?s.value===null&&E.value?rt=o.data:rt=o.data.slice(0,Math.min(o.data.length,A.value/o.itemWidth)):typeof o.maxCount=="number"&&(rt=o.data.slice(0,o.maxCount)),rt}),Le=yt(function(){return Ue.value?o.data.slice(se.value+1):o.data.slice(Oe.value.length)}),ke=function(at,ht){var Ft;return typeof o.itemKey=="function"?o.itemKey(at):(Ft=o.itemKey&&(at==null?void 0:at[o.itemKey]))!==null&&Ft!==void 0?Ft:ht},We=yt(function(){return o.renderItem||function(rt){return rt}}),ct=function(at,ht){oe.value=at,ht||(we.value=at<o.data.length-1,g("visibleChange",at))},Tt=function(at,ht){s.value=ht.clientWidth},st=function(at,ht){var Ft=new Map(k.value);ht===null?Ft.delete(at):Ft.set(at,ht),k.value=Ft},Ge=function(at,ht){R.value=D.value,D.value=ht},Ne=function(at,ht){F.value=ht},vt=function(at){return k.value.get(ke(Oe.value[at],at))};return Wn([A,k,D,F,function(){return o.itemKey},Oe],function(){if(A.value&&Te.value&&Oe.value){var rt=F.value,at=Oe.value.length,ht=at-1;if(!at){ct(0),G.value=null;return}for(var Ft=0;Ft<at;Ft+=1){var ln=vt(Ft);if(ln===void 0){ct(Ft-1,!0);break}if(rt+=ln,ht===0&&rt<=A.value||Ft===ht-1&&rt+vt(ht)<=A.value){ct(ht),G.value=null;break}else if(rt+Te.value>A.value){ct(Ft-1),G.value=rt-ln-F.value+D.value;break}}o.suffix&&vt(0)+F.value>A.value&&(G.value=null)}}),function(){var rt=we.value&&!!Le.value.length,at=o.itemComponent,ht=o.renderRawItem,Ft=o.renderRawRest,ln=o.renderRest,pn=o.prefixCls,Lt=pn===void 0?"rc-overflow":pn,nn=o.suffix,xt=o.component,be=xt===void 0?"div":xt,Xe=o.id,ut=o.onMousedown,bt=f.class,Yt=f.style,en=ga(f,JR),qt={};G.value!==null&&Ue.value&&(qt={position:"absolute",left:"".concat(G.value,"px"),top:0});var ie={prefixCls:xe.value,responsive:Ue.value,component:at,invalidate:Be.value},ye=ht?function(wt,ft){var Qe=ke(wt,ft);return Me(Ty,{key:Qe,value:Ve(Ve({},ie),{},{order:ft,item:wt,itemKey:Qe,registerSize:st,display:ft<=se.value})},{default:function(){return[ht(wt,ft)]}})}:function(wt,ft){var Qe=ke(wt,ft);return Me(Wp,Ve(Ve({},ie),{},{order:ft,key:Qe,item:wt,renderItem:We.value,itemKey:Qe,registerSize:st,display:ft<=se.value}),null)},Ae=function(){return null},qe={order:rt?se.value:Number.MAX_SAFE_INTEGER,className:"".concat(xe.value," ").concat(xe.value,"-rest"),registerSize:Ge,display:rt};if(Ft)Ft&&(Ae=function(){return Me(Ty,{value:Ve(Ve({},ie),qe)},{default:function(){return[Ft(Le.value)]}})});else{var ot=ln||QR;Ae=function(){return Me(Wp,Ve(Ve({},ie),qe),{default:function(){return typeof ot=="function"?ot(Le.value):ot}})}}var Et=function(){var ft;return Me(be,Ve({id:Xe,class:ki(!Be.value&&Lt,bt),style:Yt,onMousedown:ut},en),{default:function(){return[Oe.value.map(ye),Pe.value?Ae():null,nn&&Me(Wp,Ve(Ve({},ie),{},{order:se.value,class:"".concat(xe.value,"-suffix"),registerSize:Ne,display:!0,style:qt}),{default:function(){return nn}}),(ft=x.default)===null||ft===void 0?void 0:ft.call(x)]}})};return Me(HT,{disabled:!Ue.value,onResize:Tt},{default:Et})}}});zm.Item=YR;zm.RESPONSIVE=gC;zm.INVALIDATE=_C;const df=zm;var Gr={adjustX:1,adjustY:1},Zr=[0,0],yC={left:{points:["cr","cl"],overflow:Gr,offset:[-4,0],targetOffset:Zr},right:{points:["cl","cr"],overflow:Gr,offset:[4,0],targetOffset:Zr},top:{points:["bc","tc"],overflow:Gr,offset:[0,-4],targetOffset:Zr},bottom:{points:["tc","bc"],overflow:Gr,offset:[0,4],targetOffset:Zr},topLeft:{points:["bl","tl"],overflow:Gr,offset:[0,-4],targetOffset:Zr},leftTop:{points:["tr","tl"],overflow:Gr,offset:[-4,0],targetOffset:Zr},topRight:{points:["br","tr"],overflow:Gr,offset:[0,-4],targetOffset:Zr},rightTop:{points:["tl","tr"],overflow:Gr,offset:[4,0],targetOffset:Zr},bottomRight:{points:["tr","br"],overflow:Gr,offset:[0,4],targetOffset:Zr},rightBottom:{points:["bl","br"],overflow:Gr,offset:[4,0],targetOffset:Zr},bottomLeft:{points:["tl","bl"],overflow:Gr,offset:[0,4],targetOffset:Zr},leftBottom:{points:["br","bl"],overflow:Gr,offset:[-4,0],targetOffset:Zr}},t5={prefixCls:String,id:String,overlayInnerStyle:on.any};const n5=On({compatConfig:{MODE:3},name:"Content",props:t5,slots:["overlay"],setup:function(o,l){var f=l.slots;return function(){var g;return Me("div",{class:"".concat(o.prefixCls,"-inner"),id:o.id,role:"tooltip",style:o.overlayInnerStyle},[(g=f.overlay)===null||g===void 0?void 0:g.call(f)])}}});var i5=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","afterVisibleChange","transitionName","animation","placement","align","destroyTooltipOnHide","defaultVisible"];function Lw(){}const r5=On({compatConfig:{MODE:3},name:"Tooltip",inheritAttrs:!1,props:{trigger:on.any.def(["hover"]),defaultVisible:{type:Boolean,default:void 0},visible:{type:Boolean,default:void 0},placement:on.string.def("right"),transitionName:String,animation:on.any,afterVisibleChange:on.func.def(function(){}),overlayStyle:{type:Object,default:void 0},overlayClassName:String,prefixCls:on.string.def("rc-tooltip"),mouseEnterDelay:on.number.def(.1),mouseLeaveDelay:on.number.def(.1),getPopupContainer:Function,destroyTooltipOnHide:{type:Boolean,default:!1},align:on.object.def(function(){return{}}),arrowContent:on.any.def(null),tipId:String,builtinPlacements:on.object,overlayInnerStyle:{type:Object,default:void 0},popupVisible:{type:Boolean,default:void 0},onVisibleChange:Function,onPopupAlign:Function},slots:["arrowContent","overlay"],setup:function(o,l){var f=l.slots,g=l.attrs,x=l.expose,E=Gt(),s=function(){var F=o.prefixCls,G=o.tipId,oe=o.overlayInnerStyle;return[Me("div",{class:"".concat(F,"-arrow"),key:"arrow"},[Mf(f,o,"arrowContent")]),Me(n5,{key:"content",prefixCls:F,id:G,overlayInnerStyle:oe},{overlay:f.overlay})]},A=function(){return E.value.getPopupDomNode()};x({getPopupDomNode:A,triggerDOM:E,forcePopupAlign:function(){var F;return(F=E.value)===null||F===void 0?void 0:F.forcePopupAlign()}});var k=Gt(!1),R=Gt(!1);return Cl(function(){var D=o.destroyTooltipOnHide;if(typeof D=="boolean")k.value=D;else if(D&&Yi(D)==="object"){var F=D.keepParent;k.value=F===!0,R.value=F===!1}}),function(){var D=o.overlayClassName,F=o.trigger,G=o.mouseEnterDelay,oe=o.mouseLeaveDelay,se=o.overlayStyle,we=o.prefixCls,xe=o.afterVisibleChange,Te=o.transitionName,Ue=o.animation,Be=o.placement,Pe=o.align;o.destroyTooltipOnHide;var Oe=o.defaultVisible,Le=ga(o,i5),ke=Ve({},Le);o.visible!==void 0&&(ke.popupVisible=o.visible);var We=Ve(Ve(Ve({popupClassName:D,prefixCls:we,action:F,builtinPlacements:yC,popupPlacement:Be,popupAlign:Pe,afterPopupVisibleChange:xe,popupTransitionName:Te,popupAnimation:Ue,defaultPopupVisible:Oe,destroyPopupOnHide:k.value,autoDestroy:R.value,mouseLeaveDelay:oe,popupStyle:se,mouseEnterDelay:G},ke),g),{},{onPopupVisibleChange:o.onVisibleChange||Lw,onPopupAlign:o.onPopupAlign||Lw,ref:E,popup:s()});return Me(pC,We,{default:f.default})}}});Af("success","processing","error","default","warning");var o5=Af("pink","red","yellow","orange","cyan","green","blue","purple","geekblue","magenta","volcano","gold","lime");const s5=function(){return{trigger:[String,Array],visible:{type:Boolean,default:void 0},defaultVisible:{type:Boolean,default:void 0},placement:String,color:String,transitionName:String,overlayStyle:{type:Object,default:void 0},overlayClassName:String,openClassName:String,prefixCls:String,mouseEnterDelay:Number,mouseLeaveDelay:Number,getPopupContainer:Function,arrowPointAtCenter:{type:Boolean,default:void 0},autoAdjustOverflow:{type:[Boolean,Object],default:void 0},destroyTooltipOnHide:{type:Boolean,default:void 0},align:{type:Object,default:void 0},builtinPlacements:{type:Object,default:void 0},children:Array,onVisibleChange:Function,"onUpdate:visible":Function}};var a5={adjustX:1,adjustY:1},Rw={adjustX:0,adjustY:0},l5=[0,0];function Bw(t){return typeof t=="boolean"?t?a5:Rw:Ve(Ve({},Rw),t)}function c5(t){var o=t.arrowWidth,l=o===void 0?4:o,f=t.horizontalArrowShift,g=f===void 0?16:f,x=t.verticalArrowShift,E=x===void 0?8:x,s=t.autoAdjustOverflow,A=t.arrowPointAtCenter,k={left:{points:["cr","cl"],offset:[-4,0]},right:{points:["cl","cr"],offset:[4,0]},top:{points:["bc","tc"],offset:[0,-4]},bottom:{points:["tc","bc"],offset:[0,4]},topLeft:{points:["bl","tc"],offset:[-(g+l),-4]},leftTop:{points:["tr","cl"],offset:[-4,-(E+l)]},topRight:{points:["br","tc"],offset:[g+l,-4]},rightTop:{points:["tl","cr"],offset:[4,-(E+l)]},bottomRight:{points:["tr","bc"],offset:[g+l,4]},rightBottom:{points:["bl","cr"],offset:[4,E+l]},bottomLeft:{points:["tl","bc"],offset:[-(g+l),4]},leftBottom:{points:["br","cl"],offset:[-4,E+l]}};return Object.keys(k).forEach(function(R){k[R]=A?Ve(Ve({},k[R]),{},{overflow:Bw(s),targetOffset:l5}):Ve(Ve({},yC[R]),{},{overflow:Bw(s)}),k[R].ignoreShake=!0}),k}function u5(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=0,l=t.length;o<l;o++)if(t[o]!==void 0)return t[o]}var h5=function(o,l){var f={},g=Ve({},o);return l.forEach(function(x){o&&x in o&&(f[x]=o[x],delete g[x])}),{picked:f,omitted:g}},Fw=new RegExp("^(".concat(o5.join("|"),")(-inverse)?$")),f5=function(){return Ve(Ve({},s5()),{},{title:on.any})};const d5=On({compatConfig:{MODE:3},name:"ATooltip",inheritAttrs:!1,props:qT(f5(),{trigger:"hover",transitionName:"zoom-big-fast",align:{},placement:"top",mouseEnterDelay:.1,mouseLeaveDelay:.1,arrowPointAtCenter:!1,autoAdjustOverflow:!0}),slots:["title"],setup:function(o,l){var f=l.slots,g=l.emit,x=l.attrs,E=l.expose,s=qo("tooltip",o),A=s.prefixCls,k=s.getPopupContainer,R=Gt(u5([o.visible,o.defaultVisible])),D=Gt();Zo(function(){dv(o.defaultVisible===void 0,"Tooltip","'defaultVisible' is deprecated, please use 'v-model:visible'")});var F;Wn(function(){return o.visible},function(Pe){Xr.cancel(F),F=Xr(function(){R.value=!!Pe})});var G=function(){var Oe,Le=(Oe=o.title)!==null&&Oe!==void 0?Oe:f.title;return!Le&&Le!==0},oe=function(Oe){var Le=G();o.visible===void 0&&(R.value=Le?!1:Oe),Le||(g("update:visible",Oe),g("visibleChange",Oe))},se=function(){return D.value.getPopupDomNode()};E({getPopupDomNode:se,visible:R,forcePopupAlign:function(){var Oe;return(Oe=D.value)===null||Oe===void 0?void 0:Oe.forcePopupAlign()}});var we=yt(function(){var Pe=o.builtinPlacements,Oe=o.arrowPointAtCenter,Le=o.autoAdjustOverflow;return Pe||c5({arrowPointAtCenter:Oe,autoAdjustOverflow:Le})}),xe=function(Oe){return Oe||Oe===""},Te=function(Oe){var Le=Oe.type;if(Yi(Le)==="object"&&Oe.props&&((Le.__ANT_BUTTON===!0||Le==="button")&&xe(Oe.props.disabled)||Le.__ANT_SWITCH===!0&&(xe(Oe.props.disabled)||xe(Oe.props.loading)))){var ke=h5(hz(Oe),["position","left","right","top","bottom","float","display","zIndex"]),We=ke.picked,ct=ke.omitted,Tt=Ve(Ve({display:"inline-block"},We),{},{cursor:"not-allowed",lineHeight:1,width:Oe.props&&Oe.props.block?"100%":null}),st=Ve(Ve({},ct),{},{pointerEvents:"none"}),Ge=Il(Oe,{style:st},!0);return Me("span",{style:Tt,class:"".concat(A.value,"-disabled-compatible-wrapper")},[Ge])}return Oe},Ue=function(){var Oe,Le;return(Oe=o.title)!==null&&Oe!==void 0?Oe:(Le=f.title)===null||Le===void 0?void 0:Le.call(f)},Be=function(Oe,Le){var ke=we.value,We=Object.keys(ke).filter(function(st){return ke[st].points[0]===Le.points[0]&&ke[st].points[1]===Le.points[1]})[0];if(!!We){var ct=Oe.getBoundingClientRect(),Tt={top:"50%",left:"50%"};We.indexOf("top")>=0||We.indexOf("Bottom")>=0?Tt.top="".concat(ct.height-Le.offset[1],"px"):(We.indexOf("Top")>=0||We.indexOf("bottom")>=0)&&(Tt.top="".concat(-Le.offset[1],"px")),We.indexOf("left")>=0||We.indexOf("Right")>=0?Tt.left="".concat(ct.width-Le.offset[0],"px"):(We.indexOf("right")>=0||We.indexOf("Left")>=0)&&(Tt.left="".concat(-Le.offset[0],"px")),Oe.style.transformOrigin="".concat(Tt.left," ").concat(Tt.top)}};return function(){var Pe,Oe,Le,ke=o.openClassName,We=o.color,ct=o.overlayClassName,Tt=(Pe=$f((Oe=f.default)===null||Oe===void 0?void 0:Oe.call(f)))!==null&&Pe!==void 0?Pe:null;Tt=Tt.length===1?Tt[0]:Tt;var st=R.value;if(o.visible===void 0&&G()&&(st=!1),!Tt)return null;var Ge=Te(cv(Tt)?Tt:Me("span",null,[Tt])),Ne=ki((Le={},Cn(Le,ke||"".concat(A.value,"-open"),!0),Cn(Le,Ge.props&&Ge.props.class,Ge.props&&Ge.props.class),Le)),vt=ki(ct,Cn({},"".concat(A.value,"-").concat(We),We&&Fw.test(We))),rt,at;We&&!Fw.test(We)&&(rt={backgroundColor:We},at={backgroundColor:We});var ht=Ve(Ve(Ve({},x),o),{},{prefixCls:A.value,getPopupContainer:k.value,builtinPlacements:we.value,visible:st,ref:D,overlayClassName:vt,overlayInnerStyle:rt,onVisibleChange:oe,onPopupAlign:Be});return Me(r5,ht,{default:function(){return[R.value?Il(Ge,{class:Ne}):Ge]},arrowContent:function(){return Me("span",{class:"".concat(A.value,"-arrow-content"),style:at},null)},overlay:Ue})}}}),p5=hv(d5);var m5=function(o){return!isNaN(parseFloat(o))&&isFinite(o)};const g5=m5;var _5={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"};const y5=_5;function jw(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){v5(t,g,l[g])})}return t}function v5(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var kv=function(o,l){var f=jw({},o,l.attrs);return Me(Cr,jw({},f,{icon:y5}),null)};kv.displayName="EllipsisOutlined";kv.inheritAttrs=!1;const x5=kv;var b5={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"};const w5=b5;function Nw(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){T5(t,g,l[g])})}return t}function T5(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var Dv=function(o,l){var f=Nw({},o,l.attrs);return Me(Cr,Nw({},f,{icon:w5}),null)};Dv.displayName="RightOutlined";Dv.inheritAttrs=!1;const Uw=Dv;function E5(t,o,l,f){var g=l?l.call(f,t,o):void 0;if(g!==void 0)return!!g;if(t===o)return!0;if(Yi(t)!=="object"||!t||Yi(o)!=="object"||!o)return!1;var x=Object.keys(t),E=Object.keys(o);if(x.length!==E.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(o),A=0;A<x.length;A++){var k=x[A];if(!s(k))return!1;var R=t[k],D=o[k];if(g=l?l.call(f,R,D,k):void 0,g===!1||g===void 0&&R!==D)return!1}return!0}function Jh(t,o,l,f){return E5(Bn(t),Bn(o),l,f)}var vC=Symbol("menuContextKey"),xC=function(o){Xi(vC,o)},ba=function(){return vi(vC)},bC=Symbol("ForceRenderKey"),C5=function(o){Xi(bC,o)},wC=function(){return vi(bC,!1)},TC=Symbol("menuFirstLevelContextKey"),EC=function(o){Xi(TC,o)},S5=function(){return vi(TC,!0)},hm=On({compatConfig:{MODE:3},name:"MenuContextProvider",inheritAttrs:!1,props:{mode:{type:String,default:void 0},overflowDisabled:{type:Boolean,default:void 0},isRootMenu:{type:Boolean,default:void 0}},setup:function(o,l){var f=l.slots,g=ba(),x=Ve({},g);return o.mode!==void 0&&(x.mode=af(o,"mode")),o.isRootMenu!==void 0&&(x.isRootMenu=af(o,"isRootMenu")),o.overflowDisabled!==void 0&&(x.overflowDisabled=af(o,"overflowDisabled")),xC(x),function(){var E;return(E=f.default)===null||E===void 0?void 0:E.call(f)}}});const M5=xC;function A5(t,o,l,f){for(var g=t.length,x=l+(f?1:-1);f?x--:++x<g;)if(o(t[x],x,t))return x;return-1}function I5(t){return t!==t}function P5(t,o,l){for(var f=l-1,g=t.length;++f<g;)if(t[f]===o)return f;return-1}function z5(t,o,l){return o===o?P5(t,o,l):A5(t,I5,l)}function O5(t,o){var l=t==null?0:t.length;return!!l&&z5(t,o,0)>-1}function k5(t,o,l){for(var f=-1,g=t==null?0:t.length;++f<g;)if(l(o,t[f]))return!0;return!1}function D5(){}var L5=1/0,R5=Kc&&1/Ov(new Kc([,-0]))[1]==L5?function(t){return new Kc(t)}:D5;const B5=R5;var F5=200;function j5(t,o,l){var f=-1,g=O5,x=t.length,E=!0,s=[],A=s;if(l)E=!1,g=k5;else if(x>=F5){var k=o?null:B5(t);if(k)return Ov(k);E=!1,g=rC,A=new Rf}else A=o?[]:s;e:for(;++f<x;){var R=t[f],D=o?o(R):R;if(R=l||R!==0?R:0,E&&D===D){for(var F=A.length;F--;)if(A[F]===D)continue e;o&&A.push(D),s.push(R)}else g(A,D,l)||(A!==s&&A.push(D),s.push(R))}return s}function L_(t){return t&&t.length?j5(t):[]}var CC=Symbol("siderCollapsed"),SC=Symbol("siderHookProvider"),Lp="$$__vc-menu-more__key",MC=Symbol("KeyPathContext"),Lv=function(){return vi(MC,{parentEventKeys:yt(function(){return[]}),parentKeys:yt(function(){return[]}),parentInfo:{}})},N5=function(o,l,f){var g=Lv(),x=g.parentEventKeys,E=g.parentKeys,s=yt(function(){return[].concat(Er(x.value),[o])}),A=yt(function(){return[].concat(Er(E.value),[l])});return Xi(MC,{parentEventKeys:s,parentKeys:A,parentInfo:f}),A},AC=Symbol("measure"),Vw=On({compatConfig:{MODE:3},setup:function(o,l){var f=l.slots;return Xi(AC,!0),function(){var g;return(g=f.default)===null||g===void 0?void 0:g.call(f)}}}),Rv=function(){return vi(AC,!1)};const U5=N5;function IC(t){var o=ba(),l=o.mode,f=o.rtl,g=o.inlineIndent;return yt(function(){return l.value!=="inline"?null:f.value?{paddingRight:"".concat(t.value*g.value,"px")}:{paddingLeft:"".concat(t.value*g.value,"px")}})}var V5=0,$5=function(){return{id:String,role:String,disabled:Boolean,danger:Boolean,title:{type:[String,Boolean],default:void 0},icon:on.any,onMouseenter:Function,onMouseleave:Function,onClick:Function,onKeydown:Function,onFocus:Function}};const Bf=On({compatConfig:{MODE:3},name:"AMenuItem",inheritAttrs:!1,props:$5(),slots:["icon","title"],setup:function(o,l){var f=l.slots,g=l.emit,x=l.attrs,E=kl(),s=Rv(),A=Yi(E.vnode.key)==="symbol"?String(E.vnode.key):E.vnode.key;Of(Yi(E.vnode.key)!=="symbol","MenuItem",'MenuItem `:key="'.concat(String(A),'"` not support Symbol type'));var k="menu_item_".concat(++V5,"_$$_").concat(A),R=Lv(),D=R.parentEventKeys,F=R.parentKeys,G=ba(),oe=G.prefixCls,se=G.activeKeys,we=G.disabled,xe=G.changeActiveKeys,Te=G.rtl,Ue=G.inlineCollapsed,Be=G.siderCollapsed,Pe=G.onItemClick,Oe=G.selectedKeys,Le=G.registerMenuInfo,ke=G.unRegisterMenuInfo,We=S5(),ct=Gt(!1),Tt=yt(function(){return[].concat(Er(F.value),[A])}),st={eventKey:k,key:A,parentEventKeys:D,parentKeys:F,isLeaf:!0};Le(k,st),xs(function(){ke(k)}),Wn(se,function(){ct.value=!!se.value.find(function(xt){return xt===A})},{immediate:!0});var Ge=yt(function(){return we.value||o.disabled}),Ne=yt(function(){return Oe.value.includes(A)}),vt=yt(function(){var xt,be="".concat(oe.value,"-item");return xt={},Cn(xt,"".concat(be),!0),Cn(xt,"".concat(be,"-danger"),o.danger),Cn(xt,"".concat(be,"-active"),ct.value),Cn(xt,"".concat(be,"-selected"),Ne.value),Cn(xt,"".concat(be,"-disabled"),Ge.value),xt}),rt=function(be){return{key:A,eventKey:k,keyPath:Tt.value,eventKeyPath:[].concat(Er(D.value),[k]),domEvent:be,item:Ve(Ve({},o),x)}},at=function(be){if(!Ge.value){var Xe=rt(be);g("click",be),Pe(Xe)}},ht=function(be){Ge.value||(xe(Tt.value),g("mouseenter",be))},Ft=function(be){Ge.value||(xe([]),g("mouseleave",be))},ln=function(be){if(g("keydown",be),be.which===ZR.ENTER){var Xe=rt(be);g("click",be),Pe(Xe)}},pn=function(be){xe(Tt.value),g("focus",be)},Lt=function(be,Xe){var ut=Me("span",{class:"".concat(oe.value,"-title-content")},[Xe]);return(!be||cv(Xe)&&Xe.type==="span")&&Xe&&Ue.value&&We&&typeof Xe=="string"?Me("div",{class:"".concat(oe.value,"-inline-collapsed-noicon")},[Xe.charAt(0)]):ut},nn=IC(yt(function(){return Tt.value.length}));return function(){var xt,be,Xe,ut;if(s)return null;var bt=(xt=o.title)!==null&&xt!==void 0?xt:(be=f.title)===null||be===void 0?void 0:be.call(f),Yt=ma((Xe=f.default)===null||Xe===void 0?void 0:Xe.call(f)),en=Yt.length,qt=bt;typeof bt>"u"?qt=We&&en?Yt:"":bt===!1&&(qt="");var ie={title:qt};!Be.value&&!Ue.value&&(ie.title=null,ie.visible=!1);var ye={};o.role==="option"&&(ye["aria-selected"]=Ne.value);var Ae=Mf(f,o,"icon");return Me(p5,Ve(Ve({},ie),{},{placement:Te.value?"left":"right",overlayClassName:"".concat(oe.value,"-inline-collapsed-tooltip")}),{default:function(){return[Me(df.Item,Ve(Ve(Ve({component:"li"},x),{},{id:o.id,style:Ve(Ve({},x.style||{}),nn.value),class:[vt.value,(ut={},Cn(ut,"".concat(x.class),!!x.class),Cn(ut,"".concat(oe.value,"-item-only-child"),(Ae?en+1:en)===1),ut)],role:o.role||"menuitem",tabindex:o.disabled?null:-1,"data-menu-id":A,"aria-disabled":o.disabled},ye),{},{onMouseenter:ht,onMouseleave:Ft,onClick:at,onKeydown:ln,onFocus:pn,title:typeof bt=="string"?bt:void 0}),{default:function(){return[Il(Ae,{class:"".concat(oe.value,"-item-icon")},!1),Lt(Ae,Yt)]}})]}})}}});var ua={adjustX:1,adjustY:1},G5={topLeft:{points:["bl","tl"],overflow:ua,offset:[0,-7]},bottomLeft:{points:["tl","bl"],overflow:ua,offset:[0,7]},leftTop:{points:["tr","tl"],overflow:ua,offset:[-4,0]},rightTop:{points:["tl","tr"],overflow:ua,offset:[4,0]}},Z5={topLeft:{points:["bl","tl"],overflow:ua,offset:[0,-7]},bottomLeft:{points:["tl","bl"],overflow:ua,offset:[0,7]},rightTop:{points:["tr","tl"],overflow:ua,offset:[-4,0]},leftTop:{points:["tl","tr"],overflow:ua,offset:[4,0]}},q5={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};const $w=On({compatConfig:{MODE:3},name:"PopupTrigger",inheritAttrs:!1,props:{prefixCls:String,mode:String,visible:Boolean,popupClassName:String,popupOffset:Array,disabled:Boolean,onVisibleChange:Function},slots:["popup"],emits:["visibleChange"],setup:function(o,l){var f=l.slots,g=l.emit,x=Gt(!1),E=ba(),s=E.getPopupContainer,A=E.rtl,k=E.subMenuOpenDelay,R=E.subMenuCloseDelay,D=E.builtinPlacements,F=E.triggerSubMenuAction,G=E.isRootMenu,oe=E.forceSubMenuRender,se=E.motion,we=E.defaultMotions,xe=wC(),Te=yt(function(){return A.value?Ve(Ve({},Z5),D.value):Ve(Ve({},G5),D.value)}),Ue=yt(function(){return q5[o.mode]}),Be=Gt();Wn(function(){return o.visible},function(Le){Xr.cancel(Be.value),Be.value=Xr(function(){x.value=Le})},{immediate:!0}),xs(function(){Xr.cancel(Be.value)});var Pe=function(ke){g("visibleChange",ke)},Oe=yt(function(){var Le,ke,We=se.value||((Le=we.value)===null||Le===void 0?void 0:Le[o.mode])||((ke=we.value)===null||ke===void 0?void 0:ke.other),ct=typeof We=="function"?We():We;return ct?gE(ct.name,{css:!0}):void 0});return function(){var Le=o.prefixCls,ke=o.popupClassName,We=o.mode,ct=o.popupOffset,Tt=o.disabled;return Me(pC,{prefixCls:Le,popupClassName:ki("".concat(Le,"-popup"),Cn({},"".concat(Le,"-rtl"),A.value),ke),stretch:We==="horizontal"?"minWidth":null,getPopupContainer:G.value?s.value:function(st){return st.parentNode},builtinPlacements:Te.value,popupPlacement:Ue.value,popupVisible:x.value,popupAlign:ct&&{offset:ct},action:Tt?[]:[F.value],mouseEnterDelay:k.value,mouseLeaveDelay:R.value,onPopupVisibleChange:Pe,forceRender:xe||oe.value,popupAnimation:Oe.value},{popup:f.popup,default:f.default})}}});var PC=function(o,l){var f,g=l.slots,x=l.attrs,E=ba(),s=E.prefixCls,A=E.mode;return Me("ul",Ve(Ve({},x),{},{class:ki(s.value,"".concat(s.value,"-sub"),"".concat(s.value,"-").concat(A.value==="inline"?"inline":"vertical")),"data-menu-list":!0}),[(f=g.default)===null||f===void 0?void 0:f.call(g)])};PC.displayName="SubMenuList";const zC=PC,W5=On({compatConfig:{MODE:3},name:"InlineSubMenuList",inheritAttrs:!1,props:{id:String,open:Boolean,keyPath:Array},setup:function(o,l){var f=l.slots,g=yt(function(){return"inline"}),x=ba(),E=x.motion,s=x.mode,A=x.defaultMotions,k=yt(function(){return s.value===g.value}),R=Gt(!k.value),D=yt(function(){return k.value?o.open:!1});Wn(s,function(){k.value&&(R.value=!1)},{flush:"post"});var F=yt(function(){var G,oe,se=E.value||((G=A.value)===null||G===void 0?void 0:G[g.value])||((oe=A.value)===null||oe===void 0?void 0:oe.other),we=typeof se=="function"?se():se;return Ve(Ve({},we),{},{appear:o.keyPath.length<=1})});return function(){var G;return R.value?null:Me(hm,{mode:g.value},{default:function(){return[Me(fu,F.value,{default:function(){return[Qc(Me(zC,{id:o.id},{default:function(){return[(G=f.default)===null||G===void 0?void 0:G.call(f)]}}),[[DT,D.value]])]}})]}})}}});var Gw=0,H5=function(){return{icon:on.any,title:on.any,disabled:Boolean,level:Number,popupClassName:String,popupOffset:Array,internalPopupClose:Boolean,eventKey:String,expandIcon:Function,onMouseenter:Function,onMouseleave:Function,onTitleClick:Function}};const su=On({compatConfig:{MODE:3},name:"ASubMenu",inheritAttrs:!1,props:H5(),slots:["icon","title","expandIcon"],setup:function(o,l){var f,g,x=l.slots,E=l.attrs,s=l.emit;EC(!1);var A=Rv(),k=kl(),R=Yi(k.vnode.key)==="symbol"?String(k.vnode.key):k.vnode.key;Of(Yi(k.vnode.key)!=="symbol","SubMenu",'SubMenu `:key="'.concat(String(R),'"` not support Symbol type'));var D=iy(R)?R:"sub_menu_".concat(++Gw,"_$$_not_set_key"),F=(f=o.eventKey)!==null&&f!==void 0?f:iy(R)?"sub_menu_".concat(++Gw,"_$$_").concat(R):D,G=Lv(),oe=G.parentEventKeys,se=G.parentInfo,we=G.parentKeys,xe=yt(function(){return[].concat(Er(we.value),[D])}),Te=Gt([]),Ue={eventKey:F,key:D,parentEventKeys:oe,childrenEventKeys:Te,parentKeys:we};(g=se.childrenEventKeys)===null||g===void 0||g.value.push(F),xs(function(){if(se.childrenEventKeys){var Rt;se.childrenEventKeys.value=(Rt=se.childrenEventKeys)===null||Rt===void 0?void 0:Rt.value.filter(function(Ct){return Ct!=F})}}),U5(F,D,Ue);var Be=ba(),Pe=Be.prefixCls,Oe=Be.activeKeys,Le=Be.disabled,ke=Be.changeActiveKeys,We=Be.mode,ct=Be.inlineCollapsed,Tt=Be.antdMenuTheme,st=Be.openKeys,Ge=Be.overflowDisabled,Ne=Be.onOpenChange,vt=Be.registerMenuInfo,rt=Be.unRegisterMenuInfo,at=Be.selectedSubMenuKeys,ht=Be.expandIcon,Ft=R!=null,ln=!A&&(wC()||!Ft);C5(ln),(A&&Ft||!A&&!Ft||ln)&&(vt(F,Ue),xs(function(){rt(F)}));var pn=yt(function(){return"".concat(Pe.value,"-submenu")}),Lt=yt(function(){return Le.value||o.disabled}),nn=Gt(),xt=Gt(),be=yt(function(){return st.value.includes(D)}),Xe=yt(function(){return!Ge.value&&be.value}),ut=yt(function(){return at.value.includes(D)}),bt=Gt(!1);Wn(Oe,function(){bt.value=!!Oe.value.find(function(Rt){return Rt===D})},{immediate:!0});var Yt=function(Ct){Lt.value||(s("titleClick",Ct,D),We.value==="inline"&&Ne(D,!be.value))},en=function(Ct){Lt.value||(ke(xe.value),s("mouseenter",Ct))},qt=function(Ct){Lt.value||(ke([]),s("mouseleave",Ct))},ie=IC(yt(function(){return xe.value.length})),ye=function(Ct){We.value!=="inline"&&Ne(D,Ct)},Ae=function(){ke(xe.value)},qe=F&&"".concat(F,"-popup"),ot=yt(function(){return ki(Pe.value,"".concat(Pe.value,"-").concat(Tt.value),o.popupClassName)}),Et=function(Ct,jt){if(!jt)return ct.value&&!we.value.length&&Ct&&typeof Ct=="string"?Me("div",{class:"".concat(Pe.value,"-inline-collapsed-noicon")},[Ct.charAt(0)]):Me("span",{class:"".concat(Pe.value,"-title-content")},[Ct]);var Xt=cv(Ct)&&Ct.type==="span";return Me(yi,null,[Il(jt,{class:"".concat(Pe.value,"-item-icon")},!1),Xt?Ct:Me("span",{class:"".concat(Pe.value,"-title-content")},[Ct])])},wt=yt(function(){return We.value!=="inline"&&xe.value.length>1?"vertical":We.value}),ft=yt(function(){return We.value==="horizontal"?"vertical":We.value}),Qe=yt(function(){return wt.value==="horizontal"?"vertical":wt.value}),dt=function(){var Ct=pn.value,jt=Mf(x,o,"icon"),Xt=o.expandIcon||x.expandIcon||ht.value,sn=Et(Mf(x,o,"title"),jt);return Me("div",{style:ie.value,class:"".concat(Ct,"-title"),tabindex:Lt.value?null:-1,ref:nn,title:typeof sn=="string"?sn:null,"data-menu-id":D,"aria-expanded":Xe.value,"aria-haspopup":!0,"aria-controls":qe,"aria-disabled":Lt.value,onClick:Yt,onFocus:Ae},[sn,We.value!=="horizontal"&&Xt?Xt(Ve(Ve({},o),{},{isOpen:Xe.value})):Me("i",{class:"".concat(Ct,"-arrow")},null)])};return function(){var Rt;if(A){var Ct;return Ft?(Ct=x.default)===null||Ct===void 0?void 0:Ct.call(x):null}var jt=pn.value,Xt=function(){return null};return!Ge.value&&We.value!=="inline"?Xt=function(){return Me($w,{mode:wt.value,prefixCls:jt,visible:!o.internalPopupClose&&Xe.value,popupClassName:ot.value,popupOffset:o.popupOffset,disabled:Lt.value,onVisibleChange:ye},{default:function(){return[dt()]},popup:function(){return Me(hm,{mode:Qe.value,isRootMenu:!1},{default:function(){return[Me(zC,{id:qe,ref:xt},{default:x.default})]}})}})}:Xt=function(){return Me($w,null,{default:dt})},Me(hm,{mode:ft.value},{default:function(){return[Me(df.Item,Ve(Ve({component:"li"},E),{},{role:"none",class:ki(jt,"".concat(jt,"-").concat(We.value),E.class,(Rt={},Cn(Rt,"".concat(jt,"-open"),Xe.value),Cn(Rt,"".concat(jt,"-active"),bt.value),Cn(Rt,"".concat(jt,"-selected"),ut.value),Cn(Rt,"".concat(jt,"-disabled"),Lt.value),Rt)),onMouseenter:en,onMouseleave:qt,"data-submenu-id":D}),{default:function(){return Me(yi,null,[Xt(),!Ge.value&&Me(W5,{id:qe,open:Xe.value,keyPath:xe.value},{default:x.default})])}})]}})}}});function OC(t,o){if(t.classList)return t.classList.contains(o);var l=t.className;return" ".concat(l," ").indexOf(" ".concat(o," "))>-1}function Zw(t,o){t.classList?t.classList.add(o):OC(t,o)||(t.className="".concat(t.className," ").concat(o))}function qw(t,o){if(t.classList)t.classList.remove(o);else if(OC(t,o)){var l=t.className;t.className=" ".concat(l," ").replace(" ".concat(o," ")," ")}}var X5=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ant-motion-collapse",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{name:o,appear:l,css:!0,onBeforeEnter:function(g){g.style.height="0px",g.style.opacity="0",Zw(g,o)},onEnter:function(g){vs(function(){g.style.height="".concat(g.scrollHeight,"px"),g.style.opacity="1"})},onAfterEnter:function(g){g&&(qw(g,o),g.style.height=null,g.style.opacity=null)},onBeforeLeave:function(g){Zw(g,o),g.style.height="".concat(g.offsetHeight,"px"),g.style.opacity=null},onLeave:function(g){setTimeout(function(){g.style.height="0px",g.style.opacity="0"})},onAfterLeave:function(g){g&&(qw(g,o),g.style&&(g.style.height=null,g.style.opacity=null))}}};const K5=X5;var Y5=function(){return{id:String,prefixCls:String,disabled:Boolean,inlineCollapsed:Boolean,disabledOverflow:Boolean,forceSubMenuRender:Boolean,openKeys:Array,selectedKeys:Array,activeKey:String,selectable:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},motion:Object,theme:{type:String,default:"light"},mode:{type:String,default:"vertical"},inlineIndent:{type:Number,default:24},subMenuOpenDelay:{type:Number,default:.1},subMenuCloseDelay:{type:Number,default:.1},builtinPlacements:{type:Object},triggerSubMenuAction:{type:String,default:"hover"},getPopupContainer:Function,expandIcon:Function,onOpenChange:Function,onSelect:Function,onDeselect:Function,onClick:[Function,Array],onFocus:Function,onBlur:Function,onMousedown:Function,"onUpdate:openKeys":Function,"onUpdate:selectedKeys":Function,"onUpdate:activeKey":Function}},Ww=[];const ya=On({compatConfig:{MODE:3},name:"AMenu",inheritAttrs:!1,props:Y5(),slots:["expandIcon","overflowedIndicator"],setup:function(o,l){var f=l.slots,g=l.emit,x=l.attrs,E=qo("menu",o),s=E.prefixCls,A=E.direction,k=E.getPrefixCls,R=Gt({}),D=vi(CC,Gt(void 0)),F=yt(function(){return D.value!==void 0?D.value:o.inlineCollapsed}),G=Gt(!1);Zo(function(){G.value=!0}),Cl(function(){Of(!(o.inlineCollapsed===!0&&o.mode!=="inline"),"Menu","`inlineCollapsed` should only be used when `mode` is inline."),Of(!(D.value!==void 0&&o.inlineCollapsed===!0),"Menu","`inlineCollapsed` not control Menu under Sider. Should set `collapsed` on Sider instead.")});var oe=Gt([]),se=Gt([]),we=Gt({});Wn(R,function(){for(var xt={},be=0,Xe=Object.values(R.value);be<Xe.length;be++){var ut=Xe[be];xt[ut.key]=ut}we.value=xt},{flush:"post"}),Cl(function(){if(o.activeKey!==void 0){var xt=[],be=o.activeKey?we.value[o.activeKey]:void 0;be&&o.activeKey!==void 0?xt=L_([].concat(No(be.parentKeys),o.activeKey)):xt=[],Jh(oe.value,xt)||(oe.value=xt)}}),Wn(function(){return o.selectedKeys},function(xt){xt&&(se.value=xt.slice())},{immediate:!0,deep:!0});var xe=Gt([]);Wn([we,se],function(){var xt=[];se.value.forEach(function(be){var Xe=we.value[be];Xe&&(xt=xt.concat(No(Xe.parentKeys)))}),xt=L_(xt),Jh(xe.value,xt)||(xe.value=xt)},{immediate:!0});var Te=function(be){if(!!o.selectable){var Xe=be.key,ut=se.value.includes(Xe),bt;o.multiple?ut?bt=se.value.filter(function(en){return en!==Xe}):bt=[].concat(Er(se.value),[Xe]):bt=[Xe];var Yt=Ve(Ve({},be),{},{selectedKeys:bt});Jh(bt,se.value)||(o.selectedKeys===void 0&&(se.value=bt),g("update:selectedKeys",bt),ut&&o.multiple?g("deselect",Yt):g("select",Yt)),ke.value!=="inline"&&!o.multiple&&Ue.value.length&&Tt(Ww)}},Ue=Gt([]);Wn(function(){return o.openKeys},function(){var xt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ue.value;Jh(Ue.value,xt)||(Ue.value=xt.slice())},{immediate:!0,deep:!0});var Be,Pe=function(be){clearTimeout(Be),Be=setTimeout(function(){o.activeKey===void 0&&(oe.value=be),g("update:activeKey",be[be.length-1])})},Oe=yt(function(){return!!o.disabled}),Le=yt(function(){return A.value==="rtl"}),ke=Gt("vertical"),We=Gt(!1);Cl(function(){(o.mode==="inline"||o.mode==="vertical")&&F.value?(ke.value="vertical",We.value=F.value):(ke.value=o.mode,We.value=!1)});var ct=yt(function(){return ke.value==="inline"}),Tt=function(be){Ue.value=be,g("update:openKeys",be),g("openChange",be)},st=Gt(Ue.value),Ge=Gt(!1);Wn(Ue,function(){ct.value&&(st.value=Ue.value)},{immediate:!0}),Wn(ct,function(){if(!Ge.value){Ge.value=!0;return}ct.value?Ue.value=st.value:Tt(Ww)},{immediate:!0});var Ne=yt(function(){var xt;return xt={},Cn(xt,"".concat(s.value),!0),Cn(xt,"".concat(s.value,"-root"),!0),Cn(xt,"".concat(s.value,"-").concat(ke.value),!0),Cn(xt,"".concat(s.value,"-inline-collapsed"),We.value),Cn(xt,"".concat(s.value,"-rtl"),Le.value),Cn(xt,"".concat(s.value,"-").concat(o.theme),!0),xt}),vt=yt(function(){return k()}),rt=yt(function(){return{horizontal:{name:"".concat(vt.value,"-slide-up")},inline:K5,other:{name:"".concat(vt.value,"-zoom-big")}}});EC(!0);var at=function xt(){var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],Xe=[],ut=R.value;return be.forEach(function(bt){var Yt=ut[bt],en=Yt.key,qt=Yt.childrenEventKeys;Xe.push.apply(Xe,[en].concat(Er(xt(No(qt)))))}),Xe},ht=function(be){g("click",be),Te(be)},Ft=function(be,Xe){var ut=we.value[be].childrenEventKeys,bt=Ue.value.filter(function(en){return en!==be});if(Xe)bt.push(be);else if(ke.value!=="inline"){var Yt=at(No(ut));bt=L_(bt.filter(function(en){return!Yt.includes(en)}))}Jh(Ue,bt)||Tt(bt)},ln=function(be,Xe){R.value=Ve(Ve({},R.value),{},Cn({},be,Xe))},pn=function(be){delete R.value[be],R.value=Ve({},R.value)},Lt=Gt(0),nn=yt(function(){return o.expandIcon||f.expandIcon?function(xt){var be=o.expandIcon||f.expandIcon;return be=typeof be=="function"?be(xt):be,Il(be,{class:"".concat(s.value,"-submenu-expand-icon")},!1)}:null});return M5({store:R,prefixCls:s,activeKeys:oe,openKeys:Ue,selectedKeys:se,changeActiveKeys:Pe,disabled:Oe,rtl:Le,mode:ke,inlineIndent:yt(function(){return o.inlineIndent}),subMenuCloseDelay:yt(function(){return o.subMenuCloseDelay}),subMenuOpenDelay:yt(function(){return o.subMenuOpenDelay}),builtinPlacements:yt(function(){return o.builtinPlacements}),triggerSubMenuAction:yt(function(){return o.triggerSubMenuAction}),getPopupContainer:yt(function(){return o.getPopupContainer}),inlineCollapsed:We,antdMenuTheme:yt(function(){return o.theme}),siderCollapsed:D,defaultMotions:yt(function(){return G.value?rt.value:null}),motion:yt(function(){return G.value?o.motion:null}),overflowDisabled:Gt(void 0),onOpenChange:Ft,onItemClick:ht,registerMenuInfo:ln,unRegisterMenuInfo:pn,selectedSubMenuKeys:xe,isRootMenu:Gt(!0),expandIcon:nn,forceSubMenuRender:yt(function(){return o.forceSubMenuRender})}),function(){var xt,be,Xe=ma((xt=f.default)===null||xt===void 0?void 0:xt.call(f)),ut=Lt.value>=Xe.length-1||ke.value!=="horizontal"||o.disabledOverflow,bt=ke.value!=="horizontal"||o.disabledOverflow?Xe:Xe.map(function(en,qt){return Me(hm,{key:en.key,overflowDisabled:qt>Lt.value},{default:function(){return en}})}),Yt=((be=f.overflowedIndicator)===null||be===void 0?void 0:be.call(f))||Me(x5,null,null);return Me(df,Ve(Ve({},x),{},{onMousedown:o.onMousedown,prefixCls:"".concat(s.value,"-overflow"),component:"ul",itemComponent:Bf,class:[Ne.value,x.class],role:"menu",id:o.id,data:bt,renderRawItem:function(qt){return qt},renderRawRest:function(qt){var ie=qt.length,ye=ie?Xe.slice(-ie):null;return Me(yi,null,[Me(su,{eventKey:Lp,key:Lp,title:Yt,disabled:ut,internalPopupClose:ie===0},{default:function(){return ye}}),Me(Vw,null,{default:function(){return[Me(su,{eventKey:Lp,key:Lp,title:Yt,disabled:ut,internalPopupClose:ie===0},{default:function(){return ye}})]}})])},maxCount:ke.value!=="horizontal"||o.disabledOverflow?df.INVALIDATE:df.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(qt){Lt.value=qt}}),{default:function(){return[Me(sv,{to:"body"},{default:function(){return[Me("div",{style:{display:"none"},"aria-hidden":!0},[Me(Vw,null,{default:function(){return[bt]}})])]}})]}})}}});var J5=function(){return{title:on.any}};const Ey=On({compatConfig:{MODE:3},name:"AMenuItemGroup",inheritAttrs:!1,props:J5(),slots:["title"],setup:function(o,l){var f=l.slots,g=l.attrs,x=ba(),E=x.prefixCls,s=yt(function(){return"".concat(E.value,"-item-group")}),A=Rv();return function(){var k,R;return A?(k=f.default)===null||k===void 0?void 0:k.call(f):Me("li",Ve(Ve({},g),{},{onClick:function(F){return F.stopPropagation()},class:s.value}),[Me("div",{title:typeof o.title=="string"?o.title:void 0,class:"".concat(s.value,"-title")},[Mf(f,o,"title")]),Me("ul",{class:"".concat(s.value,"-list")},[(R=f.default)===null||R===void 0?void 0:R.call(f)])])}}});var Q5=function(){return{prefixCls:String,dashed:Boolean}};const Cy=On({compatConfig:{MODE:3},name:"AMenuDivider",props:Q5(),setup:function(o){var l=qo("menu",o),f=l.prefixCls,g=yt(function(){var x;return x={},Cn(x,"".concat(f.value,"-item-divider"),!0),Cn(x,"".concat(f.value,"-item-divider-dashed"),!!o.dashed),x});return function(){return Me("li",{class:g.value},null)}}});ya.install=function(t){return t.component(ya.name,ya),t.component(Bf.name,Bf),t.component(su.name,su),t.component(Cy.name,Cy),t.component(Ey.name,Ey),t};ya.Item=Bf;ya.Divider=Cy;ya.SubMenu=su;ya.ItemGroup=Ey;var eB={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"};const tB=eB;function Hw(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){nB(t,g,l[g])})}return t}function nB(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var Bv=function(o,l){var f=Hw({},o,l.attrs);return Me(Cr,Hw({},f,{icon:tB}),null)};Bv.displayName="LeftOutlined";Bv.inheritAttrs=!1;const Xw=Bv;var Fv=function(){return{prefixCls:String,hasSider:{type:Boolean,default:void 0},tagName:String}};function Om(t){var o=t.suffixCls,l=t.tagName,f=t.name;return function(g){var x=On({compatConfig:{MODE:3},name:f,props:Fv(),setup:function(s,A){var k=A.slots,R=qo(o,s),D=R.prefixCls;return function(){var F=Ve(Ve({},s),{},{prefixCls:D.value,tagName:l});return Me(g,F,k)}}});return x}}var jv=On({compatConfig:{MODE:3},props:Fv(),setup:function(o,l){var f=l.slots;return function(){return Me(o.tagName,{class:o.prefixCls},f)}}}),iB=On({compatConfig:{MODE:3},props:Fv(),setup:function(o,l){var f=l.slots,g=qo("",o),x=g.direction,E=Gt([]),s={addSider:function(R){E.value=[].concat(Er(E.value),[R])},removeSider:function(R){E.value=E.value.filter(function(D){return D!==R})}};Xi(SC,s);var A=yt(function(){var k,R=o.prefixCls,D=o.hasSider;return k={},Cn(k,"".concat(R),!0),Cn(k,"".concat(R,"-has-sider"),typeof D=="boolean"?D:E.value.length>0),Cn(k,"".concat(R,"-rtl"),x.value==="rtl"),k});return function(){var k=o.tagName;return Me(k,{class:A.value},f)}}}),rB=Om({suffixCls:"layout",tagName:"section",name:"ALayout"})(iB),Hp=Om({suffixCls:"layout-header",tagName:"header",name:"ALayoutHeader"})(jv),R_=Om({suffixCls:"layout-footer",tagName:"footer",name:"ALayoutFooter"})(jv),Xp=Om({suffixCls:"layout-content",tagName:"main",name:"ALayoutContent"})(jv);const B_=rB;var oB={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"bars",theme:"outlined"};const sB=oB;function Kw(t){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(l).filter(function(g){return Object.getOwnPropertyDescriptor(l,g).enumerable}))),f.forEach(function(g){aB(t,g,l[g])})}return t}function aB(t,o,l){return o in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l,t}var Nv=function(o,l){var f=Kw({},o,l.attrs);return Me(Cr,Kw({},f,{icon:sB}),null)};Nv.displayName="BarsOutlined";Nv.inheritAttrs=!1;const lB=Nv;var Yw={xs:"479.98px",sm:"575.98px",md:"767.98px",lg:"991.98px",xl:"1199.98px",xxl:"1599.98px",xxxl:"1999.98px"},cB=function(){return{prefixCls:String,collapsible:{type:Boolean,default:void 0},collapsed:{type:Boolean,default:void 0},defaultCollapsed:{type:Boolean,default:void 0},reverseArrow:{type:Boolean,default:void 0},zeroWidthTriggerStyle:{type:Object,default:void 0},trigger:on.any,width:on.oneOfType([on.number,on.string]),collapsedWidth:on.oneOfType([on.number,on.string]),breakpoint:on.oneOf(Af("xs","sm","md","lg","xl","xxl","xxxl")),theme:on.oneOf(Af("light","dark")).def("dark"),onBreakpoint:Function,onCollapse:Function}},uB=function(){var t=0;return function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return t+=1,"".concat(o).concat(t)}}();const Kp=On({compatConfig:{MODE:3},name:"ALayoutSider",inheritAttrs:!1,props:qT(cB(),{collapsible:!1,defaultCollapsed:!1,reverseArrow:!1,width:200,collapsedWidth:80}),emits:["breakpoint","update:collapsed","collapse"],setup:function(o,l){var f=l.emit,g=l.attrs,x=l.slots,E=qo("layout-sider",o),s=E.prefixCls,A=vi(SC,void 0),k=Gt(!!(o.collapsed!==void 0?o.collapsed:o.defaultCollapsed)),R=Gt(!1);Wn(function(){return o.collapsed},function(){k.value=!!o.collapsed}),Xi(CC,k);var D=function(Te,Ue){o.collapsed===void 0&&(k.value=Te),f("update:collapsed",Te),f("collapse",Te,Ue)},F=Gt(function(xe){R.value=xe.matches,f("breakpoint",xe.matches),k.value!==xe.matches&&D(xe.matches,"responsive")}),G;function oe(xe){return F.value(xe)}var se=uB("ant-sider-");A&&A.addSider(se),Zo(function(){Wn(function(){return o.breakpoint},function(){try{var xe;(xe=G)===null||xe===void 0||xe.removeEventListener("change",oe)}catch{var Te;(Te=G)===null||Te===void 0||Te.removeListener(oe)}if(typeof window<"u"){var Ue=window,Be=Ue.matchMedia;if(Be&&o.breakpoint&&o.breakpoint in Yw){G=Be("(max-width: ".concat(Yw[o.breakpoint],")"));try{G.addEventListener("change",oe)}catch{G.addListener(oe)}oe(G)}}},{immediate:!0})}),xs(function(){try{var xe;(xe=G)===null||xe===void 0||xe.removeEventListener("change",oe)}catch{var Te;(Te=G)===null||Te===void 0||Te.removeListener(oe)}A&&A.removeSider(se)});var we=function(){D(!k.value,"clickTrigger")};return function(){var xe,Te,Ue,Be=s.value,Pe=o.collapsedWidth,Oe=o.width,Le=o.reverseArrow,ke=o.zeroWidthTriggerStyle,We=o.trigger,ct=We===void 0?(xe=x.trigger)===null||xe===void 0?void 0:xe.call(x):We,Tt=o.collapsible,st=o.theme,Ge=k.value?Pe:Oe,Ne=g5(Ge)?"".concat(Ge,"px"):String(Ge),vt=parseFloat(String(Pe||0))===0?Me("span",{onClick:we,class:ki("".concat(Be,"-zero-width-trigger"),"".concat(Be,"-zero-width-trigger-").concat(Le?"right":"left")),style:ke},[ct||Me(lB,null,null)]):null,rt={expanded:Me(Le?Uw:Xw,null,null),collapsed:Me(Le?Xw:Uw,null,null)},at=k.value?"collapsed":"expanded",ht=rt[at],Ft=ct!==null?vt||Me("div",{class:"".concat(Be,"-trigger"),onClick:we,style:{width:Ne}},[ct||ht]):null,ln=[g.style,{flex:"0 0 ".concat(Ne),maxWidth:Ne,minWidth:Ne,width:Ne}],pn=ki(Be,"".concat(Be,"-").concat(st),(Te={},Cn(Te,"".concat(Be,"-collapsed"),!!k.value),Cn(Te,"".concat(Be,"-has-trigger"),Tt&&ct!==null&&!vt),Cn(Te,"".concat(Be,"-below"),!!R.value),Cn(Te,"".concat(Be,"-zero-width"),parseFloat(Ne)===0),Te),g.class);return Me("aside",Ve(Ve({},g),{},{class:pn,style:ln}),[Me("div",{class:"".concat(Be,"-children")},[(Ue=x.default)===null||Ue===void 0?void 0:Ue.call(x)]),Tt||R.value&&vt?Ft:null])}}});var hB=Hp,fB=Kp,dB=Xp;const pB=ws(B_,{Header:Hp,Footer:R_,Content:Xp,Sider:Kp,install:function(o){return o.component(B_.name,B_),o.component(Hp.name,Hp),o.component(R_.name,R_),o.component(Kp.name,Kp),o.component(Xp.name,Xp),o}}),pf=/^[a-z0-9]+(-[a-z0-9]+)*$/,km=(t,o,l,f="")=>{const g=t.split(":");if(t.slice(0,1)==="@"){if(g.length<2||g.length>3)return null;f=g.shift().slice(1)}if(g.length>3||!g.length)return null;if(g.length>1){const s=g.pop(),A=g.pop(),k={provider:g.length>0?g[0]:f,prefix:A,name:s};return o&&!Yp(k)?null:k}const x=g[0],E=x.split("-");if(E.length>1){const s={provider:f,prefix:E.shift(),name:E.join("-")};return o&&!Yp(s)?null:s}if(l&&f===""){const s={provider:f,prefix:"",name:x};return o&&!Yp(s,l)?null:s}return null},Yp=(t,o)=>t?!!((t.provider===""||t.provider.match(pf))&&(o&&t.prefix===""||t.prefix.match(pf))&&t.name.match(pf)):!1,kC=Object.freeze({left:0,top:0,width:16,height:16}),fm=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),Dm=Object.freeze({...kC,...fm}),Sy=Object.freeze({...Dm,body:"",hidden:!1});function mB(t,o){const l={};!t.hFlip!=!o.hFlip&&(l.hFlip=!0),!t.vFlip!=!o.vFlip&&(l.vFlip=!0);const f=((t.rotate||0)+(o.rotate||0))%4;return f&&(l.rotate=f),l}function Jw(t,o){const l=mB(t,o);for(const f in Sy)f in fm?f in t&&!(f in l)&&(l[f]=fm[f]):f in o?l[f]=o[f]:f in t&&(l[f]=t[f]);return l}function gB(t,o){const l=t.icons,f=t.aliases||{},g=Object.create(null);function x(E){if(l[E])return g[E]=[];if(!(E in g)){g[E]=null;const s=f[E]&&f[E].parent,A=s&&x(s);A&&(g[E]=[s].concat(A))}return g[E]}return(o||Object.keys(l).concat(Object.keys(f))).forEach(x),g}function _B(t,o,l){const f=t.icons,g=t.aliases||{};let x={};function E(s){x=Jw(f[s]||g[s],x)}return E(o),l.forEach(E),Jw(t,x)}function DC(t,o){const l=[];if(typeof t!="object"||typeof t.icons!="object")return l;t.not_found instanceof Array&&t.not_found.forEach(g=>{o(g,null),l.push(g)});const f=gB(t);for(const g in f){const x=f[g];x&&(o(g,_B(t,g,x)),l.push(g))}return l}const yB={provider:"",aliases:{},not_found:{},...kC};function F_(t,o){for(const l in o)if(l in t&&typeof t[l]!=typeof o[l])return!1;return!0}function LC(t){if(typeof t!="object"||t===null)return null;const o=t;if(typeof o.prefix!="string"||!t.icons||typeof t.icons!="object"||!F_(t,yB))return null;const l=o.icons;for(const g in l){const x=l[g];if(!g.match(pf)||typeof x.body!="string"||!F_(x,Sy))return null}const f=o.aliases||{};for(const g in f){const x=f[g],E=x.parent;if(!g.match(pf)||typeof E!="string"||!l[E]&&!f[E]||!F_(x,Sy))return null}return o}const Qw=Object.create(null);function vB(t,o){return{provider:t,prefix:o,icons:Object.create(null),missing:new Set}}function zl(t,o){const l=Qw[t]||(Qw[t]=Object.create(null));return l[o]||(l[o]=vB(t,o))}function Uv(t,o){return LC(o)?DC(o,(l,f)=>{f?t.icons[l]=f:t.missing.add(l)}):[]}function xB(t,o,l){try{if(typeof l.body=="string")return t.icons[o]={...l},!0}catch{}return!1}let Ff=!1;function RC(t){return typeof t=="boolean"&&(Ff=t),Ff}function bB(t){const o=typeof t=="string"?km(t,!0,Ff):t;if(o){const l=zl(o.provider,o.prefix),f=o.name;return l.icons[f]||(l.missing.has(f)?null:void 0)}}function wB(t,o){const l=km(t,!0,Ff);if(!l)return!1;const f=zl(l.provider,l.prefix);return xB(f,l.name,o)}function BC(t,o){if(typeof t!="object")return!1;if(typeof o!="string"&&(o=t.provider||""),Ff&&!o&&!t.prefix){let g=!1;return LC(t)&&(t.prefix="",DC(t,(x,E)=>{E&&wB(x,E)&&(g=!0)})),g}const l=t.prefix;if(!Yp({provider:o,prefix:l,name:"a"}))return!1;const f=zl(o,l);return!!Uv(f,t)}const FC=Object.freeze({width:null,height:null}),jC=Object.freeze({...FC,...fm}),TB=/(-?[0-9.]*[0-9]+[0-9.]*)/g,EB=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function e2(t,o,l){if(o===1)return t;if(l=l||100,typeof t=="number")return Math.ceil(t*o*l)/l;if(typeof t!="string")return t;const f=t.split(TB);if(f===null||!f.length)return t;const g=[];let x=f.shift(),E=EB.test(x);for(;;){if(E){const s=parseFloat(x);isNaN(s)?g.push(x):g.push(Math.ceil(s*o*l)/l)}else g.push(x);if(x=f.shift(),x===void 0)return g.join("");E=!E}}function CB(t,o){const l={...Dm,...t},f={...jC,...o},g={left:l.left,top:l.top,width:l.width,height:l.height};let x=l.body;[l,f].forEach(G=>{const oe=[],se=G.hFlip,we=G.vFlip;let xe=G.rotate;se?we?xe+=2:(oe.push("translate("+(g.width+g.left).toString()+" "+(0-g.top).toString()+")"),oe.push("scale(-1 1)"),g.top=g.left=0):we&&(oe.push("translate("+(0-g.left).toString()+" "+(g.height+g.top).toString()+")"),oe.push("scale(1 -1)"),g.top=g.left=0);let Te;switch(xe<0&&(xe-=Math.floor(xe/4)*4),xe=xe%4,xe){case 1:Te=g.height/2+g.top,oe.unshift("rotate(90 "+Te.toString()+" "+Te.toString()+")");break;case 2:oe.unshift("rotate(180 "+(g.width/2+g.left).toString()+" "+(g.height/2+g.top).toString()+")");break;case 3:Te=g.width/2+g.left,oe.unshift("rotate(-90 "+Te.toString()+" "+Te.toString()+")");break}xe%2===1&&(g.left!==g.top&&(Te=g.left,g.left=g.top,g.top=Te),g.width!==g.height&&(Te=g.width,g.width=g.height,g.height=Te)),oe.length&&(x='<g transform="'+oe.join(" ")+'">'+x+"</g>")});const E=f.width,s=f.height,A=g.width,k=g.height;let R,D;return E===null?(D=s===null?"1em":s==="auto"?k:s,R=e2(D,A/k)):(R=E==="auto"?A:E,D=s===null?e2(R,k/A):s==="auto"?k:s),{attributes:{width:R.toString(),height:D.toString(),viewBox:g.left.toString()+" "+g.top.toString()+" "+A.toString()+" "+k.toString()},body:x}}const SB=/\sid="(\S+)"/g,MB="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let AB=0;function IB(t,o=MB){const l=[];let f;for(;f=SB.exec(t);)l.push(f[1]);return l.length&&l.forEach(g=>{const x=typeof o=="function"?o(g):o+(AB++).toString(),E=g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");t=t.replace(new RegExp('([#;"])('+E+')([")]|\\.[a-z])',"g"),"$1"+x+"$3")}),t}const My=Object.create(null);function PB(t,o){My[t]=o}function Ay(t){return My[t]||My[""]}function Vv(t){let o;if(typeof t.resources=="string")o=[t.resources];else if(o=t.resources,!(o instanceof Array)||!o.length)return null;return{resources:o,path:t.path||"/",maxURL:t.maxURL||500,rotate:t.rotate||750,timeout:t.timeout||5e3,random:t.random===!0,index:t.index||0,dataAfterTimeout:t.dataAfterTimeout!==!1}}const $v=Object.create(null),Qh=["https://api.simplesvg.com","https://api.unisvg.com"],Jp=[];for(;Qh.length>0;)Qh.length===1||Math.random()>.5?Jp.push(Qh.shift()):Jp.push(Qh.pop());$v[""]=Vv({resources:["https://api.iconify.design"].concat(Jp)});function zB(t,o){const l=Vv(o);return l===null?!1:($v[t]=l,!0)}function Gv(t){return $v[t]}const OB=()=>{let t;try{if(t=fetch,typeof t=="function")return t}catch{}};let t2=OB();function kB(t,o){const l=Gv(t);if(!l)return 0;let f;if(!l.maxURL)f=0;else{let g=0;l.resources.forEach(E=>{g=Math.max(g,E.length)});const x=o+".json?icons=";f=l.maxURL-g-l.path.length-x.length}return f}function DB(t){return t===404}const LB=(t,o,l)=>{const f=[],g=kB(t,o),x="icons";let E={type:x,provider:t,prefix:o,icons:[]},s=0;return l.forEach((A,k)=>{s+=A.length+1,s>=g&&k>0&&(f.push(E),E={type:x,provider:t,prefix:o,icons:[]},s=A.length),E.icons.push(A)}),f.push(E),f};function RB(t){if(typeof t=="string"){const o=Gv(t);if(o)return o.path}return"/"}const BB=(t,o,l)=>{if(!t2){l("abort",424);return}let f=RB(o.provider);switch(o.type){case"icons":{const x=o.prefix,s=o.icons.join(","),A=new URLSearchParams({icons:s});f+=x+".json?"+A.toString();break}case"custom":{const x=o.uri;f+=x.slice(0,1)==="/"?x.slice(1):x;break}default:l("abort",400);return}let g=503;t2(t+f).then(x=>{const E=x.status;if(E!==200){setTimeout(()=>{l(DB(E)?"abort":"next",E)});return}return g=501,x.json()}).then(x=>{if(typeof x!="object"||x===null){setTimeout(()=>{l("next",g)});return}setTimeout(()=>{l("success",x)})}).catch(()=>{l("next",g)})},FB={prepare:LB,send:BB};function jB(t){const o={loaded:[],missing:[],pending:[]},l=Object.create(null);t.sort((g,x)=>g.provider!==x.provider?g.provider.localeCompare(x.provider):g.prefix!==x.prefix?g.prefix.localeCompare(x.prefix):g.name.localeCompare(x.name));let f={provider:"",prefix:"",name:""};return t.forEach(g=>{if(f.name===g.name&&f.prefix===g.prefix&&f.provider===g.provider)return;f=g;const x=g.provider,E=g.prefix,s=g.name,A=l[x]||(l[x]=Object.create(null)),k=A[E]||(A[E]=zl(x,E));let R;s in k.icons?R=o.loaded:E===""||k.missing.has(s)?R=o.missing:R=o.pending;const D={provider:x,prefix:E,name:s};R.push(D)}),o}function NC(t,o){t.forEach(l=>{const f=l.loaderCallbacks;f&&(l.loaderCallbacks=f.filter(g=>g.id!==o))})}function NB(t){t.pendingCallbacksFlag||(t.pendingCallbacksFlag=!0,setTimeout(()=>{t.pendingCallbacksFlag=!1;const o=t.loaderCallbacks?t.loaderCallbacks.slice(0):[];if(!o.length)return;let l=!1;const f=t.provider,g=t.prefix;o.forEach(x=>{const E=x.icons,s=E.pending.length;E.pending=E.pending.filter(A=>{if(A.prefix!==g)return!0;const k=A.name;if(t.icons[k])E.loaded.push({provider:f,prefix:g,name:k});else if(t.missing.has(k))E.missing.push({provider:f,prefix:g,name:k});else return l=!0,!0;return!1}),E.pending.length!==s&&(l||NC([t],x.id),x.callback(E.loaded.slice(0),E.missing.slice(0),E.pending.slice(0),x.abort))})}))}let UB=0;function VB(t,o,l){const f=UB++,g=NC.bind(null,l,f);if(!o.pending.length)return g;const x={id:f,icons:o,callback:t,abort:g};return l.forEach(E=>{(E.loaderCallbacks||(E.loaderCallbacks=[])).push(x)}),g}function $B(t,o=!0,l=!1){const f=[];return t.forEach(g=>{const x=typeof g=="string"?km(g,o,l):g;x&&f.push(x)}),f}var GB={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function ZB(t,o,l,f){const g=t.resources.length,x=t.random?Math.floor(Math.random()*g):t.index;let E;if(t.random){let Oe=t.resources.slice(0);for(E=[];Oe.length>1;){const Le=Math.floor(Math.random()*Oe.length);E.push(Oe[Le]),Oe=Oe.slice(0,Le).concat(Oe.slice(Le+1))}E=E.concat(Oe)}else E=t.resources.slice(x).concat(t.resources.slice(0,x));const s=Date.now();let A="pending",k=0,R,D=null,F=[],G=[];typeof f=="function"&&G.push(f);function oe(){D&&(clearTimeout(D),D=null)}function se(){A==="pending"&&(A="aborted"),oe(),F.forEach(Oe=>{Oe.status==="pending"&&(Oe.status="aborted")}),F=[]}function we(Oe,Le){Le&&(G=[]),typeof Oe=="function"&&G.push(Oe)}function xe(){return{startTime:s,payload:o,status:A,queriesSent:k,queriesPending:F.length,subscribe:we,abort:se}}function Te(){A="failed",G.forEach(Oe=>{Oe(void 0,R)})}function Ue(){F.forEach(Oe=>{Oe.status==="pending"&&(Oe.status="aborted")}),F=[]}function Be(Oe,Le,ke){const We=Le!=="success";switch(F=F.filter(ct=>ct!==Oe),A){case"pending":break;case"failed":if(We||!t.dataAfterTimeout)return;break;default:return}if(Le==="abort"){R=ke,Te();return}if(We){R=ke,F.length||(E.length?Pe():Te());return}if(oe(),Ue(),!t.random){const ct=t.resources.indexOf(Oe.resource);ct!==-1&&ct!==t.index&&(t.index=ct)}A="completed",G.forEach(ct=>{ct(ke)})}function Pe(){if(A!=="pending")return;oe();const Oe=E.shift();if(Oe===void 0){if(F.length){D=setTimeout(()=>{oe(),A==="pending"&&(Ue(),Te())},t.timeout);return}Te();return}const Le={status:"pending",resource:Oe,callback:(ke,We)=>{Be(Le,ke,We)}};F.push(Le),k++,D=setTimeout(Pe,t.rotate),l(Oe,o,Le.callback)}return setTimeout(Pe),xe}function UC(t){const o={...GB,...t};let l=[];function f(){l=l.filter(s=>s().status==="pending")}function g(s,A,k){const R=ZB(o,s,A,(D,F)=>{f(),k&&k(D,F)});return l.push(R),R}function x(s){return l.find(A=>s(A))||null}return{query:g,find:x,setIndex:s=>{o.index=s},getIndex:()=>o.index,cleanup:f}}function n2(){}const j_=Object.create(null);function qB(t){if(!j_[t]){const o=Gv(t);if(!o)return;const l=UC(o),f={config:o,redundancy:l};j_[t]=f}return j_[t]}function WB(t,o,l){let f,g;if(typeof t=="string"){const x=Ay(t);if(!x)return l(void 0,424),n2;g=x.send;const E=qB(t);E&&(f=E.redundancy)}else{const x=Vv(t);if(x){f=UC(x);const E=t.resources?t.resources[0]:"",s=Ay(E);s&&(g=s.send)}}return!f||!g?(l(void 0,424),n2):f.query(o,g,l)().abort}const i2="iconify2",jf="iconify",VC=jf+"-count",r2=jf+"-version",$C=36e5,HB=168;function Iy(t,o){try{return t.getItem(o)}catch{}}function Zv(t,o,l){try{return t.setItem(o,l),!0}catch{}}function o2(t,o){try{t.removeItem(o)}catch{}}function Py(t,o){return Zv(t,VC,o.toString())}function zy(t){return parseInt(Iy(t,VC))||0}const Lm={local:!0,session:!0},GC={local:new Set,session:new Set};let qv=!1;function XB(t){qv=t}let Rp=typeof window>"u"?{}:window;function ZC(t){const o=t+"Storage";try{if(Rp&&Rp[o]&&typeof Rp[o].length=="number")return Rp[o]}catch{}Lm[t]=!1}function qC(t,o){const l=ZC(t);if(!l)return;const f=Iy(l,r2);if(f!==i2){if(f){const s=zy(l);for(let A=0;A<s;A++)o2(l,jf+A.toString())}Zv(l,r2,i2),Py(l,0);return}const g=Math.floor(Date.now()/$C)-HB,x=s=>{const A=jf+s.toString(),k=Iy(l,A);if(typeof k=="string"){try{const R=JSON.parse(k);if(typeof R=="object"&&typeof R.cached=="number"&&R.cached>g&&typeof R.provider=="string"&&typeof R.data=="object"&&typeof R.data.prefix=="string"&&o(R,s))return!0}catch{}o2(l,A)}};let E=zy(l);for(let s=E-1;s>=0;s--)x(s)||(s===E-1?(E--,Py(l,E)):GC[t].add(s))}function WC(){if(!qv){XB(!0);for(const t in Lm)qC(t,o=>{const l=o.data,f=o.provider,g=l.prefix,x=zl(f,g);if(!Uv(x,l).length)return!1;const E=l.lastModified||-1;return x.lastModifiedCached=x.lastModifiedCached?Math.min(x.lastModifiedCached,E):E,!0})}}function KB(t,o){const l=t.lastModifiedCached;if(l&&l>=o)return l===o;if(t.lastModifiedCached=o,l)for(const f in Lm)qC(f,g=>{const x=g.data;return g.provider!==t.provider||x.prefix!==t.prefix||x.lastModified===o});return!0}function YB(t,o){qv||WC();function l(f){let g;if(!Lm[f]||!(g=ZC(f)))return;const x=GC[f];let E;if(x.size)x.delete(E=Array.from(x).shift());else if(E=zy(g),!Py(g,E+1))return;const s={cached:Math.floor(Date.now()/$C),provider:t.provider,data:o};return Zv(g,jf+E.toString(),JSON.stringify(s))}o.lastModified&&!KB(t,o.lastModified)||!Object.keys(o.icons).length||(o.not_found&&(o=Object.assign({},o),delete o.not_found),l("local")||l("session"))}function s2(){}function JB(t){t.iconsLoaderFlag||(t.iconsLoaderFlag=!0,setTimeout(()=>{t.iconsLoaderFlag=!1,NB(t)}))}function QB(t,o){t.iconsToLoad?t.iconsToLoad=t.iconsToLoad.concat(o).sort():t.iconsToLoad=o,t.iconsQueueFlag||(t.iconsQueueFlag=!0,setTimeout(()=>{t.iconsQueueFlag=!1;const{provider:l,prefix:f}=t,g=t.iconsToLoad;delete t.iconsToLoad;let x;if(!g||!(x=Ay(l)))return;x.prepare(l,f,g).forEach(s=>{WB(l,s,(A,k)=>{if(typeof A!="object"){if(k!==404)return;s.icons.forEach(R=>{t.missing.add(R)})}else try{const R=Uv(t,A);if(!R.length)return;const D=t.pendingIcons;D&&R.forEach(F=>{D.delete(F)}),YB(t,A)}catch(R){console.error(R)}JB(t)})})}))}const eF=(t,o)=>{const l=$B(t,!0,RC()),f=jB(l);if(!f.pending.length){let A=!0;return o&&setTimeout(()=>{A&&o(f.loaded,f.missing,f.pending,s2)}),()=>{A=!1}}const g=Object.create(null),x=[];let E,s;return f.pending.forEach(A=>{const{provider:k,prefix:R}=A;if(R===s&&k===E)return;E=k,s=R,x.push(zl(k,R));const D=g[k]||(g[k]=Object.create(null));D[R]||(D[R]=[])}),f.pending.forEach(A=>{const{provider:k,prefix:R,name:D}=A,F=zl(k,R),G=F.pendingIcons||(F.pendingIcons=new Set);G.has(D)||(G.add(D),g[k][R].push(D))}),x.forEach(A=>{const{provider:k,prefix:R}=A;g[k][R].length&&QB(A,g[k][R])}),o?VB(o,f,x):s2};function tF(t,o){const l={...t};for(const f in o){const g=o[f],x=typeof g;f in FC?(g===null||g&&(x==="string"||x==="number"))&&(l[f]=g):x===typeof l[f]&&(l[f]=f==="rotate"?g%4:g)}return l}const nF=/[\s,]+/;function iF(t,o){o.split(nF).forEach(l=>{switch(l.trim()){case"horizontal":t.hFlip=!0;break;case"vertical":t.vFlip=!0;break}})}function rF(t,o=0){const l=t.replace(/^-?[0-9.]*/,"");function f(g){for(;g<0;)g+=4;return g%4}if(l===""){const g=parseInt(t);return isNaN(g)?0:f(g)}else if(l!==t){let g=0;switch(l){case"%":g=25;break;case"deg":g=90}if(g){let x=parseFloat(t.slice(0,t.length-l.length));return isNaN(x)?0:(x=x/g,x%1===0?f(x):0)}}return o}function oF(t,o){let l=t.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const f in o)l+=" "+f+'="'+o[f]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+l+">"+t+"</svg>"}function sF(t){return t.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function aF(t){return'url("data:image/svg+xml,'+sF(t)+'")'}const a2={...jC,inline:!1},lF={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},cF={display:"inline-block"},Oy={backgroundColor:"currentColor"},HC={backgroundColor:"transparent"},l2={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},c2={webkitMask:Oy,mask:Oy,background:HC};for(const t in c2){const o=c2[t];for(const l in l2)o[t+l]=l2[l]}const Qp={};["horizontal","vertical"].forEach(t=>{const o=t.slice(0,1)+"Flip";Qp[t+"-flip"]=o,Qp[t.slice(0,1)+"-flip"]=o,Qp[t+"Flip"]=o});function u2(t){return t+(t.match(/^[-0-9.]+$/)?"px":"")}const h2=(t,o)=>{const l=tF(a2,o),f={...lF},g=o.mode||"svg",x={},E=o.style,s=typeof E=="object"&&!(E instanceof Array)?E:{};for(let se in o){const we=o[se];if(we!==void 0)switch(se){case"icon":case"style":case"onLoad":case"mode":break;case"inline":case"hFlip":case"vFlip":l[se]=we===!0||we==="true"||we===1;break;case"flip":typeof we=="string"&&iF(l,we);break;case"color":x.color=we;break;case"rotate":typeof we=="string"?l[se]=rF(we):typeof we=="number"&&(l[se]=we);break;case"ariaHidden":case"aria-hidden":we!==!0&&we!=="true"&&delete f["aria-hidden"];break;default:{const xe=Qp[se];xe?(we===!0||we==="true"||we===1)&&(l[xe]=!0):a2[se]===void 0&&(f[se]=we)}}}const A=CB(t,l),k=A.attributes;if(l.inline&&(x.verticalAlign="-0.125em"),g==="svg"){f.style={...x,...s},Object.assign(f,k);let se=0,we=o.id;return typeof we=="string"&&(we=we.replace(/-/g,"_")),f.innerHTML=IB(A.body,we?()=>we+"ID"+se++:"iconifyVue"),Ml("svg",f)}const{body:R,width:D,height:F}=t,G=g==="mask"||(g==="bg"?!1:R.indexOf("currentColor")!==-1),oe=oF(R,{...k,width:D+"",height:F+""});return f.style={...x,"--svg":aF(oe),width:u2(k.width),height:u2(k.height),...cF,...G?Oy:HC,...s},Ml("span",f)};RC(!0);PB("",FB);if(typeof document<"u"&&typeof window<"u"){WC();const t=window;if(t.IconifyPreload!==void 0){const o=t.IconifyPreload,l="Invalid IconifyPreload syntax.";typeof o=="object"&&o!==null&&(o instanceof Array?o:[o]).forEach(f=>{try{(typeof f!="object"||f===null||f instanceof Array||typeof f.icons!="object"||typeof f.prefix!="string"||!BC(f))&&console.error(l)}catch{console.error(l)}})}if(t.IconifyProviders!==void 0){const o=t.IconifyProviders;if(typeof o=="object"&&o!==null)for(let l in o){const f="IconifyProviders["+l+"] is invalid.";try{const g=o[l];if(typeof g!="object"||!g||g.resources===void 0)continue;zB(l,g)||console.error(f)}catch{console.error(f)}}}}const uF={...Dm,body:""},XC=On({inheritAttrs:!1,data(){return{iconMounted:!1,counter:0}},mounted(){this._name="",this._loadingIcon=null,this.iconMounted=!0},unmounted(){this.abortLoading()},methods:{abortLoading(){this._loadingIcon&&(this._loadingIcon.abort(),this._loadingIcon=null)},getIcon(t,o){if(typeof t=="object"&&t!==null&&typeof t.body=="string")return this._name="",this.abortLoading(),{data:t};let l;if(typeof t!="string"||(l=km(t,!1,!0))===null)return this.abortLoading(),null;const f=bB(l);if(!f)return(!this._loadingIcon||this._loadingIcon.name!==t)&&(this.abortLoading(),this._name="",f!==null&&(this._loadingIcon={name:t,abort:eF([l],()=>{this.counter++})})),null;this.abortLoading(),this._name!==t&&(this._name=t,o&&o(t));const g=["iconify"];return l.prefix!==""&&g.push("iconify--"+l.prefix),l.provider!==""&&g.push("iconify--"+l.provider),{data:f,classes:g}}},render(){this.counter;const t=this.$attrs,o=this.iconMounted?this.getIcon(t.icon,t.onLoad):null;if(!o)return h2(uF,t);let l=t;return o.classes&&(l={...t,class:(typeof t.class=="string"?t.class+" ":"")+o.classes.join(" ")}),h2({...Dm,...o.data},l)}}),hF=[{name:"Map",id:10,path:"/",icon:"icon:globe"},{name:"List",id:11,path:"/list",icon:"icon:table"},{name:"Setup",id:1,path:"/",icon:"icon:settings",subItems:[{name:"Sub 1",path:"/",icon:"icon:globe",id:2},{name:"Sub 2",icon:"icon:globe",path:"/",id:3},{name:"Sub 3",path:"/",icon:"icon:globe",id:4}]},{name:"Events",id:6,icon:"icon:notification",subItems:[{name:"Sub 1",path:"/",icon:"icon:globe",id:7},{name:"Sub 2",icon:"icon:globe",path:"/",id:8},{name:"Sub 3",icon:"icon:globe",path:"/",id:9}]},{name:"Help",id:5,path:"/help",icon:"icon:help"}];/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const $c=typeof window<"u";function fF(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const ti=Object.assign;function N_(t,o){const l={};for(const f in o){const g=o[f];l[f]=po(g)?g.map(t):t(g)}return l}const mf=()=>{},po=Array.isArray,dF=/\/$/,pF=t=>t.replace(dF,"");function U_(t,o,l="/"){let f,g={},x="",E="";const s=o.indexOf("#");let A=o.indexOf("?");return s<A&&s>=0&&(A=-1),A>-1&&(f=o.slice(0,A),x=o.slice(A+1,s>-1?s:o.length),g=t(x)),s>-1&&(f=f||o.slice(0,s),E=o.slice(s,o.length)),f=yF(f!=null?f:o,l),{fullPath:f+(x&&"?")+x+E,path:f,query:g,hash:E}}function mF(t,o){const l=o.query?t(o.query):"";return o.path+(l&&"?")+l+(o.hash||"")}function f2(t,o){return!o||!t.toLowerCase().startsWith(o.toLowerCase())?t:t.slice(o.length)||"/"}function gF(t,o,l){const f=o.matched.length-1,g=l.matched.length-1;return f>-1&&f===g&&au(o.matched[f],l.matched[g])&&KC(o.params,l.params)&&t(o.query)===t(l.query)&&o.hash===l.hash}function au(t,o){return(t.aliasOf||t)===(o.aliasOf||o)}function KC(t,o){if(Object.keys(t).length!==Object.keys(o).length)return!1;for(const l in t)if(!_F(t[l],o[l]))return!1;return!0}function _F(t,o){return po(t)?d2(t,o):po(o)?d2(o,t):t===o}function d2(t,o){return po(o)?t.length===o.length&&t.every((l,f)=>l===o[f]):t.length===1&&t[0]===o}function yF(t,o){if(t.startsWith("/"))return t;if(!t)return o;const l=o.split("/"),f=t.split("/");let g=l.length-1,x,E;for(x=0;x<f.length;x++)if(E=f[x],E!==".")if(E==="..")g>1&&g--;else break;return l.slice(0,g).join("/")+"/"+f.slice(x-(x===f.length?1:0)).join("/")}var Nf;(function(t){t.pop="pop",t.push="push"})(Nf||(Nf={}));var gf;(function(t){t.back="back",t.forward="forward",t.unknown=""})(gf||(gf={}));function vF(t){if(!t)if($c){const o=document.querySelector("base");t=o&&o.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),pF(t)}const xF=/^[^#]+#/;function bF(t,o){return t.replace(xF,"#")+o}function wF(t,o){const l=document.documentElement.getBoundingClientRect(),f=t.getBoundingClientRect();return{behavior:o.behavior,left:f.left-l.left-(o.left||0),top:f.top-l.top-(o.top||0)}}const Rm=()=>({left:window.pageXOffset,top:window.pageYOffset});function TF(t){let o;if("el"in t){const l=t.el,f=typeof l=="string"&&l.startsWith("#"),g=typeof l=="string"?f?document.getElementById(l.slice(1)):document.querySelector(l):l;if(!g)return;o=wF(g,t)}else o=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(o):window.scrollTo(o.left!=null?o.left:window.pageXOffset,o.top!=null?o.top:window.pageYOffset)}function p2(t,o){return(history.state?history.state.position-o:-1)+t}const ky=new Map;function EF(t,o){ky.set(t,o)}function CF(t){const o=ky.get(t);return ky.delete(t),o}let SF=()=>location.protocol+"//"+location.host;function YC(t,o){const{pathname:l,search:f,hash:g}=o,x=t.indexOf("#");if(x>-1){let s=g.includes(t.slice(x))?t.slice(x).length:1,A=g.slice(s);return A[0]!=="/"&&(A="/"+A),f2(A,"")}return f2(l,t)+f+g}function MF(t,o,l,f){let g=[],x=[],E=null;const s=({state:F})=>{const G=YC(t,location),oe=l.value,se=o.value;let we=0;if(F){if(l.value=G,o.value=F,E&&E===oe){E=null;return}we=se?F.position-se.position:0}else f(G);g.forEach(xe=>{xe(l.value,oe,{delta:we,type:Nf.pop,direction:we?we>0?gf.forward:gf.back:gf.unknown})})};function A(){E=l.value}function k(F){g.push(F);const G=()=>{const oe=g.indexOf(F);oe>-1&&g.splice(oe,1)};return x.push(G),G}function R(){const{history:F}=window;!F.state||F.replaceState(ti({},F.state,{scroll:Rm()}),"")}function D(){for(const F of x)F();x=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",R)}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",R),{pauseListeners:A,listen:k,destroy:D}}function m2(t,o,l,f=!1,g=!1){return{back:t,current:o,forward:l,replaced:f,position:window.history.length,scroll:g?Rm():null}}function AF(t){const{history:o,location:l}=window,f={value:YC(t,l)},g={value:o.state};g.value||x(f.value,{back:null,current:f.value,forward:null,position:o.length-1,replaced:!0,scroll:null},!0);function x(A,k,R){const D=t.indexOf("#"),F=D>-1?(l.host&&document.querySelector("base")?t:t.slice(D))+A:SF()+t+A;try{o[R?"replaceState":"pushState"](k,"",F),g.value=k}catch(G){console.error(G),l[R?"replace":"assign"](F)}}function E(A,k){const R=ti({},o.state,m2(g.value.back,A,g.value.forward,!0),k,{position:g.value.position});x(A,R,!0),f.value=A}function s(A,k){const R=ti({},g.value,o.state,{forward:A,scroll:Rm()});x(R.current,R,!0);const D=ti({},m2(f.value,A,null),{position:R.position+1},k);x(A,D,!1),f.value=A}return{location:f,state:g,push:s,replace:E}}function IF(t){t=vF(t);const o=AF(t),l=MF(t,o.state,o.location,o.replace);function f(x,E=!0){E||l.pauseListeners(),history.go(x)}const g=ti({location:"",base:t,go:f,createHref:bF.bind(null,t)},o,l);return Object.defineProperty(g,"location",{enumerable:!0,get:()=>o.location.value}),Object.defineProperty(g,"state",{enumerable:!0,get:()=>o.state.value}),g}function PF(t){return typeof t=="string"||t&&typeof t=="object"}function JC(t){return typeof t=="string"||typeof t=="symbol"}const ia={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},QC=Symbol("");var g2;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(g2||(g2={}));function lu(t,o){return ti(new Error,{type:t,[QC]:!0},o)}function ds(t,o){return t instanceof Error&&QC in t&&(o==null||!!(t.type&o))}const _2="[^/]+?",zF={sensitive:!1,strict:!1,start:!0,end:!0},OF=/[.+*?^${}()[\]/\\]/g;function kF(t,o){const l=ti({},zF,o),f=[];let g=l.start?"^":"";const x=[];for(const k of t){const R=k.length?[]:[90];l.strict&&!k.length&&(g+="/");for(let D=0;D<k.length;D++){const F=k[D];let G=40+(l.sensitive?.25:0);if(F.type===0)D||(g+="/"),g+=F.value.replace(OF,"\\$&"),G+=40;else if(F.type===1){const{value:oe,repeatable:se,optional:we,regexp:xe}=F;x.push({name:oe,repeatable:se,optional:we});const Te=xe||_2;if(Te!==_2){G+=10;try{new RegExp(`(${Te})`)}catch(Be){throw new Error(`Invalid custom RegExp for param "${oe}" (${Te}): `+Be.message)}}let Ue=se?`((?:${Te})(?:/(?:${Te}))*)`:`(${Te})`;D||(Ue=we&&k.length<2?`(?:/${Ue})`:"/"+Ue),we&&(Ue+="?"),g+=Ue,G+=20,we&&(G+=-8),se&&(G+=-20),Te===".*"&&(G+=-50)}R.push(G)}f.push(R)}if(l.strict&&l.end){const k=f.length-1;f[k][f[k].length-1]+=.7000000000000001}l.strict||(g+="/?"),l.end?g+="$":l.strict&&(g+="(?:/|$)");const E=new RegExp(g,l.sensitive?"":"i");function s(k){const R=k.match(E),D={};if(!R)return null;for(let F=1;F<R.length;F++){const G=R[F]||"",oe=x[F-1];D[oe.name]=G&&oe.repeatable?G.split("/"):G}return D}function A(k){let R="",D=!1;for(const F of t){(!D||!R.endsWith("/"))&&(R+="/"),D=!1;for(const G of F)if(G.type===0)R+=G.value;else if(G.type===1){const{value:oe,repeatable:se,optional:we}=G,xe=oe in k?k[oe]:"";if(po(xe)&&!se)throw new Error(`Provided param "${oe}" is an array but it is not repeatable (* or + modifiers)`);const Te=po(xe)?xe.join("/"):xe;if(!Te)if(we)F.length<2&&(R.endsWith("/")?R=R.slice(0,-1):D=!0);else throw new Error(`Missing required param "${oe}"`);R+=Te}}return R||"/"}return{re:E,score:f,keys:x,parse:s,stringify:A}}function DF(t,o){let l=0;for(;l<t.length&&l<o.length;){const f=o[l]-t[l];if(f)return f;l++}return t.length<o.length?t.length===1&&t[0]===40+40?-1:1:t.length>o.length?o.length===1&&o[0]===40+40?1:-1:0}function LF(t,o){let l=0;const f=t.score,g=o.score;for(;l<f.length&&l<g.length;){const x=DF(f[l],g[l]);if(x)return x;l++}if(Math.abs(g.length-f.length)===1){if(y2(f))return 1;if(y2(g))return-1}return g.length-f.length}function y2(t){const o=t[t.length-1];return t.length>0&&o[o.length-1]<0}const RF={type:0,value:""},BF=/[a-zA-Z0-9_]/;function FF(t){if(!t)return[[]];if(t==="/")return[[RF]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function o(G){throw new Error(`ERR (${l})/"${k}": ${G}`)}let l=0,f=l;const g=[];let x;function E(){x&&g.push(x),x=[]}let s=0,A,k="",R="";function D(){!k||(l===0?x.push({type:0,value:k}):l===1||l===2||l===3?(x.length>1&&(A==="*"||A==="+")&&o(`A repeatable param (${k}) must be alone in its segment. eg: '/:ids+.`),x.push({type:1,value:k,regexp:R,repeatable:A==="*"||A==="+",optional:A==="*"||A==="?"})):o("Invalid state to consume buffer"),k="")}function F(){k+=A}for(;s<t.length;){if(A=t[s++],A==="\\"&&l!==2){f=l,l=4;continue}switch(l){case 0:A==="/"?(k&&D(),E()):A===":"?(D(),l=1):F();break;case 4:F(),l=f;break;case 1:A==="("?l=2:BF.test(A)?F():(D(),l=0,A!=="*"&&A!=="?"&&A!=="+"&&s--);break;case 2:A===")"?R[R.length-1]=="\\"?R=R.slice(0,-1)+A:l=3:R+=A;break;case 3:D(),l=0,A!=="*"&&A!=="?"&&A!=="+"&&s--,R="";break;default:o("Unknown state");break}}return l===2&&o(`Unfinished custom RegExp for param "${k}"`),D(),E(),g}function jF(t,o,l){const f=kF(FF(t.path),l),g=ti(f,{record:t,parent:o,children:[],alias:[]});return o&&!g.record.aliasOf==!o.record.aliasOf&&o.children.push(g),g}function NF(t,o){const l=[],f=new Map;o=b2({strict:!1,end:!0,sensitive:!1},o);function g(R){return f.get(R)}function x(R,D,F){const G=!F,oe=UF(R);oe.aliasOf=F&&F.record;const se=b2(o,R),we=[oe];if("alias"in R){const Ue=typeof R.alias=="string"?[R.alias]:R.alias;for(const Be of Ue)we.push(ti({},oe,{components:F?F.record.components:oe.components,path:Be,aliasOf:F?F.record:oe}))}let xe,Te;for(const Ue of we){const{path:Be}=Ue;if(D&&Be[0]!=="/"){const Pe=D.record.path,Oe=Pe[Pe.length-1]==="/"?"":"/";Ue.path=D.record.path+(Be&&Oe+Be)}if(xe=jF(Ue,D,se),F?F.alias.push(xe):(Te=Te||xe,Te!==xe&&Te.alias.push(xe),G&&R.name&&!x2(xe)&&E(R.name)),oe.children){const Pe=oe.children;for(let Oe=0;Oe<Pe.length;Oe++)x(Pe[Oe],xe,F&&F.children[Oe])}F=F||xe,A(xe)}return Te?()=>{E(Te)}:mf}function E(R){if(JC(R)){const D=f.get(R);D&&(f.delete(R),l.splice(l.indexOf(D),1),D.children.forEach(E),D.alias.forEach(E))}else{const D=l.indexOf(R);D>-1&&(l.splice(D,1),R.record.name&&f.delete(R.record.name),R.children.forEach(E),R.alias.forEach(E))}}function s(){return l}function A(R){let D=0;for(;D<l.length&&LF(R,l[D])>=0&&(R.record.path!==l[D].record.path||!eS(R,l[D]));)D++;l.splice(D,0,R),R.record.name&&!x2(R)&&f.set(R.record.name,R)}function k(R,D){let F,G={},oe,se;if("name"in R&&R.name){if(F=f.get(R.name),!F)throw lu(1,{location:R});se=F.record.name,G=ti(v2(D.params,F.keys.filter(Te=>!Te.optional).map(Te=>Te.name)),R.params&&v2(R.params,F.keys.map(Te=>Te.name))),oe=F.stringify(G)}else if("path"in R)oe=R.path,F=l.find(Te=>Te.re.test(oe)),F&&(G=F.parse(oe),se=F.record.name);else{if(F=D.name?f.get(D.name):l.find(Te=>Te.re.test(D.path)),!F)throw lu(1,{location:R,currentLocation:D});se=F.record.name,G=ti({},D.params,R.params),oe=F.stringify(G)}const we=[];let xe=F;for(;xe;)we.unshift(xe.record),xe=xe.parent;return{name:se,path:oe,params:G,matched:we,meta:$F(we)}}return t.forEach(R=>x(R)),{addRoute:x,resolve:k,removeRoute:E,getRoutes:s,getRecordMatcher:g}}function v2(t,o){const l={};for(const f of o)f in t&&(l[f]=t[f]);return l}function UF(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:VF(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function VF(t){const o={},l=t.props||!1;if("component"in t)o.default=l;else for(const f in t.components)o[f]=typeof l=="boolean"?l:l[f];return o}function x2(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function $F(t){return t.reduce((o,l)=>ti(o,l.meta),{})}function b2(t,o){const l={};for(const f in t)l[f]=f in o?o[f]:t[f];return l}function eS(t,o){return o.children.some(l=>l===t||eS(t,l))}const tS=/#/g,GF=/&/g,ZF=/\//g,qF=/=/g,WF=/\?/g,nS=/\+/g,HF=/%5B/g,XF=/%5D/g,iS=/%5E/g,KF=/%60/g,rS=/%7B/g,YF=/%7C/g,oS=/%7D/g,JF=/%20/g;function Wv(t){return encodeURI(""+t).replace(YF,"|").replace(HF,"[").replace(XF,"]")}function QF(t){return Wv(t).replace(rS,"{").replace(oS,"}").replace(iS,"^")}function Dy(t){return Wv(t).replace(nS,"%2B").replace(JF,"+").replace(tS,"%23").replace(GF,"%26").replace(KF,"`").replace(rS,"{").replace(oS,"}").replace(iS,"^")}function e6(t){return Dy(t).replace(qF,"%3D")}function t6(t){return Wv(t).replace(tS,"%23").replace(WF,"%3F")}function n6(t){return t==null?"":t6(t).replace(ZF,"%2F")}function dm(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function i6(t){const o={};if(t===""||t==="?")return o;const f=(t[0]==="?"?t.slice(1):t).split("&");for(let g=0;g<f.length;++g){const x=f[g].replace(nS," "),E=x.indexOf("="),s=dm(E<0?x:x.slice(0,E)),A=E<0?null:dm(x.slice(E+1));if(s in o){let k=o[s];po(k)||(k=o[s]=[k]),k.push(A)}else o[s]=A}return o}function w2(t){let o="";for(let l in t){const f=t[l];if(l=e6(l),f==null){f!==void 0&&(o+=(o.length?"&":"")+l);continue}(po(f)?f.map(x=>x&&Dy(x)):[f&&Dy(f)]).forEach(x=>{x!==void 0&&(o+=(o.length?"&":"")+l,x!=null&&(o+="="+x))})}return o}function r6(t){const o={};for(const l in t){const f=t[l];f!==void 0&&(o[l]=po(f)?f.map(g=>g==null?null:""+g):f==null?f:""+f)}return o}const o6=Symbol(""),T2=Symbol(""),Bm=Symbol(""),sS=Symbol(""),Ly=Symbol("");function ef(){let t=[];function o(f){return t.push(f),()=>{const g=t.indexOf(f);g>-1&&t.splice(g,1)}}function l(){t=[]}return{add:o,list:()=>t,reset:l}}function sa(t,o,l,f,g){const x=f&&(f.enterCallbacks[g]=f.enterCallbacks[g]||[]);return()=>new Promise((E,s)=>{const A=D=>{D===!1?s(lu(4,{from:l,to:o})):D instanceof Error?s(D):PF(D)?s(lu(2,{from:o,to:D})):(x&&f.enterCallbacks[g]===x&&typeof D=="function"&&x.push(D),E())},k=t.call(f&&f.instances[g],o,l,A);let R=Promise.resolve(k);t.length<3&&(R=R.then(A)),R.catch(D=>s(D))})}function V_(t,o,l,f){const g=[];for(const x of t)for(const E in x.components){let s=x.components[E];if(!(o!=="beforeRouteEnter"&&!x.instances[E]))if(s6(s)){const k=(s.__vccOpts||s)[o];k&&g.push(sa(k,l,f,x,E))}else{let A=s();g.push(()=>A.then(k=>{if(!k)return Promise.reject(new Error(`Couldn't resolve component "${E}" at "${x.path}"`));const R=fF(k)?k.default:k;x.components[E]=R;const F=(R.__vccOpts||R)[o];return F&&sa(F,l,f,x,E)()}))}}return g}function s6(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function E2(t){const o=vi(Bm),l=vi(sS),f=yt(()=>o.resolve(No(t.to))),g=yt(()=>{const{matched:A}=f.value,{length:k}=A,R=A[k-1],D=l.matched;if(!R||!D.length)return-1;const F=D.findIndex(au.bind(null,R));if(F>-1)return F;const G=C2(A[k-2]);return k>1&&C2(R)===G&&D[D.length-1].path!==G?D.findIndex(au.bind(null,A[k-2])):F}),x=yt(()=>g.value>-1&&u6(l.params,f.value.params)),E=yt(()=>g.value>-1&&g.value===l.matched.length-1&&KC(l.params,f.value.params));function s(A={}){return c6(A)?o[No(t.replace)?"replace":"push"](No(t.to)).catch(mf):Promise.resolve()}return{route:f,href:yt(()=>f.value.href),isActive:x,isExactActive:E,navigate:s}}const a6=On({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:E2,setup(t,{slots:o}){const l=mr(E2(t)),{options:f}=vi(Bm),g=yt(()=>({[S2(t.activeClass,f.linkActiveClass,"router-link-active")]:l.isActive,[S2(t.exactActiveClass,f.linkExactActiveClass,"router-link-exact-active")]:l.isExactActive}));return()=>{const x=o.default&&o.default(l);return t.custom?x:Ml("a",{"aria-current":l.isExactActive?t.ariaCurrentValue:null,href:l.href,onClick:l.navigate,class:g.value},x)}}}),l6=a6;function c6(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const o=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(o))return}return t.preventDefault&&t.preventDefault(),!0}}function u6(t,o){for(const l in o){const f=o[l],g=t[l];if(typeof f=="string"){if(f!==g)return!1}else if(!po(g)||g.length!==f.length||f.some((x,E)=>x!==g[E]))return!1}return!0}function C2(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const S2=(t,o,l)=>t!=null?t:o!=null?o:l,h6=On({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:o,slots:l}){const f=vi(Ly),g=yt(()=>t.route||f.value),x=vi(T2,0),E=yt(()=>{let k=No(x);const{matched:R}=g.value;let D;for(;(D=R[k])&&!D.components;)k++;return k}),s=yt(()=>g.value.matched[E.value]);Xi(T2,yt(()=>E.value+1)),Xi(o6,s),Xi(Ly,g);const A=Gt();return Wn(()=>[A.value,s.value,t.name],([k,R,D],[F,G,oe])=>{R&&(R.instances[D]=k,G&&G!==R&&k&&k===F&&(R.leaveGuards.size||(R.leaveGuards=G.leaveGuards),R.updateGuards.size||(R.updateGuards=G.updateGuards))),k&&R&&(!G||!au(R,G)||!F)&&(R.enterCallbacks[D]||[]).forEach(se=>se(k))},{flush:"post"}),()=>{const k=g.value,R=t.name,D=s.value,F=D&&D.components[R];if(!F)return M2(l.default,{Component:F,route:k});const G=D.props[R],oe=G?G===!0?k.params:typeof G=="function"?G(k):G:null,we=Ml(F,ti({},oe,o,{onVnodeUnmounted:xe=>{xe.component.isUnmounted&&(D.instances[R]=null)},ref:A}));return M2(l.default,{Component:we,route:k})||we}}});function M2(t,o){if(!t)return null;const l=t(o);return l.length===1?l[0]:l}const f6=h6;function d6(t){const o=NF(t.routes,t),l=t.parseQuery||i6,f=t.stringifyQuery||w2,g=t.history,x=ef(),E=ef(),s=ef(),A=EI(ia);let k=ia;$c&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const R=N_.bind(null,be=>""+be),D=N_.bind(null,n6),F=N_.bind(null,dm);function G(be,Xe){let ut,bt;return JC(be)?(ut=o.getRecordMatcher(be),bt=Xe):bt=be,o.addRoute(bt,ut)}function oe(be){const Xe=o.getRecordMatcher(be);Xe&&o.removeRoute(Xe)}function se(){return o.getRoutes().map(be=>be.record)}function we(be){return!!o.getRecordMatcher(be)}function xe(be,Xe){if(Xe=ti({},Xe||A.value),typeof be=="string"){const ie=U_(l,be,Xe.path),ye=o.resolve({path:ie.path},Xe),Ae=g.createHref(ie.fullPath);return ti(ie,ye,{params:F(ye.params),hash:dm(ie.hash),redirectedFrom:void 0,href:Ae})}let ut;if("path"in be)ut=ti({},be,{path:U_(l,be.path,Xe.path).path});else{const ie=ti({},be.params);for(const ye in ie)ie[ye]==null&&delete ie[ye];ut=ti({},be,{params:D(be.params)}),Xe.params=D(Xe.params)}const bt=o.resolve(ut,Xe),Yt=be.hash||"";bt.params=R(F(bt.params));const en=mF(f,ti({},be,{hash:QF(Yt),path:bt.path})),qt=g.createHref(en);return ti({fullPath:en,hash:Yt,query:f===w2?r6(be.query):be.query||{}},bt,{redirectedFrom:void 0,href:qt})}function Te(be){return typeof be=="string"?U_(l,be,A.value.path):ti({},be)}function Ue(be,Xe){if(k!==be)return lu(8,{from:Xe,to:be})}function Be(be){return Le(be)}function Pe(be){return Be(ti(Te(be),{replace:!0}))}function Oe(be){const Xe=be.matched[be.matched.length-1];if(Xe&&Xe.redirect){const{redirect:ut}=Xe;let bt=typeof ut=="function"?ut(be):ut;return typeof bt=="string"&&(bt=bt.includes("?")||bt.includes("#")?bt=Te(bt):{path:bt},bt.params={}),ti({query:be.query,hash:be.hash,params:"path"in bt?{}:be.params},bt)}}function Le(be,Xe){const ut=k=xe(be),bt=A.value,Yt=be.state,en=be.force,qt=be.replace===!0,ie=Oe(ut);if(ie)return Le(ti(Te(ie),{state:typeof ie=="object"?ti({},Yt,ie.state):Yt,force:en,replace:qt}),Xe||ut);const ye=ut;ye.redirectedFrom=Xe;let Ae;return!en&&gF(f,bt,ut)&&(Ae=lu(16,{to:ye,from:bt}),ln(bt,bt,!0,!1)),(Ae?Promise.resolve(Ae):We(ye,bt)).catch(qe=>ds(qe)?ds(qe,2)?qe:Ft(qe):at(qe,ye,bt)).then(qe=>{if(qe){if(ds(qe,2))return Le(ti({replace:qt},Te(qe.to),{state:typeof qe.to=="object"?ti({},Yt,qe.to.state):Yt,force:en}),Xe||ye)}else qe=Tt(ye,bt,!0,qt,Yt);return ct(ye,bt,qe),qe})}function ke(be,Xe){const ut=Ue(be,Xe);return ut?Promise.reject(ut):Promise.resolve()}function We(be,Xe){let ut;const[bt,Yt,en]=p6(be,Xe);ut=V_(bt.reverse(),"beforeRouteLeave",be,Xe);for(const ie of bt)ie.leaveGuards.forEach(ye=>{ut.push(sa(ye,be,Xe))});const qt=ke.bind(null,be,Xe);return ut.push(qt),jc(ut).then(()=>{ut=[];for(const ie of x.list())ut.push(sa(ie,be,Xe));return ut.push(qt),jc(ut)}).then(()=>{ut=V_(Yt,"beforeRouteUpdate",be,Xe);for(const ie of Yt)ie.updateGuards.forEach(ye=>{ut.push(sa(ye,be,Xe))});return ut.push(qt),jc(ut)}).then(()=>{ut=[];for(const ie of be.matched)if(ie.beforeEnter&&!Xe.matched.includes(ie))if(po(ie.beforeEnter))for(const ye of ie.beforeEnter)ut.push(sa(ye,be,Xe));else ut.push(sa(ie.beforeEnter,be,Xe));return ut.push(qt),jc(ut)}).then(()=>(be.matched.forEach(ie=>ie.enterCallbacks={}),ut=V_(en,"beforeRouteEnter",be,Xe),ut.push(qt),jc(ut))).then(()=>{ut=[];for(const ie of E.list())ut.push(sa(ie,be,Xe));return ut.push(qt),jc(ut)}).catch(ie=>ds(ie,8)?ie:Promise.reject(ie))}function ct(be,Xe,ut){for(const bt of s.list())bt(be,Xe,ut)}function Tt(be,Xe,ut,bt,Yt){const en=Ue(be,Xe);if(en)return en;const qt=Xe===ia,ie=$c?history.state:{};ut&&(bt||qt?g.replace(be.fullPath,ti({scroll:qt&&ie&&ie.scroll},Yt)):g.push(be.fullPath,Yt)),A.value=be,ln(be,Xe,ut,qt),Ft()}let st;function Ge(){st||(st=g.listen((be,Xe,ut)=>{if(!xt.listening)return;const bt=xe(be),Yt=Oe(bt);if(Yt){Le(ti(Yt,{replace:!0}),bt).catch(mf);return}k=bt;const en=A.value;$c&&EF(p2(en.fullPath,ut.delta),Rm()),We(bt,en).catch(qt=>ds(qt,12)?qt:ds(qt,2)?(Le(qt.to,bt).then(ie=>{ds(ie,20)&&!ut.delta&&ut.type===Nf.pop&&g.go(-1,!1)}).catch(mf),Promise.reject()):(ut.delta&&g.go(-ut.delta,!1),at(qt,bt,en))).then(qt=>{qt=qt||Tt(bt,en,!1),qt&&(ut.delta&&!ds(qt,8)?g.go(-ut.delta,!1):ut.type===Nf.pop&&ds(qt,20)&&g.go(-1,!1)),ct(bt,en,qt)}).catch(mf)}))}let Ne=ef(),vt=ef(),rt;function at(be,Xe,ut){Ft(be);const bt=vt.list();return bt.length?bt.forEach(Yt=>Yt(be,Xe,ut)):console.error(be),Promise.reject(be)}function ht(){return rt&&A.value!==ia?Promise.resolve():new Promise((be,Xe)=>{Ne.add([be,Xe])})}function Ft(be){return rt||(rt=!be,Ge(),Ne.list().forEach(([Xe,ut])=>be?ut(be):Xe()),Ne.reset()),be}function ln(be,Xe,ut,bt){const{scrollBehavior:Yt}=t;if(!$c||!Yt)return Promise.resolve();const en=!ut&&CF(p2(be.fullPath,0))||(bt||!ut)&&history.state&&history.state.scroll||null;return vs().then(()=>Yt(be,Xe,en)).then(qt=>qt&&TF(qt)).catch(qt=>at(qt,be,Xe))}const pn=be=>g.go(be);let Lt;const nn=new Set,xt={currentRoute:A,listening:!0,addRoute:G,removeRoute:oe,hasRoute:we,getRoutes:se,resolve:xe,options:t,push:Be,replace:Pe,go:pn,back:()=>pn(-1),forward:()=>pn(1),beforeEach:x.add,beforeResolve:E.add,afterEach:s.add,onError:vt.add,isReady:ht,install(be){const Xe=this;be.component("RouterLink",l6),be.component("RouterView",f6),be.config.globalProperties.$router=Xe,Object.defineProperty(be.config.globalProperties,"$route",{enumerable:!0,get:()=>No(A)}),$c&&!Lt&&A.value===ia&&(Lt=!0,Be(g.location).catch(Yt=>{}));const ut={};for(const Yt in ia)ut[Yt]=yt(()=>A.value[Yt]);be.provide(Bm,Xe),be.provide(sS,mr(ut)),be.provide(Ly,A);const bt=be.unmount;nn.add(be),be.unmount=function(){nn.delete(be),nn.size<1&&(k=ia,st&&st(),st=null,A.value=ia,Lt=!1,rt=!1),bt()}}};return xt}function jc(t){return t.reduce((o,l)=>o.then(()=>l()),Promise.resolve())}function p6(t,o){const l=[],f=[],g=[],x=Math.max(o.matched.length,t.matched.length);for(let E=0;E<x;E++){const s=o.matched[E];s&&(t.matched.find(k=>au(k,s))?f.push(s):l.push(s));const A=t.matched[E];A&&(o.matched.find(k=>au(k,A))||g.push(A))}return[l,f,g]}function m6(){return vi(Bm)}const g6={components:{Icon:XC},setup(t,o){const l=m6(),f=mr({collapsed:!1,sidebarElements:hF}),g=()=>{f.collapsed=!f.collapsed},x=E=>{!E||setTimeout(()=>{l.push({path:E})},300)};return o.expose({toggleCollapsed:g,state:f}),{...tT(f),toggleCollapsed:g,navigate:x}}},Zf=(t,o)=>{const l=t.__vccOpts||t;for(const[f,g]of o)l[f]=g;return l},_6={class:"select-none"},y6={class:"select-none"};function v6(t,o,l,f,g,x){const E=jp("Icon"),s=Bf,A=su,k=ya,R=fB,D=nv("wave-animation");return fr(),wl(R,{collapsed:t.collapsed,"onUpdate:collapsed":o[0]||(o[0]=F=>t.collapsed=F),trigger:null,collapsible:""},{default:co(()=>[Me(k,{mode:"inline"},{default:co(()=>[(fr(!0),pa(yi,null,L1(t.sidebarElements,F=>(fr(),pa(yi,{key:F.id},[F.subItems&&F.subItems.length?(fr(),wl(A,{key:F.id},{title:co(()=>[la("span",_6,[Me(E,{class:"inline-block sidebar-icon",icon:F.icon,height:"20",width:"50"},null,8,["icon"]),Up(h_(F.name),1)])]),default:co(()=>[(fr(!0),pa(yi,null,L1(F.subItems,G=>(fr(),wl(s,{key:G.id,onClick:oe=>f.navigate(F.path)},{default:co(()=>[Qc(la("div",null,null,512),[[D]]),Up(" "+h_(G.name),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)):(fr(),wl(s,{key:"sub-"+F.id,onClick:G=>f.navigate(F.path)},{default:co(()=>[la("span",y6,[Qc(la("div",null,null,512),[[D]]),Me(E,{class:"inline-block sidebar-icon",icon:F.icon,height:"20",width:"50"},null,8,["icon"]),Up(h_(F.name),1)])]),_:2},1032,["onClick"]))],64))),128))]),_:1})]),_:1},8,["collapsed"])}const x6=Zf(g6,[["render",v6]]);var b6=!1;/*!
  * pinia v2.0.23
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let aS;const Fm=t=>aS=t,lS=Symbol();function Ry(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var _f;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(_f||(_f={}));function w6(){const t=F2(!0),o=t.run(()=>Gt({}));let l=[],f=[];const g=Jc({install(x){Fm(g),g._a=x,x.provide(lS,g),x.config.globalProperties.$pinia=g,f.forEach(E=>l.push(E)),f=[]},use(x){return!this._a&&!b6?f.push(x):l.push(x),this},_p:l,_a:null,_e:t,_s:new Map,state:o});return g}const cS=()=>{};function A2(t,o,l,f=cS){t.push(o);const g=()=>{const x=t.indexOf(o);x>-1&&(t.splice(x,1),f())};return!l&&kl()&&Ol(g),g}function Nc(t,...o){t.slice().forEach(l=>{l(...o)})}function By(t,o){t instanceof Map&&o instanceof Map&&o.forEach((l,f)=>t.set(f,l)),t instanceof Set&&o instanceof Set&&o.forEach(t.add,t);for(const l in o){if(!o.hasOwnProperty(l))continue;const f=o[l],g=t[l];Ry(g)&&Ry(f)&&t.hasOwnProperty(l)&&!Ei(f)&&!fa(f)?t[l]=By(g,f):t[l]=f}return t}const T6=Symbol();function E6(t){return!Ry(t)||!t.hasOwnProperty(T6)}const{assign:aa}=Object;function C6(t){return!!(Ei(t)&&t.effect)}function S6(t,o,l,f){const{state:g,actions:x,getters:E}=o,s=l.state.value[t];let A;function k(){s||(l.state.value[t]=g?g():{});const R=tT(l.state.value[t]);return aa(R,x,Object.keys(E||{}).reduce((D,F)=>(D[F]=Jc(yt(()=>{Fm(l);const G=l._s.get(t);return E[F].call(G,G)})),D),{}))}return A=uS(t,k,o,l,f,!0),A.$reset=function(){const D=g?g():{};this.$patch(F=>{aa(F,D)})},A}function uS(t,o,l={},f,g,x){let E;const s=aa({actions:{}},l),A={deep:!0};let k,R,D=Jc([]),F=Jc([]),G;const oe=f.state.value[t];!x&&!oe&&(f.state.value[t]={}),Gt({});let se;function we(Le){let ke;k=R=!1,typeof Le=="function"?(Le(f.state.value[t]),ke={type:_f.patchFunction,storeId:t,events:G}):(By(f.state.value[t],Le),ke={type:_f.patchObject,payload:Le,storeId:t,events:G});const We=se=Symbol();vs().then(()=>{se===We&&(k=!0)}),R=!0,Nc(D,ke,f.state.value[t])}const xe=cS;function Te(){E.stop(),D=[],F=[],f._s.delete(t)}function Ue(Le,ke){return function(){Fm(f);const We=Array.from(arguments),ct=[],Tt=[];function st(vt){ct.push(vt)}function Ge(vt){Tt.push(vt)}Nc(F,{args:We,name:Le,store:Pe,after:st,onError:Ge});let Ne;try{Ne=ke.apply(this&&this.$id===t?this:Pe,We)}catch(vt){throw Nc(Tt,vt),vt}return Ne instanceof Promise?Ne.then(vt=>(Nc(ct,vt),vt)).catch(vt=>(Nc(Tt,vt),Promise.reject(vt))):(Nc(ct,Ne),Ne)}}const Be={_p:f,$id:t,$onAction:A2.bind(null,F),$patch:we,$reset:xe,$subscribe(Le,ke={}){const We=A2(D,Le,ke.detached,()=>ct()),ct=E.run(()=>Wn(()=>f.state.value[t],Tt=>{(ke.flush==="sync"?R:k)&&Le({storeId:t,type:_f.direct,events:G},Tt)},aa({},A,ke)));return We},$dispose:Te},Pe=mr(Be);f._s.set(t,Pe);const Oe=f._e.run(()=>(E=F2(),E.run(()=>o())));for(const Le in Oe){const ke=Oe[Le];if(Ei(ke)&&!C6(ke)||fa(ke))x||(oe&&E6(ke)&&(Ei(ke)?ke.value=oe[Le]:By(ke,oe[Le])),f.state.value[t][Le]=ke);else if(typeof ke=="function"){const We=Ue(Le,ke);Oe[Le]=We,s.actions[Le]=ke}}return aa(Pe,Oe),aa(Bn(Pe),Oe),Object.defineProperty(Pe,"$state",{get:()=>f.state.value[t],set:Le=>{we(ke=>{aa(ke,Le)})}}),f._p.forEach(Le=>{aa(Pe,E.run(()=>Le({store:Pe,app:f._a,pinia:f,options:s})))}),oe&&x&&l.hydrate&&l.hydrate(Pe.$state,oe),k=!0,R=!0,Pe}function M6(t,o,l){let f,g;const x=typeof o=="function";typeof t=="string"?(f=t,g=x?l:o):(g=t,f=t.id);function E(s,A){const k=kl();return s=s||k&&vi(lS),s&&Fm(s),s=aS,s._s.has(f)||(x?uS(f,o,g,s):S6(f,g,s)),s._s.get(f)}return E.$id=f,E}const A6=M6("main",{state:()=>({count:0,name:"Eduardo",authenticated:!0}),getters:{doubleCount:t=>t.count*2,getCount:t=>t.count,isAuthenticated:t=>t.authenticated},actions:{increment(){this.count++},login(){this.authenticated=!0},logout(){this.authenticated=!1}}}),I6={components:{Icon:XC},setup(){const t=A6(),o=Gt(),l=()=>{var g;(g=o.value)==null||g.toggleCollapsed()},f=yt(()=>{var g;return(g=o.value)==null?void 0:g.state.collapsed});return{store:t,sidebar:o,isCollapsed:f,handleCollapse:l}}},P6="/assets/logo.21cfc95e.png",z6=la("img",{src:P6,class:"logo inline-block",alt:""},null,-1),O6={key:1,class:"container"};function k6(t,o,l,f,g,x){const E=jp("Icon"),s=hB,A=x6,k=jp("router-view"),R=dB,D=pB,F=jp("Login"),G=nv("wave-animation");return f.store.isAuthenticated?(fr(),wl(D,{key:0,class:"h-full"},{default:co(()=>[Me(s,null,{default:co(()=>[z6,Qc((fr(),pa("div",{class:"inline-block relative collapse-button",onClick:o[0]||(o[0]=(...oe)=>f.handleCollapse&&f.handleCollapse(...oe))},[f.isCollapsed?(fr(),wl(E,{key:0,icon:"icon:sidebaropen",height:"25",width:"25"})):(fr(),wl(E,{key:1,icon:"icon:sidebarclose",height:"25",width:"25"}))])),[[G]])]),_:1}),Me(D,null,{default:co(()=>[Me(A,{ref:"sidebar"},null,512),Me(R,{style:{height:"100%"}},{default:co(()=>[Me(k)]),_:1})]),_:1})]),_:1})):(fr(),pa("div",O6,[Me(F)]))}const D6=Zf(I6,[["render",k6]]);var hS={exports:{}};(function(t,o){(function(l,f){t.exports=f()})(dk,function(){var l,f,g;function x(s,A){if(!l)l=A;else if(!f)f=A;else{var k="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+l+")(sharedChunk); ("+f+")(sharedChunk); self.onerror = null;",R={};l(R),g=A(R),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(g.workerUrl=window.URL.createObjectURL(new Blob([k],{type:"text/javascript"})))}}x(["exports"],function(s){var A=typeof self<"u"?self:{},k=R;function R(i,e,n,a){this.cx=3*i,this.bx=3*(n-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=a,this.p2x=n,this.p2y=a}R.prototype.sampleCurveX=function(i){return((this.ax*i+this.bx)*i+this.cx)*i},R.prototype.sampleCurveY=function(i){return((this.ay*i+this.by)*i+this.cy)*i},R.prototype.sampleCurveDerivativeX=function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},R.prototype.solveCurveX=function(i,e){var n,a,u,d,m;for(e===void 0&&(e=1e-6),u=i,m=0;m<8;m++){if(d=this.sampleCurveX(u)-i,Math.abs(d)<e)return u;var _=this.sampleCurveDerivativeX(u);if(Math.abs(_)<1e-6)break;u-=d/_}if((u=i)<(n=0))return n;if(u>(a=1))return a;for(;n<a;){if(d=this.sampleCurveX(u),Math.abs(d-i)<e)return u;i>d?n=u:a=u,u=.5*(a-n)+n}return u},R.prototype.solve=function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))};var D=F;function F(i,e){this.x=i,this.y=e}F.prototype={clone:function(){return new F(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,n=i.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),n=Math.sin(i),a=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=a,this},_rotateAround:function(i,e){var n=Math.cos(i),a=Math.sin(i),u=e.y+a*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-a*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},F.convert=function(i){return i instanceof F?i:Array.isArray(i)?new F(i[0],i[1]):i};const G=Math.PI/180,oe=180/Math.PI;function se(i){return i*G}function we(i){return i*oe}const xe=[[0,0],[1,0],[1,1],[0,1]];function Te(i){if(i<=0)return 0;if(i>=1)return 1;const e=i*i,n=e*i;return 4*(i<.5?n:3*(i-e)+n-.75)}function Ue(i,e,n,a){const u=new k(i,e,n,a);return function(d){return u.solve(d)}}const Be=Ue(.25,.1,.25,1);function Pe(i,e,n){return Math.min(n,Math.max(e,i))}function Oe(i,e,n){return(n=Pe((n-i)/(e-i),0,1))*n*(3-2*n)}function Le(i,e,n){const a=n-e,u=((i-e)%a+a)%a+e;return u===e?n:u}function ke(i,e,n){if(!i.length)return n(null,[]);let a=i.length;const u=new Array(i.length);let d=null;i.forEach((m,_)=>{e(m,(b,w)=>{b&&(d=b),u[_]=w,--a==0&&n(d,u)})})}function We(i){const e=[];for(const n in i)e.push(i[n]);return e}function ct(i,...e){for(const n of e)for(const a in n)i[a]=n[a];return i}let Tt=1;function st(){return Tt++}function Ge(){return function i(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function Ne(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function vt(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function rt(i,e){i.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function at(i,e){return i.indexOf(e,i.length-e.length)!==-1}function ht(i,e,n){const a={};for(const u in i)a[u]=e.call(n||this,i[u],u,i);return a}function Ft(i,e,n){const a={};for(const u in i)e.call(n||this,i[u],u,i)&&(a[u]=i[u]);return a}function ln(i){return Array.isArray(i)?i.map(ln):typeof i=="object"&&i?ht(i,ln):i}const pn={};function Lt(i){pn[i]||(typeof console<"u"&&console.warn(i),pn[i]=!0)}function nn(i,e,n){return(n.y-i.y)*(e.x-i.x)>(e.y-i.y)*(n.x-i.x)}function xt(i){let e=0;for(let n,a,u=0,d=i.length,m=d-1;u<d;m=u++)n=i[u],a=i[m],e+=(a.x-n.x)*(n.y+a.y);return e}function be(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Xe(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,a,u,d)=>{const m=u||d;return e[a]=!m||m.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let ut=null;function bt(i){if(ut==null){const e=i.navigator?i.navigator.userAgent:null;ut=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return ut}function Yt(i){try{const e=A[i];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function en(i,e){return[i[4*e],i[4*e+1],i[4*e+2],i[4*e+3]]}const qt=A.performance;function ie(i){const e=i?i.url.toString():void 0;return qt.getEntriesByName(e)}var ye="2.10.0";let Ae,qe,ot,Et;const wt={now:()=>ot!==void 0?ot:A.performance.now(),setNow(i){ot=i},restoreNow(){ot=void 0},frame(i){const e=A.requestAnimationFrame(i);return{cancel:()=>A.cancelAnimationFrame(e)}},getImageData(i,e=0){const{width:n,height:a}=i;Et||(Et=A.document.createElement("canvas"));const u=Et.getContext("2d");if(!u)throw new Error("failed to create canvas 2d context");return(n>Et.width||a>Et.height)&&(Et.width=n,Et.height=a),u.clearRect(-e,-e,n+2*e,a+2*e),u.drawImage(i,0,0,n,a),u.getImageData(-e,-e,n+2*e,a+2*e)},resolveURL:i=>(Ae||(Ae=A.document.createElement("a")),Ae.href=i,Ae.href),get devicePixelRatio(){return A.devicePixelRatio},get prefersReducedMotion(){return!!A.matchMedia&&(qe==null&&(qe=A.matchMedia("(prefers-reduced-motion: reduce)")),qe.matches)}};let ft;const Qe={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(ft==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ft=process.env.API_URL_REGEX!=null?new RegExp(process.env.API_URL_REGEX):i}catch{ft=i}}return ft},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},dt={supported:!1,testSupport:function(i){!jt&&Ct&&(Xt?sn(i):Rt=i)}};let Rt,Ct,jt=!1,Xt=!1;function sn(i){const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,Ct),i.isContextLost())return;dt.supported=!0}catch{}i.deleteTexture(e),jt=!0}A.document&&(Ct=A.document.createElement("img"),Ct.onload=function(){Rt&&sn(Rt),Rt=null,Xt=!0},Ct.onerror=function(){jt=!0,Rt=null},Ct.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Pn="01",yn="NO_ACCESS_TOKEN";function Nn(i){return i.indexOf("mapbox:")===0}function bi(i){return Qe.API_URL_REGEX.test(i)}const Sr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Di(i){const e=i.match(Sr);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Gi(i){const e=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${e}`}function Wo(i){if(!i)return null;const e=i.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(A.atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class wi{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=Wo(Qe.ACCESS_TOKEN);let a="";return a=n&&n.u?A.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(u,d)=>String.fromCharCode(Number("0x"+d)))):Qe.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${a}`:`mapbox.eventData:${a}`}fetchEventData(){const e=Yt("localStorage"),n=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{const u=A.localStorage.getItem(n);u&&(this.eventData=JSON.parse(u));const d=A.localStorage.getItem(a);d&&(this.anonId=d)}catch{Lt("Unable to read from LocalStorage")}}saveEventData(){const e=Yt("localStorage"),n=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{A.localStorage.setItem(a,this.anonId),Object.keys(this.eventData).length>=1&&A.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{Lt("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,a,u){if(!Qe.EVENTS_URL)return;const d=Di(Qe.EVENTS_URL);d.params.push(`access_token=${u||Qe.ACCESS_TOKEN||""}`);const m={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:ye,skuId:Pn,userId:this.anonId},_=n?ct(m,n):m,b={url:Gi(d),headers:{"Content-Type":"text/plain"},body:JSON.stringify([_])};this.pendingRequest=tt(b,w=>{this.pendingRequest=null,a(w),this.saveEventData(),this.processRequests(u)})}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const Li=new class extends wi{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,e){Qe.EVENTS_URL&&Qe.ACCESS_TOKEN&&Array.isArray(i)&&i.some(n=>Nn(n)||bi(n))&&this.queueRequest(Date.now(),e)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Wo(Qe.ACCESS_TOKEN),n=e?e.u:Qe.ACCESS_TOKEN;let a=n!==this.eventData.tokenU;vt(this.anonId)||(this.anonId=Ge(),a=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const d=new Date(this.eventData.lastSuccess),m=new Date(u),_=(u-this.eventData.lastSuccess)/864e5;a=a||_>=1||_<-1||d.getDate()!==m.getDate()}else a=!0;a?this.postEvent(u,{"enabled.telemetry":!1},d=>{d||(this.eventData.lastSuccess=u,this.eventData.tokenU=n)},i):this.processRequests()}},mo=Li.postTurnstileEvent.bind(Li),wa=new class extends wi{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,e,n,a){this.skuToken=e,this.errorCb=a,Qe.EVENTS_URL&&(n||Qe.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},n):this.errorCb(new Error(yn)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),vt(this.anonId)||(this.anonId=Ge()),this.postEvent(n,{skuToken:this.skuToken},a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},i))}},Bl=wa.postMapLoadEvent.bind(wa),Fl=new class extends wi{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,e,n,a){if(!Qe.API_URL||!Qe.SESSION_PATH)return;const u=Di(Qe.API_URL+Qe.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${a||Qe.ACCESS_TOKEN||""}`);const d={url:Gi(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=zt(d,m=>{this.pendingRequest=null,n(m),this.saveEventData(),this.processRequests(a)})}getSessionAPI(i,e,n,a){this.skuToken=e,this.errorCb=a,Qe.SESSION_PATH&&Qe.API_URL&&(n||Qe.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},n):this.errorCb(new Error(yn)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},i)}},_u=Fl.getSessionAPI.bind(Fl),go=new Set;let Kr,Ss=500,jl=50,Ji={};function Ta(i){const e=U(i);let n,a;e&&e.forEach(d=>{const m=d.split("=");m[0]==="language"?n=m[1]:m[0]==="worldview"&&(a=m[1])});let u="mapbox-tiles";return n&&(u+=`-${n}`),a&&(u+=`-${a}`),u}function ee(){try{return A.caches}catch{}}function j(i){const e=ee();e&&!Ji[i]&&(Ji[i]=e.open(i))}function U(i){const e=i.indexOf("?");return e>0?i.slice(e+1).split("&"):[]}function J(i){const e=i.indexOf("?");if(e<0)return i;const n=U(i).filter(a=>{const u=a.split("=");return u[0]==="language"||u[0]==="worldview"});return n.length?`${i.slice(0,e)}?${n.join("&")}`:i.slice(0,e)}let re=1/0;const ge={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ge);class Se extends Error{constructor(e,n,a){n===401&&bi(a)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=a}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ee=be()?()=>self.worker&&self.worker.referrer:()=>(A.location.protocol==="blob:"?A.parent:A).location.href,_e=function(i,e){if(!(/^file:/.test(n=i.url)||/^file:/.test(Ee())&&!/^\w+:/.test(n))){if(A.fetch&&A.Request&&A.AbortController&&A.Request.prototype.hasOwnProperty("signal"))return function(a,u){const d=new A.AbortController,m=new A.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:Ee(),signal:d.signal});let _=!1,b=!1;const w=(S=m.url).indexOf("sku=")>0&&bi(S);var S;a.type==="json"&&m.headers.set("Accept","application/json");const I=(L,B,V)=>{if(b)return;if(L&&L.message!=="SecurityError"&&Lt(L),B&&V)return P(B);const Z=Date.now();A.fetch(m).then(Q=>{if(Q.ok){const ce=w?Q.clone():null;return P(Q,ce,Z)}return u(new Se(Q.statusText,Q.status,a.url))}).catch(Q=>{Q.code!==20&&u(new Error(Q.message))})},P=(L,B,V)=>{(a.type==="arrayBuffer"?L.arrayBuffer():a.type==="json"?L.json():L.text()).then(Z=>{b||(B&&V&&function(Q,ce,ne){const ae=Ta(Q.url);if(j(ae),!Ji[ae])return;const me={status:ce.status,statusText:ce.statusText,headers:new A.Headers};ce.headers.forEach((De,Ze)=>me.headers.set(Ze,De));const ue=Xe(ce.headers.get("Cache-Control")||"");if(ue["no-store"])return;ue["max-age"]&&me.headers.set("Expires",new Date(ne+1e3*ue["max-age"]).toUTCString());const Re=me.headers.get("Expires");Re&&(new Date(Re).getTime()-ne<42e4||function(De,Ze){if(Kr===void 0)try{new Response(new ReadableStream),Kr=!0}catch{Kr=!1}Kr?Ze(De.body):De.blob().then(Ze)}(ce,De=>{const Ze=new A.Response(De,me);j(ae),Ji[ae]&&Ji[ae].then(_t=>_t.put(J(Q.url),Ze)).catch(_t=>Lt(_t.message))}))}(m,B,V),_=!0,u(null,Z,L.headers.get("Cache-Control"),L.headers.get("Expires")))}).catch(Z=>{b||u(new Error(Z.message))})};return w?function(L,B){const V=Ta(L.url);if(j(V),!Ji[V])return B(null);const Z=J(L.url);Ji[V].then(Q=>{Q.match(Z).then(ce=>{const ne=function(ae){if(!ae)return!1;const me=new Date(ae.headers.get("Expires")||0),ue=Xe(ae.headers.get("Cache-Control")||"");return me>Date.now()&&!ue["no-cache"]}(ce);Q.delete(Z),ne&&Q.put(Z,ce.clone()),B(null,ce,ne)}).catch(B)}).catch(B)}(m,I):I(null,null),{cancel:()=>{b=!0,_||d.abort()}}}(i,e);if(be()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var n;return function(a,u){const d=new A.XMLHttpRequest;d.open(a.method||"GET",a.url,!0),a.type==="arrayBuffer"&&(d.responseType="arraybuffer");for(const m in a.headers)d.setRequestHeader(m,a.headers[m]);return a.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=a.credentials==="include",d.onerror=()=>{u(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){let m=d.response;if(a.type==="json")try{m=JSON.parse(d.response)}catch(_){return u(_)}u(null,m,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else u(new Se(d.statusText,d.status,a.url))},d.send(a.body),{cancel:()=>d.abort()}}(i,e)},Ie=function(i,e){return _e(ct(i,{type:"arrayBuffer"}),e)},tt=function(i,e){return _e(ct(i,{method:"POST"}),e)},zt=function(i,e){return _e(ct(i,{method:"GET"}),e)};function lt(i){const e=A.document.createElement("a");return e.href=i,e.protocol===A.document.location.protocol&&e.host===A.document.location.host}const Ht="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Kt,Vt;Kt=[],Vt=0;const Jt=function(i,e){if(dt.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),Vt>=Qe.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:i,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Kt.push(d),d}Vt++;let n=!1;const a=()=>{if(!n)for(n=!0,Vt--;Kt.length&&Vt<Qe.MAX_PARALLEL_IMAGE_REQUESTS;){const d=Kt.shift(),{requestParameters:m,callback:_,cancelled:b}=d;b||(d.cancel=Jt(m,_).cancel)}},u=Ie(i,(d,m,_,b)=>{a(),d?e(d):m&&(A.createImageBitmap?function(w,S){const I=new A.Blob([new Uint8Array(w)],{type:"image/png"});A.createImageBitmap(I).then(P=>{S(null,P)}).catch(P=>{S(new Error(`Could not load image because of ${P.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(w,S)=>e(w,S,_,b)):function(w,S){const I=new A.Image,P=A.URL;I.onload=()=>{S(null,I),P.revokeObjectURL(I.src),I.onload=null,A.requestAnimationFrame(()=>{I.src=Ht})},I.onerror=()=>S(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const L=new A.Blob([new Uint8Array(w)],{type:"image/png"});I.src=w.byteLength?P.createObjectURL(L):Ht}(m,(w,S)=>e(w,S,_,b)))});return{cancel:()=>{u.cancel(),a()}}};function mn(i,e,n){n[i]&&n[i].indexOf(e)!==-1||(n[i]=n[i]||[],n[i].push(e))}function Fn(i,e,n){if(n&&n[i]){const a=n[i].indexOf(e);a!==-1&&n[i].splice(a,1)}}class Gn{constructor(e,n={}){ct(this,n),this.type=e}}class jn extends Gn{constructor(e,n={}){super("error",ct({error:e},n))}}class Wt{on(e,n){return this._listeners=this._listeners||{},mn(e,n,this._listeners),this}off(e,n){return Fn(e,n,this._listeners),Fn(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},mn(e,n,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,n){typeof e=="string"&&(e=new Gn(e,n||{}));const a=e.type;if(this.listens(a)){e.target=this;const u=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const _ of u)_.call(this,e);const d=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const _ of d)Fn(a,_,this._oneTimeListeners),_.call(this,e);const m=this._eventedParent;m&&(ct(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),m.fire(e))}else e instanceof jn&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var $e=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function sr(i,...e){for(const n of e)for(const a in n)i[a]=n[a];return i}function ci(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function _o(i){if(Array.isArray(i))return i.map(_o);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const n in i)e[n]=_o(i[n]);return e}return ci(i)}class Nl extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}var Mr=Nl;class Ul{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[a,u]of n)this.bindings[a]=u}concat(e){return new Ul(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var jm=Ul;const Ms={kind:"null"},Ot={kind:"number"},vn={kind:"string"},xn={kind:"boolean"},Ar={kind:"color"},Ir={kind:"object"},un={kind:"value"},Ea={kind:"collator"},Ca={kind:"formatted"},Sa={kind:"resolvedImage"};function ar(i,e){return{kind:"array",itemType:i,N:e}}function oi(i){if(i.kind==="array"){const e=oi(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const qf=[Ms,Ot,vn,xn,Ar,Ca,Ir,ar(un),Sa];function As(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!As(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const n of qf)if(!As(n,e))return null}}return`Expected ${oi(i)} but found ${oi(e)} instead.`}function Vl(i,e){return e.some(n=>n.kind===i.kind)}function yo(i,e){return e.some(n=>n==="null"?i===null:n==="array"?Array.isArray(i):n==="object"?i&&!Array.isArray(i)&&typeof i=="object":n===typeof i)}function yu(i){var e={exports:{}};return i(e,e.exports),e.exports}var vo=yu(function(i,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function a(_){return(_=Math.round(_))<0?0:_>255?255:_}function u(_){return a(_[_.length-1]==="%"?parseFloat(_)/100*255:parseInt(_))}function d(_){return(b=_[_.length-1]==="%"?parseFloat(_)/100:parseFloat(_))<0?0:b>1?1:b;var b}function m(_,b,w){return w<0?w+=1:w>1&&(w-=1),6*w<1?_+(b-_)*w*6:2*w<1?b:3*w<2?_+(b-_)*(2/3-w)*6:_}try{e.parseCSSColor=function(_){var b,w=_.replace(/ /g,"").toLowerCase();if(w in n)return n[w].slice();if(w[0]==="#")return w.length===4?(b=parseInt(w.substr(1),16))>=0&&b<=4095?[(3840&b)>>4|(3840&b)>>8,240&b|(240&b)>>4,15&b|(15&b)<<4,1]:null:w.length===7&&(b=parseInt(w.substr(1),16))>=0&&b<=16777215?[(16711680&b)>>16,(65280&b)>>8,255&b,1]:null;var S=w.indexOf("("),I=w.indexOf(")");if(S!==-1&&I+1===w.length){var P=w.substr(0,S),L=w.substr(S+1,I-(S+1)).split(","),B=1;switch(P){case"rgba":if(L.length!==4)return null;B=d(L.pop());case"rgb":return L.length!==3?null:[u(L[0]),u(L[1]),u(L[2]),B];case"hsla":if(L.length!==4)return null;B=d(L.pop());case"hsl":if(L.length!==3)return null;var V=(parseFloat(L[0])%360+360)%360/360,Z=d(L[1]),Q=d(L[2]),ce=Q<=.5?Q*(Z+1):Q+Z-Q*Z,ne=2*Q-ce;return[a(255*m(ne,ce,V+1/3)),a(255*m(ne,ce,V)),a(255*m(ne,ce,V-1/3)),B];default:return null}}return null}}catch{}});class Zi{constructor(e,n,a,u=1){this.r=e,this.g=n,this.b=a,this.a=u}static parse(e){if(!e)return;if(e instanceof Zi)return e;if(typeof e!="string")return;const n=vo.parseCSSColor(e);return n?new Zi(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,a,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(a)},${u})`}toArray(){const{r:e,g:n,b:a,a:u}=this;return u===0?[0,0,0,0]:[255*e/u,255*n/u,255*a/u,u]}toArray01(){const{r:e,g:n,b:a,a:u}=this;return u===0?[0,0,0,0]:[e/u,n/u,a/u,u]}toArray01PremultipliedAlpha(){const{r:e,g:n,b:a,a:u}=this;return[e,n,a,u]}}Zi.black=new Zi(0,0,0,1),Zi.white=new Zi(1,1,1,1),Zi.transparent=new Zi(0,0,0,0),Zi.red=new Zi(1,0,0,1),Zi.blue=new Zi(0,0,1,1);var Un=Zi;class vu{constructor(e,n,a){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ma{constructor(e,n,a,u,d){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=a,this.fontStack=u,this.textColor=d}}class Qi{constructor(e){this.sections=e}static fromString(e){return new Qi([new Ma(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Qi?e:Qi.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.name]);continue}e.push(n.text);const a={};n.fontStack&&(a["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(a["font-scale"]=n.scale),n.textColor&&(a["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(a)}return e}}class er{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new er({name:e,available:!1}):null}serialize(){return["image",this.name]}}function xu(i,e,n,a){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[i,e,n,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[i,e,n,a]:[i,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function xo(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Un||i instanceof vu||i instanceof Qi||i instanceof er)return!0;if(Array.isArray(i)){for(const e of i)if(!xo(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!xo(i[e]))return!1;return!0}return!1}function pi(i){if(i===null)return Ms;if(typeof i=="string")return vn;if(typeof i=="boolean")return xn;if(typeof i=="number")return Ot;if(i instanceof Un)return Ar;if(i instanceof vu)return Ea;if(i instanceof Qi)return Ca;if(i instanceof er)return Sa;if(Array.isArray(i)){const e=i.length;let n;for(const a of i){const u=pi(a);if(n){if(n===u)continue;n=un;break}n=u}return ar(n||un,e)}return Ir}function Aa(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof Un||i instanceof Qi||i instanceof er?i.toString():JSON.stringify(i)}class bu{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!xo(e[1]))return n.error("invalid value");const a=e[1];let u=pi(a);const d=n.expectedType;return u.kind!=="array"||u.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(u=d),new bu(u,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Un?["rgba"].concat(this.value.toArray()):this.value instanceof Qi?this.value.serialize():this.value}}var Ia=bu,Ci=class{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}};const Pa={string:vn,number:Ot,boolean:xn,object:Ir};class wu{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let a,u=1;const d=e[0];if(d==="array"){let _,b;if(e.length>2){const w=e[1];if(typeof w!="string"||!(w in Pa)||w==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);_=Pa[w],u++}else _=un;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);b=e[2],u++}a=ar(_,b)}else a=Pa[d];const m=[];for(;u<e.length;u++){const _=n.parse(e[u],u,un);if(!_)return null;m.push(_)}return new wu(a,m)}evaluate(e){for(let n=0;n<this.args.length;n++){const a=this.args[n].evaluate(e);if(!As(this.type,pi(a)))return a;if(n===this.args.length-1)throw new Ci(`Expected value to be of type ${oi(this.type)}, but found ${oi(pi(a))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if(e.kind==="array"){const a=e.itemType;if(a.kind==="string"||a.kind==="number"||a.kind==="boolean"){n.push(a.kind);const u=e.N;(typeof u=="number"||this.args.length>1)&&n.push(u)}}return n.concat(this.args.map(a=>a.serialize()))}}var gr=wu;class za{constructor(e){this.type=Ca,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return n.error("First argument must be an image or text section.");const u=[];let d=!1;for(let m=1;m<=e.length-1;++m){const _=e[m];if(d&&typeof _=="object"&&!Array.isArray(_)){d=!1;let b=null;if(_["font-scale"]&&(b=n.parse(_["font-scale"],1,Ot),!b))return null;let w=null;if(_["text-font"]&&(w=n.parse(_["text-font"],1,ar(vn)),!w))return null;let S=null;if(_["text-color"]&&(S=n.parse(_["text-color"],1,Ar),!S))return null;const I=u[u.length-1];I.scale=b,I.font=w,I.textColor=S}else{const b=n.parse(e[m],1,un);if(!b)return null;const w=b.type.kind;if(w!=="string"&&w!=="value"&&w!=="null"&&w!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,u.push({content:b,scale:null,font:null,textColor:null})}}return new za(u)}evaluate(e){return new Qi(this.sections.map(n=>{const a=n.content.evaluate(e);return pi(a)===Sa?new Ma("",a,null,null,null):new Ma(Aa(a),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const a={};n.scale&&(a["font-scale"]=n.scale.serialize()),n.font&&(a["text-font"]=n.font.serialize()),n.textColor&&(a["text-color"]=n.textColor.serialize()),e.push(a)}return e}}class $l{constructor(e){this.type=Sa,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const a=n.parse(e[1],1,vn);return a?new $l(a):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),a=er.fromString(n);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(n)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Nm={"to-boolean":xn,"to-color":Ar,"to-number":Ot,"to-string":vn};class Tu{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const a=e[0];if((a==="to-boolean"||a==="to-string")&&e.length!==2)return n.error("Expected one argument.");const u=Nm[a],d=[];for(let m=1;m<e.length;m++){const _=n.parse(e[m],m,un);if(!_)return null;d.push(_)}return new Tu(u,d)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let n,a;for(const u of this.args){if(n=u.evaluate(e),a=null,n instanceof Un)return n;if(typeof n=="string"){const d=e.parseColor(n);if(d)return d}else if(Array.isArray(n)&&(a=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:xu(n[0],n[1],n[2],n[3]),!a))return new Un(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Ci(a||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const a of this.args){if(n=a.evaluate(e),n===null)return 0;const u=Number(n);if(!isNaN(u))return u}throw new Ci(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?Qi.fromString(Aa(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?er.fromString(Aa(this.args[0].evaluate(e))):Aa(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new za([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new $l(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Is=Tu;const Um=["Unknown","Point","LineString","Polygon"];var Wf=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Um[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:a}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-i[0])+this.featureDistanceData.bearing[1]*(a*e-i[1])}return 0}parseColor(i){let e=this._parseColorCache[i];return e||(e=this._parseColorCache[i]=Un.parse(i)),e}};class Ho{constructor(e,n,a,u){this.name=e,this.type=n,this._evaluate=a,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const a=e[0],u=Ho.definitions[a];if(!u)return n.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(u)?u[0]:u.type,m=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,_=m.filter(([w])=>!Array.isArray(w)||w.length===e.length-1);let b=null;for(const[w,S]of _){b=new Ko(n.registry,n.path,null,n.scope);const I=[];let P=!1;for(let L=1;L<e.length;L++){const B=e[L],V=Array.isArray(w)?w[L-1]:w.type,Z=b.parse(B,1+I.length,V);if(!Z){P=!0;break}I.push(Z)}if(!P)if(Array.isArray(w)&&w.length!==I.length)b.error(`Expected ${w.length} arguments, but found ${I.length} instead.`);else{for(let L=0;L<I.length;L++){const B=Array.isArray(w)?w[L]:w.type,V=I[L];b.concat(L+1).checkSubtype(B,V.type)}if(b.errors.length===0)return new Ho(a,d,S,I)}}if(_.length===1)n.errors.push(...b.errors);else{const w=(_.length?_:m).map(([I])=>{return P=I,Array.isArray(P)?`(${P.map(oi).join(", ")})`:`(${oi(P.type)}...)`;var P}).join(" | "),S=[];for(let I=1;I<e.length;I++){const P=n.parse(e[I],1+S.length);if(!P)return null;S.push(oi(P.type))}n.error(`Expected arguments of type ${w}, but found (${S.join(", ")}) instead.`)}return null}static register(e,n){Ho.definitions=n;for(const a in n)e[a]=Ho}}var Pr=Ho;class Gl{constructor(e,n,a){this.type=Ea,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return n.error("Collator options argument must be an object.");const u=n.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,xn);if(!u)return null;const d=n.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,xn);if(!d)return null;let m=null;return a.locale&&(m=n.parse(a.locale,1,vn),!m)?null:new Gl(u,d,m)}evaluate(e){return new vu(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const bo=8192;function Eu(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function Zl(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function Vm(i,e){const n=(180+i[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(n*u*bo),Math.round(a*u*bo)]}function $m(i,e,n){const a=i[0]-e[0],u=i[1]-e[1],d=i[0]-n[0],m=i[1]-n[1];return a*m-d*u==0&&a*d<=0&&u*m<=0}function ql(i,e){let n=!1;for(let m=0,_=e.length;m<_;m++){const b=e[m];for(let w=0,S=b.length;w<S-1;w++){if($m(i,b[w],b[w+1]))return!1;(u=b[w])[1]>(a=i)[1]!=(d=b[w+1])[1]>a[1]&&a[0]<(d[0]-u[0])*(a[1]-u[1])/(d[1]-u[1])+u[0]&&(n=!n)}}var a,u,d;return n}function Wl(i,e){for(let n=0;n<e.length;n++)if(ql(i,e[n]))return!0;return!1}function Hf(i,e,n,a){const u=a[0]-n[0],d=a[1]-n[1],m=(i[0]-n[0])*d-u*(i[1]-n[1]),_=(e[0]-n[0])*d-u*(e[1]-n[1]);return m>0&&_<0||m<0&&_>0}function Gm(i,e,n){for(const w of n)for(let S=0;S<w.length-1;++S)if((_=[(m=w[S+1])[0]-(d=w[S])[0],m[1]-d[1]])[0]*(b=[(u=e)[0]-(a=i)[0],u[1]-a[1]])[1]-_[1]*b[0]!=0&&Hf(a,u,d,m)&&Hf(d,m,a,u))return!0;var a,u,d,m,_,b;return!1}function Xf(i,e){for(let n=0;n<i.length;++n)if(!ql(i[n],e))return!1;for(let n=0;n<i.length-1;++n)if(Gm(i[n],i[n+1],e))return!1;return!0}function Zm(i,e){for(let n=0;n<e.length;n++)if(Xf(i,e[n]))return!0;return!1}function _r(i,e,n){const a=[];for(let u=0;u<i.length;u++){const d=[];for(let m=0;m<i[u].length;m++){const _=Vm(i[u][m],n);Eu(e,_),d.push(_)}a.push(d)}return a}function Cu(i,e,n){const a=[];for(let u=0;u<i.length;u++){const d=_r(i[u],e,n);a.push(d)}return a}function Su(i,e,n,a){if(i[0]<n[0]||i[0]>n[2]){const u=.5*a;let d=i[0]-n[0]>u?-a:n[0]-i[0]>u?a:0;d===0&&(d=i[0]-n[2]>u?-a:n[2]-i[0]>u?a:0),i[0]+=d}Eu(e,i)}function Mu(i,e,n,a){const u=Math.pow(2,a.z)*bo,d=[a.x*bo,a.y*bo],m=[];if(!i)return m;for(const _ of i)for(const b of _){const w=[b.x+d[0],b.y+d[1]];Su(w,e,n,u),m.push(w)}return m}function Au(i,e,n,a){const u=Math.pow(2,a.z)*bo,d=[a.x*bo,a.y*bo],m=[];if(!i)return m;for(const b of i){const w=[];for(const S of b){const I=[S.x+d[0],S.y+d[1]];Eu(e,I),w.push(I)}m.push(w)}if(e[2]-e[0]<=u/2){(_=e)[0]=_[1]=1/0,_[2]=_[3]=-1/0;for(const b of m)for(const w of b)Su(w,e,n,u)}var _;return m}class Ps{constructor(e,n){this.type=xn,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(xo(e[1])){const a=e[1];if(a.type==="FeatureCollection")for(let u=0;u<a.features.length;++u){const d=a.features[u].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Ps(a,a.features[u].geometry)}else if(a.type==="Feature"){const u=a.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Ps(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new Ps(a,a)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,a){const u=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],m=n.canonicalID();if(!m)return!1;if(a.type==="Polygon"){const _=_r(a.coordinates,d,m),b=Mu(n.geometry(),u,d,m);if(!Zl(u,d))return!1;for(const w of b)if(!ql(w,_))return!1}if(a.type==="MultiPolygon"){const _=Cu(a.coordinates,d,m),b=Mu(n.geometry(),u,d,m);if(!Zl(u,d))return!1;for(const w of b)if(!Wl(w,_))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,a){const u=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],m=n.canonicalID();if(!m)return!1;if(a.type==="Polygon"){const _=_r(a.coordinates,d,m),b=Au(n.geometry(),u,d,m);if(!Zl(u,d))return!1;for(const w of b)if(!Xf(w,_))return!1}if(a.type==="MultiPolygon"){const _=Cu(a.coordinates,d,m),b=Au(n.geometry(),u,d,m);if(!Zl(u,d))return!1;for(const w of b)if(!Zm(w,_))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Hl=Ps;function Xo(i){if(i instanceof Pr&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Hl)return!1;let e=!0;return i.eachChild(n=>{e&&!Xo(n)&&(e=!1)}),e}function wo(i){if(i instanceof Pr&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(n=>{e&&!wo(n)&&(e=!1)}),e}function Oa(i,e){if(i instanceof Pr&&e.indexOf(i.name)>=0)return!1;let n=!0;return i.eachChild(a=>{n&&!Oa(a,e)&&(n=!1)}),n}class Xl{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const a=e[1];return n.scope.has(a)?new Xl(a,n.scope.get(a)):n.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Kl=Xl;class Yl{constructor(e,n=[],a,u=new jm,d=[]){this.registry=e,this.path=n,this.key=n.map(m=>`[${m}]`).join(""),this.scope=u,this.errors=d,this.expectedType=a}parse(e,n,a,u,d={}){return n?this.concat(n,a,u)._parse(e,d):this._parse(e,d)}_parse(e,n){function a(u,d,m){return m==="assert"?new gr(d,[u]):m==="coerce"?new Is(d,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const d=this.registry[u];if(d){let m=d.parse(e,this);if(!m)return null;if(this.expectedType){const _=this.expectedType,b=m.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||b.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(_,b))return null}else m=a(m,_,n.typeAnnotation||"coerce");else m=a(m,_,n.typeAnnotation||"assert")}if(!(m instanceof Ia)&&m.type.kind!=="resolvedImage"&&zn(m)){const _=new Wf;try{m=new Ia(m.type,m.evaluate(_))}catch(b){return this.error(b.message),null}}return m}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,a){const u=typeof e=="number"?this.path.concat(e):this.path,d=a?this.scope.concat(a):this.scope;return new Yl(this.registry,u,n||null,d,this.errors)}error(e,...n){const a=`${this.key}${n.map(u=>`[${u}]`).join("")}`;this.errors.push(new Mr(a,e))}checkSubtype(e,n){const a=As(e,n);return a&&this.error(a),a}}var Ko=Yl;function zn(i){if(i instanceof Kl)return zn(i.boundExpression);if(i instanceof Pr&&i.name==="error"||i instanceof Gl||i instanceof Hl)return!1;const e=i instanceof Is||i instanceof gr;let n=!0;return i.eachChild(a=>{n=e?n&&zn(a):n&&a instanceof Ia}),!!n&&Xo(i)&&Oa(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Jl(i,e){const n=i.length-1;let a,u,d=0,m=n,_=0;for(;d<=m;)if(_=Math.floor((d+m)/2),a=i[_],u=i[_+1],a<=e){if(_===n||e<u)return _;d=_+1}else{if(!(a>e))throw new Ci("Input is not a number.");m=_-1}return 0}class Iu{constructor(e,n,a){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[u,d]of a)this.labels.push(u),this.outputs.push(d)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const a=n.parse(e[1],1,Ot);if(!a)return null;const u=[];let d=null;n.expectedType&&n.expectedType.kind!=="value"&&(d=n.expectedType);for(let m=1;m<e.length;m+=2){const _=m===1?-1/0:e[m],b=e[m+1],w=m,S=m+1;if(typeof _!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',w);if(u.length&&u[u.length-1][0]>=_)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',w);const I=n.parse(b,S,d);if(!I)return null;d=d||I.type,u.push([_,I])}return new Iu(d,a,u)}evaluate(e){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(e);const u=this.input.evaluate(e);if(u<=n[0])return a[0].evaluate(e);const d=n.length;return u>=n[d-1]?a[d-1].evaluate(e):a[Jl(n,u)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}var Pu=Iu;function Mn(i,e,n){return i*(1-n)+e*n}function zs(i,e,n){return i.map((a,u)=>Mn(a,e[u],n))}var ka=Object.freeze({__proto__:null,number:Mn,color:function(i,e,n){return new Un(Mn(i.r,e.r,n),Mn(i.g,e.g,n),Mn(i.b,e.b,n),Mn(i.a,e.a,n))},array:zs});const zu=.95047,Ou=1.08883,ku=4/29,To=6/29,Da=3*To*To,qm=Math.PI/180,Du=180/Math.PI;function Ql(i){return i>.008856451679035631?Math.pow(i,1/3):i/Da+ku}function Lu(i){return i>To?i*i*i:Da*(i-ku)}function Ru(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function ec(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Kf(i){const e=ec(i.r),n=ec(i.g),a=ec(i.b),u=Ql((.4124564*e+.3575761*n+.1804375*a)/zu),d=Ql((.2126729*e+.7151522*n+.072175*a)/1);return{l:116*d-16,a:500*(u-d),b:200*(d-Ql((.0193339*e+.119192*n+.9503041*a)/Ou)),alpha:i.a}}function Bu(i){let e=(i.l+16)/116,n=isNaN(i.a)?e:e+i.a/500,a=isNaN(i.b)?e:e-i.b/200;return e=1*Lu(e),n=zu*Lu(n),a=Ou*Lu(a),new Un(Ru(3.2404542*n-1.5371385*e-.4985314*a),Ru(-.969266*n+1.8760108*e+.041556*a),Ru(.0556434*n-.2040259*e+1.0572252*a),i.alpha)}function Yf(i,e,n){const a=e-i;return i+n*(a>180||a<-180?a-360*Math.round(a/360):a)}const La={forward:Kf,reverse:Bu,interpolate:function(i,e,n){return{l:Mn(i.l,e.l,n),a:Mn(i.a,e.a,n),b:Mn(i.b,e.b,n),alpha:Mn(i.alpha,e.alpha,n)}}},Os={forward:function(i){const{l:e,a:n,b:a}=Kf(i),u=Math.atan2(a,n)*Du;return{h:u<0?u+360:u,c:Math.sqrt(n*n+a*a),l:e,alpha:i.a}},reverse:function(i){const e=i.h*qm,n=i.c;return Bu({l:i.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:i.alpha})},interpolate:function(i,e,n){return{h:Yf(i.h,e.h,n),c:Mn(i.c,e.c,n),l:Mn(i.l,e.l,n),alpha:Mn(i.alpha,e.alpha,n)}}};var Jf=Object.freeze({__proto__:null,lab:La,hcl:Os});class Ra{constructor(e,n,a,u,d){this.type=e,this.operator=n,this.interpolation=a,this.input=u,this.labels=[],this.outputs=[];for(const[m,_]of d)this.labels.push(m),this.outputs.push(_)}static interpolationFactor(e,n,a,u){let d=0;if(e.name==="exponential")d=tc(n,e.base,a,u);else if(e.name==="linear")d=tc(n,1,a,u);else if(e.name==="cubic-bezier"){const m=e.controlPoints;d=new k(m[0],m[1],m[2],m[3]).solve(tc(n,1,a,u))}return d}static parse(e,n){let[a,u,d,...m]=e;if(!Array.isArray(u)||u.length===0)return n.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const w=u[1];if(typeof w!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:w}}else{if(u[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const w=u.slice(1);if(w.length!==4||w.some(S=>typeof S!="number"||S<0||S>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:w}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(d=n.parse(d,2,Ot),!d)return null;const _=[];let b=null;a==="interpolate-hcl"||a==="interpolate-lab"?b=Ar:n.expectedType&&n.expectedType.kind!=="value"&&(b=n.expectedType);for(let w=0;w<m.length;w+=2){const S=m[w],I=m[w+1],P=w+3,L=w+4;if(typeof S!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(_.length&&_[_.length-1][0]>=S)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',P);const B=n.parse(I,L,b);if(!B)return null;b=b||B.type,_.push([S,B])}return b.kind==="number"||b.kind==="color"||b.kind==="array"&&b.itemType.kind==="number"&&typeof b.N=="number"?new Ra(b,a,u,d,_):n.error(`Type ${oi(b)} is not interpolatable.`)}evaluate(e){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(e);const u=this.input.evaluate(e);if(u<=n[0])return a[0].evaluate(e);const d=n.length;if(u>=n[d-1])return a[d-1].evaluate(e);const m=Jl(n,u),_=Ra.interpolationFactor(this.interpolation,u,n[m],n[m+1]),b=a[m].evaluate(e),w=a[m+1].evaluate(e);return this.operator==="interpolate"?ka[this.type.kind.toLowerCase()](b,w,_):this.operator==="interpolate-hcl"?Os.reverse(Os.interpolate(Os.forward(b),Os.forward(w),_)):La.reverse(La.interpolate(La.forward(b),La.forward(w),_))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let a=0;a<this.labels.length;a++)n.push(this.labels[a],this.outputs[a].serialize());return n}}function tc(i,e,n,a){const u=a-n,d=i-n;return u===0?0:e===1?d/u:(Math.pow(e,d)-1)/(Math.pow(e,u)-1)}var Fr=Ra;class Fu{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let a=null;const u=n.expectedType;u&&u.kind!=="value"&&(a=u);const d=[];for(const _ of e.slice(1)){const b=n.parse(_,1+d.length,a,void 0,{typeAnnotation:"omit"});if(!b)return null;a=a||b.type,d.push(b)}const m=u&&d.some(_=>As(u,_.type));return new Fu(m?un:a,d)}evaluate(e){let n,a=null,u=0;for(const d of this.args){if(u++,a=d.evaluate(e),a&&a instanceof er&&!a.available&&(n||(n=a),a=null,u===this.args.length))return n;if(a!==null)break}return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Qf=Fu;class ju{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let d=1;d<e.length-1;d+=2){const m=e[d];if(typeof m!="string")return n.error(`Expected string, but found ${typeof m} instead.`,d);if(/[^a-zA-Z0-9_]/.test(m))return n.error("Variable names must contain only alphanumeric characters or '_'.",d);const _=n.parse(e[d+1],d+1);if(!_)return null;a.push([m,_])}const u=n.parse(e[e.length-1],e.length-1,n.expectedType,a);return u?new ju(a,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,a]of this.bindings)e.push(n,a.serialize());return e.push(this.result.serialize()),e}}var ed=ju;class Nu{constructor(e,n,a){this.type=e,this.index=n,this.input=a}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,Ot),u=n.parse(e[2],2,ar(n.expectedType||un));return a&&u?new Nu(u.type.itemType,a,u):null}evaluate(e){const n=this.index.evaluate(e),a=this.input.evaluate(e);if(n<0)throw new Ci(`Array index out of bounds: ${n} < 0.`);if(n>=a.length)throw new Ci(`Array index out of bounds: ${n} > ${a.length-1}.`);if(n!==Math.floor(n))throw new Ci(`Array index must be an integer, but found ${n} instead.`);return a[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var td=Nu;class Uu{constructor(e,n){this.type=xn,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,un),u=n.parse(e[2],2,un);return a&&u?Vl(a.type,[xn,vn,Ot,Ms,un])?new Uu(a,u):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${oi(a.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(a==null)return!1;if(!yo(n,["boolean","string","number","null"]))throw new Ci(`Expected first argument to be of type boolean, string, number or null, but found ${oi(pi(n))} instead.`);if(!yo(a,["string","array"]))throw new Ci(`Expected second argument to be of type array or string, but found ${oi(pi(a))} instead.`);return a.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Wm=Uu;class nc{constructor(e,n,a){this.type=Ot,this.needle=e,this.haystack=n,this.fromIndex=a}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,un),u=n.parse(e[2],2,un);if(!a||!u)return null;if(!Vl(a.type,[xn,vn,Ot,Ms,un]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${oi(a.type)} instead`);if(e.length===4){const d=n.parse(e[3],3,Ot);return d?new nc(a,u,d):null}return new nc(a,u)}evaluate(e){const n=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!yo(n,["boolean","string","number","null"]))throw new Ci(`Expected first argument to be of type boolean, string, number or null, but found ${oi(pi(n))} instead.`);if(!yo(a,["string","array"]))throw new Ci(`Expected second argument to be of type array or string, but found ${oi(pi(a))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return a.indexOf(n,u)}return a.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Hm=nc;class ic{constructor(e,n,a,u,d,m){this.inputType=e,this.type=n,this.input=a,this.cases=u,this.outputs=d,this.otherwise=m}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let a,u;n.expectedType&&n.expectedType.kind!=="value"&&(u=n.expectedType);const d={},m=[];for(let w=2;w<e.length-1;w+=2){let S=e[w];const I=e[w+1];Array.isArray(S)||(S=[S]);const P=n.concat(w);if(S.length===0)return P.error("Expected at least one branch label.");for(const B of S){if(typeof B!="number"&&typeof B!="string")return P.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return P.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof B=="number"&&Math.floor(B)!==B)return P.error("Numeric branch labels must be integer values.");if(a){if(P.checkSubtype(a,pi(B)))return null}else a=pi(B);if(d[String(B)]!==void 0)return P.error("Branch labels must be unique.");d[String(B)]=m.length}const L=n.parse(I,w,u);if(!L)return null;u=u||L.type,m.push(L)}const _=n.parse(e[1],1,un);if(!_)return null;const b=n.parse(e[e.length-1],e.length-1,u);return b?_.type.kind!=="value"&&n.concat(1).checkSubtype(a,_.type)?null:new ic(a,u,_,d,m,b):null}evaluate(e){const n=this.input.evaluate(e);return(pi(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),a=[],u={};for(const m of n){const _=u[this.cases[m]];_===void 0?(u[this.cases[m]]=a.length,a.push([this.cases[m],[m]])):a[_][1].push(m)}const d=m=>this.inputType.kind==="number"?Number(m):m;for(const[m,_]of a)e.push(_.length===1?d(_[0]):_.map(d)),e.push(this.outputs[m].serialize());return e.push(this.otherwise.serialize()),e}}var nd=ic;class rc{constructor(e,n,a){this.type=e,this.branches=n,this.otherwise=a}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let a;n.expectedType&&n.expectedType.kind!=="value"&&(a=n.expectedType);const u=[];for(let m=1;m<e.length-1;m+=2){const _=n.parse(e[m],m,xn);if(!_)return null;const b=n.parse(e[m+1],m+1,a);if(!b)return null;u.push([_,b]),a=a||b.type}const d=n.parse(e[e.length-1],e.length-1,a);return d?new rc(a,u,d):null}evaluate(e){for(const[n,a]of this.branches)if(n.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,a]of this.branches)e(n),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Xm=rc;class oc{constructor(e,n,a,u){this.type=e,this.input=n,this.beginIndex=a,this.endIndex=u}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,un),u=n.parse(e[2],2,Ot);if(!a||!u)return null;if(!Vl(a.type,[ar(un),vn,un]))return n.error(`Expected first argument to be of type array or string, but found ${oi(a.type)} instead`);if(e.length===4){const d=n.parse(e[3],3,Ot);return d?new oc(a.type,a,u,d):null}return new oc(a.type,a,u)}evaluate(e){const n=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!yo(n,["string","array"]))throw new Ci(`Expected first argument to be of type array or string, but found ${oi(pi(n))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return n.slice(a,u)}return n.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var id=oc;function Vu(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function $u(i,e,n,a){return a.compare(e,n)===0}function ks(i,e,n){const a=i!=="=="&&i!=="!=";return class fS{constructor(d,m,_){this.type=xn,this.lhs=d,this.rhs=m,this.collator=_,this.hasUntypedArgument=d.type.kind==="value"||m.type.kind==="value"}static parse(d,m){if(d.length!==3&&d.length!==4)return m.error("Expected two or three arguments.");const _=d[0];let b=m.parse(d[1],1,un);if(!b)return null;if(!Vu(_,b.type))return m.concat(1).error(`"${_}" comparisons are not supported for type '${oi(b.type)}'.`);let w=m.parse(d[2],2,un);if(!w)return null;if(!Vu(_,w.type))return m.concat(2).error(`"${_}" comparisons are not supported for type '${oi(w.type)}'.`);if(b.type.kind!==w.type.kind&&b.type.kind!=="value"&&w.type.kind!=="value")return m.error(`Cannot compare types '${oi(b.type)}' and '${oi(w.type)}'.`);a&&(b.type.kind==="value"&&w.type.kind!=="value"?b=new gr(w.type,[b]):b.type.kind!=="value"&&w.type.kind==="value"&&(w=new gr(b.type,[w])));let S=null;if(d.length===4){if(b.type.kind!=="string"&&w.type.kind!=="string"&&b.type.kind!=="value"&&w.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(S=m.parse(d[3],3,Ea),!S)return null}return new fS(b,w,S)}evaluate(d){const m=this.lhs.evaluate(d),_=this.rhs.evaluate(d);if(a&&this.hasUntypedArgument){const b=pi(m),w=pi(_);if(b.kind!==w.kind||b.kind!=="string"&&b.kind!=="number")throw new Ci(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${b.kind}, ${w.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const b=pi(m),w=pi(_);if(b.kind!=="string"||w.kind!=="string")return e(d,m,_)}return this.collator?n(d,m,_,this.collator.evaluate(d)):e(d,m,_)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[i];return this.eachChild(m=>{d.push(m.serialize())}),d}}}const Km=ks("==",function(i,e,n){return e===n},$u),Ym=ks("!=",function(i,e,n){return e!==n},function(i,e,n,a){return!$u(0,e,n,a)}),Jm=ks("<",function(i,e,n){return e<n},function(i,e,n,a){return a.compare(e,n)<0}),sc=ks(">",function(i,e,n){return e>n},function(i,e,n,a){return a.compare(e,n)>0}),rd=ks("<=",function(i,e,n){return e<=n},function(i,e,n,a){return a.compare(e,n)<=0}),od=ks(">=",function(i,e,n){return e>=n},function(i,e,n,a){return a.compare(e,n)>=0});class Gu{constructor(e,n,a,u,d,m){this.type=vn,this.number=e,this.locale=n,this.currency=a,this.unit=u,this.minFractionDigits=d,this.maxFractionDigits=m}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const a=n.parse(e[1],1,Ot);if(!a)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return n.error("NumberFormat options argument must be an object.");let d=null;if(u.locale&&(d=n.parse(u.locale,1,vn),!d))return null;let m=null;if(u.currency&&(m=n.parse(u.currency,1,vn),!m))return null;let _=null;if(u.unit&&(_=n.parse(u.unit,1,vn),!_))return null;let b=null;if(u["min-fraction-digits"]&&(b=n.parse(u["min-fraction-digits"],1,Ot),!b))return null;let w=null;return u["max-fraction-digits"]&&(w=n.parse(u["max-fraction-digits"],1,Ot),!w)?null:new Gu(a,d,m,_,b,w)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Zu{constructor(e){this.type=Ot,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=n.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${oi(a.type)} instead.`):new Zu(a):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new Ci(`Expected value to be of type string or array, but found ${oi(pi(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}const sd={"==":Km,"!=":Ym,">":sc,"<":Jm,">=":od,"<=":rd,array:gr,at:td,boolean:gr,case:Xm,coalesce:Qf,collator:Gl,format:za,image:$l,in:Wm,"index-of":Hm,interpolate:Fr,"interpolate-hcl":Fr,"interpolate-lab":Fr,length:Zu,let:ed,literal:Ia,match:nd,number:gr,"number-format":Gu,object:gr,slice:id,step:Pu,string:gr,"to-boolean":Is,"to-color":Is,"to-number":Is,"to-string":Is,var:Kl,within:Hl};function qu(i,[e,n,a,u]){e=e.evaluate(i),n=n.evaluate(i),a=a.evaluate(i);const d=u?u.evaluate(i):1,m=xu(e,n,a,d);if(m)throw new Ci(m);return new Un(e/255*d,n/255*d,a/255*d,d)}function Wu(i,e){return i in e}function ac(i,e){const n=e[i];return n===void 0?null:n}function Yr(i){return{type:i}}Pr.register(sd,{error:[{kind:"error"},[vn],(i,[e])=>{throw new Ci(e.evaluate(i))}],typeof:[vn,[un],(i,[e])=>oi(pi(e.evaluate(i)))],"to-rgba":[ar(Ot,4),[Ar],(i,[e])=>e.evaluate(i).toArray()],rgb:[Ar,[Ot,Ot,Ot],qu],rgba:[Ar,[Ot,Ot,Ot,Ot],qu],has:{type:xn,overloads:[[[vn],(i,[e])=>Wu(e.evaluate(i),i.properties())],[[vn,Ir],(i,[e,n])=>Wu(e.evaluate(i),n.evaluate(i))]]},get:{type:un,overloads:[[[vn],(i,[e])=>ac(e.evaluate(i),i.properties())],[[vn,Ir],(i,[e,n])=>ac(e.evaluate(i),n.evaluate(i))]]},"feature-state":[un,[vn],(i,[e])=>ac(e.evaluate(i),i.featureState||{})],properties:[Ir,[],i=>i.properties()],"geometry-type":[vn,[],i=>i.geometryType()],id:[un,[],i=>i.id()],zoom:[Ot,[],i=>i.globals.zoom],pitch:[Ot,[],i=>i.globals.pitch||0],"distance-from-center":[Ot,[],i=>i.distanceFromCenter()],"heatmap-density":[Ot,[],i=>i.globals.heatmapDensity||0],"line-progress":[Ot,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[Ot,[],i=>i.globals.skyRadialProgress||0],accumulated:[un,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Ot,Yr(Ot),(i,e)=>{let n=0;for(const a of e)n+=a.evaluate(i);return n}],"*":[Ot,Yr(Ot),(i,e)=>{let n=1;for(const a of e)n*=a.evaluate(i);return n}],"-":{type:Ot,overloads:[[[Ot,Ot],(i,[e,n])=>e.evaluate(i)-n.evaluate(i)],[[Ot],(i,[e])=>-e.evaluate(i)]]},"/":[Ot,[Ot,Ot],(i,[e,n])=>e.evaluate(i)/n.evaluate(i)],"%":[Ot,[Ot,Ot],(i,[e,n])=>e.evaluate(i)%n.evaluate(i)],ln2:[Ot,[],()=>Math.LN2],pi:[Ot,[],()=>Math.PI],e:[Ot,[],()=>Math.E],"^":[Ot,[Ot,Ot],(i,[e,n])=>Math.pow(e.evaluate(i),n.evaluate(i))],sqrt:[Ot,[Ot],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[Ot,[Ot],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[Ot,[Ot],(i,[e])=>Math.log(e.evaluate(i))],log2:[Ot,[Ot],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[Ot,[Ot],(i,[e])=>Math.sin(e.evaluate(i))],cos:[Ot,[Ot],(i,[e])=>Math.cos(e.evaluate(i))],tan:[Ot,[Ot],(i,[e])=>Math.tan(e.evaluate(i))],asin:[Ot,[Ot],(i,[e])=>Math.asin(e.evaluate(i))],acos:[Ot,[Ot],(i,[e])=>Math.acos(e.evaluate(i))],atan:[Ot,[Ot],(i,[e])=>Math.atan(e.evaluate(i))],min:[Ot,Yr(Ot),(i,e)=>Math.min(...e.map(n=>n.evaluate(i)))],max:[Ot,Yr(Ot),(i,e)=>Math.max(...e.map(n=>n.evaluate(i)))],abs:[Ot,[Ot],(i,[e])=>Math.abs(e.evaluate(i))],round:[Ot,[Ot],(i,[e])=>{const n=e.evaluate(i);return n<0?-Math.round(-n):Math.round(n)}],floor:[Ot,[Ot],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[Ot,[Ot],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[xn,[vn,un],(i,[e,n])=>i.properties()[e.value]===n.value],"filter-id-==":[xn,[un],(i,[e])=>i.id()===e.value],"filter-type-==":[xn,[vn],(i,[e])=>i.geometryType()===e.value],"filter-<":[xn,[vn,un],(i,[e,n])=>{const a=i.properties()[e.value],u=n.value;return typeof a==typeof u&&a<u}],"filter-id-<":[xn,[un],(i,[e])=>{const n=i.id(),a=e.value;return typeof n==typeof a&&n<a}],"filter->":[xn,[vn,un],(i,[e,n])=>{const a=i.properties()[e.value],u=n.value;return typeof a==typeof u&&a>u}],"filter-id->":[xn,[un],(i,[e])=>{const n=i.id(),a=e.value;return typeof n==typeof a&&n>a}],"filter-<=":[xn,[vn,un],(i,[e,n])=>{const a=i.properties()[e.value],u=n.value;return typeof a==typeof u&&a<=u}],"filter-id-<=":[xn,[un],(i,[e])=>{const n=i.id(),a=e.value;return typeof n==typeof a&&n<=a}],"filter->=":[xn,[vn,un],(i,[e,n])=>{const a=i.properties()[e.value],u=n.value;return typeof a==typeof u&&a>=u}],"filter-id->=":[xn,[un],(i,[e])=>{const n=i.id(),a=e.value;return typeof n==typeof a&&n>=a}],"filter-has":[xn,[un],(i,[e])=>e.value in i.properties()],"filter-has-id":[xn,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[xn,[ar(vn)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[xn,[ar(un)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[xn,[vn,ar(un)],(i,[e,n])=>n.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[xn,[vn,ar(un)],(i,[e,n])=>function(a,u,d,m){for(;d<=m;){const _=d+m>>1;if(u[_]===a)return!0;u[_]>a?m=_-1:d=_+1}return!1}(i.properties()[e.value],n.value,0,n.value.length-1)],all:{type:xn,overloads:[[[xn,xn],(i,[e,n])=>e.evaluate(i)&&n.evaluate(i)],[Yr(xn),(i,e)=>{for(const n of e)if(!n.evaluate(i))return!1;return!0}]]},any:{type:xn,overloads:[[[xn,xn],(i,[e,n])=>e.evaluate(i)||n.evaluate(i)],[Yr(xn),(i,e)=>{for(const n of e)if(n.evaluate(i))return!0;return!1}]]},"!":[xn,[xn],(i,[e])=>!e.evaluate(i)],"is-supported-script":[xn,[vn],(i,[e])=>{const n=i.globals&&i.globals.isSupportedScript;return!n||n(e.evaluate(i))}],upcase:[vn,[vn],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[vn,[vn],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[vn,Yr(un),(i,e)=>e.map(n=>Aa(n.evaluate(i))).join("")],"resolved-locale":[vn,[Ea],(i,[e])=>e.evaluate(i).resolvedLocale()]});var Ba=sd;function ad(i){return{result:"success",value:i}}function Ds(i){return{result:"error",value:i}}function Ls(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function ld(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Hu(i){return!!i.expression&&i.expression.interpolated}function kn(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Fa(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function cd(i){return i}function ja(i,e){const n=e.type==="color",a=i.stops&&typeof i.stops[0][0]=="object",u=a||!(a||i.property!==void 0),d=i.type||(Hu(e)?"exponential":"interval");if(n&&((i=sr({},i)).stops&&(i.stops=i.stops.map(w=>[w[0],Un.parse(w[1])])),i.default=Un.parse(i.default?i.default:e.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!Jf[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let m,_,b;if(d==="exponential")m=Xu;else if(d==="interval")m=Eo;else if(d==="categorical"){m=Qm,_=Object.create(null);for(const w of i.stops)_[w[0]]=w[1];b=typeof i.stops[0][0]}else{if(d!=="identity")throw new Error(`Unknown function type "${d}"`);m=Rs}if(a){const w={},S=[];for(let L=0;L<i.stops.length;L++){const B=i.stops[L],V=B[0].zoom;w[V]===void 0&&(w[V]={zoom:V,type:i.type,property:i.property,default:i.default,stops:[]},S.push(V)),w[V].stops.push([B[0].value,B[1]])}const I=[];for(const L of S)I.push([w[L].zoom,ja(w[L],e)]);const P={name:"linear"};return{kind:"composite",interpolationType:P,interpolationFactor:Fr.interpolationFactor.bind(void 0,P),zoomStops:I.map(L=>L[0]),evaluate:({zoom:L},B)=>Xu({stops:I,base:i.base},e,L).evaluate(L,B)}}if(u){const w=d==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:w,interpolationFactor:Fr.interpolationFactor.bind(void 0,w),zoomStops:i.stops.map(S=>S[0]),evaluate:({zoom:S})=>m(i,e,S,_,b)}}return{kind:"source",evaluate(w,S){const I=S&&S.properties?S.properties[i.property]:void 0;return I===void 0?Na(i.default,e.default):m(i,e,I,_,b)}}}function Na(i,e,n){return i!==void 0?i:e!==void 0?e:n!==void 0?n:void 0}function Qm(i,e,n,a,u){return Na(typeof n===u?a[n]:void 0,i.default,e.default)}function Eo(i,e,n){if(kn(n)!=="number")return Na(i.default,e.default);const a=i.stops.length;if(a===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[a-1][0])return i.stops[a-1][1];const u=Jl(i.stops.map(d=>d[0]),n);return i.stops[u][1]}function Xu(i,e,n){const a=i.base!==void 0?i.base:1;if(kn(n)!=="number")return Na(i.default,e.default);const u=i.stops.length;if(u===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[u-1][0])return i.stops[u-1][1];const d=Jl(i.stops.map(S=>S[0]),n),m=function(S,I,P,L){const B=L-P,V=S-P;return B===0?0:I===1?V/B:(Math.pow(I,V)-1)/(Math.pow(I,B)-1)}(n,a,i.stops[d][0],i.stops[d+1][0]),_=i.stops[d][1],b=i.stops[d+1][1];let w=ka[e.type]||cd;if(i.colorSpace&&i.colorSpace!=="rgb"){const S=Jf[i.colorSpace];w=(I,P)=>S.reverse(S.interpolate(S.forward(I),S.forward(P),m))}return typeof _.evaluate=="function"?{evaluate(...S){const I=_.evaluate.apply(void 0,S),P=b.evaluate.apply(void 0,S);if(I!==void 0&&P!==void 0)return w(I,P,m)}}:w(_,b,m)}function Rs(i,e,n){return e.type==="color"?n=Un.parse(n):e.type==="formatted"?n=Qi.fromString(n.toString()):e.type==="resolvedImage"?n=er.fromString(n.toString()):kn(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0),Na(n,i.default,e.default)}class Ku{constructor(e,n){this.expression=e,this._warningHistory={},this._evaluator=new Wf,this._defaultValue=n?function(a){return a.type==="color"&&(Fa(a.default)||Array.isArray(a.default))?new Un(0,0,0,0):a.type==="color"?Un.parse(a.default)||null:a.default===void 0?null:a.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,a,u,d,m,_,b){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=a,this._evaluator.canonical=u||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=_||null,this._evaluator.featureDistanceData=b||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,a,u,d,m,_,b){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=a||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=_||null,this._evaluator.featureDistanceData=b||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new Ci(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function lc(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Ba}function Bs(i,e){const n=new Ko(Ba,[],e?function(u){const d={color:Ar,string:vn,number:Ot,enum:vn,boolean:xn,formatted:Ca,resolvedImage:Sa};return u.type==="array"?ar(d[u.value]||un,u.length):d[u.type]}(e):void 0),a=n.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?ad(new Ku(a,e)):Ds(n.errors)}class Yu{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!wo(n.expression)}evaluateWithoutErrorHandling(e,n,a,u,d,m){return this._styleExpression.evaluateWithoutErrorHandling(e,n,a,u,d,m)}evaluate(e,n,a,u,d,m){return this._styleExpression.evaluate(e,n,a,u,d,m)}}class Ua{constructor(e,n,a,u){this.kind=e,this.zoomStops=a,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!wo(n.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,n,a,u,d,m){return this._styleExpression.evaluateWithoutErrorHandling(e,n,a,u,d,m)}evaluate(e,n,a,u,d,m){return this._styleExpression.evaluate(e,n,a,u,d,m)}interpolationFactor(e,n,a){return this.interpolationType?Fr.interpolationFactor(this.interpolationType,e,n,a):0}}function Ju(i,e){if((i=Bs(i,e)).result==="error")return i;const n=i.value.expression,a=Xo(n);if(!a&&!Ls(e))return Ds([new Mr("","data expressions not supported")]);const u=Oa(n,["zoom","pitch","distance-from-center"]);if(!u&&!ld(e))return Ds([new Mr("","zoom expressions not supported")]);const d=js(n);return d||u?d instanceof Mr?Ds([d]):d instanceof Fr&&!Hu(e)?Ds([new Mr("",'"interpolate" expressions cannot be used with this property')]):ad(d?new Ua(a?"camera":"composite",i.value,d.labels,d instanceof Fr?d.interpolation:void 0):new Yu(a?"constant":"source",i.value)):Ds([new Mr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Fs{constructor(e,n){this._parameters=e,this._specification=n,sr(this,ja(this._parameters,this._specification))}static deserialize(e){return new Fs(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function js(i){let e=null;if(i instanceof ed)e=js(i.result);else if(i instanceof Qf){for(const n of i.args)if(e=js(n),e)break}else(i instanceof Pu||i instanceof Fr)&&i.input instanceof Pr&&i.input.name==="zoom"&&(e=i);return e instanceof Mr||i.eachChild(n=>{const a=js(n);a instanceof Mr?e=a:!e&&a?e=new Mr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new Mr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class kt{constructor(e,n,a,u){this.message=(e?`${e}: `:"")+a,u&&(this.identifier=u),n!=null&&n.__line__&&(this.line=n.__line__)}}function lr(i){const e=i.key,n=i.value,a=i.valueSpec||{},u=i.objectElementValidators||{},d=i.style,m=i.styleSpec;let _=[];const b=kn(n);if(b!=="object")return[new kt(e,n,`object expected, ${b} found`)];for(const w in n){const S=w.split(".")[0],I=a[S]||a["*"];let P;u[S]?P=u[S]:a[S]?P=Mi:u["*"]?P=u["*"]:a["*"]&&(P=Mi),P?_=_.concat(P({key:(e&&`${e}.`)+w,value:n[w],valueSpec:I,style:d,styleSpec:m,object:n,objectKey:w},n)):_.push(new kt(e,n[w],`unknown property "${w}"`))}for(const w in a)u[w]||a[w].required&&a[w].default===void 0&&n[w]===void 0&&_.push(new kt(e,n,`missing required property "${w}"`));return _}function Qu(i){const e=i.value,n=i.valueSpec,a=i.style,u=i.styleSpec,d=i.key,m=i.arrayElementValidator||Mi;if(kn(e)!=="array")return[new kt(d,e,`array expected, ${kn(e)} found`)];if(n.length&&e.length!==n.length)return[new kt(d,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new kt(d,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let _={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};u.$version<7&&(_.function=n.function),kn(n.value)==="object"&&(_=n.value);let b=[];for(let w=0;w<e.length;w++)b=b.concat(m({array:e,arrayIndex:w,value:e[w],valueSpec:_,style:a,styleSpec:u,key:`${d}[${w}]`}));return b}function eh(i){const e=i.key,n=i.value,a=i.valueSpec;let u=kn(n);if(u==="number"&&n!=n&&(u="NaN"),u!=="number")return[new kt(e,n,`number expected, ${u} found`)];if("minimum"in a){let d=a.minimum;if(kn(a.minimum)==="array"&&(d=a.minimum[i.arrayIndex]),n<d)return[new kt(e,n,`${n} is less than the minimum value ${d}`)]}if("maximum"in a){let d=a.maximum;if(kn(a.maximum)==="array"&&(d=a.maximum[i.arrayIndex]),n>d)return[new kt(e,n,`${n} is greater than the maximum value ${d}`)]}return[]}function Va(i){const e=i.valueSpec,n=ci(i.value.type);let a,u,d,m={};const _=n!=="categorical"&&i.value.property===void 0,b=!_,w=kn(i.value.stops)==="array"&&kn(i.value.stops[0])==="array"&&kn(i.value.stops[0][0])==="object",S=lr({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(L){if(n==="identity")return[new kt(L.key,L.value,'identity function may not have a "stops" property')];let B=[];const V=L.value;return B=B.concat(Qu({key:L.key,value:V,valueSpec:L.valueSpec,style:L.style,styleSpec:L.styleSpec,arrayElementValidator:I})),kn(V)==="array"&&V.length===0&&B.push(new kt(L.key,V,"array must have at least one stop")),B},default:function(L){return Mi({key:L.key,value:L.value,valueSpec:e,style:L.style,styleSpec:L.styleSpec})}}});return n==="identity"&&_&&S.push(new kt(i.key,i.value,'missing required property "property"')),n==="identity"||i.value.stops||S.push(new kt(i.key,i.value,'missing required property "stops"')),n==="exponential"&&i.valueSpec.expression&&!Hu(i.valueSpec)&&S.push(new kt(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(b&&!Ls(i.valueSpec)?S.push(new kt(i.key,i.value,"property functions not supported")):_&&!ld(i.valueSpec)&&S.push(new kt(i.key,i.value,"zoom functions not supported"))),n!=="categorical"&&!w||i.value.property!==void 0||S.push(new kt(i.key,i.value,'"property" property is required')),S;function I(L){let B=[];const V=L.value,Z=L.key;if(kn(V)!=="array")return[new kt(Z,V,`array expected, ${kn(V)} found`)];if(V.length!==2)return[new kt(Z,V,`array length 2 expected, length ${V.length} found`)];if(w){if(kn(V[0])!=="object")return[new kt(Z,V,`object expected, ${kn(V[0])} found`)];if(V[0].zoom===void 0)return[new kt(Z,V,"object stop key must have zoom")];if(V[0].value===void 0)return[new kt(Z,V,"object stop key must have value")];const Q=ci(V[0].zoom);if(typeof Q!="number")return[new kt(Z,V[0].zoom,"stop zoom values must be numbers")];if(d&&d>Q)return[new kt(Z,V[0].zoom,"stop zoom values must appear in ascending order")];Q!==d&&(d=Q,u=void 0,m={}),B=B.concat(lr({key:`${Z}[0]`,value:V[0],valueSpec:{zoom:{}},style:L.style,styleSpec:L.styleSpec,objectElementValidators:{zoom:eh,value:P}}))}else B=B.concat(P({key:`${Z}[0]`,value:V[0],valueSpec:{},style:L.style,styleSpec:L.styleSpec},V));return lc(_o(V[1]))?B.concat([new kt(`${Z}[1]`,V[1],"expressions are not allowed in function stops.")]):B.concat(Mi({key:`${Z}[1]`,value:V[1],valueSpec:e,style:L.style,styleSpec:L.styleSpec}))}function P(L,B){const V=kn(L.value),Z=ci(L.value),Q=L.value!==null?L.value:B;if(a){if(V!==a)return[new kt(L.key,Q,`${V} stop domain type must match previous stop domain type ${a}`)]}else a=V;if(V!=="number"&&V!=="string"&&V!=="boolean"&&typeof Z!="number"&&typeof Z!="string"&&typeof Z!="boolean")return[new kt(L.key,Q,"stop domain value must be a number, string, or boolean")];if(V!=="number"&&n!=="categorical"){let ce=`number expected, ${V} found`;return Ls(e)&&n===void 0&&(ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new kt(L.key,Q,ce)]}return n!=="categorical"||V!=="number"||typeof Z=="number"&&isFinite(Z)&&Math.floor(Z)===Z?n!=="categorical"&&V==="number"&&typeof Z=="number"&&typeof u=="number"&&u!==void 0&&Z<u?[new kt(L.key,Q,"stop domain values must appear in ascending order")]:(u=Z,n==="categorical"&&Z in m?[new kt(L.key,Q,"stop domain values must be unique")]:(m[Z]=!0,[])):[new kt(L.key,Q,`integer expected, found ${String(Z)}`)]}}function zr(i){const e=(i.expressionContext==="property"?Ju:Bs)(_o(i.value),i.valueSpec);if(e.result==="error")return e.value.map(a=>new kt(`${i.key}${a.key}`,i.value,a.message));const n=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!n.outputDefined())return[new kt(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!wo(n))return[new kt(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return th(n,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Oa(n,["zoom","feature-state"]))return[new kt(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Xo(n))return[new kt(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function th(i,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const u of e.valueSpec.expression.parameters)n.delete(u);if(n.size===0)return[];const a=[];return i instanceof Pr&&n.has(i.name)?[new kt(e.key,e.value,`["${i.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(i.eachChild(u=>{a.push(...th(u,e))}),a)}function $a(i){const e=i.key,n=i.value,a=i.valueSpec,u=[];return Array.isArray(a.values)?a.values.indexOf(ci(n))===-1&&u.push(new kt(e,n,`expected one of [${a.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(a.values).indexOf(ci(n))===-1&&u.push(new kt(e,n,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(n)} found`)),u}function Ga(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!Ga(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Za(i,e="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ga(i)||(i=cc(i));const n=i;let a=!0;try{a=function(w){if(!Jr(w))return w;let S=_o(w);return nh(S),S=ud(S),S}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}const u=$e[`filter_${e}`],d=Bs(a,u);let m=null;if(d.result==="error")throw new Error(d.value.map(w=>`${w.key}: ${w.message}`).join(", "));m=(w,S,I)=>d.value.evaluate(w,S,{},I);let _=null,b=null;if(a!==n){const w=Bs(n,u);if(w.result==="error")throw new Error(w.value.map(S=>`${S.key}: ${S.message}`).join(", "));_=(S,I,P,L,B)=>w.value.evaluate(S,I,{},P,void 0,void 0,L,B),b=!Xo(w.value.expression)}return m=m,{filter:m,dynamicFilter:_||void 0,needGeometry:hd(a),needFeature:!!b}}function ud(i){if(!Array.isArray(i))return i;const e=function(n){if(eg.has(n[0])){for(let a=1;a<n.length;a++)if(Jr(n[a]))return!0}return n}(i);return e===!0?e:e.map(n=>ud(n))}function nh(i){let e=!1;const n=[];if(i[0]==="case"){for(let a=1;a<i.length-1;a+=2)e=e||Jr(i[a]),n.push(i[a+1]);n.push(i[i.length-1])}else if(i[0]==="match"){e=e||Jr(i[1]);for(let a=2;a<i.length-1;a+=2)n.push(i[a+1]);n.push(i[i.length-1])}else if(i[0]==="step"){e=e||Jr(i[1]);for(let a=1;a<i.length-1;a+=2)n.push(i[a+1])}e&&(i.length=0,i.push("any",...n));for(let a=1;a<i.length;a++)nh(i[a])}function Jr(i){if(!Array.isArray(i))return!1;if((e=i[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let n=1;n<i.length;n++)if(Jr(i[n]))return!0;return!1}const eg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function tg(i,e){return i<e?-1:i>e?1:0}function hd(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let e=1;e<i.length;e++)if(hd(i[e]))return!0;return!1}function cc(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?ih(i[1],i[2],"=="):e==="!="?Ri(ih(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?ih(i[1],i[2],e):e==="any"?(n=i.slice(1),["any"].concat(n.map(cc))):e==="all"?["all"].concat(i.slice(1).map(cc)):e==="none"?["all"].concat(i.slice(1).map(cc).map(Ri)):e==="in"?qa(i[1],i.slice(2)):e==="!in"?Ri(qa(i[1],i.slice(2))):e==="has"?Wa(i[1]):e==="!has"?Ri(Wa(i[1])):e!=="within"||i;var n}function ih(i,e,n){switch(i){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,i,e]}}function qa(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",i,["literal",e.sort(tg)]]:["filter-in-small",i,["literal",e]]}}function Wa(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Ri(i){return["!",i]}function Ns(i){return Ga(_o(i.value))?zr(sr({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):fd(i)}function fd(i){const e=i.value,n=i.key;if(kn(e)!=="array")return[new kt(n,e,`array expected, ${kn(e)} found`)];const a=i.styleSpec;let u,d=[];if(e.length<1)return[new kt(n,e,"filter array must have at least 1 element")];switch(d=d.concat($a({key:`${n}[0]`,value:e[0],valueSpec:a.filter_operator,style:i.style,styleSpec:i.styleSpec})),ci(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&ci(e[1])==="$type"&&d.push(new kt(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&d.push(new kt(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=kn(e[1]),u!=="string"&&d.push(new kt(`${n}[1]`,e[1],`string expected, ${u} found`)));for(let m=2;m<e.length;m++)u=kn(e[m]),ci(e[1])==="$type"?d=d.concat($a({key:`${n}[${m}]`,value:e[m],valueSpec:a.geometry_type,style:i.style,styleSpec:i.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&d.push(new kt(`${n}[${m}]`,e[m],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let m=1;m<e.length;m++)d=d.concat(fd({key:`${n}[${m}]`,value:e[m],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":u=kn(e[1]),e.length!==2?d.push(new kt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&d.push(new kt(`${n}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=kn(e[1]),e.length!==2?d.push(new kt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="object"&&d.push(new kt(`${n}[1]`,e[1],`object expected, ${u} found`))}return d}function dd(i,e){const n=i.key,a=i.style,u=i.styleSpec,d=i.value,m=i.objectKey,_=u[`${e}_${i.layerType}`];if(!_)return[];const b=m.match(/^(.*)-transition$/);if(e==="paint"&&b&&_[b[1]]&&_[b[1]].transition)return Mi({key:n,value:d,valueSpec:u.transition,style:a,styleSpec:u});const w=i.valueSpec||_[m];if(!w)return[new kt(n,d,`unknown property "${m}"`)];let S;if(kn(d)==="string"&&Ls(w)&&!w.tokens&&(S=/^{([^}]+)}$/.exec(d)))return[new kt(n,d,`"${m}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(S[1])} }\`.`)];const I=[];return i.layerType==="symbol"&&(m==="text-field"&&a&&!a.glyphs&&I.push(new kt(n,d,'use of "text-field" requires a style "glyphs" property')),m==="text-font"&&Fa(_o(d))&&ci(d.type)==="identity"&&I.push(new kt(n,d,'"text-font" does not support identity functions'))),I.concat(Mi({key:i.key,value:d,valueSpec:w,style:a,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:m}))}function pd(i){return dd(i,"paint")}function md(i){return dd(i,"layout")}function uc(i){let e=[];const n=i.value,a=i.key,u=i.style,d=i.styleSpec;n.type||n.ref||e.push(new kt(a,n,'either "type" or "ref" is required'));let m=ci(n.type);const _=ci(n.ref);if(n.id){const b=ci(n.id);for(let w=0;w<i.arrayIndex;w++){const S=u.layers[w];ci(S.id)===b&&e.push(new kt(a,n.id,`duplicate layer id "${n.id}", previously used at line ${S.id.__line__}`))}}if("ref"in n){let b;["type","source","source-layer","filter","layout"].forEach(w=>{w in n&&e.push(new kt(a,n[w],`"${w}" is prohibited for ref layers`))}),u.layers.forEach(w=>{ci(w.id)===_&&(b=w)}),b?b.ref?e.push(new kt(a,n.ref,"ref cannot reference another ref layer")):m=ci(b.type):typeof _=="string"&&e.push(new kt(a,n.ref,`ref layer "${_}" not found`))}else if(m!=="background"&&m!=="sky")if(n.source){const b=u.sources&&u.sources[n.source],w=b&&ci(b.type);b?w==="vector"&&m==="raster"?e.push(new kt(a,n.source,`layer "${n.id}" requires a raster source`)):w==="raster"&&m!=="raster"?e.push(new kt(a,n.source,`layer "${n.id}" requires a vector source`)):w!=="vector"||n["source-layer"]?w==="raster-dem"&&m!=="hillshade"?e.push(new kt(a,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):m!=="line"||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||w==="geojson"&&b.lineMetrics||e.push(new kt(a,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new kt(a,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new kt(a,n.source,`source "${n.source}" not found`))}else e.push(new kt(a,n,'missing required property "source"'));return e=e.concat(lr({key:a,value:n,valueSpec:d.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Mi({key:`${a}.type`,value:n.type,valueSpec:d.layer.type,style:i.style,styleSpec:i.styleSpec,object:n,objectKey:"type"}),filter:b=>Ns(sr({layerType:m},b)),layout:b=>lr({layer:n,key:b.key,value:b.value,valueSpec:{},style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":w=>md(sr({layerType:m},w))}}),paint:b=>lr({layer:n,key:b.key,value:b.value,valueSpec:{},style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":w=>pd(sr({layerType:m},w))}})}})),e}function Us(i){const e=i.value,n=i.key,a=kn(e);return a!=="string"?[new kt(n,e,`string expected, ${a} found`)]:[]}const hc={promoteId:function({key:i,value:e}){if(kn(e)==="string")return Us({key:i,value:e});{const n=[];for(const a in e)n.push(...Us({key:`${i}.${a}`,value:e[a]}));return n}}};function gd(i){const e=i.value,n=i.key,a=i.styleSpec,u=i.style;if(!e.type)return[new kt(n,e,'"type" is required')];const d=ci(e.type);let m;switch(d){case"vector":case"raster":case"raster-dem":return m=lr({key:n,value:e,valueSpec:a[`source_${d.replace("-","_")}`],style:i.style,styleSpec:a,objectElementValidators:hc}),m;case"geojson":if(m=lr({key:n,value:e,valueSpec:a.source_geojson,style:u,styleSpec:a,objectElementValidators:hc}),e.cluster)for(const _ in e.clusterProperties){const[b,w]=e.clusterProperties[_],S=typeof b=="string"?[b,["accumulated"],["get",_]]:b;m.push(...zr({key:`${n}.${_}.map`,value:w,expressionContext:"cluster-map"})),m.push(...zr({key:`${n}.${_}.reduce`,value:S,expressionContext:"cluster-reduce"}))}return m;case"video":return lr({key:n,value:e,valueSpec:a.source_video,style:u,styleSpec:a});case"image":return lr({key:n,value:e,valueSpec:a.source_image,style:u,styleSpec:a});case"canvas":return[new kt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return $a({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:u,styleSpec:a})}}function _d(i){const e=i.value,n=i.styleSpec,a=n.light,u=i.style;let d=[];const m=kn(e);if(e===void 0)return d;if(m!=="object")return d=d.concat([new kt("light",e,`object expected, ${m} found`)]),d;for(const _ in e){const b=_.match(/^(.*)-transition$/);d=d.concat(b&&a[b[1]]&&a[b[1]].transition?Mi({key:_,value:e[_],valueSpec:n.transition,style:u,styleSpec:n}):a[_]?Mi({key:_,value:e[_],valueSpec:a[_],style:u,styleSpec:n}):[new kt(_,e[_],`unknown property "${_}"`)])}return d}function fc(i){const e=i.value,n=i.key,a=i.style,u=i.styleSpec,d=u.terrain;let m=[];const _=kn(e);if(e===void 0)return m;if(_!=="object")return m=m.concat([new kt("terrain",e,`object expected, ${_} found`)]),m;for(const b in e){const w=b.match(/^(.*)-transition$/);m=m.concat(w&&d[w[1]]&&d[w[1]].transition?Mi({key:b,value:e[b],valueSpec:u.transition,style:a,styleSpec:u}):d[b]?Mi({key:b,value:e[b],valueSpec:d[b],style:a,styleSpec:u}):[new kt(b,e[b],`unknown property "${b}"`)])}if(e.source){const b=a.sources&&a.sources[e.source],w=b&&ci(b.type);b?w!=="raster-dem"&&m.push(new kt(n,e.source,`terrain cannot be used with a source of type ${String(w)}, it only be used with a "raster-dem" source type`)):m.push(new kt(n,e.source,`source "${e.source}" not found`))}else m.push(new kt(n,e,'terrain is missing required property "source"'));return m}function yd(i){const e=i.value,n=i.style,a=i.styleSpec,u=a.fog;let d=[];const m=kn(e);if(e===void 0)return d;if(m!=="object")return d=d.concat([new kt("fog",e,`object expected, ${m} found`)]),d;for(const _ in e){const b=_.match(/^(.*)-transition$/);d=d.concat(b&&u[b[1]]&&u[b[1]].transition?Mi({key:_,value:e[_],valueSpec:a.transition,style:n,styleSpec:a}):u[_]?Mi({key:_,value:e[_],valueSpec:u[_],style:n,styleSpec:a}):[new kt(_,e[_],`unknown property "${_}"`)])}return d}const rh={"*":()=>[],array:Qu,boolean:function(i){const e=i.value,n=i.key,a=kn(e);return a!=="boolean"?[new kt(n,e,`boolean expected, ${a} found`)]:[]},number:eh,color:function(i){const e=i.key,n=i.value,a=kn(n);return a!=="string"?[new kt(e,n,`color expected, ${a} found`)]:vo.parseCSSColor(n)===null?[new kt(e,n,`color expected, "${n}" found`)]:[]},enum:$a,filter:Ns,function:Va,layer:uc,object:lr,source:gd,light:_d,terrain:fc,fog:yd,string:Us,formatted:function(i){return Us(i).length===0?[]:zr(i)},resolvedImage:function(i){return Us(i).length===0?[]:zr(i)},projection:function(i){const e=i.value,n=i.styleSpec,a=n.projection,u=i.style;let d=[];const m=kn(e);if(m==="object")for(const _ in e)d=d.concat(Mi({key:_,value:e[_],valueSpec:a[_],style:u,styleSpec:n}));else m!=="string"&&(d=d.concat([new kt("projection",e,`object or string expected, ${m} found`)]));return d}};function Mi(i){const e=i.value,n=i.valueSpec,a=i.styleSpec;return n.expression&&Fa(ci(e))?Va(i):n.expression&&lc(_o(e))?zr(i):n.type&&rh[n.type]?rh[n.type](i):lr(sr({},i,{valueSpec:n.type?a[n.type]:n}))}function ng(i){const e=i.value,n=i.key,a=Us(i);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new kt(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new kt(n,e,'"glyphs" url must include a "{range}" token'))),a}function dc(i,e=$e){return Qr(Mi({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,objectElementValidators:{glyphs:ng,"*":()=>[]}}))}const pc=i=>Qr(pd(i)),vd=i=>Qr(md(i));function Qr(i){return i.slice().sort((e,n)=>e.line&&n.line?e.line-n.line:0)}function oh(i,e){let n=!1;if(e&&e.length)for(const a of e)i.fire(new jn(new Error(a.message))),n=!0;return n}var Vs=yr;function yr(i,e,n){var a=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var u=new Int32Array(this.arrayBuffer);i=u[0],this.d=(e=u[1])+2*(n=u[2]);for(var d=0;d<this.d*this.d;d++){var m=u[3+d],_=u[3+d+1];a.push(m===_?null:u.subarray(m,_))}var b=u[3+a.length+1];this.keys=u.subarray(u[3+a.length],b),this.bboxes=u.subarray(b),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var w=0;w<this.d*this.d;w++)a.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=i,this.padding=n,this.scale=e/i,this.uid=0;var S=n/e*i;this.min=-S,this.max=i+S}yr.prototype.insert=function(i,e,n,a,u){this._forEachCell(e,n,a,u,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(a),this.bboxes.push(u)},yr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},yr.prototype._insertCell=function(i,e,n,a,u,d){this.cells[u].push(d)},yr.prototype.query=function(i,e,n,a,u){var d=this.min,m=this.max;if(i<=d&&e<=d&&m<=n&&m<=a&&!u)return Array.prototype.slice.call(this.keys);var _=[];return this._forEachCell(i,e,n,a,this._queryCell,_,{},u),_},yr.prototype._queryCell=function(i,e,n,a,u,d,m,_){var b=this.cells[u];if(b!==null)for(var w=this.keys,S=this.bboxes,I=0;I<b.length;I++){var P=b[I];if(m[P]===void 0){var L=4*P;(_?_(S[L+0],S[L+1],S[L+2],S[L+3]):i<=S[L+2]&&e<=S[L+3]&&n>=S[L+0]&&a>=S[L+1])?(m[P]=!0,d.push(w[P])):m[P]=!1}}},yr.prototype._forEachCell=function(i,e,n,a,u,d,m,_){for(var b=this._convertToCellCoord(i),w=this._convertToCellCoord(e),S=this._convertToCellCoord(n),I=this._convertToCellCoord(a),P=b;P<=S;P++)for(var L=w;L<=I;L++){var B=this.d*L+P;if((!_||_(this._convertFromCellCoord(P),this._convertFromCellCoord(L),this._convertFromCellCoord(P+1),this._convertFromCellCoord(L+1)))&&u.call(this,i,e,n,a,B,d,m,_))return}},yr.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},yr.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},yr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,e=3+this.cells.length+1+1,n=0,a=0;a<this.cells.length;a++)n+=this.cells[a].length;var u=new Int32Array(e+n+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var d=e,m=0;m<i.length;m++){var _=i[m];u[3+m]=d,u.set(_,d),d+=_.length}return u[3+i.length]=d,u.set(this.keys,d),u[3+i.length+1]=d+=this.keys.length,u.set(this.bboxes,d),d+=this.bboxes.length,u.buffer};const mc={};function Bt(i,e,n={}){Object.defineProperty(i,"_classRegistryKey",{value:e,writeable:!1}),mc[e]={klass:i,omit:n.omit||[]}}Bt(Object,"Object"),Vs.serialize=function(i,e){const n=i.toArrayBuffer();return e&&e.push(n),{buffer:n}},Vs.deserialize=function(i){return new Vs(i.buffer)},Object.defineProperty(Vs,"name",{value:"Grid"}),Bt(Vs,"Grid"),Bt(Un,"Color"),Bt(Error,"Error"),Bt(Se,"AJAXError"),Bt(er,"ResolvedImage"),Bt(Fs,"StylePropertyFunction"),Bt(Ku,"StyleExpression",{omit:["_evaluator"]}),Bt(Ua,"ZoomDependentExpression"),Bt(Yu,"ZoomConstantExpression"),Bt(Pr,"CompoundExpression",{omit:["_evaluate"]});for(const i in Ba)mc[Ba[i]._classRegistryKey]||Bt(Ba[i],`Expression${i}`);function xd(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function bd(i){return A.ImageBitmap&&i instanceof A.ImageBitmap}function $s(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(xd(i)||bd(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const n=i;return e&&e.push(n.buffer),n}if(i instanceof A.ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const n=[];for(const a of i)n.push($s(a,e));return n}if(typeof i=="object"){const n=i.constructor,a=n._classRegistryKey;if(!a)throw new Error(`can't serialize object of unregistered class ${a}`);const u=n.serialize?n.serialize(i,e):{};if(!n.serialize){for(const d in i)i.hasOwnProperty(d)&&(mc[a].omit.indexOf(d)>=0||(u[d]=$s(i[d],e)));i instanceof Error&&(u.message=i.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(u.$name=a),u}throw new Error("can't serialize object of type "+typeof i)}function Ha(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||xd(i)||bd(i)||ArrayBuffer.isView(i)||i instanceof A.ImageData)return i;if(Array.isArray(i))return i.map(Ha);if(typeof i=="object"){const e=i.$name||"Object",{klass:n}=mc[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(i);const a=Object.create(n.prototype);for(const u of Object.keys(i))u!=="$name"&&(a[u]=Ha(i[u]));return a}throw new Error("can't deserialize object of type "+typeof i)}class wd{constructor(){this.first=!0}update(e,n){const a=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=a,!0))}}const Td=i=>i>=1536&&i<=1791,Ed=i=>i>=1872&&i<=1919,Cd=i=>i>=2208&&i<=2303,Sd=i=>i>=11904&&i<=12031,Md=i=>i>=12032&&i<=12255,Xa=i=>i>=12272&&i<=12287,gc=i=>i>=12288&&i<=12351,sh=i=>i>=12352&&i<=12447,Yo=i=>i>=12448&&i<=12543,Ad=i=>i>=12544&&i<=12591,ah=i=>i>=12704&&i<=12735,Id=i=>i>=12736&&i<=12783,lh=i=>i>=12784&&i<=12799,ch=i=>i>=12800&&i<=13055,uh=i=>i>=13056&&i<=13311,hh=i=>i>=13312&&i<=19903,Ka=i=>i>=19968&&i<=40959,_c=i=>i>=40960&&i<=42127,Pd=i=>i>=42128&&i<=42191,zd=i=>i>=44032&&i<=55215,Od=i=>i>=63744&&i<=64255,Ya=i=>i>=64336&&i<=65023,kd=i=>i>=65040&&i<=65055,fh=i=>i>=65072&&i<=65103,Dd=i=>i>=65104&&i<=65135,dh=i=>i>=65136&&i<=65279,ph=i=>i>=65280&&i<=65519;function yc(i){for(const e of i)if(vc(e.charCodeAt(0)))return!0;return!1}function ig(i){for(const e of i)if(!rg(e.charCodeAt(0)))return!1;return!0}function rg(i){return!(Td(i)||Ed(i)||Cd(i)||Ya(i)||dh(i))}function vc(i){return!(i!==746&&i!==747&&(i<4352||!(ah(i)||Ad(i)||fh(i)&&!(i>=65097&&i<=65103)||Od(i)||uh(i)||Sd(i)||Id(i)||!(!gc(i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||hh(i)||Ka(i)||ch(i)||(e=>e>=12592&&e<=12687)(i)||(e=>e>=43360&&e<=43391)(i)||(e=>e>=55216&&e<=55295)(i)||(e=>e>=4352&&e<=4607)(i)||zd(i)||sh(i)||Xa(i)||(e=>e>=12688&&e<=12703)(i)||Md(i)||lh(i)||Yo(i)&&i!==12540||!(!ph(i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Dd(i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||(e=>e>=5120&&e<=5759)(i)||(e=>e>=6320&&e<=6399)(i)||kd(i)||(e=>e>=19904&&e<=19967)(i)||_c(i)||Pd(i))))}function Ja(i){return!(vc(i)||function(e){return!!((n=>n>=128&&n<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(n=>n>=8192&&n<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(n=>n>=8448&&n<=8527)(e)||(n=>n>=8528&&n<=8591)(e)||(n=>n>=8960&&n<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(n=>n>=9216&&n<=9279)(e)&&e!==9251||(n=>n>=9280&&n<=9311)(e)||(n=>n>=9312&&n<=9471)(e)||(n=>n>=9632&&n<=9727)(e)||(n=>n>=9728&&n<=9983)(e)&&!(e>=9754&&e<=9759)||(n=>n>=11008&&n<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||gc(e)||Yo(e)||(n=>n>=57344&&n<=63743)(e)||fh(e)||Dd(e)||ph(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function h(i){return i>=1424&&i<=2303||Ya(i)||dh(i)}function r(i,e){return!(!e&&h(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||(n=>n>=6016&&n<=6143)(i))}function c(i){for(const e of i)if(h(e.charCodeAt(0)))return!0;return!1}const p="deferred",y="loading",v="loaded";let T=null,C="unavailable",M=null;const z=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(C="error"),T&&T(i)};function O(){N.fire(new Gn("pluginStateChange",{pluginStatus:C,pluginURL:M}))}const N=new Wt,$=function(){return C},K=function(){if(C!==p||!M)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");C=y,O(),M&&Ie({url:M},i=>{i?z(i):(C=v,O())})},W={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>C===v||W.applyArabicShaping!=null,isLoading:()=>C===y,setState(i){C=i.pluginStatus,M=i.pluginURL},isParsed:()=>W.applyArabicShaping!=null&&W.processBidirectionalText!=null&&W.processStyledBidirectionalText!=null,getPluginURL:()=>M};class H{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new wd,this.transition={},this.pitch=0)}isSupportedScript(e){return function(n,a){for(const u of n)if(!r(u.charCodeAt(0),a))return!1;return!0}(e,W.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),a=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*n}}}class X{constructor(e,n){this.property=e,this.value=n,this.expression=function(a,u){if(Fa(a))return new Fs(a,u);if(lc(a)){const d=Ju(a,u);if(d.result==="error")throw new Error(d.value.map(m=>`${m.key}: ${m.message}`).join(", "));return d.value}{let d=a;return typeof a=="string"&&u.type==="color"&&(d=Un.parse(a)),{kind:"constant",evaluate:()=>d}}}(n===void 0?e.specification.default:n,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,a){return this.property.possiblyEvaluate(this,e,n,a)}}class q{constructor(e){this.property=e,this.value=new X(e,void 0)}transitioned(e,n){return new Y(this.property,this.value,n,ct({},e.transition,this.transition),e.now)}untransitioned(){return new Y(this.property,this.value,null,{},0)}}class te{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return ln(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new q(this._values[e].property)),this._values[e].value=new X(this._values[e].property,n===null?void 0:ln(n))}getTransition(e){return ln(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new q(this._values[e].property)),this._values[e].transition=ln(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(e[n]=a);const u=this.getTransition(n);u!==void 0&&(e[`${n}-transition`]=u)}return e}transitioned(e,n){const a=new pe(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].transitioned(e,n._values[u]);return a}untransitioned(){const e=new pe(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class Y{constructor(e,n,a,u,d){const m=u.delay||0,_=u.duration||0;d=d||0,this.property=e,this.value=n,this.begin=d+m,this.end=this.begin+_,e.specification.transition&&(u.delay||u.duration)&&(this.prior=a)}possiblyEvaluate(e,n,a){const u=e.now||0,d=this.value.possiblyEvaluate(e,n,a),m=this.prior;if(m){if(u>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(u<this.begin)return m.possiblyEvaluate(e,n,a);{const _=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,n,a),d,Te(_))}}return d}}class pe{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,a){const u=new de(this._properties);for(const d of Object.keys(this._values))u._values[d]=this._values[d].possiblyEvaluate(e,n,a);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class fe{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return ln(this._values[e].value)}setValue(e,n){this._values[e]=new X(this._values[e].property,n===null?void 0:ln(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(e[n]=a)}return e}possiblyEvaluate(e,n,a){const u=new de(this._properties);for(const d of Object.keys(this._values))u._values[d]=this._values[d].possiblyEvaluate(e,n,a);return u}}class le{constructor(e,n,a){this.property=e,this.value=n,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,a,u){return this.property.evaluate(this.value,this.parameters,e,n,a,u)}}class de{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class he{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,a){const u=ka[this.specification.type];return u?u(e,n,a):e}}class ve{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,a,u){return new le(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},a,u)}:e.expression,n)}interpolate(e,n,a){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new le(this,{kind:"constant",value:void 0},e.parameters);const u=ka[this.specification.type];return u?new le(this,{kind:"constant",value:u(e.value.value,n.value.value,a)},e.parameters):e}evaluate(e,n,a,u,d,m){return e.kind==="constant"?e.value:e.evaluate(n,a,u,d,m)}}class ze extends ve{possiblyEvaluate(e,n,a,u){if(e.value===void 0)return new le(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const d=e.expression.evaluate(n,null,{},a,u),m=e.property.specification.type==="resolvedImage"&&typeof d!="string"?d.name:d,_=this._calculate(m,m,m,n);return new le(this,{kind:"constant",value:_},n)}if(e.expression.kind==="camera"){const d=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new le(this,{kind:"constant",value:d},n)}return new le(this,e.expression,n)}evaluate(e,n,a,u,d,m){if(e.kind==="source"){const _=e.evaluate(n,a,u,d,m);return this._calculate(_,_,_,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},a,u),e.evaluate({zoom:Math.floor(n.zoom)},a,u),e.evaluate({zoom:Math.floor(n.zoom)+1},a,u),n):e.value}_calculate(e,n,a,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:n,other:a}:{from:a,to:n,other:e}}interpolate(e){return e}}class pt{constructor(e){this.specification=e}possiblyEvaluate(e,n,a,u){if(e.value!==void 0){if(e.expression.kind==="constant"){const d=e.expression.evaluate(n,null,{},a,u);return this._calculate(d,d,d,n)}return this._calculate(e.expression.evaluate(new H(Math.floor(n.zoom-1),n)),e.expression.evaluate(new H(Math.floor(n.zoom),n)),e.expression.evaluate(new H(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,a,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:a,to:n}}interpolate(e){return e}}class Ce{constructor(e){this.specification=e}possiblyEvaluate(e,n,a,u){return!!e.expression.evaluate(n,null,{},a,u)}interpolate(){return!1}}class He{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new H(0,{});for(const a in e){const u=e[a];u.specification.overridable&&this.overridableProperties.push(a);const d=this.defaultPropertyValues[a]=new X(u,void 0),m=this.defaultTransitionablePropertyValues[a]=new q(u);this.defaultTransitioningPropertyValues[a]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=d.possiblyEvaluate(n)}}}function et(i,e){return 256*(i=Pe(Math.floor(i),0,255))+Pe(Math.floor(e),0,255)}Bt(ve,"DataDrivenProperty"),Bt(he,"DataConstantProperty"),Bt(ze,"CrossFadedDataDrivenProperty"),Bt(pt,"CrossFadedProperty"),Bt(Ce,"ColorRampProperty");const St={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class je{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class gt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Je(i,e=1){let n=0,a=0;return{members:i.map(u=>{const d=St[u.type].BYTES_PER_ELEMENT,m=n=It(n,Math.max(e,d)),_=u.components||1;return a=Math.max(a,d),n+=d*_,{name:u.name,type:u.type,components:_,offset:m}}),size:It(n,Math.max(a,e)),alignment:e}}function It(i,e){return Math.ceil(i/e)*e}class At extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const u=2*e;return this.int16[u+0]=n,this.int16[u+1]=a,e}}At.prototype.bytesPerElement=4,Bt(At,"StructArrayLayout2i4");class Nt extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,a)}emplace(e,n,a,u){const d=3*e;return this.int16[d+0]=n,this.int16[d+1]=a,this.int16[d+2]=u,e}}Nt.prototype.bytesPerElement=6,Bt(Nt,"StructArrayLayout3i6");class Zt extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,a,u)}emplace(e,n,a,u,d){const m=4*e;return this.int16[m+0]=n,this.int16[m+1]=a,this.int16[m+2]=u,this.int16[m+3]=d,e}}Zt.prototype.bytesPerElement=8,Bt(Zt,"StructArrayLayout4i8");class tn extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,_){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,a,u,d,m,_)}emplace(e,n,a,u,d,m,_,b){const w=6*e,S=12*e,I=3*e;return this.int16[w+0]=n,this.int16[w+1]=a,this.uint8[S+4]=u,this.uint8[S+5]=d,this.uint8[S+6]=m,this.uint8[S+7]=_,this.float32[I+2]=b,e}}tn.prototype.bytesPerElement=12,Bt(tn,"StructArrayLayout2i4ub1f12");class bn extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,a,u)}emplace(e,n,a,u,d){const m=4*e;return this.float32[m+0]=n,this.float32[m+1]=a,this.float32[m+2]=u,this.float32[m+3]=d,e}}bn.prototype.bytesPerElement=16,Bt(bn,"StructArrayLayout4f16");class Ut extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,_,b,w,S){const I=this.length;return this.resize(I+1),this.emplace(I,e,n,a,u,d,m,_,b,w,S)}emplace(e,n,a,u,d,m,_,b,w,S,I){const P=10*e;return this.uint16[P+0]=n,this.uint16[P+1]=a,this.uint16[P+2]=u,this.uint16[P+3]=d,this.uint16[P+4]=m,this.uint16[P+5]=_,this.uint16[P+6]=b,this.uint16[P+7]=w,this.uint16[P+8]=S,this.uint16[P+9]=I,e}}Ut.prototype.bytesPerElement=20,Bt(Ut,"StructArrayLayout10ui20");class an extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,_,b){const w=this.length;return this.resize(w+1),this.emplace(w,e,n,a,u,d,m,_,b)}emplace(e,n,a,u,d,m,_,b,w){const S=8*e;return this.uint16[S+0]=n,this.uint16[S+1]=a,this.uint16[S+2]=u,this.uint16[S+3]=d,this.uint16[S+4]=m,this.uint16[S+5]=_,this.uint16[S+6]=b,this.uint16[S+7]=w,e}}an.prototype.bytesPerElement=16,Bt(an,"StructArrayLayout8ui16");class An extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m){const _=this.length;return this.resize(_+1),this.emplace(_,e,n,a,u,d,m)}emplace(e,n,a,u,d,m,_){const b=6*e;return this.int16[b+0]=n,this.int16[b+1]=a,this.int16[b+2]=u,this.int16[b+3]=d,this.int16[b+4]=m,this.int16[b+5]=_,e}}An.prototype.bytesPerElement=12,Bt(An,"StructArrayLayout6i12");class Jn extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,_,b,w,S,I,P){const L=this.length;return this.resize(L+1),this.emplace(L,e,n,a,u,d,m,_,b,w,S,I,P)}emplace(e,n,a,u,d,m,_,b,w,S,I,P,L){const B=12*e;return this.int16[B+0]=n,this.int16[B+1]=a,this.int16[B+2]=u,this.int16[B+3]=d,this.uint16[B+4]=m,this.uint16[B+5]=_,this.uint16[B+6]=b,this.uint16[B+7]=w,this.int16[B+8]=S,this.int16[B+9]=I,this.int16[B+10]=P,this.int16[B+11]=L,e}}Jn.prototype.bytesPerElement=24,Bt(Jn,"StructArrayLayout4i4ui4i24");class ui extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m){const _=this.length;return this.resize(_+1),this.emplace(_,e,n,a,u,d,m)}emplace(e,n,a,u,d,m,_){const b=10*e,w=5*e;return this.int16[b+0]=n,this.int16[b+1]=a,this.int16[b+2]=u,this.float32[w+2]=d,this.float32[w+3]=m,this.float32[w+4]=_,e}}ui.prototype.bytesPerElement=20,Bt(ui,"StructArrayLayout3i3f20");class Vn extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}Vn.prototype.bytesPerElement=4,Bt(Vn,"StructArrayLayout1ul4");class Ai extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,_,b,w,S,I,P,L){const B=this.length;return this.resize(B+1),this.emplace(B,e,n,a,u,d,m,_,b,w,S,I,P,L)}emplace(e,n,a,u,d,m,_,b,w,S,I,P,L,B){const V=20*e,Z=10*e;return this.int16[V+0]=n,this.int16[V+1]=a,this.int16[V+2]=u,this.int16[V+3]=d,this.int16[V+4]=m,this.float32[Z+3]=_,this.float32[Z+4]=b,this.float32[Z+5]=w,this.float32[Z+6]=S,this.int16[V+14]=I,this.uint32[Z+8]=P,this.uint16[V+18]=L,this.uint16[V+19]=B,e}}Ai.prototype.bytesPerElement=40,Bt(Ai,"StructArrayLayout5i4f1i1ul2ui40");class Or extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,_){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,a,u,d,m,_)}emplace(e,n,a,u,d,m,_,b){const w=8*e;return this.int16[w+0]=n,this.int16[w+1]=a,this.int16[w+2]=u,this.int16[w+4]=d,this.int16[w+5]=m,this.int16[w+6]=_,this.int16[w+7]=b,e}}Or.prototype.bytesPerElement=16,Bt(Or,"StructArrayLayout3i2i2i16");class eo extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,a,u,d)}emplace(e,n,a,u,d,m){const _=4*e,b=8*e;return this.float32[_+0]=n,this.float32[_+1]=a,this.float32[_+2]=u,this.int16[b+6]=d,this.int16[b+7]=m,e}}eo.prototype.bytesPerElement=16,Bt(eo,"StructArrayLayout2f1f2i16");class Qn extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,a,u)}emplace(e,n,a,u,d){const m=12*e,_=3*e;return this.uint8[m+0]=n,this.uint8[m+1]=a,this.float32[_+1]=u,this.float32[_+2]=d,e}}Qn.prototype.bytesPerElement=12,Bt(Qn,"StructArrayLayout2ub2f12");class ni extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,a)}emplace(e,n,a,u){const d=3*e;return this.float32[d+0]=n,this.float32[d+1]=a,this.float32[d+2]=u,e}}ni.prototype.bytesPerElement=12,Bt(ni,"StructArrayLayout3f12");class gn extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,a)}emplace(e,n,a,u){const d=3*e;return this.uint16[d+0]=n,this.uint16[d+1]=a,this.uint16[d+2]=u,e}}gn.prototype.bytesPerElement=6,Bt(gn,"StructArrayLayout3ui6");class gi extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,_,b,w,S,I,P,L,B,V,Z,Q,ce,ne,ae,me){const ue=this.length;return this.resize(ue+1),this.emplace(ue,e,n,a,u,d,m,_,b,w,S,I,P,L,B,V,Z,Q,ce,ne,ae,me)}emplace(e,n,a,u,d,m,_,b,w,S,I,P,L,B,V,Z,Q,ce,ne,ae,me,ue){const Re=30*e,De=15*e,Ze=60*e;return this.int16[Re+0]=n,this.int16[Re+1]=a,this.int16[Re+2]=u,this.float32[De+2]=d,this.float32[De+3]=m,this.uint16[Re+8]=_,this.uint16[Re+9]=b,this.uint32[De+5]=w,this.uint32[De+6]=S,this.uint32[De+7]=I,this.uint16[Re+16]=P,this.uint16[Re+17]=L,this.uint16[Re+18]=B,this.float32[De+10]=V,this.float32[De+11]=Z,this.uint8[Ze+48]=Q,this.uint8[Ze+49]=ce,this.uint8[Ze+50]=ne,this.uint32[De+13]=ae,this.int16[Re+28]=me,this.uint8[Ze+58]=ue,e}}gi.prototype.bytesPerElement=60,Bt(gi,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Bi extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d,m,_,b,w,S,I,P,L,B,V,Z,Q,ce,ne,ae,me,ue,Re,De,Ze,_t,Fe,Ke,nt,Ye){const mt=this.length;return this.resize(mt+1),this.emplace(mt,e,n,a,u,d,m,_,b,w,S,I,P,L,B,V,Z,Q,ce,ne,ae,me,ue,Re,De,Ze,_t,Fe,Ke,nt,Ye)}emplace(e,n,a,u,d,m,_,b,w,S,I,P,L,B,V,Z,Q,ce,ne,ae,me,ue,Re,De,Ze,_t,Fe,Ke,nt,Ye,mt){const it=38*e,Pt=19*e;return this.int16[it+0]=n,this.int16[it+1]=a,this.int16[it+2]=u,this.float32[Pt+2]=d,this.float32[Pt+3]=m,this.int16[it+8]=_,this.int16[it+9]=b,this.int16[it+10]=w,this.int16[it+11]=S,this.int16[it+12]=I,this.int16[it+13]=P,this.uint16[it+14]=L,this.uint16[it+15]=B,this.uint16[it+16]=V,this.uint16[it+17]=Z,this.uint16[it+18]=Q,this.uint16[it+19]=ce,this.uint16[it+20]=ne,this.uint16[it+21]=ae,this.uint16[it+22]=me,this.uint16[it+23]=ue,this.uint16[it+24]=Re,this.uint16[it+25]=De,this.uint16[it+26]=Ze,this.uint16[it+27]=_t,this.uint16[it+28]=Fe,this.uint32[Pt+15]=Ke,this.float32[Pt+16]=nt,this.float32[Pt+17]=Ye,this.float32[Pt+18]=mt,e}}Bi.prototype.bytesPerElement=76,Bt(Bi,"StructArrayLayout3i2f6i15ui1ul3f76");class Hn extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}Hn.prototype.bytesPerElement=4,Bt(Hn,"StructArrayLayout1f4");class Fi extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,u,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,a,u,d)}emplace(e,n,a,u,d,m){const _=5*e;return this.float32[_+0]=n,this.float32[_+1]=a,this.float32[_+2]=u,this.float32[_+3]=d,this.float32[_+4]=m,e}}Fi.prototype.bytesPerElement=20,Bt(Fi,"StructArrayLayout5f20");class Jo extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,a,u)}emplace(e,n,a,u,d){const m=6*e;return this.uint32[3*e+0]=n,this.uint16[m+2]=a,this.uint16[m+3]=u,this.uint16[m+4]=d,e}}Jo.prototype.bytesPerElement=12,Bt(Jo,"StructArrayLayout1ul3ui12");class qi extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const u=2*e;return this.uint16[u+0]=n,this.uint16[u+1]=a,e}}qi.prototype.bytesPerElement=4,Bt(qi,"StructArrayLayout2ui4");class Qo extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}Qo.prototype.bytesPerElement=2,Bt(Qo,"StructArrayLayout1ui2");class es extends gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const u=2*e;return this.float32[u+0]=n,this.float32[u+1]=a,e}}es.prototype.bytesPerElement=8,Bt(es,"StructArrayLayout2f8");class ts extends je{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}ts.prototype.size=12;class Wi extends An{get(e){return new ts(this,e)}}Bt(Wi,"FillExtrusionExtArray");class ns extends je{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ns.prototype.size=40;class Co extends Ai{get(e){return new ns(this,e)}}Bt(Co,"CollisionBoxArray");class Qa extends je{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Qa.prototype.size=60;class Xv extends gi{get(e){return new Qa(this,e)}}Bt(Xv,"PlacedSymbolArray");class Kv extends je{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Kv.prototype.size=76;class Yv extends Bi{get(e){return new Kv(this,e)}}Bt(Yv,"SymbolInstanceArray");class Jv extends Hn{getoffsetX(e){return this.float32[1*e+0]}}Bt(Jv,"GlyphOffsetArray");class Qv extends Nt{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Bt(Qv,"SymbolLineVertexArray");class e0 extends je{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}e0.prototype.size=12;class t0 extends Jo{get(e){return new e0(this,e)}}Bt(t0,"FeatureIndexArray");class n0 extends je{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}n0.prototype.size=4;class i0 extends qi{get(e){return new n0(this,e)}}Bt(i0,"FillExtrusionCentroidArray");class r0 extends je{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}r0.prototype.size=12;class o0 extends An{get(e){return new r0(this,e)}}Bt(o0,"CircleGlobeExtArray");const dS=Je([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),pS=Je([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var s0=yu(function(i){i.exports=function(e,n){var a,u,d,m,_,b,w,S;for(u=e.length-(a=3&e.length),d=n,_=3432918353,b=461845907,S=0;S<u;)w=255&e.charCodeAt(S)|(255&e.charCodeAt(++S))<<8|(255&e.charCodeAt(++S))<<16|(255&e.charCodeAt(++S))<<24,++S,d=27492+(65535&(m=5*(65535&(d=(d^=w=(65535&(w=(w=(65535&w)*_+(((w>>>16)*_&65535)<<16)&4294967295)<<15|w>>>17))*b+(((w>>>16)*b&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(w=0,a){case 3:w^=(255&e.charCodeAt(S+2))<<16;case 2:w^=(255&e.charCodeAt(S+1))<<8;case 1:d^=w=(65535&(w=(w=(65535&(w^=255&e.charCodeAt(S)))*_+(((w>>>16)*_&65535)<<16)&4294967295)<<15|w>>>17))*b+(((w>>>16)*b&65535)<<16)&4294967295}return d^=e.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0}}),mS=yu(function(i){i.exports=function(e,n){for(var a,u=e.length,d=n^u,m=0;u>=4;)a=1540483477*(65535&(a=255&e.charCodeAt(m)|(255&e.charCodeAt(++m))<<8|(255&e.charCodeAt(++m))<<16|(255&e.charCodeAt(++m))<<24))+((1540483477*(a>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),u-=4,++m;switch(u){case 3:d^=(255&e.charCodeAt(m+2))<<16;case 2:d^=(255&e.charCodeAt(m+1))<<8;case 1:d=1540483477*(65535&(d^=255&e.charCodeAt(m)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0}}),mh=s0,gS=mS;mh.murmur3=s0,mh.murmur2=gS;class Ld{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,a,u){this.ids.push(a0(e)),this.positions.push(n,a,u)}getPositions(e){const n=a0(e);let a=0,u=this.ids.length-1;for(;a<u;){const m=a+u>>1;this.ids[m]>=n?u=m:a=m+1}const d=[];for(;this.ids[a]===n;)d.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return d}static serialize(e,n){const a=new Float64Array(e.ids),u=new Uint32Array(e.positions);return og(a,u,0,a.length-1),n&&n.push(a.buffer,u.buffer),{ids:a,positions:u}}static deserialize(e){const n=new Ld;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function a0(i){const e=+i;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:mh(String(i))}function og(i,e,n,a){for(;n<a;){const u=i[n+a>>1];let d=n-1,m=a+1;for(;;){do d++;while(i[d]<u);do m--;while(i[m]>u);if(d>=m)break;Rd(i,d,m),Rd(e,3*d,3*m),Rd(e,3*d+1,3*m+1),Rd(e,3*d+2,3*m+2)}m-n<a-m?(og(i,e,n,m),n=m+1):(og(i,e,m+1,a),a=m)}}function Rd(i,e,n){const a=i[e];i[e]=i[n],i[n]=a}Bt(Ld,"FeaturePositionMap");class is{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,n),this.initialized=!0),!!this.location}}class Bd extends is{constructor(e){super(e),this.current=0}set(e,n,a){this.fetchUniformLocation(e,n)&&this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class l0 extends is{constructor(e){super(e),this.current=[0,0,0,0]}set(e,n,a){this.fetchUniformLocation(e,n)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3])))}}class c0 extends is{constructor(e){super(e),this.current=Un.transparent}set(e,n,a){this.fetchUniformLocation(e,n)&&(a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a)))}}const _S=new Float32Array(16),yS=new Float32Array(9),vS=new Float32Array(4);function sg(i){return[et(255*i.r,255*i.g),et(255*i.b,255*i.a)]}class gh{constructor(e,n,a){this.value=e,this.uniformNames=n.map(u=>`u_${u}`),this.type=a}setUniform(e,n,a,u,d){n.set(e,d,u.constantOr(this.value))}getBinding(e,n){return this.type==="color"?new c0(e):new Bd(e)}}class xc{constructor(e,n){this.uniformNames=n.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio||1,this.pixelRatioTo=e.pixelRatio||1,this.patternFrom=n.tl.concat(n.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,n,a,u,d){const m=d==="u_pattern_to"||d==="u_dash_to"?this.patternTo:d==="u_pattern_from"||d==="u_dash_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&n.set(e,d,m)}getBinding(e,n){return n==="u_pattern_from"||n==="u_pattern_to"||n==="u_dash_from"||n==="u_dash_to"?new l0(e):new Bd(e)}}class rs{constructor(e,n,a,u){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=n.map(d=>({name:`a_${d}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,n,a,u,d,m){const _=this.paintVertexArray.length,b=this.expression.evaluate(new H(0),n,{},d,u,m);this.paintVertexArray.resize(e),this._setPaintValue(_,e,b)}updatePaintArray(e,n,a,u,d){const m=this.expression.evaluate({zoom:0},a,u,void 0,d);this._setPaintValue(e,n,m)}_setPaintValue(e,n,a){if(this.type==="color"){const u=sg(a);for(let d=e;d<n;d++)this.paintVertexArray.emplace(d,u[0],u[1])}else{for(let u=e;u<n;u++)this.paintVertexArray.emplace(u,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class to{constructor(e,n,a,u,d,m){this.expression=e,this.uniformNames=n.map(_=>`u_${_}_t`),this.type=a,this.useIntegerZoom=u,this.zoom=d,this.maxValue=0,this.paintVertexAttributes=n.map(_=>({name:`a_${_}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(e,n,a,u,d,m){const _=this.expression.evaluate(new H(this.zoom),n,{},d,u,m),b=this.expression.evaluate(new H(this.zoom+1),n,{},d,u,m),w=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(w,e,_,b)}updatePaintArray(e,n,a,u,d){const m=this.expression.evaluate({zoom:this.zoom},a,u,void 0,d),_=this.expression.evaluate({zoom:this.zoom+1},a,u,void 0,d);this._setPaintValue(e,n,m,_)}_setPaintValue(e,n,a,u){if(this.type==="color"){const d=sg(a),m=sg(u);for(let _=e;_<n;_++)this.paintVertexArray.emplace(_,d[0],d[1],m[0],m[1])}else{for(let d=e;d<n;d++)this.paintVertexArray.emplace(d,a,u);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n,a,u,d){const m=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,_=Pe(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);n.set(e,d,_)}getBinding(e,n){return new Bd(e)}}class Gs{constructor(e,n,a,u,d,m,_){this.expression=e,this.type=a,this.useIntegerZoom=u,this.zoom=d,this.layerId=_,this.paintVertexAttributes=(a==="array"?pS:dS).members;for(let b=0;b<n.length;++b);this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,n,a){const u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,n.patterns&&n.patterns[this.layerId],a)}updatePaintArray(e,n,a,u,d,m){this._setPaintValues(e,n,a.patterns&&a.patterns[this.layerId],m)}_setPaintValues(e,n,a,u){if(!u||!a)return;const{min:d,mid:m,max:_}=a,b=u[d],w=u[m],S=u[_];if(b&&w&&S)for(let I=e;I<n;I++)this._setPaintValue(this.zoomInPaintVertexArray,I,w,b),this._setPaintValue(this.zoomOutPaintVertexArray,I,w,S)}_setPaintValue(e,n,a,u){e.emplace(n,a.tl[0],a.tl[1],a.br[0],a.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],a.pixelRatio,u.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Zs{constructor(e,n,a=()=>!0){this.binders={},this._buffers=[];const u=[];for(const d in e.paint._values){if(!a(d))continue;const m=e.paint.get(d);if(!(m instanceof le&&Ls(m.property.specification)))continue;const _=bS(d,e.type),b=m.value,w=m.property.specification.type,S=m.property.useIntegerZoom,I=m.property.specification["property-type"],P=I==="cross-faded"||I==="cross-faded-data-driven",L=String(d)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(b.kind!=="constant"||L)if(b.kind==="source"||L||P){const B=u0(d,w,"source");this.binders[d]=P?new Gs(b,_,w,S,n,B,e.id):new rs(b,_,w,B),u.push(`/a_${d}`)}else{const B=u0(d,w,"composite");this.binders[d]=new to(b,_,w,S,n,B),u.push(`/z_${d}`)}else this.binders[d]=P?new xc(b.value,_):new gh(b.value,_,w),u.push(`/u_${d}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof rs||n instanceof to?n.maxValue:0}populatePaintArrays(e,n,a,u,d,m){for(const _ in this.binders){const b=this.binders[_];(b instanceof rs||b instanceof to||b instanceof Gs)&&b.populatePaintArray(e,n,a,u,d,m)}}setConstantPatternPositions(e,n){for(const a in this.binders){const u=this.binders[a];u instanceof xc&&u.setConstantPatternPositions(e,n)}}updatePaintArrays(e,n,a,u,d,m){let _=!1;for(const b in e){const w=n.getPositions(b);for(const S of w){const I=a.feature(S.index);for(const P in this.binders){const L=this.binders[P];if((L instanceof rs||L instanceof to||L instanceof Gs)&&L.expression.isStateDependent===!0){const B=u.paint.get(P);L.expression=B.value,L.updatePaintArray(S.start,S.end,I,e[b],d,m),_=!0}}}}return _}defines(){const e=[];for(const n in this.binders){const a=this.binders[n];(a instanceof gh||a instanceof xc)&&e.push(...a.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof rs||a instanceof to||a instanceof Gs)for(let u=0;u<a.paintVertexAttributes.length;u++)e.push(a.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof gh||a instanceof xc||a instanceof to)for(const u of a.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const n=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof gh||u instanceof xc||u instanceof to)for(const d of u.uniformNames)n.push({name:d,property:a,binding:u.getBinding(e,d)})}return n}setUniforms(e,n,a,u,d){for(const{name:m,property:_,binding:b}of a)this.binders[_].setUniform(e,b,d,u.get(_),m)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const a=this.binders[n];if(e&&a instanceof Gs){const u=e.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(a instanceof rs||a instanceof to)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(e){for(const n in this.binders){const a=this.binders[n];(a instanceof rs||a instanceof to||a instanceof Gs)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof rs||n instanceof to||n instanceof Gs)&&n.destroy()}}}class el{constructor(e,n,a=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new Zs(u,n,a);this.needsUpload=!1,this._featureMap=new Ld,this._bufferOffset=0}populatePaintArrays(e,n,a,u,d,m,_){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(e,n,u,d,m,_);n.id!==void 0&&this._featureMap.add(n.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,a,u,d){for(const m of a)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,n,m,u,d)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const xS={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function bS(i,e){return xS[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}const wS={"line-pattern":{source:Ut,composite:Ut},"fill-pattern":{source:Ut,composite:Ut},"fill-extrusion-pattern":{source:Ut,composite:Ut},"line-dasharray":{source:an,composite:an}},TS={color:{source:es,composite:bn},number:{source:Hn,composite:es}};function u0(i,e,n){const a=wS[i];return a&&a[n]||TS[e][n]}Bt(gh,"ConstantBinder"),Bt(xc,"CrossFadedConstantBinder"),Bt(rs,"SourceExpressionBinder"),Bt(Gs,"CrossFadedCompositeBinder"),Bt(to,"CompositeExpressionBinder"),Bt(Zs,"ProgramConfiguration",{omit:["_buffers"]}),Bt(el,"ProgramConfigurationSet");const Fd="-transition";class no extends Wt{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new fe(n.layout)),n.paint)){this._transitionablePaint=new te(n.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new de(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,a={}){n!=null&&this._validate(vd,`layers.${this.id}.layout.${e}`,e,n,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return at(e,Fd)?this._transitionablePaint.getTransition(e.slice(0,-Fd.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,a={}){if(n!=null&&this._validate(pc,`layers.${this.id}.paint.${e}`,e,n,a))return!1;if(at(e,Fd))return this._transitionablePaint.setTransition(e.slice(0,-Fd.length),n||void 0),!1;{const u=this._transitionablePaint._values[e],d=u.property.specification["property-type"]==="cross-faded-data-driven",m=u.value.isDataDriven(),_=u.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const b=this._transitionablePaint._values[e].value;return b.isDataDriven()||m||d||this._handleOverridablePaintPropertyUpdate(e,_,b)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,n,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Ft(e,(n,a)=>!(n===void 0||a==="layout"&&!Object.keys(n).length||a==="paint"&&!Object.keys(n).length))}_validate(e,n,a,u,d={}){return(!d||d.validate!==!1)&&oh(this,e.call(dc,{key:n,layerType:this.type,objectKey:a,value:u,styleSpec:$e,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof le&&Ls(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Za(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const ES=Je([{name:"a_pos",components:2,type:"Int16"}],4),CS=Je([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class xi{constructor(e=[]){this.segments=e}prepareSegment(e,n,a,u){let d=this.segments[this.segments.length-1];return e>xi.MAX_VERTEX_ARRAY_LENGTH&&Lt(`Max vertices per segment is ${xi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!d||d.vertexLength+e>xi.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==u)&&(d={vertexOffset:n.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},u!==void 0&&(d.sortKey=u),this.segments.push(d)),d}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,a,u){return new xi([{vertexOffset:e,primitiveOffset:n,vertexLength:a,primitiveLength:u,vaos:{},sortKey:0}])}}xi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Bt(xi,"SegmentVector");var Qt=8192;class qs{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Ln?new Ln(e.lng,e.lat):Ln.convert(e),this}setSouthWest(e){return this._sw=e instanceof Ln?new Ln(e.lng,e.lat):Ln.convert(e),this}extend(e){const n=this._sw,a=this._ne;let u,d;if(e instanceof Ln)u=e,d=e;else{if(!(e instanceof qs))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(qs.convert(e)):this.extend(Ln.convert(e)):this;if(u=e._sw,d=e._ne,!u||!d)return this}return n||a?(n.lng=Math.min(u.lng,n.lng),n.lat=Math.min(u.lat,n.lat),a.lng=Math.max(d.lng,a.lng),a.lat=Math.max(d.lat,a.lat)):(this._sw=new Ln(u.lng,u.lat),this._ne=new Ln(d.lng,d.lat)),this}getCenter(){return new Ln((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ln(this.getWest(),this.getNorth())}getSouthEast(){return new Ln(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:a}=Ln.convert(e);let u=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&u}static convert(e){return!e||e instanceof qs?e:new qs(e)}}const ag=63710088e-1;class Ln{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ln(Le(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,a=this.lat*n,u=e.lat*n,d=Math.sin(a)*Math.sin(u)+Math.cos(a)*Math.cos(u)*Math.cos((e.lng-this.lng)*n);return ag*Math.acos(Math.min(d,1))}toBounds(e=0){const n=360*e/40075017,a=n/Math.cos(Math.PI/180*this.lat);return new qs(new Ln(this.lng-a,this.lat-n),new Ln(this.lng+a,this.lat+n))}static convert(e){if(e instanceof Ln)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Ln(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Ln(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const h0=2*Math.PI*ag;function lg(i){return h0*Math.cos(i*Math.PI/180)}function So(i){return(180+i)/360}function os(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function jr(i,e){return i/lg(e)}function Nr(i){return 360*i-180}function ji(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function f0(i,e){return i*lg(ji(e))}const Mo=85.051129;function d0(i){return 1/Math.cos(i*Math.PI/180)}class bc{constructor(e,n,a=0){this.x=+e,this.y=+n,this.z=+a}static fromLngLat(e,n=0){const a=Ln.convert(e);return new bc(So(a.lng),os(a.lat),jr(n,a.lat))}toLngLat(){return new Ln(Nr(this.x),ji(this.y))}toAltitude(){return f0(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/h0*d0(ji(this.y))}}function cg(i,e,n,a,u,d,m,_,b){const w=(e+a)/2,S=(n+u)/2,I=new D(w,S);_(I),function(P,L,B,V,Z,Q){const ce=B-Z,ne=V-Q;return Math.abs((V-L)*ce-(B-P)*ne)/Math.hypot(ce,ne)}(I.x,I.y,d.x,d.y,m.x,m.y)>=b?(cg(i,e,n,w,S,d,I,_,b),cg(i,w,S,a,u,I,m,_,b)):i.push(m)}function p0(i,e,n){let a=i[0],u=a.x,d=a.y;e(a);const m=[a];for(let _=1;_<i.length;_++){const b=i[_],{x:w,y:S}=b;e(b),cg(m,u,d,w,S,a,b,e,n),u=w,d=S,a=b}return m}function ug(i,e,n,a,u){if(u(e,n)){const d=e.add(n).mult(.5);a(d),ug(i,e,d,a,u),ug(i,d,n,a,u)}else i.push(n)}function SS(i,e,n){let a=i[0];e(a);const u=[a];for(let d=1;d<i.length;d++){const m=i[d];e(m),ug(u,a,m,e,n),a=m}return u}const hg=Math.pow(2,14)-1,m0=-hg-1;function MS(i,e){const n=Math.round(i.x*e),a=Math.round(i.y*e);return i.x=Pe(n,m0,hg),i.y=Pe(a,m0,hg),(n<i.x||n>i.x+1||a<i.y||a>i.y+1)&&Lt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function ss(i,e,n){const a=i.loadGeometry(),u=i.extent,d=Qt/u;if(e&&n&&n.projection.isReprojectedInTileSpace){const m=1<<e.z,{scale:_,x:b,y:w,projection:S}=n,I=P=>{const L=Nr((e.x+P.x/u)/m),B=ji((e.y+P.y/u)/m),V=S.project(L,B);P.x=(V.x*_-b)*u,P.y=(V.y*_-w)*u};for(let P=0;P<a.length;P++)if(i.type!==1)a[P]=p0(a[P],I,1);else{const L=[];for(const B of a[P])B.x<0||B.x>=u||B.y<0||B.y>=u||(I(B),L.push(B));a[P]=L}}for(const m of a)for(const _ of m)MS(_,d);return a}function tl(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?ss(i):[]}}function jd(i,e,n,a,u){i.emplaceBack(2*e+(a+1)/2,2*n+(u+1)/2)}function Nd(i,e,n){i.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class fg{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new At,this.indexArray=new gn,this.segments=new xi,this.programConfigurations=new el(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,a,u){const d=this.layers[0],m=[];let _=null;d.type==="circle"&&(_=d.layout.get("circle-sort-key"));for(const{feature:w,id:S,index:I,sourceLayerIndex:P}of e){const L=this.layers[0]._featureFilter.needGeometry,B=tl(w,L);if(!this.layers[0]._featureFilter.filter(new H(this.zoom),B,a))continue;const V=_?_.evaluate(B,{},a):void 0,Z={id:S,properties:w.properties,type:w.type,sourceLayerIndex:P,index:I,geometry:L?B.geometry:ss(w,a,u),patterns:{},sortKey:V};m.push(Z)}_&&m.sort((w,S)=>w.sortKey-S.sortKey);let b=null;u.projection.name==="globe"&&(this.globeExtVertexArray=new o0,b=u.projection);for(const w of m){const{geometry:S,index:I,sourceLayerIndex:P}=w,L=e[I].feature;this.addFeature(w,S,I,n.availableImages,a,b),n.featureIndex.insert(L,S,I,P,this.index)}}update(e,n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ES.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,CS.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,n,a,u,d,m){for(const _ of n)for(const b of _){const w=b.x,S=b.y;if(w<0||w>=Qt||S<0||S>=Qt)continue;if(m){const L=m.projectTilePoint(w,S,d),B=m.upVector(d,w,S),V=this.globeExtVertexArray;Nd(V,L,B),Nd(V,L,B),Nd(V,L,B),Nd(V,L,B)}const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),P=I.vertexLength;jd(this.layoutVertexArray,w,S,-1,-1),jd(this.layoutVertexArray,w,S,1,-1),jd(this.layoutVertexArray,w,S,1,1),jd(this.layoutVertexArray,w,S,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+2,P+3),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},u,d)}}function g0(i,e){for(let n=0;n<i.length;n++)if(nl(e,i[n]))return!0;for(let n=0;n<e.length;n++)if(nl(i,e[n]))return!0;return!!dg(i,e)}function AS(i,e,n){return!!nl(i,e)||!!pg(e,i,n)}function _0(i,e){if(i.length===1)return v0(e,i[0]);for(let n=0;n<e.length;n++){const a=e[n];for(let u=0;u<a.length;u++)if(nl(i,a[u]))return!0}for(let n=0;n<i.length;n++)if(v0(e,i[n]))return!0;for(let n=0;n<e.length;n++)if(dg(i,e[n]))return!0;return!1}function IS(i,e,n){if(i.length>1){if(dg(i,e))return!0;for(let a=0;a<e.length;a++)if(pg(e[a],i,n))return!0}for(let a=0;a<i.length;a++)if(pg(i[a],e,n))return!0;return!1}function dg(i,e){if(i.length===0||e.length===0)return!1;for(let n=0;n<i.length-1;n++){const a=i[n],u=i[n+1];for(let d=0;d<e.length-1;d++)if(PS(a,u,e[d],e[d+1]))return!0}return!1}function PS(i,e,n,a){return nn(i,n,a)!==nn(e,n,a)&&nn(i,e,n)!==nn(i,e,a)}function pg(i,e,n){const a=n*n;if(e.length===1)return i.distSqr(e[0])<a;for(let u=1;u<e.length;u++)if(y0(i,e[u-1],e[u])<a)return!0;return!1}function y0(i,e,n){const a=e.distSqr(n);if(a===0)return i.distSqr(e);const u=((i.x-e.x)*(n.x-e.x)+(i.y-e.y)*(n.y-e.y))/a;return i.distSqr(u<0?e:u>1?n:n.sub(e)._mult(u)._add(e))}function v0(i,e){let n,a,u,d=!1;for(let m=0;m<i.length;m++){n=i[m];for(let _=0,b=n.length-1;_<n.length;b=_++)a=n[_],u=n[b],a.y>e.y!=u.y>e.y&&e.x<(u.x-a.x)*(e.y-a.y)/(u.y-a.y)+a.x&&(d=!d)}return d}function nl(i,e){let n=!1;for(let a=0,u=i.length-1;a<i.length;u=a++){const d=i[a],m=i[u];d.y>e.y!=m.y>e.y&&e.x<(m.x-d.x)*(e.y-d.y)/(m.y-d.y)+d.x&&(n=!n)}return n}function x0(i,e,n,a,u){for(const m of i)if(e<=m.x&&n<=m.y&&a>=m.x&&u>=m.y)return!0;const d=[new D(e,n),new D(e,u),new D(a,u),new D(a,n)];if(i.length>2){for(const m of d)if(nl(i,m))return!0}for(let m=0;m<i.length-1;m++)if(zS(i[m],i[m+1],d))return!0;return!1}function zS(i,e,n){const a=n[0],u=n[2];if(i.x<a.x&&e.x<a.x||i.x>u.x&&e.x>u.x||i.y<a.y&&e.y<a.y||i.y>u.y&&e.y>u.y)return!1;const d=nn(i,e,n[0]);return d!==nn(i,e,n[1])||d!==nn(i,e,n[2])||d!==nn(i,e,n[3])}function wc(i,e,n){const a=e.paint.get(i).value;return a.kind==="constant"?a.value:n.programConfigurations.get(e.id).getMaxValue(i)}function Ud(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function b0(i,e,n,a,u){if(!e[0]&&!e[1])return i;const d=D.convert(e)._mult(u);n==="viewport"&&d._rotate(-a);const m=[];for(let _=0;_<i.length;_++)m.push(i[_].sub(d));return m}function w0(i,e,n,a){const u=D.convert(i)._mult(a);return e==="viewport"&&u._rotate(-n),u}Bt(fg,"CircleBucket",{omit:["layers"]});const OS=new He({"circle-sort-key":new ve($e.layout_circle["circle-sort-key"])});var kS={paint:new He({"circle-radius":new ve($e.paint_circle["circle-radius"]),"circle-color":new ve($e.paint_circle["circle-color"]),"circle-blur":new ve($e.paint_circle["circle-blur"]),"circle-opacity":new ve($e.paint_circle["circle-opacity"]),"circle-translate":new he($e.paint_circle["circle-translate"]),"circle-translate-anchor":new he($e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new he($e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new he($e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ve($e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ve($e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ve($e.paint_circle["circle-stroke-opacity"])}),layout:OS},Vd=1e-6,vr=typeof Float32Array<"u"?Float32Array:Array;function T0(){var i=new vr(9);return vr!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function Ao(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function mg(i,e){var n=e[0],a=e[1],u=e[2],d=e[3],m=e[4],_=e[5],b=e[6],w=e[7],S=e[8],I=e[9],P=e[10],L=e[11],B=e[12],V=e[13],Z=e[14],Q=e[15],ce=n*_-a*m,ne=n*b-u*m,ae=n*w-d*m,me=a*b-u*_,ue=a*w-d*_,Re=u*w-d*b,De=S*V-I*B,Ze=S*Z-P*B,_t=S*Q-L*B,Fe=I*Z-P*V,Ke=I*Q-L*V,nt=P*Q-L*Z,Ye=ce*nt-ne*Ke+ae*Fe+me*_t-ue*Ze+Re*De;return Ye?(i[0]=(_*nt-b*Ke+w*Fe)*(Ye=1/Ye),i[1]=(u*Ke-a*nt-d*Fe)*Ye,i[2]=(V*Re-Z*ue+Q*me)*Ye,i[3]=(P*ue-I*Re-L*me)*Ye,i[4]=(b*_t-m*nt-w*Ze)*Ye,i[5]=(n*nt-u*_t+d*Ze)*Ye,i[6]=(Z*ae-B*Re-Q*ne)*Ye,i[7]=(S*Re-P*ae+L*ne)*Ye,i[8]=(m*Ke-_*_t+w*De)*Ye,i[9]=(a*_t-n*Ke-d*De)*Ye,i[10]=(B*ue-V*ae+Q*ce)*Ye,i[11]=(I*ae-S*ue-L*ce)*Ye,i[12]=(_*Ze-m*Fe-b*De)*Ye,i[13]=(n*Fe-a*Ze+u*De)*Ye,i[14]=(V*ne-B*me-Z*ce)*Ye,i[15]=(S*me-I*ne+P*ce)*Ye,i):null}function Tc(i,e,n){var a=e[0],u=e[1],d=e[2],m=e[3],_=e[4],b=e[5],w=e[6],S=e[7],I=e[8],P=e[9],L=e[10],B=e[11],V=e[12],Z=e[13],Q=e[14],ce=e[15],ne=n[0],ae=n[1],me=n[2],ue=n[3];return i[0]=ne*a+ae*_+me*I+ue*V,i[1]=ne*u+ae*b+me*P+ue*Z,i[2]=ne*d+ae*w+me*L+ue*Q,i[3]=ne*m+ae*S+me*B+ue*ce,i[4]=(ne=n[4])*a+(ae=n[5])*_+(me=n[6])*I+(ue=n[7])*V,i[5]=ne*u+ae*b+me*P+ue*Z,i[6]=ne*d+ae*w+me*L+ue*Q,i[7]=ne*m+ae*S+me*B+ue*ce,i[8]=(ne=n[8])*a+(ae=n[9])*_+(me=n[10])*I+(ue=n[11])*V,i[9]=ne*u+ae*b+me*P+ue*Z,i[10]=ne*d+ae*w+me*L+ue*Q,i[11]=ne*m+ae*S+me*B+ue*ce,i[12]=(ne=n[12])*a+(ae=n[13])*_+(me=n[14])*I+(ue=n[15])*V,i[13]=ne*u+ae*b+me*P+ue*Z,i[14]=ne*d+ae*w+me*L+ue*Q,i[15]=ne*m+ae*S+me*B+ue*ce,i}function _h(i,e,n){var a,u,d,m,_,b,w,S,I,P,L,B,V=n[0],Z=n[1],Q=n[2];return e===i?(i[12]=e[0]*V+e[4]*Z+e[8]*Q+e[12],i[13]=e[1]*V+e[5]*Z+e[9]*Q+e[13],i[14]=e[2]*V+e[6]*Z+e[10]*Q+e[14],i[15]=e[3]*V+e[7]*Z+e[11]*Q+e[15]):(u=e[1],d=e[2],m=e[3],_=e[4],b=e[5],w=e[6],S=e[7],I=e[8],P=e[9],L=e[10],B=e[11],i[0]=a=e[0],i[1]=u,i[2]=d,i[3]=m,i[4]=_,i[5]=b,i[6]=w,i[7]=S,i[8]=I,i[9]=P,i[10]=L,i[11]=B,i[12]=a*V+_*Z+I*Q+e[12],i[13]=u*V+b*Z+P*Q+e[13],i[14]=d*V+w*Z+L*Q+e[14],i[15]=m*V+S*Z+B*Q+e[15]),i}function il(i,e,n){var a=n[0],u=n[1],d=n[2];return i[0]=e[0]*a,i[1]=e[1]*a,i[2]=e[2]*a,i[3]=e[3]*a,i[4]=e[4]*u,i[5]=e[5]*u,i[6]=e[6]*u,i[7]=e[7]*u,i[8]=e[8]*d,i[9]=e[9]*d,i[10]=e[10]*d,i[11]=e[11]*d,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function gg(i,e,n){var a=Math.sin(n),u=Math.cos(n),d=e[4],m=e[5],_=e[6],b=e[7],w=e[8],S=e[9],I=e[10],P=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=d*u+w*a,i[5]=m*u+S*a,i[6]=_*u+I*a,i[7]=b*u+P*a,i[8]=w*u-d*a,i[9]=S*u-m*a,i[10]=I*u-_*a,i[11]=P*u-b*a,i}function $d(i,e,n){var a=Math.sin(n),u=Math.cos(n),d=e[0],m=e[1],_=e[2],b=e[3],w=e[8],S=e[9],I=e[10],P=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=d*u-w*a,i[1]=m*u-S*a,i[2]=_*u-I*a,i[3]=b*u-P*a,i[8]=d*a+w*u,i[9]=m*a+S*u,i[10]=_*a+I*u,i[11]=b*a+P*u,i}function E0(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function C0(i,e,n){var a,u,d,m=n[0],_=n[1],b=n[2],w=Math.hypot(m,_,b);return w<Vd?null:(m*=w=1/w,_*=w,b*=w,a=Math.sin(e),u=Math.cos(e),i[0]=m*m*(d=1-u)+u,i[1]=_*m*d+b*a,i[2]=b*m*d-_*a,i[3]=0,i[4]=m*_*d-b*a,i[5]=_*_*d+u,i[6]=b*_*d+m*a,i[7]=0,i[8]=m*b*d+_*a,i[9]=_*b*d-m*a,i[10]=b*b*d+u,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var DS=Tc;function _g(){var i=new vr(3);return vr!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function S0(i){var e=new vr(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function yh(i){return Math.hypot(i[0],i[1],i[2])}function Ec(i,e,n){var a=new vr(3);return a[0]=i,a[1]=e,a[2]=n,a}function Ws(i,e,n){return i[0]=e[0]+n[0],i[1]=e[1]+n[1],i[2]=e[2]+n[2],i}function yg(i,e,n){return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],i}function M0(i,e,n){return i[0]=e[0]*n[0],i[1]=e[1]*n[1],i[2]=e[2]*n[2],i}function vg(i,e,n){return i[0]=Math.min(e[0],n[0]),i[1]=Math.min(e[1],n[1]),i[2]=Math.min(e[2],n[2]),i}function xg(i,e,n){return i[0]=Math.max(e[0],n[0]),i[1]=Math.max(e[1],n[1]),i[2]=Math.max(e[2],n[2]),i}function io(i,e,n){return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i}function Gd(i,e,n,a){return i[0]=e[0]+n[0]*a,i[1]=e[1]+n[1]*a,i[2]=e[2]+n[2]*a,i}function tr(i,e){var n=e[0],a=e[1],u=e[2],d=n*n+a*a+u*u;return d>0&&(d=1/Math.sqrt(d)),i[0]=e[0]*d,i[1]=e[1]*d,i[2]=e[2]*d,i}function Ur(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function bg(i,e,n){var a=e[0],u=e[1],d=e[2],m=n[0],_=n[1],b=n[2];return i[0]=u*b-d*_,i[1]=d*m-a*b,i[2]=a*_-u*m,i}function Ti(i,e,n){var a=e[0],u=e[1],d=e[2],m=n[3]*a+n[7]*u+n[11]*d+n[15];return i[0]=(n[0]*a+n[4]*u+n[8]*d+n[12])/(m=m||1),i[1]=(n[1]*a+n[5]*u+n[9]*d+n[13])/m,i[2]=(n[2]*a+n[6]*u+n[10]*d+n[14])/m,i}function A0(i,e,n){var a=n[0],u=n[1],d=n[2],m=e[0],_=e[1],b=e[2],w=u*b-d*_,S=d*m-a*b,I=a*_-u*m,P=u*I-d*S,L=d*w-a*I,B=a*S-u*w,V=2*n[3];return S*=V,I*=V,L*=2,B*=2,i[0]=m+(w*=V)+(P*=2),i[1]=_+S+L,i[2]=b+I+B,i}var vh,ro=yg,LS=M0,RS=yh;function I0(i,e,n){return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=e[3]*n,i}function rl(i,e,n){var a=e[0],u=e[1],d=e[2],m=e[3];return i[0]=n[0]*a+n[4]*u+n[8]*d+n[12]*m,i[1]=n[1]*a+n[5]*u+n[9]*d+n[13]*m,i[2]=n[2]*a+n[6]*u+n[10]*d+n[14]*m,i[3]=n[3]*a+n[7]*u+n[11]*d+n[15]*m,i}function P0(){var i=new vr(4);return vr!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function z0(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function O0(i,e,n){n*=.5;var a=e[0],u=e[1],d=e[2],m=e[3],_=Math.sin(n),b=Math.cos(n);return i[0]=a*b+m*_,i[1]=u*b+d*_,i[2]=d*b-u*_,i[3]=m*b-a*_,i}function k0(i,e,n){n*=.5;var a=e[0],u=e[1],d=e[2],m=e[3],_=Math.sin(n),b=Math.cos(n);return i[0]=a*b-d*_,i[1]=u*b+m*_,i[2]=d*b+a*_,i[3]=m*b-u*_,i}_g(),vh=new vr(4),vr!=Float32Array&&(vh[0]=0,vh[1]=0,vh[2]=0,vh[3]=0),_g(),Ec(1,0,0),Ec(0,1,0),P0(),P0(),T0();class wg{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,a){const u=Ur(n,this.dir);if(Math.abs(u)<1e-6)return!1;const d=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/u;return a[0]=this.pos[0]+this.dir[0]*d,a[1]=this.pos[1]+this.dir[1]*d,a[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(e,n,a){if(function(L,B){var V=L[0],Z=L[1],Q=L[2],ce=B[0],ne=B[1],ae=B[2];return Math.abs(V-ce)<=Vd*Math.max(1,Math.abs(V),Math.abs(ce))&&Math.abs(Z-ne)<=Vd*Math.max(1,Math.abs(Z),Math.abs(ne))&&Math.abs(Q-ae)<=Vd*Math.max(1,Math.abs(Q),Math.abs(ae))}(this.pos,e)||n===0)return a[0]=a[1]=a[2]=0,!1;const[u,d,m]=this.dir,_=this.pos[0]-e[0],b=this.pos[1]-e[1],w=this.pos[2]-e[2],S=u*u+d*d+m*m,I=2*(_*u+b*d+w*m),P=I*I-4*S*(_*_+b*b+w*w-n*n);if(P<0){const L=Math.max(-I/2,0),B=_+u*L,V=b+d*L,Z=w+m*L,Q=Math.hypot(B,V,Z);return a[0]=B*n/Q,a[1]=V*n/Q,a[2]=Z*n/Q,!1}{const L=(-I-Math.sqrt(P))/(2*S);if(L<0){const B=Math.hypot(_,b,w);return a[0]=_*n/B,a[1]=b*n/B,a[2]=w*n/B,!1}return a[0]=_+u*L,a[1]=b+d*L,a[2]=w+m*L,!0}}}class Tg{constructor(e,n,a,u,d){this.TL=e,this.TR=n,this.BR=a,this.BL=u,this.horizon=d}static fromInvProjectionMatrix(e,n,a){const u=[-1,1,1],d=[1,1,1],m=[1,-1,1],_=[-1,-1,1],b=Ti(u,u,e),w=Ti(d,d,e),S=Ti(m,m,e),I=Ti(_,_,e);return new Tg(b,w,S,I,n/a)}}class Eg{constructor(e,n){this.points=e,this.planes=n}static fromInvProjectionMatrix(e,n,a,u){const d=Math.pow(2,a),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const w=rl([],b,e),S=1/w[3]/n*d;return function(I,P,L){return I[0]=P[0]*L[0],I[1]=P[1]*L[1],I[2]=P[2]*L[2],I[3]=P[3]*L[3],I}(w,w,[S,S,u?1/w[3]:S,S])}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const w=tr([],bg([],ro([],m[b[0]],m[b[1]]),ro([],m[b[2]],m[b[1]]))),S=-Ur(w,m[b[1]]);return w.concat(S)});return new Eg(m,_)}}class cr{static fromPoints(e){const n=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],a=[Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE];for(const u of e)n[0]=Math.min(n[0],u[0]),n[1]=Math.min(n[1],u[1]),n[2]=Math.min(n[2],u[2]),a[0]=Math.max(a[0],u[0]),a[1]=Math.max(a[1],u[1]),a[2]=Math.max(a[2],u[2]);return new cr(n,a)}constructor(e,n){this.min=e,this.max=n,this.center=io([],Ws([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],a=S0(this.min),u=S0(this.max);for(let d=0;d<n.length;d++)a[d]=n[d]?this.min[d]:this.center[d],u[d]=n[d]?this.center[d]:this.max[d];return u[2]=this.max[2],new cr(a,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){const n=this.getCorners();let a=!0;for(let u=0;u<e.planes.length;u++){const d=e.planes[u];let m=0;for(let _=0;_<n.length;_++)m+=Ur(d,n[_])+d[3]>=0;if(m===0)return 0;m!==n.length&&(a=!1)}if(a)return 2;for(let u=0;u<3;u++){let d=Number.MAX_VALUE,m=-Number.MAX_VALUE;for(let _=0;_<e.points.length;_++){const b=e.points[_][u]-this.min[u];d=Math.min(d,b),m=Math.max(m,b)}if(m<0||d>this.max[u]-this.min[u])return 0}return 1}}function D0(i,e,n,a,u,d,m,_,b){if(d&&i.queryGeometry.isAboveHorizon)return!1;d&&(b*=i.pixelToTileUnitsFactor);const w=i.tileID.canonical,S=n.projection.upVectorScale(w,n.center.lat,n.worldSize).metersToTile;for(const I of e)for(const P of I){const L=P.add(_),B=u&&n.elevation?n.elevation.exaggeration()*u.getElevationAt(L.x,L.y,!0):0,V=n.projection.projectTilePoint(L.x,L.y,w);if(B>0){const ne=n.projection.upVector(w,L.x,L.y);V.x+=ne[0]*S*B,V.y+=ne[1]*S*B,V.z+=ne[2]*S*B}const Z=d?L:BS(V.x,V.y,V.z,a),Q=d?i.tilespaceRays.map(ne=>jS(ne,B)):i.queryGeometry.screenGeometry,ce=rl([],[V.x,V.y,V.z,1],a);if(!m&&d?b*=ce[3]/n.cameraToCenterDistance:m&&!d&&(b*=n.cameraToCenterDistance/ce[3]),d){const ne=ji((P.y/Qt+w.y)/(1<<w.z));b/=n.projection.pixelsPerMeter(ne,1)/jr(1,ne)}if(AS(Q,Z,b))return!0}return!1}function BS(i,e,n,a){const u=rl([],[i,e,n,1],a);return new D(u[0]/u[3],u[1]/u[3])}const L0=Ec(0,0,0),FS=Ec(0,0,1);function jS(i,e){const n=_g();return L0[2]=e,i.intersectsPlane(L0,FS,n),new D(n[0],n[1])}class R0 extends fg{}function B0(i,{width:e,height:n},a,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*n*a)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*n*a);return i.width=e,i.height=n,i.data=u,i}function F0(i,e,n){const{width:a,height:u}=e;a===i.width&&u===i.height||(Cg(i,e,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,a),height:Math.min(i.height,u)},n),i.width=a,i.height=u,i.data=e.data)}function Cg(i,e,n,a,u,d){if(u.width===0||u.height===0)return e;if(u.width>i.width||u.height>i.height||n.x>i.width-u.width||n.y>i.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||a.x>e.width-u.width||a.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const m=i.data,_=e.data;for(let b=0;b<u.height;b++){const w=((n.y+b)*i.width+n.x)*d,S=((a.y+b)*e.width+a.x)*d;for(let I=0;I<u.width*d;I++)_[S+I]=m[w+I]}return e}Bt(R0,"HeatmapBucket",{omit:["layers"]});class as{constructor(e,n){B0(this,e,1,n)}resize(e){F0(this,new as(e),1)}clone(){return new as({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,a,u,d){Cg(e,n,a,u,d,1)}}class xr{constructor(e,n){B0(this,e,4,n)}resize(e){F0(this,new xr(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new xr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,a,u,d){Cg(e,n,a,u,d,4)}}Bt(as,"AlphaImage"),Bt(xr,"RGBAImage");var NS={paint:new He({"heatmap-radius":new ve($e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ve($e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new he($e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ce($e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new he($e.paint_heatmap["heatmap-opacity"])})};function Sg(i){const e={},n=i.resolution||256,a=i.clips?i.clips.length:1,u=i.image||new xr({width:n,height:a}),d=(m,_,b)=>{e[i.evaluationKey]=b;const w=i.expression.evaluate(e);u.data[m+_+0]=Math.floor(255*w.r/w.a),u.data[m+_+1]=Math.floor(255*w.g/w.a),u.data[m+_+2]=Math.floor(255*w.b/w.a),u.data[m+_+3]=Math.floor(255*w.a)};if(i.clips)for(let m=0,_=0;m<a;++m,_+=4*n)for(let b=0,w=0;b<n;b++,w+=4){const S=b/(n-1),{start:I,end:P}=i.clips[m];d(_,w,I*(1-S)+P*S)}else for(let m=0,_=0;m<n;m++,_+=4)d(0,_,m/(n-1));return u}var US={paint:new He({"hillshade-illumination-direction":new he($e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new he($e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new he($e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new he($e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new he($e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new he($e.paint_hillshade["hillshade-accent-color"])})};const VS=Je([{name:"a_pos",components:2,type:"Int16"}],4),{members:$S}=VS;var Zd=qd,GS=qd;function qd(i,e,n){n=n||2;var a,u,d,m,_,b,w,S=e&&e.length,I=S?e[0]*n:i.length,P=j0(i,0,I,n,!0),L=[];if(!P||P.next===P.prev)return L;if(S&&(P=function(V,Z,Q,ce){var ne,ae,me,ue=[];for(ne=0,ae=Z.length;ne<ae;ne++)(me=j0(V,Z[ne]*ce,ne<ae-1?Z[ne+1]*ce:V.length,ce,!1))===me.next&&(me.steiner=!0),ue.push(JS(me));for(ue.sort(XS),ne=0;ne<ue.length;ne++)Q=KS(ue[ne],Q);return Q}(i,e,P,n)),i.length>80*n){a=d=i[0],u=m=i[1];for(var B=n;B<I;B+=n)(_=i[B])<a&&(a=_),(b=i[B+1])<u&&(u=b),_>d&&(d=_),b>m&&(m=b);w=(w=Math.max(d-a,m-u))!==0?32767/w:0}return xh(P,L,n,a,u,w,0),L}function j0(i,e,n,a,u){var d,m;if(u===Ig(i,e,n,a)>0)for(d=e;d<n;d+=a)m=V0(d,i[d],i[d+1],m);else for(d=n-a;d>=e;d-=a)m=V0(d,i[d],i[d+1],m);return m&&Wd(m,m.next)&&(wh(m),m=m.next),m}function ol(i,e){if(!i)return i;e||(e=i);var n,a=i;do if(n=!1,a.steiner||!Wd(a,a.next)&&_i(a.prev,a,a.next)!==0)a=a.next;else{if(wh(a),(a=e=a.prev)===a.next)break;n=!0}while(n||a!==e);return e}function xh(i,e,n,a,u,d,m){if(i){!m&&d&&function(S,I,P,L){var B=S;do B.z===0&&(B.z=Mg(B.x,B.y,I,P,L)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==S);B.prevZ.nextZ=null,B.prevZ=null,function(V){var Z,Q,ce,ne,ae,me,ue,Re,De=1;do{for(Q=V,V=null,ae=null,me=0;Q;){for(me++,ce=Q,ue=0,Z=0;Z<De&&(ue++,ce=ce.nextZ);Z++);for(Re=De;ue>0||Re>0&&ce;)ue!==0&&(Re===0||!ce||Q.z<=ce.z)?(ne=Q,Q=Q.nextZ,ue--):(ne=ce,ce=ce.nextZ,Re--),ae?ae.nextZ=ne:V=ne,ne.prevZ=ae,ae=ne;Q=ce}ae.nextZ=null,De*=2}while(me>1)}(B)}(i,a,u,d);for(var _,b,w=i;i.prev!==i.next;)if(_=i.prev,b=i.next,d?qS(i,a,u,d):ZS(i))e.push(_.i/n|0),e.push(i.i/n|0),e.push(b.i/n|0),wh(i),i=b.next,w=b.next;else if((i=b)===w){m?m===1?xh(i=WS(ol(i),e,n),e,n,a,u,d,2):m===2&&HS(i,e,n,a,u,d):xh(ol(i),e,n,a,u,d,1);break}}}function ZS(i){var e=i.prev,n=i,a=i.next;if(_i(e,n,a)>=0)return!1;for(var u=e.x,d=n.x,m=a.x,_=e.y,b=n.y,w=a.y,S=u<d?u<m?u:m:d<m?d:m,I=_<b?_<w?_:w:b<w?b:w,P=u>d?u>m?u:m:d>m?d:m,L=_>b?_>w?_:w:b>w?b:w,B=a.next;B!==e;){if(B.x>=S&&B.x<=P&&B.y>=I&&B.y<=L&&Cc(u,_,d,b,m,w,B.x,B.y)&&_i(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function qS(i,e,n,a){var u=i.prev,d=i,m=i.next;if(_i(u,d,m)>=0)return!1;for(var _=u.x,b=d.x,w=m.x,S=u.y,I=d.y,P=m.y,L=_<b?_<w?_:w:b<w?b:w,B=S<I?S<P?S:P:I<P?I:P,V=_>b?_>w?_:w:b>w?b:w,Z=S>I?S>P?S:P:I>P?I:P,Q=Mg(L,B,e,n,a),ce=Mg(V,Z,e,n,a),ne=i.prevZ,ae=i.nextZ;ne&&ne.z>=Q&&ae&&ae.z<=ce;){if(ne.x>=L&&ne.x<=V&&ne.y>=B&&ne.y<=Z&&ne!==u&&ne!==m&&Cc(_,S,b,I,w,P,ne.x,ne.y)&&_i(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,ae.x>=L&&ae.x<=V&&ae.y>=B&&ae.y<=Z&&ae!==u&&ae!==m&&Cc(_,S,b,I,w,P,ae.x,ae.y)&&_i(ae.prev,ae,ae.next)>=0))return!1;ae=ae.nextZ}for(;ne&&ne.z>=Q;){if(ne.x>=L&&ne.x<=V&&ne.y>=B&&ne.y<=Z&&ne!==u&&ne!==m&&Cc(_,S,b,I,w,P,ne.x,ne.y)&&_i(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;ae&&ae.z<=ce;){if(ae.x>=L&&ae.x<=V&&ae.y>=B&&ae.y<=Z&&ae!==u&&ae!==m&&Cc(_,S,b,I,w,P,ae.x,ae.y)&&_i(ae.prev,ae,ae.next)>=0)return!1;ae=ae.nextZ}return!0}function WS(i,e,n){var a=i;do{var u=a.prev,d=a.next.next;!Wd(u,d)&&N0(u,a,a.next,d)&&bh(u,d)&&bh(d,u)&&(e.push(u.i/n|0),e.push(a.i/n|0),e.push(d.i/n|0),wh(a),wh(a.next),a=i=d),a=a.next}while(a!==i);return ol(a)}function HS(i,e,n,a,u,d){var m=i;do{for(var _=m.next.next;_!==m.prev;){if(m.i!==_.i&&QS(m,_)){var b=U0(m,_);return m=ol(m,m.next),b=ol(b,b.next),xh(m,e,n,a,u,d,0),void xh(b,e,n,a,u,d,0)}_=_.next}m=m.next}while(m!==i)}function XS(i,e){return i.x-e.x}function KS(i,e){var n=function(u,d){var m,_=d,b=u.x,w=u.y,S=-1/0;do{if(w<=_.y&&w>=_.next.y&&_.next.y!==_.y){var I=_.x+(w-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(I<=b&&I>S&&(S=I,m=_.x<_.next.x?_:_.next,I===b))return m}_=_.next}while(_!==d);if(!m)return null;var P,L=m,B=m.x,V=m.y,Z=1/0;_=m;do b>=_.x&&_.x>=B&&b!==_.x&&Cc(w<V?b:S,w,B,V,w<V?S:b,w,_.x,_.y)&&(P=Math.abs(w-_.y)/(b-_.x),bh(_,u)&&(P<Z||P===Z&&(_.x>m.x||_.x===m.x&&YS(m,_)))&&(m=_,Z=P)),_=_.next;while(_!==L);return m}(i,e);if(!n)return e;var a=U0(n,i);return ol(a,a.next),ol(n,n.next)}function YS(i,e){return _i(i.prev,i,e.prev)<0&&_i(e.next,i,i.next)<0}function Mg(i,e,n,a,u){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-n)*u|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function JS(i){var e=i,n=i;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==i);return n}function Cc(i,e,n,a,u,d,m,_){return(u-m)*(e-_)>=(i-m)*(d-_)&&(i-m)*(a-_)>=(n-m)*(e-_)&&(n-m)*(d-_)>=(u-m)*(a-_)}function QS(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(n,a){var u=n;do{if(u.i!==n.i&&u.next.i!==n.i&&u.i!==a.i&&u.next.i!==a.i&&N0(u,u.next,n,a))return!0;u=u.next}while(u!==n);return!1}(i,e)&&(bh(i,e)&&bh(e,i)&&function(n,a){var u=n,d=!1,m=(n.x+a.x)/2,_=(n.y+a.y)/2;do u.y>_!=u.next.y>_&&u.next.y!==u.y&&m<(u.next.x-u.x)*(_-u.y)/(u.next.y-u.y)+u.x&&(d=!d),u=u.next;while(u!==n);return d}(i,e)&&(_i(i.prev,i,e.prev)||_i(i,e.prev,e))||Wd(i,e)&&_i(i.prev,i,i.next)>0&&_i(e.prev,e,e.next)>0)}function _i(i,e,n){return(e.y-i.y)*(n.x-e.x)-(e.x-i.x)*(n.y-e.y)}function Wd(i,e){return i.x===e.x&&i.y===e.y}function N0(i,e,n,a){var u=Xd(_i(i,e,n)),d=Xd(_i(i,e,a)),m=Xd(_i(n,a,i)),_=Xd(_i(n,a,e));return u!==d&&m!==_||!(u!==0||!Hd(i,n,e))||!(d!==0||!Hd(i,a,e))||!(m!==0||!Hd(n,i,a))||!(_!==0||!Hd(n,e,a))}function Hd(i,e,n){return e.x<=Math.max(i.x,n.x)&&e.x>=Math.min(i.x,n.x)&&e.y<=Math.max(i.y,n.y)&&e.y>=Math.min(i.y,n.y)}function Xd(i){return i>0?1:i<0?-1:0}function bh(i,e){return _i(i.prev,i,i.next)<0?_i(i,e,i.next)>=0&&_i(i,i.prev,e)>=0:_i(i,e,i.prev)<0||_i(i,i.next,e)<0}function U0(i,e){var n=new Ag(i.i,i.x,i.y),a=new Ag(e.i,e.x,e.y),u=i.next,d=e.prev;return i.next=e,e.prev=i,n.next=u,u.prev=n,a.next=n,n.prev=a,d.next=a,a.prev=d,a}function V0(i,e,n,a){var u=new Ag(i,e,n);return a?(u.next=a.next,u.prev=a,a.next.prev=u,a.next=u):(u.prev=u,u.next=u),u}function wh(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Ag(i,e,n){this.i=i,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ig(i,e,n,a){for(var u=0,d=e,m=n-a;d<n;d+=a)u+=(i[m]-i[d])*(i[d+1]+i[m+1]),m=d;return u}function eM(i,e,n,a,u){$0(i,e,n||0,a||i.length-1,u||tM)}function $0(i,e,n,a,u){for(;a>n;){if(a-n>600){var d=a-n+1,m=e-n+1,_=Math.log(d),b=.5*Math.exp(2*_/3),w=.5*Math.sqrt(_*b*(d-b)/d)*(m-d/2<0?-1:1);$0(i,e,Math.max(n,Math.floor(e-m*b/d+w)),Math.min(a,Math.floor(e+(d-m)*b/d+w)),u)}var S=i[e],I=n,P=a;for(Th(i,n,e),u(i[a],S)>0&&Th(i,n,a);I<P;){for(Th(i,I,P),I++,P--;u(i[I],S)<0;)I++;for(;u(i[P],S)>0;)P--}u(i[n],S)===0?Th(i,n,P):Th(i,++P,a),P<=e&&(n=P+1),e<=P&&(a=P-1)}}function Th(i,e,n){var a=i[e];i[e]=i[n],i[n]=a}function tM(i,e){return i<e?-1:i>e?1:0}function Pg(i,e){const n=i.length;if(n<=1)return[i];const a=[];let u,d;for(let m=0;m<n;m++){const _=xt(i[m]);_!==0&&(i[m].area=Math.abs(_),d===void 0&&(d=_<0),d===_<0?(u&&a.push(u),u=[i[m]]):u.push(i[m]))}if(u&&a.push(u),e>1)for(let m=0;m<a.length;m++)a[m].length<=e||(eM(a[m],e,1,a[m].length-1,nM),a[m]=a[m].slice(0,e));return a}function nM(i,e){return e.area-i.area}function zg(i,e,n){const a=n.patternDependencies;let u=!1;for(const d of e){const m=d.paint.get(`${i}-pattern`);m.isConstant()||(u=!0);const _=m.constantOr(null);_&&(u=!0,a[_.to]=!0,a[_.from]=!0)}return u}function Og(i,e,n,a,u){const d=u.patternDependencies;for(const m of e){const _=m.paint.get(`${i}-pattern`).value;if(_.kind!=="constant"){let b=_.evaluate({zoom:a-1},n,{},u.availableImages),w=_.evaluate({zoom:a},n,{},u.availableImages),S=_.evaluate({zoom:a+1},n,{},u.availableImages);b=b&&b.name?b.name:b,w=w&&w.name?w.name:w,S=S&&S.name?S.name:S,d[b]=!0,d[w]=!0,d[S]=!0,n.patterns[m.id]={min:b,mid:w,max:S}}}return n}qd.deviation=function(i,e,n,a){var u=e&&e.length,d=Math.abs(Ig(i,0,u?e[0]*n:i.length,n));if(u)for(var m=0,_=e.length;m<_;m++)d-=Math.abs(Ig(i,e[m]*n,m<_-1?e[m+1]*n:i.length,n));var b=0;for(m=0;m<a.length;m+=3){var w=a[m]*n,S=a[m+1]*n,I=a[m+2]*n;b+=Math.abs((i[w]-i[I])*(i[S+1]-i[w+1])-(i[w]-i[S])*(i[I+1]-i[w+1]))}return d===0&&b===0?0:Math.abs((b-d)/d)},qd.flatten=function(i){for(var e=i[0][0].length,n={vertices:[],holes:[],dimensions:e},a=0,u=0;u<i.length;u++){for(var d=0;d<i[u].length;d++)for(var m=0;m<e;m++)n.vertices.push(i[u][d][m]);u>0&&n.holes.push(a+=i[u-1].length)}return n},Zd.default=GS;class Kd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new At,this.indexArray=new gn,this.indexArray2=new qi,this.programConfigurations=new el(e.layers,e.zoom),this.segments=new xi,this.segments2=new xi,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection}populate(e,n,a,u){this.hasPattern=zg("fill",this.layers,n);const d=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:_,id:b,index:w,sourceLayerIndex:S}of e){const I=this.layers[0]._featureFilter.needGeometry,P=tl(_,I);if(!this.layers[0]._featureFilter.filter(new H(this.zoom),P,a))continue;const L=d?d.evaluate(P,{},a,n.availableImages):void 0,B={id:b,properties:_.properties,type:_.type,sourceLayerIndex:S,index:w,geometry:I?P.geometry:ss(_,a,u),patterns:{},sortKey:L};m.push(B)}d&&m.sort((_,b)=>_.sortKey-b.sortKey);for(const _ of m){const{geometry:b,index:w,sourceLayerIndex:S}=_;if(this.hasPattern){const I=Og("fill",this.layers,_,this.zoom,n);this.patternFeatures.push(I)}else this.addFeature(_,b,w,a,{},n.availableImages);n.featureIndex.insert(e[w].feature,b,w,S,this.index)}}update(e,n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,u)}addFeatures(e,n,a,u,d){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,n,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$S),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,a,u,d,m=[]){for(const _ of Pg(n,500)){let b=0;for(const B of _)b+=B.length;const w=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),S=w.vertexLength,I=[],P=[];for(const B of _){if(B.length===0)continue;B!==_[0]&&P.push(I.length/2);const V=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),Z=V.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(Z+B.length-1,Z),I.push(B[0].x),I.push(B[0].y);for(let Q=1;Q<B.length;Q++)this.layoutVertexArray.emplaceBack(B[Q].x,B[Q].y),this.indexArray2.emplaceBack(Z+Q-1,Z+Q),I.push(B[Q].x),I.push(B[Q].y);V.vertexLength+=B.length,V.primitiveLength+=B.length}const L=Zd(I,P);for(let B=0;B<L.length;B+=3)this.indexArray.emplaceBack(S+L[B],S+L[B+1],S+L[B+2]);w.vertexLength+=b,w.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,d,m,u)}}Bt(Kd,"FillBucket",{omit:["layers","patternFeatures"]});const iM=new He({"fill-sort-key":new ve($e.layout_fill["fill-sort-key"])});var rM={paint:new He({"fill-antialias":new he($e.paint_fill["fill-antialias"]),"fill-opacity":new ve($e.paint_fill["fill-opacity"]),"fill-color":new ve($e.paint_fill["fill-color"]),"fill-outline-color":new ve($e.paint_fill["fill-outline-color"]),"fill-translate":new he($e.paint_fill["fill-translate"]),"fill-translate-anchor":new he($e.paint_fill["fill-translate-anchor"]),"fill-pattern":new ze($e.paint_fill["fill-pattern"])}),layout:iM};const oM=Je([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),sM=Je([{name:"a_centroid_pos",components:2,type:"Uint16"}]),aM=Je([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:lM}=oM;var G0=Sc;function Sc(i,e,n,a,u){this.properties={},this.extent=n,this.type=0,this._pbf=i,this._geometry=-1,this._keys=a,this._values=u,i.readFields(cM,this,e)}function cM(i,e,n){i==1?e.id=n.readVarint():i==2?function(a,u){for(var d=a.readVarint()+a.pos;a.pos<d;){var m=u._keys[a.readVarint()],_=u._values[a.readVarint()];u.properties[m]=_}}(n,e):i==3?e.type=n.readVarint():i==4&&(e._geometry=n.pos)}function uM(i){for(var e,n,a=0,u=0,d=i.length,m=d-1;u<d;m=u++)a+=((n=i[m]).x-(e=i[u]).x)*(e.y+n.y);return a}Sc.types=["Unknown","Point","LineString","Polygon"],Sc.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,n=i.readVarint()+i.pos,a=1,u=0,d=0,m=0,_=[];i.pos<n;){if(u<=0){var b=i.readVarint();a=7&b,u=b>>3}if(u--,a===1||a===2)d+=i.readSVarint(),m+=i.readSVarint(),a===1&&(e&&_.push(e),e=[]),e.push(new D(d,m));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&_.push(e),_},Sc.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,n=1,a=0,u=0,d=0,m=1/0,_=-1/0,b=1/0,w=-1/0;i.pos<e;){if(a<=0){var S=i.readVarint();n=7&S,a=S>>3}if(a--,n===1||n===2)(u+=i.readSVarint())<m&&(m=u),u>_&&(_=u),(d+=i.readSVarint())<b&&(b=d),d>w&&(w=d);else if(n!==7)throw new Error("unknown command "+n)}return[m,b,_,w]},Sc.prototype.toGeoJSON=function(i,e,n){var a,u,d=this.extent*Math.pow(2,n),m=this.extent*i,_=this.extent*e,b=this.loadGeometry(),w=Sc.types[this.type];function S(L){for(var B=0;B<L.length;B++){var V=L[B];L[B]=[360*(V.x+m)/d-180,360/Math.PI*Math.atan(Math.exp((180-360*(V.y+_)/d)*Math.PI/180))-90]}}switch(this.type){case 1:var I=[];for(a=0;a<b.length;a++)I[a]=b[a][0];S(b=I);break;case 2:for(a=0;a<b.length;a++)S(b[a]);break;case 3:for(b=function(L){var B=L.length;if(B<=1)return[L];for(var V,Z,Q=[],ce=0;ce<B;ce++){var ne=uM(L[ce]);ne!==0&&(Z===void 0&&(Z=ne<0),Z===ne<0?(V&&Q.push(V),V=[L[ce]]):V.push(L[ce]))}return V&&Q.push(V),Q}(b),a=0;a<b.length;a++)for(u=0;u<b[a].length;u++)S(b[a][u])}b.length===1?b=b[0]:w="Multi"+w;var P={type:"Feature",geometry:{type:w,coordinates:b},properties:this.properties};return"id"in this&&(P.id=this.id),P};var Z0=q0;function q0(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(hM,this,e),this.length=this._features.length}function hM(i,e,n){i===15?e.version=n.readVarint():i===1?e.name=n.readString():i===5?e.extent=n.readVarint():i===2?e._features.push(n.pos):i===3?e._keys.push(n.readString()):i===4&&e._values.push(function(a){for(var u=null,d=a.readVarint()+a.pos;a.pos<d;){var m=a.readVarint()>>3;u=m===1?a.readString():m===2?a.readFloat():m===3?a.readDouble():m===4?a.readVarint64():m===5?a.readVarint():m===6?a.readSVarint():m===7?a.readBoolean():null}return u}(n))}function fM(i,e,n){if(i===3){var a=new Z0(n,n.readVarint()+n.pos);a.length&&(e[a.name]=a)}}q0.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new G0(this._pbf,e,this.extent,this._keys,this._values)};var sl={VectorTile:function(i,e){this.layers=i.readFields(fM,{},e)},VectorTileFeature:G0,VectorTileLayer:Z0};function Yd(i,e,n,a){const u=[],d=a===0?(m,_,b,w,S,I)=>{m.push(new D(I,b+(I-_)/(w-_)*(S-b)))}:(m,_,b,w,S,I)=>{m.push(new D(_+(I-b)/(S-b)*(w-_),I))};for(const m of i){const _=[];for(const b of m){if(b.length<=2)continue;const w=[];for(let P=0;P<b.length-1;P++){const L=b[P].x,B=b[P].y,V=b[P+1].x,Z=b[P+1].y,Q=a===0?L:B,ce=a===0?V:Z;Q<e?ce>e&&d(w,L,B,V,Z,e):Q>n?ce<n&&d(w,L,B,V,Z,n):w.push(b[P]),ce<e&&Q>=e&&d(w,L,B,V,Z,e),ce>n&&Q<=n&&d(w,L,B,V,Z,n)}let S=b[b.length-1];const I=a===0?S.x:S.y;I>=e&&I<=n&&w.push(S),w.length&&(S=w[w.length-1],w[0].x===S.x&&w[0].y===S.y||w.push(w[0]),_.push(w))}_.length&&u.push(_)}return u}const dM=sl.VectorTileFeature.types,pM=Math.pow(2,13);function Eh(i,e,n,a,u,d,m,_){i.emplaceBack((e<<1)+m,(n<<1)+d,(Math.floor(a*pM)<<1)+u,Math.round(_))}function Ch(i,e,n){i.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class W0{constructor(){this.acc=new D(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new D(e.x,e.y),this.max=new D(e.x,e.y))}append(e,n){this.currentPolyCount.edges++,this.acc._add(e);const a=this.min,u=this.max;e.x<a.x?a.x=e.x:e.x>u.x&&(u.x=e.x),e.y<a.y?a.y=e.y:e.y>u.y&&(u.y=e.y),((e.x===0||e.x===Qt)&&e.x===n.x)!=((e.y===0||e.y===Qt)&&e.y===n.y)&&this.processBorderOverlap(e,n),n.x<0!=e.x<0&&this.addBorderIntersection(0,Mn(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>Qt!=e.x>Qt&&this.addBorderIntersection(1,Mn(n.y,e.y,(Qt-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,Mn(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>Qt!=e.y>Qt&&this.addBorderIntersection(3,Mn(n.x,e.x,(Qt-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const a=this.borders[e];n<a[0]&&(a[0]=n),n>a[1]&&(a[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const a=e.x===0?0:1;this.addBorderIntersection(a,n.y),this.addBorderIntersection(a,e.y)}else{const a=e.y===0?2:3;this.addBorderIntersection(a,n.x),this.addBorderIntersection(a,e.x)}}centroid(){const e=this.polyCount.reduce((n,a)=>n+a.edges,0);return e!==0?this.acc.div(e)._round():new D(0,0)}span(){return new D(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0)}}class Sh{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Zt,this.centroidVertexArray=new i0,this.indexArray=new gn,this.programConfigurations=new el(e.layers,e.zoom),this.segments=new xi,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.enableTerrain=e.enableTerrain}populate(e,n,a,u){this.features=[],this.hasPattern=zg("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(d){const m=Math.exp(Math.PI*(1-d.y/(1<<d.z)*2));return 80150034*m/(m*m+1)/Qt/(1<<d.z)}(a),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:d,id:m,index:_,sourceLayerIndex:b}of e){const w=this.layers[0]._featureFilter.needGeometry,S=tl(d,w);if(!this.layers[0]._featureFilter.filter(new H(this.zoom),S,a))continue;const I={id:m,sourceLayerIndex:b,index:_,geometry:w?S.geometry:ss(d,a,u),properties:d.properties,type:d.type,patterns:{}},P=this.layoutVertexArray.length;this.hasPattern?this.features.push(Og("fill-extrusion",this.layers,I,this.zoom,n)):this.addFeature(I,I.geometry,_,a,{},n.availableImages,u),n.featureIndex.insert(d,I.geometry,_,b,this.index,P)}this.sortBorders()}addFeatures(e,n,a,u,d){for(const m of this.features){const{geometry:_}=m;this.addFeature(m,_,m.index,n,a,u,d)}this.sortBorders()}update(e,n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,lM),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,aM.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,sM.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,a,u,d,m,_){const b=[new D(0,0),new D(Qt,Qt)],w=_.projection,S=w.name==="globe",I=this.enableTerrain&&!S?new W0:null,P=dM[e.type]==="Polygon";S&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Wi);const L=Pg(n,500);for(let Q=L.length-1;Q>=0;Q--){const ce=L[Q];(ce.length===0||(B=ce[0]).every(ne=>ne.x<=0)||B.every(ne=>ne.x>=Qt)||B.every(ne=>ne.y<=0)||B.every(ne=>ne.y>=Qt))&&L.splice(Q,1)}var B;let V;if(S)V=ex(L,b,u);else{V=[];for(const Q of L)V.push({polygon:Q,bounds:b})}const Z=P?this.edgeRadius:0;for(const{polygon:Q,bounds:ce}of V){let ne=0,ae=0;for(const ue of Q)P&&!ue[0].equals(ue[ue.length-1])&&ue.push(ue[0]),ae+=P?ue.length-1:ue.length;const me=this.segments.prepareSegment((P?5:4)*ae,this.layoutVertexArray,this.indexArray);if(P){const ue=[],Re=[];ne=me.vertexLength;for(const Ze of Q){let _t,Fe;Ze.length&&Ze!==Q[0]&&Re.push(ue.length/2),_t=Ze[1].sub(Ze[0])._perp()._unit();for(let Ke=1;Ke<Ze.length;Ke++){const nt=Ze[Ke],Ye=Ze[Ke===Ze.length-1?1:Ke+1];let{x:mt,y:it}=nt;if(Z){Fe=Ye.sub(nt)._perp()._unit();const Pt=_t.add(Fe)._unit(),cn=Z*Math.min(4,1/(_t.x*Pt.x+_t.y*Pt.y));mt+=cn*Pt.x,it+=cn*Pt.y,_t=Fe}Eh(this.layoutVertexArray,mt,it,0,0,1,1,0),me.vertexLength++,ue.push(nt.x,nt.y),S&&Ch(this.layoutVertexExtArray,w.projectTilePoint(mt,it,u),w.upVector(u,mt,it))}}const De=Zd(ue,Re);for(let Ze=0;Ze<De.length;Ze+=3)this.indexArray.emplaceBack(ne+De[Ze],ne+De[Ze+2],ne+De[Ze+1]),me.primitiveLength++}for(const ue of Q){I&&ue.length&&I.startRing(ue[0]);let Re,De,Ze,_t=ue.length>4&&Y0(ue[ue.length-2],ue[0],ue[1]),Fe=Z?mM(ue[ue.length-2],ue[0],ue[1],Z):0;De=ue[1].sub(ue[0])._perp()._unit();for(let Ke=1,nt=0;Ke<ue.length;Ke++){let Ye=ue[Ke-1],mt=ue[Ke];const it=ue[Ke===ue.length-1?1:Ke+1];if(I&&P&&I.currentPolyCount.top++,K0(mt,Ye,ce)){Z&&(De=it.sub(mt)._perp()._unit());continue}I&&I.append(mt,Ye);const Pt=mt.sub(Ye)._perp(),cn=Pt.x/(Math.abs(Pt.x)+Math.abs(Pt.y)),hn=Pt.y>0?1:0,$t=Ye.dist(mt);if(nt+$t>32768&&(nt=0),Z){Ze=it.sub(mt)._perp()._unit();let Dt=X0(Ye,mt,it,H0(De,Ze),Z);isNaN(Dt)&&(Dt=0);const Kn=mt.sub(Ye)._unit();Ye=Ye.add(Kn.mult(Fe))._round(),mt=mt.add(Kn.mult(-Dt))._round(),Fe=Dt,De=Ze}const Mt=me.vertexLength,wn=ue.length>4&&Y0(Ye,mt,it);let rn=J0(nt,_t,!0);if(Eh(this.layoutVertexArray,Ye.x,Ye.y,cn,hn,0,0,rn),Eh(this.layoutVertexArray,Ye.x,Ye.y,cn,hn,0,1,rn),nt+=$t,rn=J0(nt,wn,!1),_t=wn,Eh(this.layoutVertexArray,mt.x,mt.y,cn,hn,0,0,rn),Eh(this.layoutVertexArray,mt.x,mt.y,cn,hn,0,1,rn),me.vertexLength+=4,this.indexArray.emplaceBack(Mt+0,Mt+1,Mt+2),this.indexArray.emplaceBack(Mt+1,Mt+3,Mt+2),me.primitiveLength+=2,Z){const Dt=ne+(Ke===1?ue.length-2:Ke-2),Kn=Ke===1?ne:Dt+1;if(this.indexArray.emplaceBack(Mt+1,Dt,Mt+3),this.indexArray.emplaceBack(Dt,Kn,Mt+3),me.primitiveLength+=2,Re===void 0&&(Re=Mt),!K0(it,ue[Ke],ce)){const Zn=Ke===ue.length-1?Re:me.vertexLength;this.indexArray.emplaceBack(Mt+2,Mt+3,Zn),this.indexArray.emplaceBack(Mt+3,Zn+1,Zn),this.indexArray.emplaceBack(Mt+3,Kn,Zn+1),me.primitiveLength+=3}}if(S){const Dt=this.layoutVertexExtArray,Kn=w.projectTilePoint(Ye.x,Ye.y,u),Zn=w.projectTilePoint(mt.x,mt.y,u),ii=w.upVector(u,Ye.x,Ye.y),dn=w.upVector(u,mt.x,mt.y);Ch(Dt,Kn,ii),Ch(Dt,Kn,ii),Ch(Dt,Zn,dn),Ch(Dt,Zn,dn)}}P&&(ne+=ue.length-1)}}if(I&&I.polyCount.length>0){if(I.borders){I.vertexArrayOffset=this.centroidVertexArray.length;const Q=I.borders,ce=this.featuresOnBorder.push(I)-1;for(let ne=0;ne<4;ne++)Q[ne][0]!==Number.MAX_VALUE&&this.borders[ne].push(ce)}this.encodeCentroid(I.borders?void 0:I.centroid(),I)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,d,m,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((n,a)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[a].borders[e][0])}encodeCentroid(e,n,a=!0){let u,d;if(e)if(e.y!==0){const _=n.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(_.x/10)),d=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(_.y/10))}else u=Math.ceil(7*(e.x+450)),d=0;else u=0,d=+a;let m=a?this.centroidVertexArray.length:n.vertexArrayOffset;for(const _ of n.polyCount){a&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*_.edges+_.top);for(let b=0;b<_.top;b++)this.centroidVertexArray.emplace(m++,u,d);for(let b=0;b<2*_.edges;b++)this.centroidVertexArray.emplace(m++,0,d),this.centroidVertexArray.emplace(m++,u,d)}}}function H0(i,e){const n=i.add(e)._unit();return i.x*n.x+i.y*n.y}function mM(i,e,n,a){const u=e.sub(i)._perp()._unit(),d=n.sub(e)._perp()._unit();return X0(i,e,n,H0(u,d),a)}function X0(i,e,n,a,u){const d=Math.sqrt(1-a*a);return Math.min(i.dist(e)/3,e.dist(n)/3,u*d/a)}function K0(i,e,n){return i.x<n[0].x&&e.x<n[0].x||i.x>n[1].x&&e.x>n[1].x||i.y<n[0].y&&e.y<n[0].y||i.y>n[1].y&&e.y>n[1].y}function Y0(i,e,n){if(i.x<0||i.x>=Qt||e.x<0||e.x>=Qt||n.x<0||n.x>=Qt)return!1;const a=n.sub(e),u=a.perp(),d=i.sub(e);return(a.x*d.x+a.y*d.y)/Math.sqrt((a.x*a.x+a.y*a.y)*(d.x*d.x+d.y*d.y))>-.866&&u.x*d.x+u.y*d.y<0}function J0(i,e,n){const a=e?2|i:-3&i;return n?1|a:-2&a}function Q0(){const i=Math.PI/32,e=Math.tan(i),n=ag;return n*Math.sqrt(1+2*e*e)-n}function ex(i,e,n){const a=1<<n.z,u=Nr(n.x/a),d=Nr((n.x+1)/a),m=ji(n.y/a),_=ji((n.y+1)/a);return function(b,w,S,I,P=0,L){const B=[];if(!b.length||!S||!I)return B;const V=(ue,Re)=>{for(const De of ue)B.push({polygon:De,bounds:Re})},Z=Math.ceil(Math.log2(S)),Q=Math.ceil(Math.log2(I)),ce=Z-Q,ne=[];for(let ue=0;ue<Math.abs(ce);ue++)ne.push(ce>0?0:1);for(let ue=0;ue<Math.min(Z,Q);ue++)ne.push(0),ne.push(1);let ae=b;if(ae=Yd(ae,w[0].y-P,w[1].y+P,1),ae=Yd(ae,w[0].x-P,w[1].x+P,0),!ae.length)return B;const me=[];for(ne.length?me.push({polygons:ae,bounds:w,depth:0}):V(ae,w);me.length;){const ue=me.pop(),Re=ue.depth,De=ne[Re],Ze=ue.bounds[0],_t=ue.bounds[1],Fe=De===0?Ze.x:Ze.y,Ke=De===0?_t.x:_t.y,nt=L?L(De,Fe,Ke):.5*(Fe+Ke),Ye=Yd(ue.polygons,Fe-P,nt+P,De),mt=Yd(ue.polygons,nt-P,Ke+P,De);if(Ye.length){const it=[Ze,new D(De===0?nt:_t.x,De===1?nt:_t.y)];ne.length>Re+1?me.push({polygons:Ye,bounds:it,depth:Re+1}):V(Ye,it)}if(mt.length){const it=[new D(De===0?nt:Ze.x,De===1?nt:Ze.y),_t];ne.length>Re+1?me.push({polygons:mt,bounds:it,depth:Re+1}):V(mt,it)}}return B}(i,e,Math.ceil((d-u)/11.25),Math.ceil((m-_)/11.25),1,(b,w,S)=>{if(b===0)return .5*(w+S);{const I=ji((n.y+w/Qt)/a);return(os(.5*(ji((n.y+S/Qt)/a)+I))*a-n.y)*Qt}})}Bt(Sh,"FillExtrusionBucket",{omit:["layers","features"]}),Bt(W0,"PartMetadata");const gM=new He({"fill-extrusion-edge-radius":new he($e["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var _M={paint:new He({"fill-extrusion-opacity":new he($e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ve($e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new he($e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new he($e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ze($e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ve($e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ve($e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new he($e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new he($e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new he($e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:gM};function tx(i,e,n){var a=2*Math.PI*6378137/256/Math.pow(2,n);return[i*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class Jd{constructor(e,n,a){this.z=e,this.x=n,this.y=a,this.key=Mh(0,e,e,n,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const a=function(d,m,_){var b=tx(256*d,256*(m=Math.pow(2,_)-m-1),_),w=tx(256*(d+1),256*(m+1),_);return b[0]+","+b[1]+","+w[0]+","+w[1]}(this.x,this.y,this.z),u=function(d,m,_){let b,w="";for(let S=d;S>0;S--)b=1<<S-1,w+=(m&b?1:0)+(_&b?2:0);return w}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",a)}toString(){return`${this.z}/${this.x}/${this.y}`}}class nx{constructor(e,n){this.wrap=e,this.canonical=n,this.key=Mh(e,n.z,n.z,n.x,n.y)}}class nr{constructor(e,n,a,u,d){this.overscaledZ=e,this.wrap=n,this.canonical=new Jd(a,+u,+d),this.key=n===0&&e===a?this.canonical.key:Mh(n,e,a,u,d)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new nr(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new nr(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return Mh(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const a=this.canonical.z-e;return Mh(this.wrap*+n,e,e,this.canonical.x>>a,this.canonical.y>>a)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new nr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,a=2*this.canonical.x,u=2*this.canonical.y;return[new nr(n,this.wrap,n,a,u),new nr(n,this.wrap,n,a+1,u),new nr(n,this.wrap,n,a,u+1),new nr(n,this.wrap,n,a+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new nr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new nr(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new nx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Mh(i,e,n,a,u){const d=1<<Math.min(n,22);let m=d*(u%d)+a%d;return i&&n<22&&(m+=d*d*((i<0?-2*i-1:2*i)%(1<<2*(22-n)))),16*(32*m+n)+(e-n)}function Ah(i,e){return i.x*e.x+i.y*e.y}function ix(i,e){if(i.length===1){let n=0;const a=e[n++];let u;for(;!u||a.equals(u);)if(u=e[n++],!u)return 1/0;for(;n<e.length;n++){const d=e[n],m=i[0],_=u.sub(a),b=d.sub(a),w=m.sub(a),S=Ah(_,_),I=Ah(_,b),P=Ah(b,b),L=Ah(w,_),B=Ah(w,b),V=S*P-I*I,Z=(P*L-I*B)/V,Q=(S*B-I*L)/V,ce=a.z*(1-Z-Q)+u.z*Z+d.z*Q;if(isFinite(ce))return ce}return 1/0}{let n=1/0;for(const a of e)n=Math.min(n,a.z);return n}}function Qd(i){const e=new D(i[0],i[1]);return e.z=i[2],e}function rx(i,e,n,a,u,d,m,_){const b=m*u.getElevationAt(i,e,!0,!0),w=d[0]!==0,S=w?d[1]===0?m*(d[0]/7-450):m*function(I,P,L){const B=Math.floor(P[0]/8),V=Math.floor(P[1]/8),Z=10*(P[0]-8*B),Q=10*(P[1]-8*V),ce=I.getElevationAt(B,V,!0,!0),ne=I.getMeterToDEM(L),ae=Math.floor(.5*(Z*ne-1)),me=Math.floor(.5*(Q*ne-1)),ue=I.tileCoordToPixel(B,V),Re=2*ae+1,De=2*me+1,Ze=function(mt,it,Pt,cn,hn){return[mt.getElevationAtPixel(it,Pt,!0),mt.getElevationAtPixel(it+hn,Pt,!0),mt.getElevationAtPixel(it,Pt+hn,!0),mt.getElevationAtPixel(it+cn,Pt+hn,!0)]}(I,ue.x-ae,ue.y-me,Re,De),_t=Math.abs(Ze[0]-Ze[1]),Fe=Math.abs(Ze[2]-Ze[3]),Ke=Math.abs(Ze[0]-Ze[2])+Math.abs(Ze[1]-Ze[3]),nt=Math.min(.25,.5*ne*(_t+Fe)/Re),Ye=Math.min(.25,.5*ne*Ke/De);return ce+Math.max(nt*Z,Ye*Q)}(u,d,_):b;return{base:b+(n===0)?-1:n,top:w?Math.max(S+a,b+n+2):b+a}}Bt(Jd,"CanonicalTileID"),Bt(nr,"OverscaledTileID",{omit:["projMatrix"]});const yM=Je([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:vM}=yM,xM=Je([{name:"a_packed",components:4,type:"Float32"}]),{members:bM}=xM,wM=sl.VectorTileFeature.types,TM=Math.cos(Math.PI/180*37.5);class ep{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new tn,this.layoutVertexArray2=new bn,this.indexArray=new gn,this.programConfigurations=new el(e.layers,e.zoom),this.segments=new xi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,a,u){this.hasPattern=zg("line",this.layers,n);const d=this.layers[0].layout.get("line-sort-key"),m=[];for(const{feature:S,id:I,index:P,sourceLayerIndex:L}of e){const B=this.layers[0]._featureFilter.needGeometry,V=tl(S,B);if(!this.layers[0]._featureFilter.filter(new H(this.zoom),V,a))continue;const Z=d?d.evaluate(V,{},a):void 0,Q={id:I,properties:S.properties,type:S.type,sourceLayerIndex:L,index:P,geometry:B?V.geometry:ss(S,a,u),patterns:{},sortKey:Z};m.push(Q)}d&&m.sort((S,I)=>S.sortKey-I.sortKey);const{lineAtlas:_,featureIndex:b}=n,w=this.addConstantDashes(_);for(const S of m){const{geometry:I,index:P,sourceLayerIndex:L}=S;if(w&&this.addFeatureDashes(S,_),this.hasPattern){const B=Og("line",this.layers,S,this.zoom,n);this.patternFeatures.push(B)}else this.addFeature(S,I,P,a,_.positions,n.availableImages);b.insert(e[P].feature,I,P,L,this.index)}}addConstantDashes(e){let n=!1;for(const a of this.layers){const u=a.paint.get("line-dasharray").value,d=a.layout.get("line-cap").value;if(u.kind!=="constant"||d.kind!=="constant")n=!0;else{const m=d.value,_=u.value;if(!_)continue;e.addDash(_.from,m),e.addDash(_.to,m),_.other&&e.addDash(_.other,m)}}return n}addFeatureDashes(e,n){const a=this.zoom;for(const u of this.layers){const d=u.paint.get("line-dasharray").value,m=u.layout.get("line-cap").value;if(d.kind==="constant"&&m.kind==="constant")continue;let _,b,w,S,I,P;if(d.kind==="constant"){const Z=d.value;if(!Z)continue;_=Z.other||Z.to,b=Z.to,w=Z.from}else _=d.evaluate({zoom:a-1},e),b=d.evaluate({zoom:a},e),w=d.evaluate({zoom:a+1},e);m.kind==="constant"?S=I=P=m.value:(S=m.evaluate({zoom:a-1},e),I=m.evaluate({zoom:a},e),P=m.evaluate({zoom:a+1},e)),n.addDash(_,S),n.addDash(b,I),n.addDash(w,P);const L=n.getKey(_,S),B=n.getKey(b,I),V=n.getKey(w,P);e.patterns[u.id]={min:L,mid:B,max:V}}}update(e,n,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a,u)}addFeatures(e,n,a,u,d){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,n,a,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,bM)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,vM),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,a,u,d,m){const _=this.layers[0].layout,b=_.get("line-join").evaluate(e,{}),w=_.get("line-cap").evaluate(e,{}),S=_.get("line-miter-limit"),I=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const P of n)this.addLine(P,e,b,w,S,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,d,m,u)}addLine(e,n,a,u,d,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Q=0;Q<e.length-1;Q++)this.totalDistance+=e[Q].dist(e[Q+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const _=wM[n.type]==="Polygon";let b=e.length;for(;b>=2&&e[b-1].equals(e[b-2]);)b--;let w=0;for(;w<b-1&&e[w].equals(e[w+1]);)w++;if(b<(_?3:2))return;a==="bevel"&&(d=1.05);const S=this.overscaling<=16?122880/(512*this.overscaling):0,I=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let P,L,B,V,Z;this.e1=this.e2=-1,_&&(P=e[b-2],Z=e[w].sub(P)._unit()._perp());for(let Q=w;Q<b;Q++){if(B=Q===b-1?_?e[w+1]:void 0:e[Q+1],B&&e[Q].equals(B))continue;Z&&(V=Z),P&&(L=P),P=e[Q],Z=B?B.sub(P)._unit()._perp():V,V=V||Z;let ce=V.add(Z);ce.x===0&&ce.y===0||ce._unit();const ne=V.x*Z.x+V.y*Z.y,ae=ce.x*Z.x+ce.y*Z.y,me=ae!==0?1/ae:1/0,ue=2*Math.sqrt(2-2*ae),Re=ae<TM&&L&&B,De=V.x*Z.y-V.y*Z.x>0;if(Re&&Q>w){const Fe=P.dist(L);if(Fe>2*S){const Ke=P.sub(P.sub(L)._mult(S/Fe)._round());this.updateDistance(L,Ke),this.addCurrentVertex(Ke,V,0,0,I),L=Ke}}const Ze=L&&B;let _t=Ze?a:_?"butt":u;if(Ze&&_t==="round"&&(me<m?_t="miter":me<=2&&(_t="fakeround")),_t==="miter"&&me>d&&(_t="bevel"),_t==="bevel"&&(me>2&&(_t="flipbevel"),me<d&&(_t="miter")),L&&this.updateDistance(L,P),_t==="miter")ce._mult(me),this.addCurrentVertex(P,ce,0,0,I);else if(_t==="flipbevel"){if(me>100)ce=Z.mult(-1);else{const Fe=me*V.add(Z).mag()/V.sub(Z).mag();ce._perp()._mult(Fe*(De?-1:1))}this.addCurrentVertex(P,ce,0,0,I),this.addCurrentVertex(P,ce.mult(-1),0,0,I)}else if(_t==="bevel"||_t==="fakeround"){const Fe=-Math.sqrt(me*me-1),Ke=De?Fe:0,nt=De?0:Fe;if(L&&this.addCurrentVertex(P,V,Ke,nt,I),_t==="fakeround"){const Ye=Math.round(180*ue/Math.PI/20);for(let mt=1;mt<Ye;mt++){let it=mt/Ye;if(it!==.5){const cn=it-.5;it+=it*cn*(it-1)*((1.0904+ne*(ne*(3.55645-1.43519*ne)-3.2452))*cn*cn+(.848013+ne*(.215638*ne-1.06021)))}const Pt=Z.sub(V)._mult(it)._add(V)._unit()._mult(De?-1:1);this.addHalfVertex(P,Pt.x,Pt.y,!1,De,0,I)}}B&&this.addCurrentVertex(P,Z,-Ke,-nt,I)}else if(_t==="butt")this.addCurrentVertex(P,ce,0,0,I);else if(_t==="square"){const Fe=L?1:-1;L||this.addCurrentVertex(P,ce,Fe,Fe,I),this.addCurrentVertex(P,ce,0,0,I),L&&this.addCurrentVertex(P,ce,Fe,Fe,I)}else _t==="round"&&(L&&(this.addCurrentVertex(P,V,0,0,I),this.addCurrentVertex(P,V,1,1,I,!0)),B&&(this.addCurrentVertex(P,Z,-1,-1,I,!0),this.addCurrentVertex(P,Z,0,0,I)));if(Re&&Q<b-1){const Fe=P.dist(B);if(Fe>2*S){const Ke=P.add(B.sub(P)._mult(S/Fe)._round());this.updateDistance(P,Ke),this.addCurrentVertex(Ke,Z,0,0,I),P=Ke}}}}addCurrentVertex(e,n,a,u,d,m=!1){const _=n.y*u-n.x,b=-n.y-n.x*u;this.addHalfVertex(e,n.x+n.y*a,n.y-n.x*a,m,!1,a,d),this.addHalfVertex(e,_,b,m,!0,-u,d)}addHalfVertex({x:e,y:n},a,u,d,m,_,b){this.layoutVertexArray.emplaceBack((e<<1)+(d?1:0),(n<<1)+(m?1:0),Math.round(63*a)+128,Math.round(63*u)+128,1+(_===0?0:_<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const w=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,w),b.primitiveLength++),m?this.e2=w:this.e1=w}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}Bt(ep,"LineBucket",{omit:["layers","patternFeatures"]});const EM=new He({"line-cap":new ve($e.layout_line["line-cap"]),"line-join":new ve($e.layout_line["line-join"]),"line-miter-limit":new he($e.layout_line["line-miter-limit"]),"line-round-limit":new he($e.layout_line["line-round-limit"]),"line-sort-key":new ve($e.layout_line["line-sort-key"])});var ox={paint:new He({"line-opacity":new ve($e.paint_line["line-opacity"]),"line-color":new ve($e.paint_line["line-color"]),"line-translate":new he($e.paint_line["line-translate"]),"line-translate-anchor":new he($e.paint_line["line-translate-anchor"]),"line-width":new ve($e.paint_line["line-width"]),"line-gap-width":new ve($e.paint_line["line-gap-width"]),"line-offset":new ve($e.paint_line["line-offset"]),"line-blur":new ve($e.paint_line["line-blur"]),"line-dasharray":new ze($e.paint_line["line-dasharray"]),"line-pattern":new ze($e.paint_line["line-pattern"]),"line-gradient":new Ce($e.paint_line["line-gradient"]),"line-trim-offset":new he($e.paint_line["line-trim-offset"])}),layout:EM};const sx=new class extends ve{possiblyEvaluate(i,e){return e=new H(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(i,e)}evaluate(i,e,n,a){return e=ct({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(i,e,n,a)}}(ox.paint.properties["line-width"].specification);function ax(i,e){return e>0?e+2*i:i}sx.useIntegerZoom=!0;const CM=Je([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),SM=Je([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),MM=Je([{name:"a_projected_pos",components:4,type:"Float32"}],4);Je([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const AM=Je([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),IM=Je([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Je([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const lx=Je([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),PM=Je([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Je([{name:"triangle",components:3,type:"Uint16"}]),Je([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Je([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Je([{type:"Float32",name:"offsetX"}]),Je([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ni=24;const Io=128;function kg(i,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new H(i+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:u}=n;let d=0;for(;d<a.length&&a[d]<=i;)d++;d=Math.max(0,d-1);let m=d;for(;m<a.length&&a[m]<i+1;)m++;m=Math.min(a.length-1,m);const _=a[d],b=a[m];return n.kind==="composite"?{kind:"composite",minZoom:_,maxZoom:b,interpolationType:u}:{kind:"camera",minZoom:_,maxZoom:b,minSize:n.evaluate(new H(_)),maxSize:n.evaluate(new H(b)),interpolationType:u}}}function tp(i,{uSize:e,uSizeT:n},{lowerSize:a,upperSize:u}){return i.kind==="source"?a/Io:i.kind==="composite"?Mn(a/Io,u/Io,n):e}function Mc(i,e){let n=0,a=0;if(i.kind==="constant")a=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:u,minZoom:d,maxZoom:m}=i,_=u?Pe(Fr.interpolationFactor(u,e,d,m),0,1):0;i.kind==="camera"?a=Mn(i.minSize,i.maxSize,_):n=_}return{uSizeT:n,uSize:a}}var zM=Object.freeze({__proto__:null,getSizeData:kg,evaluateSizeForFeature:tp,evaluateSizeForZoom:Mc,SIZE_PACK_FACTOR:Io});function OM(i,e,n){return i.sections.forEach(a=>{a.text=function(u,d,m){const _=d.layout.get("text-transform").evaluate(m,{});return _==="uppercase"?u=u.toLocaleUpperCase():_==="lowercase"&&(u=u.toLocaleLowerCase()),W.applyArabicShaping&&(u=W.applyArabicShaping(u)),u}(a.text,e,n)}),i}const Ih={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function kM(i){return i==="\uFE36"||i==="\uFE48"||i==="\uFE38"||i==="\uFE44"||i==="\uFE42"||i==="\uFE3E"||i==="\uFE3C"||i==="\uFE3A"||i==="\uFE18"||i==="\uFE40"||i==="\uFE10"||i==="\uFE13"||i==="\uFE14"||i==="\uFF40"||i==="\uFFE3"||i==="\uFE11"||i==="\uFE12"}function DM(i){return i==="\uFE35"||i==="\uFE47"||i==="\uFE37"||i==="\uFE43"||i==="\uFE41"||i==="\uFE3D"||i==="\uFE3B"||i==="\uFE39"||i==="\uFE17"||i==="\uFE3F"}var cx=function(i,e,n,a,u){var d,m,_=8*u-a-1,b=(1<<_)-1,w=b>>1,S=-7,I=n?u-1:0,P=n?-1:1,L=i[e+I];for(I+=P,d=L&(1<<-S)-1,L>>=-S,S+=_;S>0;d=256*d+i[e+I],I+=P,S-=8);for(m=d&(1<<-S)-1,d>>=-S,S+=a;S>0;m=256*m+i[e+I],I+=P,S-=8);if(d===0)d=1-w;else{if(d===b)return m?NaN:1/0*(L?-1:1);m+=Math.pow(2,a),d-=w}return(L?-1:1)*m*Math.pow(2,d-a)},ux=function(i,e,n,a,u,d){var m,_,b,w=8*d-u-1,S=(1<<w)-1,I=S>>1,P=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,L=a?0:d-1,B=a?1:-1,V=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(_=isNaN(e)?1:0,m=S):(m=Math.floor(Math.log(e)/Math.LN2),e*(b=Math.pow(2,-m))<1&&(m--,b*=2),(e+=m+I>=1?P/b:P*Math.pow(2,1-I))*b>=2&&(m++,b/=2),m+I>=S?(_=0,m=S):m+I>=1?(_=(e*b-1)*Math.pow(2,u),m+=I):(_=e*Math.pow(2,I-1)*Math.pow(2,u),m=0));u>=8;i[n+L]=255&_,L+=B,_/=256,u-=8);for(m=m<<u|_,w+=u;w>0;i[n+L]=255&m,L+=B,m/=256,w-=8);i[n+L-B]|=128*V},Ph=Xn;function Xn(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Xn.Varint=0,Xn.Fixed64=1,Xn.Bytes=2,Xn.Fixed32=5;var Dg=4294967296,hx=1/Dg,fx=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ls(i){return i.type===Xn.Bytes?i.readVarint()+i.pos:i.pos+1}function Ac(i,e,n){return n?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function dx(i,e,n){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(a);for(var u=n.pos-1;u>=i;u--)n.buf[u+a]=n.buf[u]}function LM(i,e){for(var n=0;n<i.length;n++)e.writeVarint(i[n])}function RM(i,e){for(var n=0;n<i.length;n++)e.writeSVarint(i[n])}function BM(i,e){for(var n=0;n<i.length;n++)e.writeFloat(i[n])}function FM(i,e){for(var n=0;n<i.length;n++)e.writeDouble(i[n])}function jM(i,e){for(var n=0;n<i.length;n++)e.writeBoolean(i[n])}function NM(i,e){for(var n=0;n<i.length;n++)e.writeFixed32(i[n])}function UM(i,e){for(var n=0;n<i.length;n++)e.writeSFixed32(i[n])}function VM(i,e){for(var n=0;n<i.length;n++)e.writeFixed64(i[n])}function $M(i,e){for(var n=0;n<i.length;n++)e.writeSFixed64(i[n])}function np(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function Ic(i,e,n){i[n]=e,i[n+1]=e>>>8,i[n+2]=e>>>16,i[n+3]=e>>>24}function px(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}function GM(i,e,n){e.glyphs=[],i===1&&n.readMessage(ZM,e)}function ZM(i,e,n){if(i===3){const{id:a,bitmap:u,width:d,height:m,left:_,top:b,advance:w}=n.readMessage(qM,{});e.glyphs.push({id:a,bitmap:new as({width:d+6,height:m+6},u),metrics:{width:d,height:m,left:_,top:b,advance:w}})}else i===4?e.ascender=n.readSVarint():i===5&&(e.descender=n.readSVarint())}function qM(i,e,n){i===1?e.id=n.readVarint():i===2?e.bitmap=n.readBytes():i===3?e.width=n.readVarint():i===4?e.height=n.readVarint():i===5?e.left=n.readSVarint():i===6?e.top=n.readSVarint():i===7&&(e.advance=n.readVarint())}function Lg(i){let e=0,n=0;for(const m of i)e+=m.w*m.h,n=Math.max(n,m.w);i.sort((m,_)=>_.h-m.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let u=0,d=0;for(const m of i)for(let _=a.length-1;_>=0;_--){const b=a[_];if(!(m.w>b.w||m.h>b.h)){if(m.x=b.x,m.y=b.y,d=Math.max(d,m.y+m.h),u=Math.max(u,m.x+m.w),m.w===b.w&&m.h===b.h){const w=a.pop();_<a.length&&(a[_]=w)}else m.h===b.h?(b.x+=m.w,b.w-=m.w):m.w===b.w?(b.y+=m.h,b.h-=m.h):(a.push({x:b.x+m.w,y:b.y,w:b.w-m.w,h:m.h}),b.y+=m.h,b.h-=m.h);break}}return{w:u,h:d,fill:e/(u*d)||0}}Xn.prototype={destroy:function(){this.buf=null},readFields:function(i,e,n){for(n=n||this.length;this.pos<n;){var a=this.readVarint(),u=a>>3,d=this.pos;this.type=7&a,i(u,e,this),this.pos===d&&this.skip(a)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=np(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=px(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=np(this.buf,this.pos)+np(this.buf,this.pos+4)*Dg;return this.pos+=8,i},readSFixed64:function(){var i=np(this.buf,this.pos)+px(this.buf,this.pos+4)*Dg;return this.pos+=8,i},readFloat:function(){var i=cx(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=cx(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,n,a=this.buf;return e=127&(n=a[this.pos++]),n<128?e:(e|=(127&(n=a[this.pos++]))<<7,n<128?e:(e|=(127&(n=a[this.pos++]))<<14,n<128?e:(e|=(127&(n=a[this.pos++]))<<21,n<128?e:function(u,d,m){var _,b,w=m.buf;if(_=(112&(b=w[m.pos++]))>>4,b<128||(_|=(127&(b=w[m.pos++]))<<3,b<128)||(_|=(127&(b=w[m.pos++]))<<10,b<128)||(_|=(127&(b=w[m.pos++]))<<17,b<128)||(_|=(127&(b=w[m.pos++]))<<24,b<128)||(_|=(1&(b=w[m.pos++]))<<31,b<128))return Ac(u,_,d);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=a[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&fx?function(n,a,u){return fx.decode(n.subarray(a,u))}(this.buf,e,i):function(n,a,u){for(var d="",m=a;m<u;){var _,b,w,S=n[m],I=null,P=S>239?4:S>223?3:S>191?2:1;if(m+P>u)break;P===1?S<128&&(I=S):P===2?(192&(_=n[m+1]))==128&&(I=(31&S)<<6|63&_)<=127&&(I=null):P===3?(b=n[m+2],(192&(_=n[m+1]))==128&&(192&b)==128&&((I=(15&S)<<12|(63&_)<<6|63&b)<=2047||I>=55296&&I<=57343)&&(I=null)):P===4&&(b=n[m+2],w=n[m+3],(192&(_=n[m+1]))==128&&(192&b)==128&&(192&w)==128&&((I=(15&S)<<18|(63&_)<<12|(63&b)<<6|63&w)<=65535||I>=1114112)&&(I=null)),I===null?(I=65533,P=1):I>65535&&(I-=65536,d+=String.fromCharCode(I>>>10&1023|55296),I=56320|1023&I),d+=String.fromCharCode(I),m+=P}return d}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==Xn.Bytes)return i.push(this.readVarint(e));var n=ls(this);for(i=i||[];this.pos<n;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==Xn.Bytes)return i.push(this.readSVarint());var e=ls(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Xn.Bytes)return i.push(this.readBoolean());var e=ls(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Xn.Bytes)return i.push(this.readFloat());var e=ls(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Xn.Bytes)return i.push(this.readDouble());var e=ls(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Xn.Bytes)return i.push(this.readFixed32());var e=ls(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Xn.Bytes)return i.push(this.readSFixed32());var e=ls(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Xn.Bytes)return i.push(this.readFixed64());var e=ls(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Xn.Bytes)return i.push(this.readSFixed64());var e=ls(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===Xn.Varint)for(;this.buf[this.pos++]>127;);else if(e===Xn.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Xn.Fixed32)this.pos+=4;else{if(e!==Xn.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Ic(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Ic(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Ic(this.buf,-1&i,this.pos),Ic(this.buf,Math.floor(i*hx),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Ic(this.buf,-1&i,this.pos),Ic(this.buf,Math.floor(i*hx),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,n){var a,u;if(e>=0?(a=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,u=u+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(d,m,_){_.buf[_.pos++]=127&d|128,d>>>=7,_.buf[_.pos++]=127&d|128,d>>>=7,_.buf[_.pos++]=127&d|128,d>>>=7,_.buf[_.pos++]=127&d|128,_.buf[_.pos]=127&(d>>>=7)}(a,0,n),function(d,m){var _=(7&d)<<4;m.buf[m.pos++]|=_|((d>>>=3)?128:0),d&&(m.buf[m.pos++]=127&d|((d>>>=7)?128:0),d&&(m.buf[m.pos++]=127&d|((d>>>=7)?128:0),d&&(m.buf[m.pos++]=127&d|((d>>>=7)?128:0),d&&(m.buf[m.pos++]=127&d|((d>>>=7)?128:0),d&&(m.buf[m.pos++]=127&d)))))}(u,n)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(a,u,d){for(var m,_,b=0;b<u.length;b++){if((m=u.charCodeAt(b))>55295&&m<57344){if(!_){m>56319||b+1===u.length?(a[d++]=239,a[d++]=191,a[d++]=189):_=m;continue}if(m<56320){a[d++]=239,a[d++]=191,a[d++]=189,_=m;continue}m=_-55296<<10|m-56320|65536,_=null}else _&&(a[d++]=239,a[d++]=191,a[d++]=189,_=null);m<128?a[d++]=m:(m<2048?a[d++]=m>>6|192:(m<65536?a[d++]=m>>12|224:(a[d++]=m>>18|240,a[d++]=m>>12&63|128),a[d++]=m>>6&63|128),a[d++]=63&m|128)}return d}(this.buf,i,this.pos);var n=this.pos-e;n>=128&&dx(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(i){this.realloc(4),ux(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),ux(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=i[n]},writeRawMessage:function(i,e){this.pos++;var n=this.pos;i(e,this);var a=this.pos-n;a>=128&&dx(n,a,this),this.pos=n-1,this.writeVarint(a),this.pos+=a},writeMessage:function(i,e,n){this.writeTag(i,Xn.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,LM,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,RM,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,jM,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,BM,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,FM,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,NM,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,UM,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,VM,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,$M,e)},writeBytesField:function(i,e){this.writeTag(i,Xn.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,Xn.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,Xn.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,Xn.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,Xn.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,Xn.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,Xn.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,Xn.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,Xn.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,Xn.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,Boolean(e))}};class Rg{constructor(e,{pixelRatio:n,version:a,stretchX:u,stretchY:d,content:m}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=u,this.stretchY=d,this.content=m,this.version=a}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class mx{constructor(e,n){const a={},u={};this.haveRenderCallbacks=[];const d=[];this.addImages(e,a,d),this.addImages(n,u,d);const{w:m,h:_}=Lg(d),b=new xr({width:m||1,height:_||1});for(const w in e){const S=e[w],I=a[w].paddedRect;xr.copy(S.data,b,{x:0,y:0},{x:I.x+1,y:I.y+1},S.data)}for(const w in n){const S=n[w],I=u[w].paddedRect,P=I.x+1,L=I.y+1,B=S.data.width,V=S.data.height;xr.copy(S.data,b,{x:0,y:0},{x:P,y:L},S.data),xr.copy(S.data,b,{x:0,y:V-1},{x:P,y:L-1},{width:B,height:1}),xr.copy(S.data,b,{x:0,y:0},{x:P,y:L+V},{width:B,height:1}),xr.copy(S.data,b,{x:B-1,y:0},{x:P-1,y:L},{width:1,height:V}),xr.copy(S.data,b,{x:0,y:0},{x:P+B,y:L},{width:1,height:V})}this.image=b,this.iconPositions=a,this.patternPositions=u}addImages(e,n,a){for(const u in e){const d=e[u],m={x:0,y:0,w:d.data.width+2,h:d.data.height+2};a.push(m),n[u]=new Rg(m,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(a=>e.hasImage(a)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),n),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),n)}patchUpdatedImage(e,n,a){if(!e||!n||e.version===n.version)return;e.version=n.version;const[u,d]=e.tl;a.update(n.data,void 0,{x:u,y:d})}}Bt(Rg,"ImagePosition"),Bt(mx,"ImageAtlas");const kr={horizontal:1,vertical:2,horizontalOnly:3};class zh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const a=new zh;return a.scale=e||1,a.fontStack=n,a}static forImage(e){const n=new zh;return n.imageName=e,n}}class Pc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const a=new Pc;for(let u=0;u<e.sections.length;u++){const d=e.sections[u];d.image?a.addImageSection(d):a.addTextSection(d,n)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(n,a){let u="";for(let d=0;d<n.length;d++){const m=n.charCodeAt(d+1)||null,_=n.charCodeAt(d-1)||null;u+=!a&&(m&&Ja(m)&&!Ih[n[d+1]]||_&&Ja(_)&&!Ih[n[d-1]])||!Ih[n[d]]?n[d]:Ih[n[d]]}return u}(this.text,e)}trim(){let e=0;for(let a=0;a<this.text.length&&ip[this.text.charCodeAt(a)];a++)e++;let n=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&ip[this.text.charCodeAt(a)];a--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const a=new Pc;return a.text=this.text.substring(e,n),a.sectionIndex=this.sectionIndex.slice(e,n),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(zh.forText(e.scale,e.fontStack||n));const a=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(a)}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void Lt("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(zh.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Lt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Bg(i,e,n,a,u,d,m,_,b,w,S,I,P,L,B,V){const Z=Pc.fromFeature(i,u);let Q;I===kr.vertical&&Z.verticalizePunctuation(P);const{processBidirectionalText:ce,processStyledBidirectionalText:ne}=W;if(ce&&Z.sections.length===1){Q=[];const ue=ce(Z.toString(),Fg(Z,w,d,e,a,L,B));for(const Re of ue){const De=new Pc;De.text=Re,De.sections=Z.sections;for(let Ze=0;Ze<Re.length;Ze++)De.sectionIndex.push(0);Q.push(De)}}else if(ne){Q=[];const ue=ne(Z.text,Z.sectionIndex,Fg(Z,w,d,e,a,L,B));for(const Re of ue){const De=new Pc;De.text=Re[0],De.sectionIndex=Re[1],De.sections=Z.sections,Q.push(De)}}else Q=function(ue,Re){const De=[],Ze=ue.text;let _t=0;for(const Fe of Re)De.push(ue.substring(_t,Fe)),_t=Fe;return _t<Ze.length&&De.push(ue.substring(_t,Ze.length)),De}(Z,Fg(Z,w,d,e,a,L,B));const ae=[],me={positionedLines:ae,text:Z.toString(),top:S[1],bottom:S[1],left:S[0],right:S[0],writingMode:I,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ue,Re,De,Ze,_t,Fe,Ke,nt,Ye,mt,it,Pt){let cn=0,hn=0,$t=0;const Mt=nt==="right"?1:nt==="left"?0:.5;let wn=!1;for(const dn of _t){const In=dn.getSections();for(const Yn of In){if(Yn.imageName)continue;const qn=Re[Yn.fontStack];if(qn&&(wn=qn.ascender!==void 0&&qn.descender!==void 0,!wn))break}if(!wn)break}let rn=0;for(const dn of _t){dn.trim();const In=dn.getMaxScale(),Yn=(In-1)*Ni,qn={positionedGlyphs:[],lineOffset:0};ue.positionedLines[rn]=qn;const $n=qn.positionedGlyphs;let ei=0;if(!dn.length()){hn+=Fe,++rn;continue}let si=0,Ii=0;for(let En=0;En<dn.length();En++){const hi=dn.getSection(En),Hi=dn.getSectionIndex(En),Dn=dn.getCharCode(En);let ai=hi.scale,ir=null,ri=null,mi=null,Pi=Ni,Si=0;const Ui=!(Ye===kr.horizontal||!it&&!vc(Dn)||it&&(ip[Dn]||(Dt=Dn,Td(Dt)||Ed(Dt)||Cd(Dt)||Ya(Dt)||dh(Dt))));if(hi.imageName){const rr=Ze[hi.imageName];if(!rr)continue;mi=hi.imageName,ue.iconsInText=ue.iconsInText||!0,ri=rr.paddedRect;const zi=rr.displaySize;ai=ai*Ni/Pt,ir={width:zi[0],height:zi[1],left:1,top:-3,advance:Ui?zi[1]:zi[0],localGlyph:!1},Si=wn?-ir.height*ai:In*Ni-17-zi[1]*ai,Pi=ir.advance;const hs=(Ui?zi[0]:zi[1])*ai-Ni*In;hs>0&&hs>ei&&(ei=hs)}else{const rr=De[hi.fontStack];if(!rr)continue;rr[Dn]&&(ri=rr[Dn]);const zi=Re[hi.fontStack];if(!zi)continue;const hs=zi.glyphs[Dn];if(!hs)continue;if(ir=hs.metrics,Pi=Dn!==8203?Ni:0,wn){const Bc=zi.ascender!==void 0?Math.abs(zi.ascender):0,$h=zi.descender!==void 0?Math.abs(zi.descender):0,Gh=(Bc+$h)*ai;si<Gh&&(si=Gh,Ii=(Bc-$h)/2*ai),Si=-Bc*ai}else Si=(In-ai)*Ni-17}Ui?(ue.verticalizable=!0,$n.push({glyph:Dn,imageName:mi,x:cn,y:hn+Si,vertical:Ui,scale:ai,localGlyph:ir.localGlyph,fontStack:hi.fontStack,sectionIndex:Hi,metrics:ir,rect:ri}),cn+=Pi*ai+mt):($n.push({glyph:Dn,imageName:mi,x:cn,y:hn+Si,vertical:Ui,scale:ai,localGlyph:ir.localGlyph,fontStack:hi.fontStack,sectionIndex:Hi,metrics:ir,rect:ri}),cn+=ir.advance*ai+mt)}$n.length!==0&&($t=Math.max(cn-mt,$t),wn?xx($n,Mt,ei,Ii,Fe*In/2):xx($n,Mt,ei,0,Fe/2)),cn=0;const ur=Fe*In+ei;qn.lineOffset=Math.max(ei,Yn),hn+=ur,++rn}var Dt;const Kn=hn,{horizontalAlign:Zn,verticalAlign:ii}=jg(Ke);(function(dn,In,Yn,qn,$n,ei){const si=(In-Yn)*$n,Ii=-ei*qn;for(const ur of dn)for(const En of ur.positionedGlyphs)En.x+=si,En.y+=Ii})(ue.positionedLines,Mt,Zn,ii,$t,Kn),ue.top+=-ii*Kn,ue.bottom=ue.top+Kn,ue.left+=-Zn*$t,ue.right=ue.left+$t,ue.hasBaseline=wn}(me,e,n,a,Q,m,_,b,I,w,P,V),!function(ue){for(const Re of ue)if(Re.positionedGlyphs.length!==0)return!1;return!0}(ae)&&me}const ip={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},WM={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function gx(i,e,n,a,u,d){if(e.imageName){const m=a[e.imageName];return m?m.displaySize[0]*e.scale*Ni/d+u:0}{const m=n[e.fontStack],_=m&&m.glyphs[i];return _?_.metrics.advance*e.scale+u:0}}function _x(i,e,n,a){const u=Math.pow(i-e,2);return a?i<e?u/2:2*u:u+Math.abs(n)*n}function HM(i,e,n){let a=0;return i===10&&(a-=1e4),n&&(a+=150),i!==40&&i!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function yx(i,e,n,a,u,d){let m=null,_=_x(e,n,u,d);for(const b of a){const w=_x(e-b.x,n,u,d)+b.badness;w<=_&&(m=b,_=w)}return{index:i,x:e,priorBreak:m,badness:_}}function vx(i){return i?vx(i.priorBreak).concat(i.index):[]}function Fg(i,e,n,a,u,d,m){if(d!=="point")return[];if(!i)return[];const _=[],b=function(P,L,B,V,Z,Q){let ce=0;for(let ne=0;ne<P.length();ne++){const ae=P.getSection(ne);ce+=gx(P.getCharCode(ne),ae,V,Z,L,Q)}return ce/Math.max(1,Math.ceil(ce/B))}(i,e,n,a,u,m),w=i.text.indexOf("\u200B")>=0;let S=0;for(let P=0;P<i.length();P++){const L=i.getSection(P),B=i.getCharCode(P);if(ip[B]||(S+=gx(B,L,a,u,e,m)),P<i.length()-1){const V=!((I=B)<11904||!(ah(I)||Ad(I)||fh(I)||Od(I)||uh(I)||Sd(I)||Id(I)||gc(I)||hh(I)||Ka(I)||ch(I)||ph(I)||sh(I)||Xa(I)||Md(I)||lh(I)||Yo(I)||kd(I)||Pd(I)||_c(I)));(WM[B]||V||L.imageName)&&_.push(yx(P+1,S,b,_,HM(B,i.getCharCode(P+1),V&&w),!1))}}var I;return vx(yx(i.length(),S,b,_,0,!0))}function jg(i){let e=.5,n=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function xx(i,e,n,a,u){if(!(e||n||a||u))return;const d=i.length-1,m=i[d],_=(m.x+m.metrics.advance*m.scale)*e;for(let b=0;b<=d;b++)i[b].x-=_,i[b].y+=n+a+u}function XM(i,e,n){const{horizontalAlign:a,verticalAlign:u}=jg(n),d=e[0]-i.displaySize[0]*a,m=e[1]-i.displaySize[1]*u;return{image:i,top:m,bottom:m+i.displaySize[1],left:d,right:d+i.displaySize[0]}}function bx(i,e,n,a,u,d){const m=i.image;let _;if(m.content){const Z=m.content,Q=m.pixelRatio||1;_=[Z[0]/Q,Z[1]/Q,m.displaySize[0]-Z[2]/Q,m.displaySize[1]-Z[3]/Q]}const b=e.left*d,w=e.right*d;let S,I,P,L;n==="width"||n==="both"?(L=u[0]+b-a[3],I=u[0]+w+a[1]):(L=u[0]+(b+w-m.displaySize[0])/2,I=L+m.displaySize[0]);const B=e.top*d,V=e.bottom*d;return n==="height"||n==="both"?(S=u[1]+B-a[0],P=u[1]+V+a[2]):(S=u[1]+(B+V-m.displaySize[1])/2,P=S+m.displaySize[1]),{image:m,top:S,right:I,bottom:P,left:L,collisionPadding:_}}class cs extends D{constructor(e,n,a,u,d){super(e,n),this.angle=u,this.z=a,d!==void 0&&(this.segment=d)}clone(){return new cs(this.x,this.y,this.z,this.angle,this.segment)}}function wx(i,e,n,a,u){if(e.segment===void 0)return!0;let d=e,m=e.segment+1,_=0;for(;_>-n/2;){if(m--,m<0)return!1;_-=i[m].dist(d),d=i[m]}_+=i[m].dist(i[m+1]),m++;const b=[];let w=0;for(;_<n/2;){const S=i[m],I=i[m+1];if(!I)return!1;let P=i[m-1].angleTo(S)-S.angleTo(I);for(P=Math.abs((P+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:_,angleDelta:P}),w+=P;_-b[0].distance>a;)w-=b.shift().angleDelta;if(w>u)return!1;m++,_+=S.dist(I)}return!0}function Tx(i){let e=0;for(let n=0;n<i.length-1;n++)e+=i[n].dist(i[n+1]);return e}function Ex(i,e,n){return i?.6*e*n:0}function Cx(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function KM(i,e,n,a,u,d){const m=Ex(n,u,d),_=Cx(n,a)*d;let b=0;const w=Tx(i)/2;for(let S=0;S<i.length-1;S++){const I=i[S],P=i[S+1],L=I.dist(P);if(b+L>w){const B=(w-b)/L,V=Mn(I.x,P.x,B),Z=Mn(I.y,P.y,B),Q=new cs(V,Z,0,P.angleTo(I),S);return!m||wx(i,Q,_,m,e)?Q:void 0}b+=L}}function YM(i,e,n,a,u,d,m,_,b){const w=Ex(a,d,m),S=Cx(a,u),I=S*m,P=i[0].x===0||i[0].x===b||i[0].y===0||i[0].y===b;return e-I<e/4&&(e=I+e/4),Sx(i,P?e/2*_%e:(S/2+2*d)*m*_%e,e,w,n,I,P,!1,b)}function Sx(i,e,n,a,u,d,m,_,b){const w=d/2,S=Tx(i);let I=0,P=e-n,L=[];for(let B=0;B<i.length-1;B++){const V=i[B],Z=i[B+1],Q=V.dist(Z),ce=Z.angleTo(V);for(;P+n<I+Q;){P+=n;const ne=(P-I)/Q,ae=Mn(V.x,Z.x,ne),me=Mn(V.y,Z.y,ne);if(ae>=0&&ae<b&&me>=0&&me<b&&P-w>=0&&P+w<=S){const ue=new cs(ae,me,0,ce,B);ue._round(),a&&!wx(i,ue,d,a,u)||L.push(ue)}}I+=Q}return _||L.length||m||(L=Sx(i,I/2,n,a,u,d,m,!0,b)),L}function Mx(i,e,n,a,u){const d=[];for(let m=0;m<i.length;m++){const _=i[m];let b;for(let w=0;w<_.length-1;w++){let S=_[w],I=_[w+1];S.x<e&&I.x<e||(S.x<e?S=new D(e,S.y+(e-S.x)/(I.x-S.x)*(I.y-S.y))._round():I.x<e&&(I=new D(e,S.y+(e-S.x)/(I.x-S.x)*(I.y-S.y))._round()),S.y<n&&I.y<n||(S.y<n?S=new D(S.x+(n-S.y)/(I.y-S.y)*(I.x-S.x),n)._round():I.y<n&&(I=new D(S.x+(n-S.y)/(I.y-S.y)*(I.x-S.x),n)._round()),S.x>=a&&I.x>=a||(S.x>=a?S=new D(a,S.y+(a-S.x)/(I.x-S.x)*(I.y-S.y))._round():I.x>=a&&(I=new D(a,S.y+(a-S.x)/(I.x-S.x)*(I.y-S.y))._round()),S.y>=u&&I.y>=u||(S.y>=u?S=new D(S.x+(u-S.y)/(I.y-S.y)*(I.x-S.x),u)._round():I.y>=u&&(I=new D(S.x+(u-S.y)/(I.y-S.y)*(I.x-S.x),u)._round()),b&&S.equals(b[b.length-1])||(b=[S],d.push(b)),b.push(I)))))}}return d}Bt(cs,"Anchor");const Oh=1e20;function Ax(i,e,n,a,u,d,m,_,b){for(let w=e;w<e+a;w++)Ix(i,n*d+w,d,u,m,_,b);for(let w=n;w<n+u;w++)Ix(i,w*d+e,1,a,m,_,b)}function Ix(i,e,n,a,u,d,m){d[0]=0,m[0]=-Oh,m[1]=Oh,u[0]=i[e];for(let _=1,b=0,w=0;_<a;_++){u[_]=i[e+_*n];const S=_*_;do{const I=d[b];w=(u[_]-u[I]+S-I*I)/(_-I)/2}while(w<=m[b]&&--b>-1);b++,d[b]=_,m[b]=w,m[b+1]=Oh}for(let _=0,b=0;_<a;_++){for(;m[b+1]<_;)b++;const w=d[b],S=_-w;i[e+_*n]=u[w]+S*S}}const Ng={none:0,ideographs:1,all:2};class zc{constructor(e,n,a){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=a,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,n){const a=[];for(const u in e)for(const d of e[u])a.push({stack:u,id:d});ke(a,({stack:u,id:d},m)=>{let _=this.entries[u];_||(_=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let b=_.glyphs[d];if(b!==void 0)return void m(null,{stack:u,id:d,glyph:b});if(b=this._tinySDF(_,u,d),b)return _.glyphs[d]=b,void m(null,{stack:u,id:d,glyph:b});const w=Math.floor(d/256);if(256*w>65535)return void m(new Error("glyphs > 65535 not supported"));if(_.ranges[w])return void m(null,{stack:u,id:d,glyph:b});let S=_.requests[w];S||(S=_.requests[w]=[],zc.loadGlyphRange(u,w,this.url,this.requestManager,(I,P)=>{if(P){_.ascender=P.ascender,_.descender=P.descender;for(const L in P.glyphs)this._doesCharSupportLocalGlyph(+L)||(_.glyphs[+L]=P.glyphs[+L]);_.ranges[w]=!0}for(const L of S)L(I,P);delete _.requests[w]})),S.push((I,P)=>{I?m(I):P&&m(null,{stack:u,id:d,glyph:P.glyphs[d]||null})})},(u,d)=>{if(u)n(u);else if(d){const m={};for(const{stack:_,id:b,glyph:w}of d)m[_]===void 0&&(m[_]={}),m[_].glyphs===void 0&&(m[_].glyphs={}),m[_].glyphs[b]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics},m[_].ascender=this.entries[_].ascender,m[_].descender=this.entries[_].descender;n(null,m)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Ng.none&&(this.localGlyphMode===Ng.all?!!this.localFontFamily:!!this.localFontFamily&&(Ka(e)||zd(e)||sh(e)||Yo(e)||gc(e)))}_tinySDF(e,n,a){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(a))return;let d=e.tinySDF;if(!d){let V="400";/bold/i.test(n)?V="900":/medium/i.test(n)?V="500":/light/i.test(n)&&(V="200"),d=e.tinySDF=new zc.TinySDF({fontFamily:u,fontWeight:V,fontSize:48,buffer:6,radius:16}),d.fontWeight=V}if(this.localGlyphs[d.fontWeight][a])return this.localGlyphs[d.fontWeight][a];const m=String.fromCharCode(a),{data:_,width:b,height:w,glyphWidth:S,glyphHeight:I,glyphLeft:P,glyphTop:L,glyphAdvance:B}=d.draw(m);return this.localGlyphs[d.fontWeight][a]={id:a,bitmap:new as({width:b,height:w},_),metrics:{width:S/2,height:I/2,left:P/2,top:L/2-27,advance:B/2,localGlyph:!0}}}}function Px(i,e,n,a){const u=[],d=i.image,m=d.pixelRatio,_=d.paddedRect.w-2,b=d.paddedRect.h-2,w=i.right-i.left,S=i.bottom-i.top,I=d.stretchX||[[0,_]],P=d.stretchY||[[0,b]],L=(Fe,Ke)=>Fe+Ke[1]-Ke[0],B=I.reduce(L,0),V=P.reduce(L,0),Z=_-B,Q=b-V;let ce=0,ne=B,ae=0,me=V,ue=0,Re=Z,De=0,Ze=Q;if(d.content&&a){const Fe=d.content;ce=rp(I,0,Fe[0]),ae=rp(P,0,Fe[1]),ne=rp(I,Fe[0],Fe[2]),me=rp(P,Fe[1],Fe[3]),ue=Fe[0]-ce,De=Fe[1]-ae,Re=Fe[2]-Fe[0]-ne,Ze=Fe[3]-Fe[1]-me}const _t=(Fe,Ke,nt,Ye)=>{const mt=op(Fe.stretch-ce,ne,w,i.left),it=sp(Fe.fixed-ue,Re,Fe.stretch,B),Pt=op(Ke.stretch-ae,me,S,i.top),cn=sp(Ke.fixed-De,Ze,Ke.stretch,V),hn=op(nt.stretch-ce,ne,w,i.left),$t=sp(nt.fixed-ue,Re,nt.stretch,B),Mt=op(Ye.stretch-ae,me,S,i.top),wn=sp(Ye.fixed-De,Ze,Ye.stretch,V),rn=new D(mt,Pt),Dt=new D(hn,Pt),Kn=new D(hn,Mt),Zn=new D(mt,Mt),ii=new D(it/m,cn/m),dn=new D($t/m,wn/m),In=e*Math.PI/180;if(In){const $n=Math.sin(In),ei=Math.cos(In),si=[ei,-$n,$n,ei];rn._matMult(si),Dt._matMult(si),Zn._matMult(si),Kn._matMult(si)}const Yn=Fe.stretch+Fe.fixed,qn=Ke.stretch+Ke.fixed;return{tl:rn,tr:Dt,bl:Zn,br:Kn,tex:{x:d.paddedRect.x+1+Yn,y:d.paddedRect.y+1+qn,w:nt.stretch+nt.fixed-Yn,h:Ye.stretch+Ye.fixed-qn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ii,pixelOffsetBR:dn,minFontScaleX:Re/m/w,minFontScaleY:Ze/m/S,isSDF:n}};if(a&&(d.stretchX||d.stretchY)){const Fe=zx(I,Z,B),Ke=zx(P,Q,V);for(let nt=0;nt<Fe.length-1;nt++){const Ye=Fe[nt],mt=Fe[nt+1];for(let it=0;it<Ke.length-1;it++)u.push(_t(Ye,Ke[it],mt,Ke[it+1]))}}else u.push(_t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:_+1},{fixed:0,stretch:b+1}));return u}function rp(i,e,n){let a=0;for(const u of i)a+=Math.max(e,Math.min(n,u[1]))-Math.max(e,Math.min(n,u[0]));return a}function zx(i,e,n){const a=[{fixed:-1,stretch:0}];for(const[u,d]of i){const m=a[a.length-1];a.push({fixed:u-m.stretch,stretch:m.stretch}),a.push({fixed:u-m.stretch,stretch:m.stretch+(d-u)})}return a.push({fixed:e+1,stretch:n}),a}function op(i,e,n,a){return i/e*n+a}function sp(i,e,n,a){return i-e*n/a}function JM(i,e,n,a){const u=e+i.positionedLines[a].lineOffset;return a===0?n+u/2:n+(u+(e+i.positionedLines[a-1].lineOffset))/2}zc.loadGlyphRange=function(i,e,n,a,u){const d=256*e,m=d+255,_=a.transformRequest(a.normalizeGlyphsURL(n).replace("{fontstack}",i).replace("{range}",`${d}-${m}`),ge.Glyphs);Ie(_,(b,w)=>{if(b)u(b);else if(w){const S={},I=function(P){return new Ph(P).readFields(GM,{})}(w);for(const P of I.glyphs)S[P.id]=P;u(null,{glyphs:S,ascender:I.ascender,descender:I.descender})}})},zc.TinySDF=class{constructor({fontSize:i=24,buffer:e=3,radius:n=8,cutoff:a=.25,fontFamily:u="sans-serif",fontWeight:d="normal",fontStyle:m="normal"}={}){this.buffer=e,this.cutoff=a,this.radius=n;const _=this.size=i+4*e,b=this._createCanvas(_),w=this.ctx=b.getContext("2d",{willReadFrequently:!0});w.font=`${m} ${d} ${i}px ${u}`,w.textBaseline="alphabetic",w.textAlign="left",w.fillStyle="black",this.gridOuter=new Float64Array(_*_),this.gridInner=new Float64Array(_*_),this.f=new Float64Array(_),this.z=new Float64Array(_+1),this.v=new Uint16Array(_)}_createCanvas(i){const e=document.createElement("canvas");return e.width=e.height=i,e}draw(i){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:a,actualBoundingBoxLeft:u,actualBoundingBoxRight:d}=this.ctx.measureText(i),m=Math.ceil(n),_=Math.min(this.size-this.buffer,Math.ceil(d-u)),b=Math.min(this.size-this.buffer,m+Math.ceil(a)),w=_+2*this.buffer,S=b+2*this.buffer,I=Math.max(w*S,0),P=new Uint8ClampedArray(I),L={data:P,width:w,height:S,glyphWidth:_,glyphHeight:b,glyphTop:m,glyphLeft:0,glyphAdvance:e};if(_===0||b===0)return L;const{ctx:B,buffer:V,gridInner:Z,gridOuter:Q}=this;B.clearRect(V,V,_,b),B.fillText(i,V,V+m);const ce=B.getImageData(V,V,_,b);Q.fill(Oh,0,I),Z.fill(0,0,I);for(let ne=0;ne<b;ne++)for(let ae=0;ae<_;ae++){const me=ce.data[4*(ne*_+ae)+3]/255;if(me===0)continue;const ue=(ne+V)*w+ae+V;if(me===1)Q[ue]=0,Z[ue]=Oh;else{const Re=.5-me;Q[ue]=Re>0?Re*Re:0,Z[ue]=Re<0?Re*Re:0}}Ax(Q,0,0,w,S,w,this.f,this.v,this.z),Ax(Z,V,V,_,b,w,this.f,this.v,this.z);for(let ne=0;ne<I;ne++){const ae=Math.sqrt(Q[ne])-Math.sqrt(Z[ne]);P[ne]=Math.round(255-255*(ae/this.radius+this.cutoff))}return L}};class QM{constructor(e=[],n=eA){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:a}=this,u=n[e];for(;e>0;){const d=e-1>>1,m=n[d];if(a(u,m)>=0)break;n[e]=m,e=d}n[e]=u}_down(e){const{data:n,compare:a}=this,u=this.length>>1,d=n[e];for(;e<u;){let m=1+(e<<1),_=n[m];const b=m+1;if(b<this.length&&a(n[b],_)<0&&(m=b,_=n[b]),a(_,d)>=0)break;n[e]=_,e=m}n[e]=d}}function eA(i,e){return i<e?-1:i>e?1:0}function tA(i,e=1,n=!1){let a=1/0,u=1/0,d=-1/0,m=-1/0;const _=i[0];for(let L=0;L<_.length;L++){const B=_[L];(!L||B.x<a)&&(a=B.x),(!L||B.y<u)&&(u=B.y),(!L||B.x>d)&&(d=B.x),(!L||B.y>m)&&(m=B.y)}const b=Math.min(d-a,m-u);let w=b/2;const S=new QM([],nA);if(b===0)return new D(a,u);for(let L=a;L<d;L+=b)for(let B=u;B<m;B+=b)S.push(new Oc(L+w,B+w,w,i));let I=function(L){let B=0,V=0,Z=0;const Q=L[0];for(let ce=0,ne=Q.length,ae=ne-1;ce<ne;ae=ce++){const me=Q[ce],ue=Q[ae],Re=me.x*ue.y-ue.x*me.y;V+=(me.x+ue.x)*Re,Z+=(me.y+ue.y)*Re,B+=3*Re}return new Oc(V/B,Z/B,0,L)}(i),P=S.length;for(;S.length;){const L=S.pop();(L.d>I.d||!I.d)&&(I=L,n&&console.log("found best %d after %d probes",Math.round(1e4*L.d)/1e4,P)),L.max-I.d<=e||(w=L.h/2,S.push(new Oc(L.p.x-w,L.p.y-w,w,i)),S.push(new Oc(L.p.x+w,L.p.y-w,w,i)),S.push(new Oc(L.p.x-w,L.p.y+w,w,i)),S.push(new Oc(L.p.x+w,L.p.y+w,w,i)),P+=4)}return n&&(console.log(`num probes: ${P}`),console.log(`best distance: ${I.d}`)),I.p}function nA(i,e){return e.max-i.max}function Oc(i,e,n,a){this.p=new D(i,e),this.h=n,this.d=function(u,d){let m=!1,_=1/0;for(let b=0;b<d.length;b++){const w=d[b];for(let S=0,I=w.length,P=I-1;S<I;P=S++){const L=w[S],B=w[P];L.y>u.y!=B.y>u.y&&u.x<(B.x-L.x)*(u.y-L.y)/(B.y-L.y)+L.x&&(m=!m),_=Math.min(_,y0(u,L,B))}}return(m?1:-1)*Math.sqrt(_)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}const Ug=Number.POSITIVE_INFINITY,iA=Math.sqrt(2);function Ox(i,e){return e[1]!==Ug?function(n,a,u){let d=0,m=0;switch(a=Math.abs(a),u=Math.abs(u),n){case"top-right":case"top-left":case"top":m=u-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-u}switch(n){case"top-right":case"bottom-right":case"right":d=-a;break;case"top-left":case"bottom-left":case"left":d=a}return[d,m]}(i,e[0],e[1]):function(n,a){let u=0,d=0;a<0&&(a=0);const m=a/iA;switch(n){case"top-right":case"top-left":d=m-7;break;case"bottom-right":case"bottom-left":d=7-m;break;case"bottom":d=7-a;break;case"top":d=a-7}switch(n){case"top-right":case"bottom-right":u=-m;break;case"top-left":case"bottom-left":u=m;break;case"left":u=a;break;case"right":u=-a}return[u,d]}(i,e[0])}function rA(i,e,n,a,u,d,m,_,b,w){i.createArrays(),i.tilePixelRatio=Qt/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const S=i.layers[0].layout,I=i.layers[0]._unevaluatedLayout._values,P={};if(i.textSizeData.kind==="composite"){const{minZoom:V,maxZoom:Z}=i.textSizeData;P.compositeTextSizes=[I["text-size"].possiblyEvaluate(new H(V),_),I["text-size"].possiblyEvaluate(new H(Z),_)]}if(i.iconSizeData.kind==="composite"){const{minZoom:V,maxZoom:Z}=i.iconSizeData;P.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new H(V),_),I["icon-size"].possiblyEvaluate(new H(Z),_)]}P.layoutTextSize=I["text-size"].possiblyEvaluate(new H(b+1),_),P.layoutIconSize=I["icon-size"].possiblyEvaluate(new H(b+1),_),P.textMaxSize=I["text-size"].possiblyEvaluate(new H(18),_);const L=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point",B=S.get("text-size");for(const V of i.features){const Z=S.get("text-font").evaluate(V,{},_).join(","),Q=B.evaluate(V,{},_),ce=P.layoutTextSize.evaluate(V,{},_),ne=(P.layoutIconSize.evaluate(V,{},_),{horizontal:{},vertical:void 0}),ae=V.text;let me,ue=[0,0];if(ae){const Ze=ae.toString(),_t=S.get("text-letter-spacing").evaluate(V,{},_)*Ni,Fe=S.get("text-line-height").evaluate(V,{},_)*Ni,Ke=ig(Ze)?_t:0,nt=S.get("text-anchor").evaluate(V,{},_),Ye=S.get("text-variable-anchor");if(!Ye){const $t=S.get("text-radial-offset").evaluate(V,{},_);ue=$t?Ox(nt,[$t*Ni,Ug]):S.get("text-offset").evaluate(V,{},_).map(Mt=>Mt*Ni)}let mt=L?"center":S.get("text-justify").evaluate(V,{},_);const it=S.get("symbol-placement"),Pt=it==="point",cn=it==="point"?S.get("text-max-width").evaluate(V,{},_)*Ni:0,hn=$t=>{i.allowVerticalPlacement&&yc(Ze)&&(ne.vertical=Bg(ae,e,n,u,Z,cn,Fe,nt,$t,Ke,ue,kr.vertical,!0,it,ce,Q))};if(!L&&Ye){const $t=mt==="auto"?Ye.map(wn=>Vg(wn)):[mt];let Mt=!1;for(let wn=0;wn<$t.length;wn++){const rn=$t[wn];if(!ne.horizontal[rn])if(Mt)ne.horizontal[rn]=ne.horizontal[0];else{const Dt=Bg(ae,e,n,u,Z,cn,Fe,"center",rn,Ke,ue,kr.horizontal,!1,it,ce,Q);Dt&&(ne.horizontal[rn]=Dt,Mt=Dt.positionedLines.length===1)}}hn("left")}else{if(mt==="auto"&&(mt=Vg(nt)),Pt||S.get("text-writing-mode").indexOf("horizontal")>=0||!yc(Ze)){const $t=Bg(ae,e,n,u,Z,cn,Fe,nt,mt,Ke,ue,kr.horizontal,!1,it,ce,Q);$t&&(ne.horizontal[mt]=$t)}hn(it==="point"?"left":mt)}}let Re=!1;if(V.icon&&V.icon.name){const Ze=a[V.icon.name];Ze&&(me=XM(u[V.icon.name],S.get("icon-offset").evaluate(V,{},_),S.get("icon-anchor").evaluate(V,{},_)),Re=Ze.sdf,i.sdfIcons===void 0?i.sdfIcons=Ze.sdf:i.sdfIcons!==Ze.sdf&&Lt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ze.pixelRatio!==i.pixelRatio||S.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const De=Dx(ne.horizontal)||ne.vertical;i.iconsInText||(i.iconsInText=!!De&&De.iconsInText),(De||me)&&oA(i,V,ne,me,a,P,ce,0,ue,Re,m,_,w)}d&&i.generateCollisionDebugBuffers(b,i.collisionBoxArray)}function Vg(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function oA(i,e,n,a,u,d,m,_,b,w,S,I,P){let L=d.textMaxSize.evaluate(e,{},I);L===void 0&&(L=m);const B=i.layers[0].layout,V=B.get("icon-offset").evaluate(e,{},I),Z=Dx(n.horizontal)||n.vertical,Q=P.name==="globe",ce=m/24,ne=i.tilePixelRatio*L/24,ae=(Ke=i.overscaling,i.zoom>18&&Ke>2&&(Ke>>=1),Math.max(Qt/(512*Ke),1)*B.get("symbol-spacing")),me=B.get("text-padding")*i.tilePixelRatio,ue=B.get("icon-padding")*i.tilePixelRatio,Re=se(B.get("text-max-angle")),De=B.get("text-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",Ze=B.get("icon-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",_t=B.get("symbol-placement"),Fe=ae/2;var Ke;const nt=B.get("icon-text-fit");let Ye;a&&nt!=="none"&&(i.allowVerticalPlacement&&n.vertical&&(Ye=bx(a,n.vertical,nt,B.get("icon-text-fit-padding"),V,ce)),Z&&(a=bx(a,Z,nt,B.get("icon-text-fit-padding"),V,ce)));const mt=(it,Pt,cn)=>{if(Pt.x<0||Pt.x>=Qt||Pt.y<0||Pt.y>=Qt)return;let hn=null;if(Q){const{x:$t,y:Mt,z:wn}=P.projectTilePoint(Pt.x,Pt.y,cn);hn={anchor:new cs($t,Mt,wn,0,void 0),up:P.upVector(cn,Pt.x,Pt.y)}}(function($t,Mt,wn,rn,Dt,Kn,Zn,ii,dn,In,Yn,qn,$n,ei,si,Ii,ur,En,hi,Hi,Dn,ai,ir,ri,mi){const Pi=$t.addToLineVertexArray(Mt,rn);let Si,Ui,rr,zi,hs,Bc,$h,Gh=0,_1=0,y1=0,v1=0,o_=-1,s_=-1;const Do={};let x1=mh("");const cl=wn?wn.anchor:Mt;let a_=0,l_=0;if(dn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[a_,l_]=dn.layout.get("text-offset").evaluate(Dn,{},mi).map(br=>br*Ni):(a_=dn.layout.get("text-radial-offset").evaluate(Dn,{},mi)*Ni,l_=Ug),$t.allowVerticalPlacement&&Dt.vertical){const br=Dt.vertical;if(si)Bc=$g(br),ii&&($h=$g(ii));else{const wr=dn.layout.get("text-rotate").evaluate(Dn,{},mi)+90;rr=ap(In,cl,Mt,Yn,qn,$n,br,ei,wr,Ii),ii&&(zi=ap(In,cl,Mt,Yn,qn,$n,ii,En,wr))}}if(Kn){const br=dn.layout.get("icon-rotate").evaluate(Dn,{},mi),wr=dn.layout.get("icon-text-fit")!=="none",Zh=Px(Kn,br,ir,wr),u_=ii?Px(ii,br,ir,wr):void 0;Ui=ap(In,cl,Mt,Yn,qn,$n,Kn,En,br),Gh=4*Zh.length;const b1=$t.iconSizeData;let ul=null;b1.kind==="source"?(ul=[Io*dn.layout.get("icon-size").evaluate(Dn,{},mi)],ul[0]>Hs&&Lt(`${$t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):b1.kind==="composite"&&(ul=[Io*ai.compositeIconSizes[0].evaluate(Dn,{},mi),Io*ai.compositeIconSizes[1].evaluate(Dn,{},mi)],(ul[0]>Hs||ul[1]>Hs)&&Lt(`${$t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),$t.addSymbols($t.icon,Zh,ul,Hi,hi,Dn,!1,wn,Mt,Pi.lineStartIndex,Pi.lineLength,-1,ri,mi),o_=$t.icon.placedSymbolArray.length-1,u_&&(_1=4*u_.length,$t.addSymbols($t.icon,u_,ul,Hi,hi,Dn,kr.vertical,wn,Mt,Pi.lineStartIndex,Pi.lineLength,-1,ri,mi),s_=$t.icon.placedSymbolArray.length-1)}for(const br in Dt.horizontal){const wr=Dt.horizontal[br];Si||(x1=mh(wr.text),si?hs=$g(wr):Si=ap(In,cl,Mt,Yn,qn,$n,wr,ei,dn.layout.get("text-rotate").evaluate(Dn,{},mi),Ii));const Zh=wr.positionedLines.length===1;if(y1+=kx($t,wn,Mt,wr,Zn,dn,si,Dn,Ii,Pi,Dt.vertical?kr.horizontal:kr.horizontalOnly,Zh?Object.keys(Dt.horizontal):[br],Do,o_,ai,ri,mi),Zh)break}Dt.vertical&&(v1+=kx($t,wn,Mt,Dt.vertical,Zn,dn,si,Dn,Ii,Pi,kr.vertical,["vertical"],Do,s_,ai,ri,mi));let ea=-1;const c_=(br,wr)=>br?Math.max(br,wr):wr;ea=c_(hs,ea),ea=c_(Bc,ea),ea=c_($h,ea);const BA=ea>-1?1:0;$t.glyphOffsetArray.length>=Ks.MAX_GLYPHS&&Lt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Dn.sortKey!==void 0&&$t.addToSortKeyRanges($t.symbolInstances.length,Dn.sortKey),$t.symbolInstances.emplaceBack(cl.x,cl.y,cl.z,Mt.x,Mt.y,Do.right>=0?Do.right:-1,Do.center>=0?Do.center:-1,Do.left>=0?Do.left:-1,Do.vertical>=0?Do.vertical:-1,o_,s_,x1,Si!==void 0?Si:$t.collisionBoxArray.length,Si!==void 0?Si+1:$t.collisionBoxArray.length,rr!==void 0?rr:$t.collisionBoxArray.length,rr!==void 0?rr+1:$t.collisionBoxArray.length,Ui!==void 0?Ui:$t.collisionBoxArray.length,Ui!==void 0?Ui+1:$t.collisionBoxArray.length,zi||$t.collisionBoxArray.length,zi?zi+1:$t.collisionBoxArray.length,Yn,y1,v1,Gh,_1,BA,0,a_,l_,ea)})(i,Pt,hn,it,n,a,u,Ye,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,me,De,b,0,ue,Ze,V,e,d,w,S,I)};if(_t==="line")for(const it of Mx(e.geometry,0,0,Qt,Qt)){const Pt=YM(it,ae,Re,n.vertical||Z,a,24,ne,i.overscaling,Qt);for(const cn of Pt){const hn=Z;hn&&sA(i,hn.text,Fe,cn)||mt(it,cn,I)}}else if(_t==="line-center"){for(const it of e.geometry)if(it.length>1){const Pt=KM(it,Re,n.vertical||Z,a,24,ne);Pt&&mt(it,Pt,I)}}else if(e.type==="Polygon")for(const it of Pg(e.geometry,0)){const Pt=tA(it,16);mt(it[0],new cs(Pt.x,Pt.y,0,0,void 0),I)}else if(e.type==="LineString")for(const it of e.geometry)mt(it,new cs(it[0].x,it[0].y,0,0,void 0),I);else if(e.type==="Point")for(const it of e.geometry)for(const Pt of it)mt([Pt],new cs(Pt.x,Pt.y,0,0,void 0),I)}const Hs=32640;function kx(i,e,n,a,u,d,m,_,b,w,S,I,P,L,B,V,Z){const Q=function(ae,me,ue,Re,De,Ze,_t,Fe){const Ke=[];if(me.positionedLines.length===0)return Ke;const nt=Re.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,Ye=function(hn){const $t=hn[0],Mt=hn[1],wn=$t*Mt;return wn>0?[$t,-Mt]:wn<0?[-$t,Mt]:$t===0?[Mt,$t]:[Mt,-$t]}(ue);let mt=Math.abs(me.top-me.bottom);for(const hn of me.positionedLines)mt-=hn.lineOffset;const it=me.positionedLines.length,Pt=mt/it;let cn=me.top-ue[1];for(let hn=0;hn<it;++hn){const $t=me.positionedLines[hn];cn=JM(me,Pt,cn,hn);for(const Mt of $t.positionedGlyphs){if(!Mt.rect)continue;const wn=Mt.rect||{};let rn=4,Dt=!0,Kn=1,Zn=0;if(Mt.imageName){const ri=_t[Mt.imageName];if(!ri)continue;if(ri.sdf){Lt("SDF images are not supported in formatted text and will be ignored.");continue}Dt=!1,Kn=ri.pixelRatio,rn=1/Kn}const ii=(De||Fe)&&Mt.vertical,dn=Mt.metrics.advance*Mt.scale/2,In=Mt.metrics,Yn=Mt.rect;if(Yn===null)continue;Fe&&me.verticalizable&&(Zn=Mt.imageName?dn-Mt.metrics.width*Mt.scale/2:0);const qn=De?[Mt.x+dn,Mt.y]:[0,0];let $n=[0,0],ei=[0,0],si=!1;De||(ii?(ei=[Mt.x+dn+Ye[0],Mt.y+Ye[1]-Zn],si=!0):$n=[Mt.x+dn+ue[0],Mt.y+ue[1]-Zn]);const Ii=Yn.w*Mt.scale/(Kn*(Mt.localGlyph?2:1)),ur=Yn.h*Mt.scale/(Kn*(Mt.localGlyph?2:1));let En,hi,Hi,Dn;if(ii){const ri=Mt.y-cn,mi=new D(-dn,dn-ri),Pi=-Math.PI/2,Si=new D(...ei);En=new D(-dn+$n[0],$n[1]),En._rotateAround(Pi,mi)._add(Si),En.x+=-ri+dn,En.y-=(In.left-rn)*Mt.scale;const Ui=Mt.imageName?In.advance*Mt.scale:Ni*Mt.scale,rr=String.fromCharCode(Mt.glyph);kM(rr)?En.x+=(1-rn)*Mt.scale:DM(rr)?En.x+=Ui-In.height*Mt.scale+(-rn-1)*Mt.scale:En.x+=Mt.imageName||In.width+2*rn===Yn.w&&In.height+2*rn===Yn.h?(Ui-ur)/2:(Ui-(In.height+2*rn)*Mt.scale)/2,hi=new D(En.x,En.y-Ii),Hi=new D(En.x+ur,En.y),Dn=new D(En.x+ur,En.y-Ii)}else{const ri=(In.left-rn)*Mt.scale-dn+$n[0],mi=(-In.top-rn)*Mt.scale+$n[1],Pi=ri+Ii,Si=mi+ur;En=new D(ri,mi),hi=new D(Pi,mi),Hi=new D(ri,Si),Dn=new D(Pi,Si)}if(nt){let ri;ri=De?new D(0,0):si?new D(Ye[0],Ye[1]):new D(ue[0],ue[1]),En._rotateAround(nt,ri),hi._rotateAround(nt,ri),Hi._rotateAround(nt,ri),Dn._rotateAround(nt,ri)}const ai=new D(0,0),ir=new D(0,0);Ke.push({tl:En,tr:hi,bl:Hi,br:Dn,tex:wn,writingMode:me.writingMode,glyphOffset:qn,sectionIndex:Mt.sectionIndex,isSDF:Dt,pixelOffsetTL:ai,pixelOffsetBR:ir,minFontScaleX:0,minFontScaleY:0})}}return Ke}(0,a,b,d,m,_,u,i.allowVerticalPlacement),ce=i.textSizeData;let ne=null;ce.kind==="source"?(ne=[Io*d.layout.get("text-size").evaluate(_,{},Z)],ne[0]>Hs&&Lt(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ce.kind==="composite"&&(ne=[Io*B.compositeTextSizes[0].evaluate(_,{},Z),Io*B.compositeTextSizes[1].evaluate(_,{},Z)],(ne[0]>Hs||ne[1]>Hs)&&Lt(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,Q,ne,b,m,_,S,e,n,w.lineStartIndex,w.lineLength,L,V,Z);for(const ae of I)P[ae]=i.text.placedSymbolArray.length-1;return 4*Q.length}function Dx(i){for(const e in i)return i[e];return null}function ap(i,e,n,a,u,d,m,_,b,w){let S=m.top,I=m.bottom,P=m.left,L=m.right;const B=m.collisionPadding;if(B&&(P-=B[0],S-=B[1],L+=B[2],I+=B[3]),b){const V=new D(P,S),Z=new D(L,S),Q=new D(P,I),ce=new D(L,I),ne=se(b);let ae=new D(0,0);w&&(ae=new D(w[0],w[1])),V._rotateAround(ne,ae),Z._rotateAround(ne,ae),Q._rotateAround(ne,ae),ce._rotateAround(ne,ae),P=Math.min(V.x,Z.x,Q.x,ce.x),L=Math.max(V.x,Z.x,Q.x,ce.x),S=Math.min(V.y,Z.y,Q.y,ce.y),I=Math.max(V.y,Z.y,Q.y,ce.y)}return i.emplaceBack(e.x,e.y,e.z,n.x,n.y,P,S,L,I,_,a,u,d),i.length-1}function $g(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const e=i.bottom-i.top;return e>0?Math.max(10,e):null}function sA(i,e,n,a){const u=i.compareText;if(e in u){const d=u[e];for(let m=d.length-1;m>=0;m--)if(a.dist(d[m])<n)return!0}else u[e]=[];return u[e].push(a),!1}const aA=Je([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Lx}=aA,Rx=Je([{name:"a_pos_3",components:3,type:"Int16"}]);var kh=Je([{name:"a_pos",type:"Int16",components:2}]);const us=Qt/Math.PI/2,Gg=2*jr(1,0)*us*Math.PI,kc=[64,32,16],oo=-us,so=us,lA=[new cr([oo,oo,oo],[so,so,so]),new cr([oo,oo,oo],[0,0,so]),new cr([0,oo,oo],[so,0,so]),new cr([oo,0,oo],[0,so,so]),new cr([0,0,oo],[so,so,so])];function Bx(i,e,n,a=!0){const u=io([],i._camera.position,i.worldSize),d=[e,n,1,1];rl(d,d,i.pixelMatrixInverse),I0(d,d,1/d[3]);const m=tr([],ro([],d,u)),_=i.globeMatrix,b=[_[12],_[13],_[14]],w=ro([],b,u),S=yh(w),I=tr([],w),P=i.worldSize/(2*Math.PI),L=Ur(I,m),B=Math.asin(P/S);if(B<Math.acos(L)){if(!a)return null;const _t=[],Fe=[];io(_t,m,S/L),tr(Fe,ro(Fe,_t,w)),tr(m,Ws(m,w,io(m,Fe,Math.tan(B)*S)))}const V=[];new wg(u,m).closestPointOnSphere(b,P,V);const Z=tr([],en(_,0)),Q=tr([],en(_,1)),ce=tr([],en(_,2)),ne=Ur(Z,V),ae=Ur(Q,V),me=Ur(ce,V),ue=we(Math.asin(-ae/P));let Re=we(Math.atan2(ne,me));Re=i.center.lng+function(_t,Fe){const Ke=(Fe-_t+180)%360-180;return Ke<-180?Ke+360:Ke}(i.center.lng,Re);const De=So(Re),Ze=Pe(os(ue),0,1);return new bc(De,Ze)}class cA{constructor(e,n,a){this.a=ro([],e,a),this.b=ro([],n,a),this.center=a;const u=tr([],this.a),d=tr([],this.b);this.angle=Math.acos(Ur(u,d))}}function Zg(i,e){if(i.angle===0)return null;let n;return n=i.a[e]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[e]/i.a[e]/Math.sin(i.angle)-1/Math.tan(i.angle)),n<0||n>1?null:function(a,u,d,m){const _=Math.sin(d);return a*(Math.sin((1-m)*d)/_)+u*(Math.sin(m*d)/_)}(i.a[e],i.b[e],i.angle,Pe(n,0,1))+i.center[e]}function Po(i){if(i.z<=1)return lA[i.z+2*i.y+i.x];const e=qg(lp(i));return cr.fromPoints(e)}function Fx(i,e){const n=Rh(e.zoom);if(n===0)return Po(i);const a=lp(i),u=qg(a),d=So(a.getWest())*e.worldSize,m=So(a.getEast())*e.worldSize,_=os(a.getNorth())*e.worldSize,b=os(a.getSouth())*e.worldSize,w=[d,_,0],S=[m,_,0],I=[d,b,0],P=[m,b,0],L=mg([],e.globeMatrix);return Ti(w,w,L),Ti(S,S,L),Ti(I,I,L),Ti(P,P,L),u[0]=zs(u[0],I,n),u[1]=zs(u[1],P,n),u[2]=zs(u[2],S,n),u[3]=zs(u[3],w,n),cr.fromPoints(u)}function jx(i,e,n,a,u){for(const d of n)Ti(d,d,a),io(d,d,u),vg(i,i,d),xg(e,e,d)}function uA(i,e,n){const a=e/i.worldSize,u=Number.MAX_VALUE,d=[-u,-u,-u],m=[u,u,u],_=i.globeMatrix;if(n.z<=1)return jx(m,d,Po(n).getCorners(),_,a),new cr(m,d);const b=lp(n),w=qg(b);if(jx(m,d,w,_,a),b.contains(i.center)){d[2]=0;const Re=i.point,De=[Re.x*a,Re.y*a,0];return vg(m,m,De),xg(d,d,De),new cr(m,d)}const S=[_[12]*a,_[13]*a,_[14]*a],I=b.getCenter(),P=Pe(i.center.lat,-85.051129,Mo),L=Pe(I.lat,-85.051129,Mo),B=So(i.center.lng),V=os(P);let Z=B-So(I.lng);const Q=V-os(L);Z>.5?Z-=1:Z<-.5&&(Z+=1);let ce=0;Math.abs(Z)>Math.abs(Q)?ce=Z>=0?1:3:(ce=Q>=0?0:2,Gd(S,S,[_[4]*a,_[5]*a,_[6]*a],-Math.sin(se(Q>=0?b.getSouth():b.getNorth()))*us));const ne=w[ce],ae=w[(ce+1)%4],me=new cA(ne,ae,S),ue=[Zg(me,0)||ne[0],Zg(me,1)||ne[1],Zg(me,2)||ne[2]];return m[2]=Math.min(ne[2],ae[2]),vg(m,m,ue),xg(d,d,ue),new cr(m,d)}function lp({x:i,y:e,z:n}){const a=1/(1<<n),u=new Ln(Nr(i*a),ji((e+1)*a)),d=new Ln(Nr((i+1)*a),ji(e*a));return new qs(u,d)}function qg(i){const e=se(i.getNorth()),n=se(i.getSouth()),a=Math.cos(e),u=Math.cos(n),d=Math.sin(e),m=Math.sin(n),_=i.getWest(),b=i.getEast();return[Dc(u,m,_),Dc(u,m,b),Dc(a,d,b),Dc(a,d,_)]}function Dc(i,e,n,a=us){return n=se(n),[i*Math.sin(n)*a,-e*a,i*Math.cos(n)*a]}function cp(i,e,n){return Dc(Math.cos(se(i)),Math.sin(se(i)),e,n)}function Dh(i,e,n,a){const u=1<<n.z,d=(i/Qt+n.x)/u;return cp(ji((e/Qt+n.y)/u),Nr(d),a)}function up({min:i,max:e}){return 16383/Math.max(e[0]-i[0],e[1]-i[1],e[2]-i[2])}const Nx=new Float64Array(16);function Lh(i){const e=up(i),n=E0(Nx,[e,e,e]);return _h(n,n,((a=[])[0]=-(u=i.min)[0],a[1]=-u[1],a[2]=-u[2],a));var a,u}function Wg(i){const e=(a=i.min,(n=Nx)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=a[0],n[13]=a[1],n[14]=a[2],n[15]=1,n);var n,a;const u=1/up(i);return il(e,e,[u,u,u])}function Ux(i,e,n,a,u){const d=function(b){const w=Qt/(2*Math.PI);return b/(2*Math.PI)/w}(n),m=[i,e,-n/(2*Math.PI)],_=Ao(new Float64Array(16));return _h(_,_,m),il(_,_,[d,d,d]),gg(_,_,se(-u)),$d(_,_,se(-a)),_}function Rh(i){return Oe(5,6,i)}function Vx(i,e){const n=cp(e.lat,e.lng);return d=(a=yg([],function(L){const B=cp(L._center.lat,L._center.lng);let V=bg([],Ec(0,1,0),B);const Z=C0([],-L.angle,B);V=Ti(V,V,Z),C0(Z,-L._pitch,V);const Q=tr([],B);return io(Q,Q,L.cameraToCenterDistance/L.pixelsPerMeter*Gg),Ti(Q,Q,Z),Ws([],B,Q)}(i),n))[0],m=a[1],_=a[2],b=(u=n)[0],w=u[1],S=u[2],P=(I=Math.sqrt(d*d+m*m+_*_)*Math.sqrt(b*b+w*w+S*S))&&Ur(a,u)/I,Math.acos(Math.min(Math.max(P,-1),1));var a,u,d,m,_,b,w,S,I,P}const $x=se(85),hA=Math.cos($x),fA=Math.sin($x);function Gx(i,e){const n=i.fovAboveCenter,a=i.elevation?i.elevation.getMinElevationBelowMSL()*e:0,u=(i._camera.position[2]*i.worldSize-a)/Math.cos(i._pitch),d=Math.sin(n)*u/Math.sin(Math.max(Math.PI/2-i._pitch-n,.01)),m=Math.sin(i._pitch)*d+u;return Math.min(1.01*m,u*(1/i._horizonShift))}function al(i,e){if(!e.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:e};const n=Math.pow(2,-i.z),a=i.x*n,u=(i.x+1)*n,d=i.y*n,m=(i.y+1)*n,_=Nr(a),b=Nr(u),w=ji(d),S=ji(m),I=e.project(_,w),P=e.project(b,w),L=e.project(b,S),B=e.project(_,S);let V=Math.min(I.x,P.x,L.x,B.x),Z=Math.min(I.y,P.y,L.y,B.y),Q=Math.max(I.x,P.x,L.x,B.x),ce=Math.max(I.y,P.y,L.y,B.y);const ne=n/16;function ae(ue,Re,De,Ze,_t,Fe){const Ke=(De+_t)/2,nt=(Ze+Fe)/2,Ye=e.project(Nr(Ke),ji(nt)),mt=Math.max(0,V-Ye.x,Z-Ye.y,Ye.x-Q,Ye.y-ce);V=Math.min(V,Ye.x),Q=Math.max(Q,Ye.x),Z=Math.min(Z,Ye.y),ce=Math.max(ce,Ye.y),mt>ne&&(ae(ue,Ye,De,Ze,Ke,nt),ae(Ye,Re,Ke,nt,_t,Fe))}ae(I,P,a,d,u,d),ae(P,L,u,d,u,m),ae(L,B,u,m,a,m),ae(B,I,a,m,a,d),V-=ne,Z-=ne,Q+=ne,ce+=ne;const me=1/Math.max(Q-V,ce-Z);return{scale:me,x:V*me,y:Z*me,x2:Q*me,y2:ce*me,projection:e}}const dA=Ao(new Float32Array(16));class Xs{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new Ln(0,0)}projectTilePoint(e,n,a){return{x:e,y:n,z:0}}locationPoint(e,n,a=!0){return e._coordinatePoint(e.locationCoordinate(n),a)}pixelsPerMeter(e,n){return jr(1,e)*n}pixelSpaceConversion(e,n,a){return 1}farthestPixelDistance(e){return Gx(e,e.pixelsPerMeter)}pointCoordinate(e,n,a,u){const d=e.horizonLineFromTop(!1),m=new D(n,Math.max(d,a));return e.rayIntersectionCoordinate(e.pointRayIntersection(m,u))}pointCoordinate3D(e,n,a){const u=new D(n,a);if(e.elevation)return e.elevation.pointCoordinate(u);{const d=this.pointCoordinate(e,u.x,u.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(e,n){if(e.elevation)return!this.pointCoordinate3D(e,n.x,n.y);const a=e.horizonLineFromTop();return n.y<a}createInversionMatrix(e,n){return dA}createTileMatrix(e,n,a){let u,d,m;const _=a.canonical,b=Ao(new Float64Array(16));if(this.isReprojectedInTileSpace){const w=al(_,this);u=1,d=w.x+a.wrap*w.scale,m=w.y,il(b,b,[u/w.scale,u/w.scale,e.pixelsPerMeter/n])}else u=n/e.zoomScale(_.z),d=(_.x+Math.pow(2,_.z)*a.wrap)*u,m=_.y*u;return _h(b,b,[d,m,0]),il(b,b,[u/Qt,u/Qt,1]),b}upVector(e,n,a){return[0,0,1]}upVectorScale(e,n,a){return{metersToTile:1}}}class pA extends Xs{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[n,a]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(se(n));this.n=(u+Math.sin(se(a)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,n){const{n:a,c:u,r0:d}=this,m=se(e-this.center[0]),_=se(n),b=Math.sqrt(u-2*a*Math.sin(_))/a;return{x:b*Math.sin(m*a),y:b*Math.cos(m*a)-d,z:0}}unproject(e,n){const{n:a,c:u,r0:d}=this,m=d+n;let _=Math.atan2(e,Math.abs(m))*Math.sign(m);m*a<0&&(_-=Math.PI*Math.sign(e)*Math.sign(m));const b=se(this.center[0])*a;_=Le(_,-Math.PI-b,Math.PI-b);const w=we(_/a)+this.center[0],S=Math.asin(Pe((u-(e*e+m*m)*a*a)/(2*a),-1,1)),I=Pe(we(S),-85.051129,Mo);return new Ln(w,I)}}const Bh=1.340264,Fh=-.081106,jh=893e-6,Nh=.003796,hp=Math.sqrt(3)/2;class mA extends Xs{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;const a=Math.asin(hp*Math.sin(n)),u=a*a,d=u*u*u;return{x:.5*(e*Math.cos(a)/(hp*(Bh+3*Fh*u+d*(7*jh+9*Nh*u)))/Math.PI+.5),y:1-.5*(a*(Bh+Fh*u+d*(jh+Nh*u))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let a=n=(2*(1-n)-1)*Math.PI,u=a*a,d=u*u*u;for(let S,I,P,L=0;L<12&&(I=a*(Bh+Fh*u+d*(jh+Nh*u))-n,P=Bh+3*Fh*u+d*(7*jh+9*Nh*u),S=I/P,a=Pe(a-S,-Math.PI/3,Math.PI/3),u=a*a,d=u*u*u,!(Math.abs(S)<1e-12));++L);const m=hp*e*(Bh+3*Fh*u+d*(7*jh+9*Nh*u))/Math.cos(a),_=Math.asin(Math.sin(a)/hp),b=Pe(180*m/Math.PI,-180,180),w=Pe(180*_/Math.PI,-85.051129,Mo);return new Ln(b,w)}}class gA extends Xs{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){const a=360*(e-.5),u=Pe(360*(.5-n),-85.051129,Mo);return new Ln(a,u)}}const Lc=Math.PI/2;function fp(i){return Math.tan((Lc+i)/2)}class _A extends Xs{constructor(e){super(e),this.center=e.center||[0,30];const[n,a]=this.parallels=e.parallels||[30,30],u=se(n),d=se(a),m=Math.cos(u);this.n=u===d?Math.sin(u):Math.log(m/Math.cos(d))/Math.log(fp(d)/fp(u)),this.f=m*Math.pow(fp(u),this.n)/this.n}project(e,n){n=se(n),e=se(e-this.center[0]);const a=1e-6,{n:u,f:d}=this;d>0?n<-Lc+a&&(n=-Lc+a):n>Lc-a&&(n=Lc-a);const m=d/Math.pow(fp(n),u),_=m*Math.sin(u*e),b=d-m*Math.cos(u*e);return{x:.5*(_/Math.PI+.5),y:1-.5*(b/Math.PI+.5),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,n=(2*(1-n)-.5)*Math.PI;const{n:a,f:u}=this,d=u-n,m=Math.sign(d),_=Math.sign(a)*Math.sqrt(e*e+d*d);let b=Math.atan2(e,Math.abs(d))*m;d*a<0&&(b-=Math.PI*Math.sign(e)*m);const w=Pe(we(b/a)+this.center[0],-180,180),S=Pe(we(2*Math.atan(Math.pow(u/_,1/a))-Lc),-85.051129,Mo);return new Ln(w,S)}}class Zx extends Xs{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:So(e),y:os(n),z:0}}unproject(e,n){const a=Nr(e),u=ji(n);return new Ln(a,u)}}const qx=se(Mo);class yA extends Xs{project(e,n){const a=(n=se(n))*n,u=a*a;return{x:.5*((e=se(e))*(.8707-.131979*a+u*(u*(.003971*a-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+a*(.015085+u*(.028874*a-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let a=n=(2*(1-n)-1)*Math.PI,u=25,d=0,m=a*a;do{m=a*a;const w=m*m;d=(a*(1.007226+m*(.015085+w*(.028874*m-.044475-.005916*w)))-n)/(1.007226+m*(.045255+w*(.259866*m-.311325-.005916*11*w))),a=Pe(a-d,-qx,qx)}while(Math.abs(d)>1e-6&&--u>0);m=a*a;const _=Pe(we(e/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),b=we(a);return new Ln(_,b)}}const Wx=se(Mo);class vA extends Xs{project(e,n){n=se(n),e=se(e);const a=Math.cos(n),u=2/Math.PI,d=Math.acos(a*Math.cos(e/2)),m=Math.sin(d)/d,_=.5*(e*u+2*a*Math.sin(e/2)/m)||0,b=.5*(n+Math.sin(n)/m)||0;return{x:.5*(_/Math.PI+.5),y:1-.5*(b/Math.PI+1),z:0}}unproject(e,n){let a=e=(2*e-.5)*Math.PI,u=n=(2*(1-n)-1)*Math.PI,d=25;const m=1e-6;let _=0,b=0;do{const w=Math.cos(u),S=Math.sin(u),I=2*S*w,P=S*S,L=w*w,B=Math.cos(a/2),V=Math.sin(a/2),Z=2*B*V,Q=V*V,ce=1-L*B*B,ne=ce?1/ce:0,ae=ce?Math.acos(w*B)*Math.sqrt(1/ce):0,me=.5*(2*ae*w*V+2*a/Math.PI)-e,ue=.5*(ae*S+u)-n,Re=.5*ne*(L*Q+ae*w*B*P)+1/Math.PI,De=ne*(Z*I/4-ae*S*V),Ze=.125*ne*(I*V-ae*S*L*Z),_t=.5*ne*(P*B+ae*Q*w)+.5,Fe=De*Ze-_t*Re;_=(ue*De-me*_t)/Fe,b=(me*Ze-ue*Re)/Fe,a=Pe(a-_,-Math.PI,Math.PI),u=Pe(u-b,-Wx,Wx)}while((Math.abs(_)>m||Math.abs(b)>m)&&--d>0);return new Ln(we(a),we(u))}}class Hx extends Xs{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(se(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){const{scale:a,cosPhi:u}=this;return{x:se(e)*u*a+.5,y:-Math.sin(se(n))/u*a+.5,z:0}}unproject(e,n){const{scale:a,cosPhi:u}=this,d=-(n-.5)/a,m=Pe(we((e-.5)/a)/u,-180,180),_=Math.asin(Pe(d*u,-1,1)),b=Pe(we(_),-85.051129,Mo);return new Ln(m,b)}}class xA extends Zx{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(e,n,a){const u=Dh(e,n,a);return Ti(u,u,Lh(Po(a))),{x:u[0],y:u[1],z:u[2]}}locationPoint(e,n){const a=cp(n.lat,n.lng),u=tr([],a),d=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude;Gd(a,a,u,jr(1,0)*Qt*d);const m=Ao(new Float64Array(16));return Tc(m,e.pixelMatrix,e.globeMatrix),Ti(a,a,m),new D(a[0],a[1])}pixelsPerMeter(e,n){return jr(1,0)*n}pixelSpaceConversion(e,n,a){const u=Mn(jr(1,45)*n,jr(1,e)*n,a);return this.pixelsPerMeter(e,n)/u}createTileMatrix(e,n,a){const u=Wg(Po(a.canonical));return Tc(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,n){const{center:a}=e,u=Lh(Po(n));return $d(u,u,se(a.lng)),gg(u,u,se(a.lat)),il(u,u,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(e,n,a,u){return Bx(e,n,a,!0)||new bc(0,0)}pointCoordinate3D(e,n,a){const u=this.pointCoordinate(e,n,a,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,n){return!Bx(e,n.x,n.y,!1)}farthestPixelDistance(e){const n=function(u,d){const m=u.cameraToCenterDistance,_=u._centerAltitude*d,b=u._camera,w=u._camera.forward(),S=Ws([],io([],w,-m),[0,0,_]),I=u.worldSize/(2*Math.PI),P=[0,0,-I],L=u.width/u.height,B=Math.tan(u.fovAboveCenter),V=io([],b.up(),B),Z=io([],b.right(),B*L),Q=tr([],Ws([],Ws([],w,V),Z)),ce=[];let ne;if(new wg(S,Q).closestPointOnSphere(P,I,ce)){const ae=Ws([],ce,P),me=ro([],ae,S);ne=Math.cos(u.fovAboveCenter)*yh(me)}else{const ae=ro([],S,P),me=ro([],P,S);tr(me,me);const ue=yh(ae)-I;ne=Math.sqrt(ue*(ue+2*I));const Re=Math.acos(ne/(I+ue))-Math.acos(Ur(w,me));ne*=Math.cos(Re)}return 1.01*ne}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),a=Rh(e.zoom);if(a>0){const u=Gx(e,jr(1,e.center.lat)*e.worldSize),d=e.worldSize/(2*Math.PI),m=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Mn(n,u+d*(1-Math.cos(m)),Math.pow(a,10))}return n}upVector(e,n,a){return Dh(n,a,e,1)}upVectorScale(e){return{metersToTile:Gg*up(Po(e))}}}function Xx(i){const e=i.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(i.name){case"mercator":return new Zx(i);case"equirectangular":return new gA(i);case"naturalEarth":return new yA(i);case"equalEarth":return new mA(i);case"winkelTripel":return new vA(i);case"albers":return n?new Hx(i):new pA(i);case"lambertConformalConic":return n?new Hx(i):new _A(i);case"globe":return new xA(i)}throw new Error(`Invalid projection name: ${i.name}`)}const bA=sl.VectorTileFeature.types,wA=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function dp(i,e,n,a,u,d,m,_,b,w,S,I,P){const L=_?Math.min(Hs,Math.round(_[0])):0,B=_?Math.min(Hs,Math.round(_[1])):0;i.emplaceBack(e,n,Math.round(32*a),Math.round(32*u),d,m,(L<<1)+(b?1:0),B,16*w,16*S,256*I,256*P)}function pp(i,e,n,a,u,d,m){i.emplaceBack(e,n,a,u,d,m)}function mp(i,e,n,a,u){i.emplaceBack(e,n,a,u),i.emplaceBack(e,n,a,u),i.emplaceBack(e,n,a,u),i.emplaceBack(e,n,a,u)}function TA(i){for(const e of i.sections)if(c(e.text))return!0;return!1}class Hg{constructor(e){this.layoutVertexArray=new Jn,this.indexArray=new gn,this.programConfigurations=e,this.segments=new xi,this.dynamicLayoutVertexArray=new bn,this.opacityVertexArray=new Vn,this.placedSymbolArray=new Xv,this.globeExtVertexArray=new ui}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,a,u){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,CM.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,MM.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,wA,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,SM.members,!0)),this.opacityVertexBuffer.itemSize=1),(a||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Bt(Hg,"SymbolBuffers");class Xg{constructor(e,n,a){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new a,this.segments=new xi,this.collisionVertexArray=new Qn,this.collisionVertexArrayExt=new ni}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,AM.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,IM.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Bt(Xg,"CollisionBuffers");class Ks{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(m=>m.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ao([]),this.placementViewportMatrix=Ao([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=kg(this.zoom,n["text-size"]),this.iconSizeData=kg(this.zoom,n["icon-size"]);const a=this.layers[0].layout,u=a.get("symbol-sort-key"),d=a.get("symbol-z-order");this.canOverlap=a.get("text-allow-overlap")||a.get("icon-allow-overlap")||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=a.get("text-writing-mode").map(m=>kr[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Hg(new el(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Hg(new el(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Jv,this.lineVertexArray=new Qv,this.symbolInstances=new Yv}calculateGlyphDependencies(e,n,a,u,d){for(let m=0;m<e.length;m++)if(n[e.charCodeAt(m)]=!0,u&&d){const _=Ih[e.charAt(m)];_&&(n[_.charCodeAt(0)]=!0)}}populate(e,n,a,u){const d=this.layers[0],m=d.layout,_=this.projection.name==="globe",b=m.get("text-font"),w=m.get("text-field"),S=m.get("icon-image"),I=(w.value.kind!=="constant"||w.value.value instanceof Qi&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),P=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,L=m.get("symbol-sort-key");if(this.features=[],!I&&!P)return;const B=n.iconDependencies,V=n.glyphDependencies,Z=n.availableImages,Q=new H(this.zoom);for(const{feature:ce,id:ne,index:ae,sourceLayerIndex:me}of e){const ue=d._featureFilter.needGeometry,Re=tl(ce,ue);if(!d._featureFilter.filter(Q,Re,a))continue;if(ue||(Re.geometry=ss(ce,a,u)),_&&ce.type!==1&&a.z<=5){const Fe=Re.geometry,Ke=.98078528056;for(let nt=0;nt<Fe.length;nt++)Fe[nt]=SS(Fe[nt],Ye=>Ye,(Ye,mt)=>Ur(Dh(Ye.x,Ye.y,a,1),Dh(mt.x,mt.y,a,1))<Ke)}let De,Ze;if(I){const Fe=d.getValueAndResolveTokens("text-field",Re,a,Z),Ke=Qi.factory(Fe);TA(Ke)&&(this.hasRTLText=!0),(!this.hasRTLText||$()==="unavailable"||this.hasRTLText&&W.isParsed())&&(De=OM(Ke,d,Re))}if(P){const Fe=d.getValueAndResolveTokens("icon-image",Re,a,Z);Ze=Fe instanceof er?Fe:er.fromString(Fe)}if(!De&&!Ze)continue;const _t=this.sortFeaturesByKey?L.evaluate(Re,{},a):void 0;if(this.features.push({id:ne,text:De,icon:Ze,index:ae,sourceLayerIndex:me,geometry:Re.geometry,properties:ce.properties,type:bA[ce.type],sortKey:_t}),Ze&&(B[Ze.name]=!0),De){const Fe=b.evaluate(Re,{},a).join(","),Ke=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(kr.vertical)>=0;for(const nt of De.sections)if(nt.image)B[nt.image.name]=!0;else{const Ye=yc(De.toString()),mt=nt.fontStack||Fe,it=V[mt]=V[mt]||{};this.calculateGlyphDependencies(nt.text,it,Ke,this.allowVerticalPlacement,Ye)}}}m.get("symbol-placement")==="line"&&(this.features=function(ce){const ne={},ae={},me=[];let ue=0;function Re(Fe){me.push(ce[Fe]),ue++}function De(Fe,Ke,nt){const Ye=ae[Fe];return delete ae[Fe],ae[Ke]=Ye,me[Ye].geometry[0].pop(),me[Ye].geometry[0]=me[Ye].geometry[0].concat(nt[0]),Ye}function Ze(Fe,Ke,nt){const Ye=ne[Ke];return delete ne[Ke],ne[Fe]=Ye,me[Ye].geometry[0].shift(),me[Ye].geometry[0]=nt[0].concat(me[Ye].geometry[0]),Ye}function _t(Fe,Ke,nt){const Ye=nt?Ke[0][Ke[0].length-1]:Ke[0][0];return`${Fe}:${Ye.x}:${Ye.y}`}for(let Fe=0;Fe<ce.length;Fe++){const Ke=ce[Fe],nt=Ke.geometry,Ye=Ke.text?Ke.text.toString():null;if(!Ye){Re(Fe);continue}const mt=_t(Ye,nt),it=_t(Ye,nt,!0);if(mt in ae&&it in ne&&ae[mt]!==ne[it]){const Pt=Ze(mt,it,nt),cn=De(mt,it,me[Pt].geometry);delete ne[mt],delete ae[it],ae[_t(Ye,me[cn].geometry,!0)]=cn,me[Pt].geometry=null}else mt in ae?De(mt,it,nt):it in ne?Ze(mt,it,nt):(Re(Fe),ne[mt]=ue-1,ae[it]=ue-1)}return me.filter(Fe=>Fe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,ne)=>ce.sortKey-ne.sortKey)}update(e,n,a,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,a,u),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,a,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Xx(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const a=this.lineVertexArray.length,u=e.segment;if(u!==void 0){let d=e.dist(n[u+1]),m=e.dist(n[u]);const _={};for(let b=u+1;b<n.length;b++)_[b]={x:n[b].x,y:n[b].y,tileUnitDistanceFromAnchor:d},b<n.length-1&&(d+=n[b+1].dist(n[b]));for(let b=u||0;b>=0;b--)_[b]={x:n[b].x,y:n[b].y,tileUnitDistanceFromAnchor:m},b>0&&(m+=n[b-1].dist(n[b]));for(let b=0;b<n.length;b++){const w=_[b];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,n,a,u,d,m,_,b,w,S,I,P,L,B){const V=e.indexArray,Z=e.layoutVertexArray,Q=e.globeExtVertexArray,ce=e.segments.prepareSegment(4*n.length,Z,V,this.canOverlap?m.sortKey:void 0),ne=this.glyphOffsetArray.length,ae=ce.vertexLength,me=this.allowVerticalPlacement&&_===kr.vertical?Math.PI/2:0,ue=m.text&&m.text.sections;for(let De=0;De<n.length;De++){const{tl:Ze,tr:_t,bl:Fe,br:Ke,tex:nt,pixelOffsetTL:Ye,pixelOffsetBR:mt,minFontScaleX:it,minFontScaleY:Pt,glyphOffset:cn,isSDF:hn,sectionIndex:$t}=n[De],Mt=ce.vertexLength,wn=cn[1];if(dp(Z,w.x,w.y,Ze.x,wn+Ze.y,nt.x,nt.y,a,hn,Ye.x,Ye.y,it,Pt),dp(Z,w.x,w.y,_t.x,wn+_t.y,nt.x+nt.w,nt.y,a,hn,mt.x,Ye.y,it,Pt),dp(Z,w.x,w.y,Fe.x,wn+Fe.y,nt.x,nt.y+nt.h,a,hn,Ye.x,mt.y,it,Pt),dp(Z,w.x,w.y,Ke.x,wn+Ke.y,nt.x+nt.w,nt.y+nt.h,a,hn,mt.x,mt.y,it,Pt),b){const rn=b.anchor,Dt=b.up;pp(Q,rn.x,rn.y,rn.z,Dt[0],Dt[1],Dt[2]),pp(Q,rn.x,rn.y,rn.z,Dt[0],Dt[1],Dt[2]),pp(Q,rn.x,rn.y,rn.z,Dt[0],Dt[1],Dt[2]),pp(Q,rn.x,rn.y,rn.z,Dt[0],Dt[1],Dt[2]),mp(e.dynamicLayoutVertexArray,rn.x,rn.y,rn.z,me)}else mp(e.dynamicLayoutVertexArray,w.x,w.y,w.z,me);V.emplaceBack(Mt,Mt+1,Mt+2),V.emplaceBack(Mt+1,Mt+2,Mt+3),ce.vertexLength+=4,ce.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(cn[0]),De!==n.length-1&&$t===n[De+1].sectionIndex||e.programConfigurations.populatePaintArrays(Z.length,m,m.index,{},L,B,ue&&ue[$t])}const Re=b?b.anchor:w;e.placedSymbolArray.emplaceBack(Re.x,Re.y,Re.z,w.x,w.y,ne,this.glyphOffsetArray.length-ne,ae,S,I,w.segment,a?a[0]:0,a?a[1]:0,u[0],u[1],_,0,!1,0,P,0)}_commitLayoutVertex(e,n,a,u,d,m,_){e.emplaceBack(n,a,u,d,m,Math.round(_.x),Math.round(_.y))}_addCollisionDebugVertices(e,n,a,u,d,m,_){const b=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),w=b.vertexLength,S=_.tileAnchorX,I=_.tileAnchorY;for(let L=0;L<4;L++)a.collisionVertexArray.emplaceBack(0,0,0,0);a.collisionVertexArrayExt.emplaceBack(n,-e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(n,e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(n,e.padding,e.padding),a.collisionVertexArrayExt.emplaceBack(n,-e.padding,e.padding),this._commitLayoutVertex(a.layoutVertexArray,u,d,m,S,I,new D(e.x1,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,u,d,m,S,I,new D(e.x2,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,u,d,m,S,I,new D(e.x2,e.y2)),this._commitLayoutVertex(a.layoutVertexArray,u,d,m,S,I,new D(e.x1,e.y2)),b.vertexLength+=4;const P=a.indexArray;P.emplaceBack(w,w+1),P.emplaceBack(w+1,w+2),P.emplaceBack(w+2,w+3),P.emplaceBack(w+3,w),b.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,a,u,d,m){for(let _=u;_<d;_++){const b=a.get(_),w=this.getSymbolInstanceTextSize(e,m,n,_);this._addCollisionDebugVertices(b,w,this.textCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(e,n,a,u,d,m){for(let _=u;_<d;_++){const b=a.get(_),w=this.getSymbolInstanceIconSize(e,n,_);this._addCollisionDebugVertices(b,w,this.iconCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,m)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xg(Or,lx.members,qi),this.iconCollisionBox=new Xg(Or,lx.members,qi);const a=Mc(this.iconSizeData,e),u=Mc(this.textSizeData,e);for(let d=0;d<this.symbolInstances.length;d++){const m=this.symbolInstances.get(d);this._addTextDebugCollisionBoxes(u,e,n,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(u,e,n,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(a,e,n,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(a,e,n,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(e,n,a,u){const d=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:u),m=tp(this.textSizeData,e,d)/Ni;return this.tilePixelRatio*m}getSymbolInstanceIconSize(e,n,a){const u=this.icon.placedSymbolArray.get(a),d=tp(this.iconSizeData,e,u);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(e,n,a){e.emplaceBack(n,-a,-a),e.emplaceBack(n,a,-a),e.emplaceBack(n,a,a),e.emplaceBack(n,-a,a)}_updateTextDebugCollisionBoxes(e,n,a,u,d,m){for(let _=u;_<d;_++){const b=a.get(_),w=this.getSymbolInstanceTextSize(e,m,n,_);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,w,b.padding)}}_updateIconDebugCollisionBoxes(e,n,a,u,d){for(let m=u;m<d;m++){const _=a.get(m),b=this.getSymbolInstanceIconSize(e,n,m);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,_.padding)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const a=Mc(this.iconSizeData,e),u=Mc(this.textSizeData,e);for(let d=0;d<this.symbolInstances.length;d++){const m=this.symbolInstances.get(d);this._updateTextDebugCollisionBoxes(u,e,n,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(u,e,n,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(a,e,n,m.iconBoxStartIndex,m.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(a,e,n,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,a,u,d,m,_,b,w){const S={};for(let I=n;I<a;I++){const P=e.get(I);S.textBox={x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,padding:P.padding,projectedAnchorX:P.projectedAnchorX,projectedAnchorY:P.projectedAnchorY,projectedAnchorZ:P.projectedAnchorZ,tileAnchorX:P.tileAnchorX,tileAnchorY:P.tileAnchorY},S.textFeatureIndex=P.featureIndex;break}for(let I=u;I<d;I++){const P=e.get(I);S.verticalTextBox={x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,padding:P.padding,projectedAnchorX:P.projectedAnchorX,projectedAnchorY:P.projectedAnchorY,projectedAnchorZ:P.projectedAnchorZ,tileAnchorX:P.tileAnchorX,tileAnchorY:P.tileAnchorY},S.verticalTextFeatureIndex=P.featureIndex;break}for(let I=m;I<_;I++){const P=e.get(I);S.iconBox={x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,padding:P.padding,projectedAnchorX:P.projectedAnchorX,projectedAnchorY:P.projectedAnchorY,projectedAnchorZ:P.projectedAnchorZ,tileAnchorX:P.tileAnchorX,tileAnchorY:P.tileAnchorY},S.iconFeatureIndex=P.featureIndex;break}for(let I=b;I<w;I++){const P=e.get(I);S.verticalIconBox={x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,padding:P.padding,projectedAnchorX:P.projectedAnchorX,projectedAnchorY:P.projectedAnchorY,projectedAnchorZ:P.projectedAnchorZ,tileAnchorX:P.tileAnchorX,tileAnchorY:P.tileAnchorY},S.verticalIconFeatureIndex=P.featureIndex;break}return S}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const a=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const a=e.placedSymbolArray.get(n),u=a.vertexStartIndex+4*a.numGlyphs;for(let d=a.vertexStartIndex;d<u;d+=4)e.indexArray.emplaceBack(d,d+1,d+2),e.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),a=Math.cos(e),u=[],d=[],m=[];for(let _=0;_<this.symbolInstances.length;++_){m.push(_);const b=this.symbolInstances.get(_);u.push(0|Math.round(n*b.tileAnchorX+a*b.tileAnchorY)),d.push(b.featureIndex)}return m.sort((_,b)=>u[_]-u[b]||d[b]-d[_]),m}addToSortKeyRanges(e,n){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===n?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const a=this.symbolInstances.get(n);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((u,d,m)=>{u>=0&&m.indexOf(u)===d&&this.addIndicesForPlacedSymbol(this.text,u)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Bt(Ks,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Ks.MAX_GLYPHS=65535,Ks.addDynamicAttributes=mp;const EA=new He({"symbol-placement":new he($e.layout_symbol["symbol-placement"]),"symbol-spacing":new he($e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new he($e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ve($e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new he($e.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new he($e.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new he($e.layout_symbol["icon-ignore-placement"]),"icon-optional":new he($e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new he($e.layout_symbol["icon-rotation-alignment"]),"icon-size":new ve($e.layout_symbol["icon-size"]),"icon-text-fit":new he($e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new he($e.layout_symbol["icon-text-fit-padding"]),"icon-image":new ve($e.layout_symbol["icon-image"]),"icon-rotate":new ve($e.layout_symbol["icon-rotate"]),"icon-padding":new he($e.layout_symbol["icon-padding"]),"icon-keep-upright":new he($e.layout_symbol["icon-keep-upright"]),"icon-offset":new ve($e.layout_symbol["icon-offset"]),"icon-anchor":new ve($e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new he($e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new he($e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new he($e.layout_symbol["text-rotation-alignment"]),"text-field":new ve($e.layout_symbol["text-field"]),"text-font":new ve($e.layout_symbol["text-font"]),"text-size":new ve($e.layout_symbol["text-size"]),"text-max-width":new ve($e.layout_symbol["text-max-width"]),"text-line-height":new ve($e.layout_symbol["text-line-height"]),"text-letter-spacing":new ve($e.layout_symbol["text-letter-spacing"]),"text-justify":new ve($e.layout_symbol["text-justify"]),"text-radial-offset":new ve($e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new he($e.layout_symbol["text-variable-anchor"]),"text-anchor":new ve($e.layout_symbol["text-anchor"]),"text-max-angle":new he($e.layout_symbol["text-max-angle"]),"text-writing-mode":new he($e.layout_symbol["text-writing-mode"]),"text-rotate":new ve($e.layout_symbol["text-rotate"]),"text-padding":new he($e.layout_symbol["text-padding"]),"text-keep-upright":new he($e.layout_symbol["text-keep-upright"]),"text-transform":new ve($e.layout_symbol["text-transform"]),"text-offset":new ve($e.layout_symbol["text-offset"]),"text-allow-overlap":new he($e.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new he($e.layout_symbol["text-ignore-placement"]),"text-optional":new he($e.layout_symbol["text-optional"])});var Kg={paint:new He({"icon-opacity":new ve($e.paint_symbol["icon-opacity"]),"icon-color":new ve($e.paint_symbol["icon-color"]),"icon-halo-color":new ve($e.paint_symbol["icon-halo-color"]),"icon-halo-width":new ve($e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ve($e.paint_symbol["icon-halo-blur"]),"icon-translate":new he($e.paint_symbol["icon-translate"]),"icon-translate-anchor":new he($e.paint_symbol["icon-translate-anchor"]),"text-opacity":new ve($e.paint_symbol["text-opacity"]),"text-color":new ve($e.paint_symbol["text-color"],{runtimeType:Ar,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new ve($e.paint_symbol["text-halo-color"]),"text-halo-width":new ve($e.paint_symbol["text-halo-width"]),"text-halo-blur":new ve($e.paint_symbol["text-halo-blur"]),"text-translate":new he($e.paint_symbol["text-translate"]),"text-translate-anchor":new he($e.paint_symbol["text-translate-anchor"])}),layout:EA};class Kx{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Ms,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Bt(Kx,"FormatSectionOverride",{omit:["defaultValue"]});class gp extends no{constructor(e){super(e,Kg)}recalculate(e,n){super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const a=this.layout.get("text-writing-mode");if(a){const u=[];for(const d of a)u.indexOf(d)<0&&u.push(d);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,a,u){const d=this.layout.get(e).evaluate(n,{},a,u),m=this._unevaluatedLayout._values[e];return m.isDataDriven()||lc(m.value)||!d?d:function(_,b){return b.replace(/{([^{}]+)}/g,(w,S)=>S in _?String(_[S]):"")}(n.properties,d)}createBucket(e){return new Ks(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Kg.paint.overridableProperties){if(!gp.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),a=new Kx(n),u=new Ku(a,n.property.specification);let d=null;d=n.value.kind==="constant"||n.value.kind==="source"?new Yu("source",u):new Ua("composite",u,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new le(n.property,d,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,a){return!(!this.layout||n.isDataDriven()||a.isDataDriven())&&gp.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const a=e.get("text-field"),u=Kg.paint.properties[n];let d=!1;const m=_=>{for(const b of _)if(u.overrides&&u.overrides.hasOverride(b))return void(d=!0)};if(a.value.kind==="constant"&&a.value.value instanceof Qi)m(a.value.value.sections);else if(a.value.kind==="source"){const _=w=>{d||(w instanceof Ia&&pi(w.value)===Ca?m(w.value.sections):w instanceof za?m(w.sections):w.eachChild(_))},b=a.value;b._styleExpression&&_(b._styleExpression.expression)}return d}getProgramConfiguration(e){return new Zs(this,e)}}var CA={paint:new He({"background-color":new he($e.paint_background["background-color"]),"background-pattern":new pt($e.paint_background["background-pattern"]),"background-opacity":new he($e.paint_background["background-opacity"])})},SA={paint:new He({"raster-opacity":new he($e.paint_raster["raster-opacity"]),"raster-hue-rotate":new he($e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new he($e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new he($e.paint_raster["raster-brightness-max"]),"raster-saturation":new he($e.paint_raster["raster-saturation"]),"raster-contrast":new he($e.paint_raster["raster-contrast"]),"raster-resampling":new he($e.paint_raster["raster-resampling"]),"raster-fade-duration":new he($e.paint_raster["raster-fade-duration"])})};class MA extends no{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var AA={paint:new He({"sky-type":new he($e.paint_sky["sky-type"]),"sky-atmosphere-sun":new he($e.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new he($e.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new he($e.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new he($e.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ce($e.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new he($e.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new he($e.paint_sky["sky-atmosphere-color"]),"sky-opacity":new he($e.paint_sky["sky-opacity"])})};function Yg(i,e,n){const a=[0,0,1],u=z0([]);return k0(u,u,n?-se(i)+Math.PI:se(i)),O0(u,u,-se(e)),A0(a,a,u),tr(a,a)}const IA={circle:class extends no{constructor(i){super(i,kS)}createBucket(i){return new fg(i)}queryRadius(i){const e=i;return wc("circle-radius",this,e)+wc("circle-stroke-width",this,e)+Ud(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,n,a,u,d,m,_){const b=w0(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,i.pixelToTileUnitsFactor),w=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return D0(i,a,d,m,_,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",b,w)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new Zs(this,i)}},heatmap:class extends no{createBucket(i){return new R0(i)}constructor(i){super(i,NS),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Sg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return wc("heatmap-radius",this,i)}queryIntersectsFeature(i,e,n,a,u,d,m,_){const b=this.paint.get("heatmap-radius").evaluate(e,n);return D0(i,a,d,m,_,!0,!0,new D(0,0),b)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new Zs(this,i)}},hillshade:class extends no{constructor(i){super(i,US)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends no{constructor(i){super(i,rM)}getProgramIds(){const i=this.paint.get("fill-pattern"),e=i&&i.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(i){return new Zs(this,i)}recalculate(i,e){super.recalculate(i,e);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Kd(i)}queryRadius(){return Ud(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,n,a,u,d){return!i.queryGeometry.isAboveHorizon&&_0(b0(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,i.pixelToTileUnitsFactor),a)}isTileClipped(){return!0}},"fill-extrusion":class extends no{constructor(i){super(i,_M)}createBucket(i){return new Sh(i)}queryRadius(){return Ud(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new Zs(this,i)}queryIntersectsFeature(i,e,n,a,u,d,m,_,b){const w=w0(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,i.pixelToTileUnitsFactor),S=this.paint.get("fill-extrusion-height").evaluate(e,n),I=this.paint.get("fill-extrusion-base").evaluate(e,n),P=[0,0],L=_&&d.elevation,B=d.elevation?d.elevation.exaggeration():1,V=i.tile.getBucket(this);if(L&&V instanceof Sh){const ce=V.centroidVertexArray,ne=b+1;if(ne<ce.length){const ae=ce.get(ne);P[0]=ae.a_centroid_pos0,P[1]=ae.a_centroid_pos1}}if(P[0]===0&&P[1]===1)return!1;d.projection.name==="globe"&&(a=ex([a],[new D(0,0),new D(Qt,Qt)],i.tileID.canonical).map(ce=>ce.polygon).flat());const Z=function(ce,ne,ae,me,ue,Re,De,Ze,_t,Fe,Ke){return ce.projection.name==="globe"?function(nt,Ye,mt,it,Pt,cn,hn,$t,Mt,wn,rn){const Dt=[],Kn=[],Zn=nt.projection.upVectorScale(rn,nt.center.lat,nt.worldSize).metersToTile,ii=[0,0,0,1],dn=[0,0,0,1],In=(qn,$n,ei,si)=>{qn[0]=$n,qn[1]=ei,qn[2]=si,qn[3]=1},Yn=Q0();mt>0&&(mt+=Yn),it+=Yn;for(const qn of Ye){const $n=[],ei=[];for(const si of qn){const Ii=si.x+Pt.x,ur=si.y+Pt.y,En=nt.projection.projectTilePoint(Ii,ur,rn),hi=nt.projection.upVector(rn,si.x,si.y);let Hi=mt,Dn=it;if(hn){const ai=rx(Ii,ur,mt,it,hn,$t,Mt,wn);Hi+=ai.base,Dn+=ai.top}mt!==0?In(ii,En.x+hi[0]*Zn*Hi,En.y+hi[1]*Zn*Hi,En.z+hi[2]*Zn*Hi):In(ii,En.x,En.y,En.z),In(dn,En.x+hi[0]*Zn*Dn,En.y+hi[1]*Zn*Dn,En.z+hi[2]*Zn*Dn),Ti(ii,ii,cn),Ti(dn,dn,cn),$n.push(Qd(ii)),ei.push(Qd(dn))}Dt.push($n),Kn.push(ei)}return[Dt,Kn]}(ce,ne,ae,me,ue,Re,De,Ze,_t,Fe,Ke):De?function(nt,Ye,mt,it,Pt,cn,hn,$t,Mt){const wn=[],rn=[],Dt=[0,0,0,1];for(const Kn of nt){const Zn=[],ii=[];for(const dn of Kn){const In=dn.x+it.x,Yn=dn.y+it.y,qn=rx(In,Yn,Ye,mt,cn,hn,$t,Mt);Dt[0]=In,Dt[1]=Yn,Dt[2]=qn.base,Dt[3]=1,rl(Dt,Dt,Pt),Dt[3]=Math.max(Dt[3],1e-5);const $n=Qd([Dt[0]/Dt[3],Dt[1]/Dt[3],Dt[2]/Dt[3]]);Dt[0]=In,Dt[1]=Yn,Dt[2]=qn.top,Dt[3]=1,rl(Dt,Dt,Pt),Dt[3]=Math.max(Dt[3],1e-5);const ei=Qd([Dt[0]/Dt[3],Dt[1]/Dt[3],Dt[2]/Dt[3]]);Zn.push($n),ii.push(ei)}wn.push(Zn),rn.push(ii)}return[wn,rn]}(ne,ae,me,ue,Re,De,Ze,_t,Fe):function(nt,Ye,mt,it,Pt){const cn=[],hn=[],$t=Pt[8]*Ye,Mt=Pt[9]*Ye,wn=Pt[10]*Ye,rn=Pt[11]*Ye,Dt=Pt[8]*mt,Kn=Pt[9]*mt,Zn=Pt[10]*mt,ii=Pt[11]*mt;for(const dn of nt){const In=[],Yn=[];for(const qn of dn){const $n=qn.x+it.x,ei=qn.y+it.y,si=Pt[0]*$n+Pt[4]*ei+Pt[12],Ii=Pt[1]*$n+Pt[5]*ei+Pt[13],ur=Pt[2]*$n+Pt[6]*ei+Pt[14],En=Pt[3]*$n+Pt[7]*ei+Pt[15],hi=si+$t,Hi=Ii+Mt,Dn=ur+wn,ai=Math.max(En+rn,1e-5),ir=si+Dt,ri=Ii+Kn,mi=ur+Zn,Pi=Math.max(En+ii,1e-5),Si=new D(hi/ai,Hi/ai);Si.z=Dn/ai,In.push(Si);const Ui=new D(ir/Pi,ri/Pi);Ui.z=mi/Pi,Yn.push(Ui)}cn.push(In),hn.push(Yn)}return[cn,hn]}(ne,ae,me,ue,Re)}(d,a,I,S,w,m,L?_:null,P,B,d.center.lat,i.tileID.canonical),Q=i.queryGeometry;return function(ce,ne,ae){let me=1/0;_0(ae,ne)&&(me=ix(ae,ne[0]));for(let ue=0;ue<ne.length;ue++){const Re=ne[ue],De=ce[ue];for(let Ze=0;Ze<Re.length-1;Ze++){const _t=Re[Ze],Fe=[_t,Re[Ze+1],De[Ze+1],De[Ze],_t];g0(ae,Fe)&&(me=Math.min(me,ix(ae,Fe)))}}return me!==1/0&&me}(Z[0],Z[1],Q.isPointQuery()?Q.screenBounds:Q.screenGeometry)}},line:class extends no{constructor(i){super(i,ox),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Pu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=sx.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new ep(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new Zs(this,i)}queryRadius(i){const e=i,n=ax(wc("line-width",this,e),wc("line-gap-width",this,e)),a=wc("line-offset",this,e);return n/2+Math.abs(a)+Ud(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,n,a,u,d){if(i.queryGeometry.isAboveHorizon)return!1;const m=b0(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,i.pixelToTileUnitsFactor),_=i.pixelToTileUnitsFactor/2*ax(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),b=this.paint.get("line-offset").evaluate(e,n);return b&&(a=function(w,S){const I=[],P=new D(0,0);for(let L=0;L<w.length;L++){const B=w[L],V=[];for(let Z=0;Z<B.length;Z++){const Q=B[Z-1],ce=B[Z],ne=B[Z+1],ae=Z===0?P:ce.sub(Q)._unit()._perp(),me=Z===B.length-1?P:ne.sub(ce)._unit()._perp(),ue=ae._add(me)._unit();ue._mult(1/(ue.x*me.x+ue.y*me.y)),V.push(ue._mult(S)._add(ce))}I.push(V)}return I}(a,b*i.pixelToTileUnitsFactor)),function(w,S,I){for(let P=0;P<S.length;P++){const L=S[P];if(w.length>=3){for(let B=0;B<L.length;B++)if(nl(w,L[B]))return!0}if(IS(w,L,I))return!0}return!1}(m,a,_)}isTileClipped(){return!0}},symbol:gp,background:class extends no{constructor(i){super(i,CA)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends no{constructor(i){super(i,SA)}getProgramIds(){return["raster"]}},sky:class extends no{constructor(i){super(i,AA),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Sg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(i,e){if(this.paint.get("sky-type")==="atmosphere"){const a=this.paint.get("sky-atmosphere-sun"),u=!a,d=i.style.light,m=d.properties.get("position");return u&&d.properties.get("anchor")==="viewport"&&Lt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?Yg(m.azimuthal,90-m.polar,e):Yg(a[0],90-a[1],e)}const n=this.paint.get("sky-gradient-center");return Yg(n[0],90-n[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}};class Uh{constructor(e,n,a,u){this.context=e,this.format=a,this.texture=e.gl.createTexture(),this.update(n,u)}update(e,n,a){const{width:u,height:d}=e,{context:m}=this,{gl:_}=m,{HTMLImageElement:b,HTMLCanvasElement:w,HTMLVideoElement:S,ImageData:I,ImageBitmap:P}=A;if(_.bindTexture(_.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA&&(!n||n.premultiply!==!1)),a||this.size&&this.size[0]===u&&this.size[1]===d){const{x:L,y:B}=a||{x:0,y:0};e instanceof b||e instanceof w||e instanceof S||e instanceof I||P&&e instanceof P?_.texSubImage2D(_.TEXTURE_2D,0,L,B,_.RGBA,_.UNSIGNED_BYTE,e):_.texSubImage2D(_.TEXTURE_2D,0,L,B,u,d,_.RGBA,_.UNSIGNED_BYTE,e.data)}else this.size=[u,d],e instanceof b||e instanceof w||e instanceof S||e instanceof I||P&&e instanceof P?_.texImage2D(_.TEXTURE_2D,0,this.format,this.format,_.UNSIGNED_BYTE,e):_.texImage2D(_.TEXTURE_2D,0,this.format,u,d,0,this.format,_.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(e,n){const{context:a}=this,{gl:u}=a;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),n!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Jg{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new as({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const a=this.getKey(e,n);return this.positions[a]}trim(){const e=this.width,n=this.height=Ne(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,a){const u=[];let d=e.length%2==1?-e[e.length-1]*a:0,m=e[0]*a,_=!0;u.push({left:d,right:m,isDash:_,zeroLength:e[0]===0});let b=e[0];for(let w=1;w<e.length;w++){_=!_;const S=e[w];d=b*a,b+=S,m=b*a,u.push({left:d,right:m,isDash:_,zeroLength:S===0})}return u}addRoundDash(e,n,a){const u=n/2;for(let d=-a;d<=a;d++){const m=this.width*(this.nextRow+a+d);let _=0,b=e[_];for(let w=0;w<this.width;w++){w/b.right>1&&(b=e[++_]);const S=Math.abs(w-b.left),I=Math.abs(w-b.right),P=Math.min(S,I);let L;const B=d/a*(u+1);if(b.isDash){const V=u-Math.abs(B);L=Math.sqrt(P*P+V*V)}else L=u-Math.sqrt(P*P+B*B);this.image.data[m+w]=Math.max(0,Math.min(255,L+128))}}}addRegularDash(e,n){for(let b=e.length-1;b>=0;--b){const w=e[b],S=e[b+1];w.zeroLength?e.splice(b,1):S&&S.isDash===w.isDash&&(S.left=w.left,e.splice(b,1))}const a=e[0],u=e[e.length-1];a.isDash===u.isDash&&(a.left=u.left-this.width,u.right=a.right+this.width);const d=this.width*this.nextRow;let m=0,_=e[m];for(let b=0;b<this.width;b++){b/_.right>1&&(_=e[++m]);const w=Math.abs(b-_.left),S=Math.abs(b-_.right),I=Math.min(w,S);this.image.data[d+b]=Math.max(0,Math.min(255,(_.isDash?I:-I)+n+128))}}addDash(e,n){const a=this.getKey(e,n);if(this.positions[a])return this.positions[a];const u=n==="round",d=u?7:0,m=2*d+1;if(this.nextRow+m>this.height)return Lt("LineAtlas out of space"),null;e.length===0&&e.push(1);let _=0;for(let S=0;S<e.length;S++)e[S]<0&&(Lt("Negative value is found in line dasharray, replacing values with 0"),e[S]=0),_+=e[S];if(_!==0){const S=this.width/_,I=this.getDashRanges(e,this.width,S);u?this.addRoundDash(I,S,d):this.addRegularDash(I,n==="square"?.5*S:0)}const b=this.nextRow+d;this.nextRow+=m;const w={tl:[b,d],br:[_,0]};return this.positions[a]=w,w}}Bt(Jg,"LineAtlas");class PA{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class zA{constructor(){this.tasks={},this.taskQueue=[],rt(["process"],this),this.invoker=new PA(this.process),this.nextId=0}add(e,n){const a=this.nextId++,u=function({type:d,isSymbolTile:m,zoom:_}){return _=_||0,d==="message"?0:d!=="maybePrepare"||m?d!=="parseTile"||m?d==="parseTile"&&m?300-_:d==="maybePrepare"&&m?400-_:500:200-_:100-_}(n);if(u===0){be();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[a]={fn:e,metadata:n,priority:u,id:a},this.taskQueue.push(a),this.invoker.trigger(),{cancel:()=>{delete this.tasks[a]}}}process(){be();try{if(this.taskQueue=this.taskQueue.filter(a=>!!this.tasks[a]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let u=0;u<this.taskQueue.length;u++){const d=this.tasks[this.taskQueue[u]];d.priority<n&&(n=d.priority,e=u)}if(e===null)return null;const a=this.taskQueue[e];return this.taskQueue.splice(e,1),a}remove(){this.invoker.remove()}}class Yx{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const a=e[n];this._stringToNumber[a]=n,this._numberToString[n]=a}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const OA=["tile","layer","source","sourceLayer","state"];class Jx{constructor(e,n,a,u,d){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=a,this._y=u,this.properties=e.properties,this.id=d}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const n of OA)this[n]!==void 0&&(e[n]=this[n]);return e}}const Vr=32,zo=33,Ys=new Uint16Array(8184);for(let i=0;i<2046;i++){let e=i+2,n=0,a=0,u=0,d=0,m=0,_=0;for(1&e?u=d=m=Vr:n=a=_=Vr;(e>>=1)>1;){const w=n+u>>1,S=a+d>>1;1&e?(u=n,d=a,n=m,a=_):(n=u,a=d,u=m,d=_),m=w,_=S}const b=4*i;Ys[b+0]=n,Ys[b+1]=a,Ys[b+2]=u,Ys[b+3]=d}const Oo=new Uint16Array(2178),Js=new Uint8Array(1089),_p=new Uint16Array(1089);function Qx(i){return i===0?-.03125:i===32?.03125:0}var e1=Je([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const t1={type:2,extent:Qt,loadGeometry:()=>[[new D(0,0),new D(8193,0),new D(8193,8193),new D(0,8193),new D(0,0)]]};class Qg{constructor(e,n,a,u,d){this.tileID=e,this.uid=st(),this.uses=0,this.tileSize=n,this.tileZoom=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=d,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const n=e+this.timeAdded;n<wt.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=al(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,a){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,d){const m={};if(!d)return m;for(const _ of u){const b=_.layerIds.map(w=>d.getLayer(w)).filter(Boolean);if(b.length!==0){_.layers=b,_.stateDependentLayerIds&&(_.stateDependentLayers=_.stateDependentLayerIds.map(w=>b.filter(S=>S.id===w)[0]));for(const w of b)m[w.id]=_}}return m}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const d=this.buckets[u];if(d instanceof Ks){if(this.hasSymbolBuckets=!0,!a)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const d=this.buckets[u];if(d instanceof Ks&&d.hasRTLText){this.hasRTLText=!0,W.isLoading()||W.isLoaded()||$()!=="deferred"||K();break}}this.queryPadding=0;for(const u in this.buckets){const d=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(u).queryRadius(d))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Co}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const a in this.buckets){const u=this.buckets[a];u.uploadPending()&&u.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Uh(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Uh(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Uh(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,a,u,d,m,_,b){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:_,transform:m,params:d,tileTransform:this.tileTransform},e,n,a):{}}querySourceFeatures(e,n){const a=this.latestFeatureIndex;if(!a||!a.rawTileData)return;const u=a.loadVTLayers(),d=n?n.sourceLayer:"",m=u._geojsonTileLayer||u[d];if(!m)return;const _=Za(n&&n.filter),{z:b,x:w,y:S}=this.tileID.canonical,I={z:b,x:w,y:S};for(let P=0;P<m.length;P++){const L=m.feature(P);if(_.needGeometry){const Z=tl(L,!0);if(!_.filter(new H(this.tileID.overscaledZ),Z,this.tileID.canonical))continue}else if(!_.filter(new H(this.tileID.overscaledZ),L))continue;const B=a.getId(L,d),V=new Jx(L,b,w,S,B);V.tile=I,e.push(V)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const a=Xe(e.cacheControl);a["max-age"]&&(this.expirationTime=Date.now()+1e3*a["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const a=Date.now();let u=!1;if(this.expirationTime>a)u=!1;else if(n)if(this.expirationTime<n)u=!0;else{const d=this.expirationTime-n;d?this.expirationTime=a+Math.max(d,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!n)return;const a=this.latestFeatureIndex.loadVTLayers(),u=n.style.listImages();for(const d in this.buckets){if(!n.style.hasLayer(d))continue;const m=this.buckets[d],_=m.layers[0].sourceLayer||"_geojsonTileLayer",b=a[_],w=e[_];if(!b||!w||Object.keys(w).length===0)continue;if(m.update(w,b,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),m instanceof ep||m instanceof Kd){const I=n.style._getSourceCache(m.layers[0].source);n._terrain&&n._terrain.enabled&&I&&m.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(I.id,this.tileID)}const S=n&&n.style&&n.style.getLayer(d);S&&(this.queryPadding=Math.max(this.queryPadding,S.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<wt.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=wt.now()+e}setTexture(e,n){const a=n.context,u=a.gl;this.texture=n.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Uh(a,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),a.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax))}setDependencies(e,n){const a={};for(const u of n)a[u]=!0;this.dependencies[e]=a}hasDependency(e,n){for(const a of e){const u=this.dependencies[a];if(u){for(const d of n)if(u[d])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;const a=ss(t1,this.tileID.canonical,this.tileTransform)[0],u=new At,d=new Qo;for(let m=0;m<a.length;m++){const{x:_,y:b}=a[m];u.emplaceBack(_,b),d.emplaceBack(m)}d.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(d),this._tileDebugBuffer=e.createVertexBuffer(u,kh.members),this._tileDebugSegments=xi.simpleSegment(0,0,u.length,d.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;const a=ss(t1,this.tileID.canonical,this.tileTransform)[0];let u,d;if(this.isRaster){const m=function(_,b){const w=al(_,b),S=Math.pow(2,_.z);for(let Z=0;Z<zo;Z++)for(let Q=0;Q<zo;Q++){const ce=Nr((_.x+(Q+Qx(Q))/Vr)/S),ne=ji((_.y+(Z+Qx(Z))/Vr)/S),ae=b.project(ce,ne),me=Z*zo+Q;Oo[2*me+0]=Math.round((ae.x*w.scale-w.x)*Qt),Oo[2*me+1]=Math.round((ae.y*w.scale-w.y)*Qt)}Js.fill(0),_p.fill(0);for(let Z=2045;Z>=0;Z--){const Q=4*Z,ce=Ys[Q+0],ne=Ys[Q+1],ae=Ys[Q+2],me=Ys[Q+3],ue=ce+ae>>1,Re=ne+me>>1,De=ue+Re-ne,Ze=Re+ce-ue,_t=ne*zo+ce,Fe=me*zo+ae,Ke=Re*zo+ue,nt=Math.hypot((Oo[2*_t+0]+Oo[2*Fe+0])/2-Oo[2*Ke+0],(Oo[2*_t+1]+Oo[2*Fe+1])/2-Oo[2*Ke+1])>=16;if(Js[Ke]=Js[Ke]||(nt?1:0),Z<1022){const Ye=(ne+Ze>>1)*zo+(ce+De>>1),mt=(me+Ze>>1)*zo+(ae+De>>1);Js[Ke]=Js[Ke]||Js[Ye]||Js[mt]}}const I=new Zt,P=new gn;let L=0;function B(Z,Q){const ce=Q*zo+Z;return _p[ce]===0&&(I.emplaceBack(Oo[2*ce+0],Oo[2*ce+1],Z*Qt/Vr,Q*Qt/Vr),_p[ce]=++L),_p[ce]-1}function V(Z,Q,ce,ne,ae,me){const ue=Z+ce>>1,Re=Q+ne>>1;if(Math.abs(Z-ae)+Math.abs(Q-me)>1&&Js[Re*zo+ue])V(ae,me,Z,Q,ue,Re),V(ce,ne,ae,me,ue,Re);else{const De=B(Z,Q),Ze=B(ce,ne),_t=B(ae,me);P.emplaceBack(De,Ze,_t)}}return V(0,0,Vr,Vr,Vr,0),V(Vr,Vr,0,0,0,Vr),{vertices:I,indices:P}}(this.tileID.canonical,n);u=m.vertices,d=m.indices}else{u=new Zt,d=new gn;for(const{x:_,y:b}of a)u.emplaceBack(_,b,0,0);const m=Zd(u.int16,void 0,4);for(let _=0;_<m.length;_+=3)d.emplaceBack(m[_],m[_+1],m[_+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,e1.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(d),this._tileBoundsSegments=xi.simpleSegment(0,0,u.length,d.length)}_makeGlobeTileDebugBuffers(e,n){const a=n.projection;if(!a||a.name!=="globe"||n.freezeTileCoverage)return;const u=this.tileID.canonical,d=Lh(Fx(u,n)),m=Rh(n.zoom);let _;m>0&&(_=mg(new Float64Array(16),n.globeMatrix));const b=(u.x+.5)/(1<<u.z)-So(n.center.lng);let w=0;b>.5?w=-1:b<-.5&&(w=1),this._makeGlobeTileDebugBorderBuffer(e,u,n,d,_,m,w),this._makeGlobeTileDebugTextBuffer(e,u,n,d,_,m,w)}_globePoint(e,n,a,u,d,m,_,b){let w=Dh(e,n,a);if(m){const S=1<<a.z,I=[((e/Qt+a.x)/S+b)*u,(n/Qt+a.y)/S*u,0];Ti(I,I,m),w=zs(w,I,_)}return Ti(w,w,d)}_makeGlobeTileDebugBorderBuffer(e,n,a,u,d,m,_){const b=new At,w=new Qo,S=new Nt,I=(L,B,V,Z,Q)=>{const ce=(V-L)/(Q-1),ne=(Z-B)/(Q-1),ae=b.length;for(let me=0;me<Q;me++){const ue=L+me*ce,Re=B+me*ne;b.emplaceBack(ue,Re);const De=this._globePoint(ue,Re,n,a.worldSize,u,d,m,_);S.emplaceBack(De[0],De[1],De[2]),w.emplaceBack(ae+me)}},P=Qt;I(0,0,P,0,16),I(P,0,P,P,16),I(P,P,0,P,16),I(0,P,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(w),this._tileDebugBuffer=e.createVertexBuffer(b,kh.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(S,Rx.members),this._tileDebugSegments=xi.simpleSegment(0,0,b.length,w.length)}_makeGlobeTileDebugTextBuffer(e,n,a,u,d,m,_){const b=new At,w=new gn,S=new Nt,I=25;w.reserve(32),b.reserve(I),S.reserve(I);const P=(L,B)=>I*L+B;for(let L=0;L<I;L++){const B=2048*L;for(let V=0;V<I;V++){const Z=2048*V;b.emplaceBack(Z,B);const Q=this._globePoint(Z,B,n,a.worldSize,u,d,m,_);S.emplaceBack(Q[0],Q[1],Q[2])}}for(let L=0;L<4;L++)for(let B=0;B<4;B++){const V=P(L,B),Z=P(L,B+1),Q=P(L+1,B),ce=P(L+1,B+1);w.emplaceBack(V,Z,Q),w.emplaceBack(Q,Z,ce)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(w),this._tileDebugTextBuffer=e.createVertexBuffer(b,kh.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(S,Rx.members),this._tileDebugTextSegments=xi.simpleSegment(0,0,I,32)}}class kA{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,a){const u=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},ct(this.stateChanges[e][u],a),this.deletedStates[e]===null){this.deletedStates[e]={};for(const d in this.state[e])d!==u&&(this.deletedStates[e][d]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const d in this.state[e][u])a[d]||(this.deletedStates[e][u][d]=null)}else for(const d in a)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][d]===null&&delete this.deletedStates[e][u][d]}removeFeatureState(e,n,a){if(this.deletedStates[e]===null)return;const u=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},a&&n!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][a]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(a in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][a]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,n){const a=String(n),u=ct({},(this.state[e]||{})[a],(this.stateChanges[e]||{})[a]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const d=this.deletedStates[e][n];if(d===null)return{};for(const m in d)delete u[m]}return u}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const a={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const d={};for(const m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),ct(this.state[u][m],this.stateChanges[u][m]),d[m]=this.state[u][m];a[u]=d}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const d={};if(this.deletedStates[u]===null)for(const m in this.state[u])d[m]={},this.state[u][m]={};else for(const m in this.deletedStates[u]){if(this.deletedStates[u][m]===null)this.state[u][m]={};else for(const _ of Object.keys(this.deletedStates[u][m]))delete this.state[u][m][_];d[m]=this.state[u][m]}a[u]=a[u]||{},ct(a[u],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(a).length!==0)for(const u in e)e[u].setFeatureState(a,n)}}class n1{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const a=this.toIdx(e,n);return{min:this.minimums[a],max:this.maximums[a]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function i1(i,e,n,a){let u=0,d=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(a[m])<1e-15){if(n[m]<i[m]||n[m]>e[m])return null}else{const _=1/a[m];let b=(i[m]-n[m])*_,w=(e[m]-n[m])*_;if(b>w){const S=b;b=w,w=S}if(b>u&&(u=b),w<d&&(d=w),u>d)return null}return u}function r1(i,e,n,a,u,d,m,_,b,w,S){const I=a-i,P=u-e,L=d-n,B=m-i,V=_-e,Z=b-n,Q=S[1]*Z-S[2]*V,ce=S[2]*B-S[0]*Z,ne=S[0]*V-S[1]*B,ae=I*Q+P*ce+L*ne;if(Math.abs(ae)<1e-15)return null;const me=1/ae,ue=w[0]-i,Re=w[1]-e,De=w[2]-n,Ze=(ue*Q+Re*ce+De*ne)*me;if(Ze<0||Ze>1)return null;const _t=Re*L-De*P,Fe=De*I-ue*L,Ke=ue*P-Re*I,nt=(S[0]*_t+S[1]*Fe+S[2]*Ke)*me;return nt<0||Ze+nt>1?null:(B*_t+V*Fe+Z*Ke)*me}function o1(i,e,n){return(i-e)/(n-e)}function s1(i,e,n,a,u,d,m,_,b){const w=1<<n,S=d-a,I=m-u,P=(i+1)/w*S+a,L=(e+0)/w*I+u,B=(e+1)/w*I+u;_[0]=(i+0)/w*S+a,_[1]=L,b[0]=P,b[1]=B}class a1{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(d){const m=Math.ceil(Math.log2(d.dim/8)),_=[];let b=Math.ceil(Math.pow(2,m));const w=1/b,S=(L,B,V,Z,Q)=>{const ce=Z?1:0,ne=(L+1)*V-ce,ae=B*V,me=(B+1)*V-ce;Q[0]=L*V,Q[1]=ae,Q[2]=ne,Q[3]=me};let I=new n1(b);const P=[];for(let L=0;L<b*b;L++){S(L%b,Math.floor(L/b),w,!1,P);const B=Qs(P[0],P[1],d),V=Qs(P[2],P[1],d),Z=Qs(P[2],P[3],d),Q=Qs(P[0],P[3],d);I.minimums.push(Math.min(B,V,Z,Q)),I.maximums.push(Math.max(B,V,Z,Q)),I.leaves.push(1)}for(_.push(I),b/=2;b>=1;b/=2){const L=_[_.length-1];I=new n1(b);for(let B=0;B<b*b;B++){S(B%b,Math.floor(B/b),2,!0,P);const V=L.getElevation(P[0],P[1]),Z=L.getElevation(P[2],P[1]),Q=L.getElevation(P[2],P[3]),ce=L.getElevation(P[0],P[3]),ne=L.isLeaf(P[0],P[1]),ae=L.isLeaf(P[2],P[1]),me=L.isLeaf(P[2],P[3]),ue=L.isLeaf(P[0],P[3]),Re=Math.min(V.min,Z.min,Q.min,ce.min),De=Math.max(V.max,Z.max,Q.max,ce.max),Ze=ne&&ae&&me&&ue;I.maximums.push(De),I.minimums.push(Re),I.leaves.push(De-Re<=5&&Ze?1:0)}_.push(I)}return _}(this.dem),a=n.length-1,u=n[a];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(n,0,0,a,0)}raycastRoot(e,n,a,u,d,m,_=1){return i1([e,n,-100],[a,u,this.maximums[0]*_],d,m)}raycast(e,n,a,u,d,m,_=1){if(!this.nodeCount)return null;const b=this.raycastRoot(e,n,a,u,d,m,_);if(b==null)return null;const w=[],S=[],I=[],P=[],L=[{idx:0,t:b,nodex:0,nodey:0,depth:0}];for(;L.length>0;){const{idx:B,t:V,nodex:Z,nodey:Q,depth:ce}=L.pop();if(this.leaves[B]){s1(Z,Q,ce,e,n,a,u,I,P);const ae=1<<ce,me=(Z+0)/ae,ue=(Z+1)/ae,Re=(Q+0)/ae,De=(Q+1)/ae,Ze=Qs(me,Re,this.dem)*_,_t=Qs(ue,Re,this.dem)*_,Fe=Qs(ue,De,this.dem)*_,Ke=Qs(me,De,this.dem)*_,nt=r1(I[0],I[1],Ze,P[0],I[1],_t,P[0],P[1],Fe,d,m),Ye=r1(P[0],P[1],Fe,I[0],P[1],Ke,I[0],I[1],Ze,d,m),mt=Math.min(nt!==null?nt:Number.MAX_VALUE,Ye!==null?Ye:Number.MAX_VALUE);if(mt!==Number.MAX_VALUE)return mt;{const it=Gd([],d,m,V);if(l1(Ze,_t,Ke,Fe,o1(it[0],I[0],P[0]),o1(it[1],I[1],P[1]))>=it[2])return V}continue}let ne=0;for(let ae=0;ae<this._siblingOffset.length;ae++){s1((Z<<1)+this._siblingOffset[ae][0],(Q<<1)+this._siblingOffset[ae][1],ce+1,e,n,a,u,I,P),I[2]=-100,P[2]=this.maximums[this.childOffsets[B]+ae]*_;const me=i1(I,P,d,m);if(me!=null){const ue=me;w[ae]=ue;let Re=!1;for(let De=0;De<ne&&!Re;De++)ue>=w[S[De]]&&(S.splice(De,0,ae),Re=!0);Re||(S[ne]=ae),ne++}}for(let ae=0;ae<ne;ae++){const me=S[ae];L.push({idx:this.childOffsets[B]+me,t:w[me],nodex:(Z<<1)+this._siblingOffset[me][0],nodey:(Q<<1)+this._siblingOffset[me][1],depth:ce+1})}}return null}_addNode(e,n,a){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(a),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,a,u,d){if(e[u].isLeaf(n,a)===1)return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const m=u-1,_=e[m];let b=0,w=0;for(let S=0;S<this._siblingOffset.length;S++){const I=2*n+this._siblingOffset[S][0],P=2*a+this._siblingOffset[S][1],L=_.getElevation(I,P),B=_.isLeaf(I,P),V=this._addNode(L.min,L.max,B);B&&(b|=1<<S),w||(w=V)}for(let S=0;S<this._siblingOffset.length;S++)b&1<<S||this._construct(e,2*n+this._siblingOffset[S][0],2*a+this._siblingOffset[S][1],m,w+S)}}function l1(i,e,n,a,u,d){return Mn(Mn(i,n,d),Mn(e,a,d),u)}function Qs(i,e,n){const a=n.dim,u=Pe(i*a-.5,0,a-1),d=Pe(e*a-.5,0,a-1),m=Math.floor(u),_=Math.floor(d),b=Math.min(m+1,a-1),w=Math.min(_+1,a-1);return l1(n.get(m,_),n.get(b,_),n.get(m,w),n.get(b,w),u-m,d-_)}const c1={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class yp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,a,u=!1,d=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(a&&a!=="mapbox"&&a!=="terrarium")return Lt(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const m=this.dim=n.height-2,_=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.encoding=a||"mapbox",this.borderReady=u,!u){for(let b=0;b<m;b++)_[this._idx(-1,b)]=_[this._idx(0,b)],_[this._idx(m,b)]=_[this._idx(m-1,b)],_[this._idx(b,-1)]=_[this._idx(b,0)],_[this._idx(b,m)]=_[this._idx(b,m-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(m,-1)]=_[this._idx(m-1,0)],_[this._idx(-1,m)]=_[this._idx(0,m-1)],_[this._idx(m,m)]=_[this._idx(m-1,m-1)],d&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new a1(this)}get(e,n,a=!1){a&&(e=Pe(e,-1,this.dim),n=Pe(n,-1,this.dim));const u=4*this._idx(e,n);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}static getUnpackVector(e){return c1[e]}get unpackVector(){return c1[this.encoding]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}_unpackMapbox(e,n,a){return(256*e*256+256*n+a)/10-1e4}_unpackTerrarium(e,n,a){return 256*e+n+a/256-32768}static pack(e,n){const a=[0,0,0,0],u=yp.getUnpackVector(n);let d=Math.floor((e+u[3])/u[2]);return a[2]=d%256,d=Math.floor(d/256),a[1]=d%256,d=Math.floor(d/256),a[0]=d,a}getPixels(){return new xr({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=n*this.dim,d=n*this.dim+this.dim,m=a*this.dim,_=a*this.dim+this.dim;switch(n){case-1:u=d-1;break;case 1:d=u+1}switch(a){case-1:m=_-1;break;case 1:_=m+1}const b=-n*this.dim,w=-a*this.dim;for(let S=m;S<_;S++)for(let I=u;I<d;I++){const P=4*this._idx(I,S),L=4*this._idx(I+b,S+w);this.pixels[P+0]=e.pixels[L+0],this.pixels[P+1]=e.pixels[L+1],this.pixels[P+2]=e.pixels[L+2],this.pixels[P+3]=e.pixels[L+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Bt(yp,"DEMData"),Bt(a1,"DemMinMaxQuadTree",{omit:["dem"]});class DA{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,a){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const d={value:n,timeout:void 0};if(a!==void 0&&(d.timeout=setTimeout(()=>{this.remove(e,d)},a)),this.data[u].push(d),this.order.push(u),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const a=e.wrapped().key,u=n===void 0?0:this.data[a].indexOf(n),d=this.data[a][u];return this.data[a].splice(u,1),d.timeout&&clearTimeout(d.timeout),this.data[a].length===0&&delete this.data[a],this.onRemove(d.value),this.order.splice(this.order.indexOf(a),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const a in this.data)for(const u of this.data[a])e(u.value)||n.push(u);for(const a of n)this.remove(a.value.tileID,a)}}class Rc{constructor(e,n,a){this.func=e,this.mask=n,this.range=a}}Rc.ReadOnly=!1,Rc.ReadWrite=!0,Rc.disabled=new Rc(519,Rc.ReadOnly,[0,1]);const e_=7680;class t_{constructor(e,n,a,u,d,m){this.test=e,this.ref=n,this.mask=a,this.fail=u,this.depthFail=d,this.pass=m}}t_.disabled=new t_({func:519,mask:0},0,0,e_,e_,e_);class ko{constructor(e,n,a){this.blendFunction=e,this.blendColor=n,this.mask=a}}ko.Replace=[1,0],ko.disabled=new ko(ko.Replace,Un.transparent,[!1,!1,!1,!1]),ko.unblended=new ko(ko.Replace,Un.transparent,[!0,!0,!0,!0]),ko.alphaBlended=new ko([1,771],Un.transparent,[!0,!0,!0,!0]);const n_=1029,i_=2305;class ao{constructor(e,n,a){this.enable=e,this.mode=n,this.frontFace=a}}ao.disabled=new ao(!1,n_,i_),ao.backCCW=new ao(!0,n_,i_),ao.backCW=new ao(!0,n_,2304),ao.frontCW=new ao(!0,1028,2304),ao.frontCCW=new ao(!0,1028,i_);class ll extends Wt{constructor(e,n,a){super(),this.id=e,this._onlySymbols=a,n.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new DA(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new kA,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const n in this._tiles){const a=this._tiles[n];this._source.prepareTile(a)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,a.tileID),a.upload(e),a.prepare(this.map.style.imageManager)}else for(const n in this._tiles){const a=this._tiles[n];a.upload(e),a.prepare(this.map.style.imageManager)}}getIds(){return We(this._tiles).map(e=>e.tileID).sort(u1).map(e=>e.key)}getRenderableIds(e){const n=[];for(const a in this._tiles)this._isIdRenderable(+a,e)&&n.push(this._tiles[a]);return e?n.sort((a,u)=>{const d=a.tileID,m=u.tileID,_=new D(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),b=new D(m.canonical.x,m.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-m.overscaledZ||b.y-_.y||b.x-_.x}).map(a=>a.tileID.key):n.map(a=>a.tileID).sort(u1).map(a=>a.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){const a=this._tiles[e];a&&(a.state!=="loading"&&(a.state=n),this._loadTile(a,this._tileLoaded.bind(this,a,e,n)))}_tileLoaded(e,n,a,u){if(u)if(e.state="errored",u.status!==404)this._source.fire(new jn(u,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const d=this.map.painter.terrain;this.update(this.transform,d.getScaledDemTileSize(),!0),d.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=wt.now(),a==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Gn("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const n=this.getRenderableIds();for(let u=0;u<n.length;u++){const d=n[u];if(e.neighboringTiles&&e.neighboringTiles[d]){const m=this.getTileByID(d);a(e,m),a(m,e)}}function a(u,d){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let m=d.tileID.canonical.x-u.tileID.canonical.x;const _=d.tileID.canonical.y-u.tileID.canonical.y,b=Math.pow(2,u.tileID.canonical.z),w=d.tileID.key;m===0&&_===0||Math.abs(_)>1||(Math.abs(m)>1&&(Math.abs(m+b)===1?m+=b:Math.abs(m-b)===1&&(m-=b)),d.dem&&u.dem&&(u.dem.backfillBorder(d.dem,m,_),u.neighboringTiles&&u.neighboringTiles[w]&&(u.neighboringTiles[w].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,a,u){for(const d in this._tiles){let m=this._tiles[d];if(u[d]||!m.hasData()||m.tileID.overscaledZ<=n||m.tileID.overscaledZ>a)continue;let _=m.tileID;for(;m&&m.tileID.overscaledZ>n+1;){const w=m.tileID.scaledTo(m.tileID.overscaledZ-1);m=this._tiles[w.key],m&&m.hasData()&&(_=w)}let b=_;for(;b.overscaledZ>n;)if(b=b.scaledTo(b.overscaledZ-1),e[b.key]){u[_.key]=_;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const a=this._loadedParentTiles[e.key];return a&&a.tileID.overscaledZ>=n?a:null}for(let a=e.overscaledZ-1;a>=n;a--){const u=e.scaledTo(a),d=this._getLoadedTile(u);if(d)return d}}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;const a=Math.ceil(e.width/n)+1,u=Math.ceil(e.height/n)+1,d=Math.floor(a*u*5),m=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,d):d,_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(_)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const a={};for(const u in this._tiles){const d=this._tiles[u];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+n),a[d.tileID.key]=d}this._tiles=a;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,n,a){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!a)return;let u;this.updateCacheSize(e,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(_=>new nr(_.canonical.z,_.wrap,_.canonical.z,_.canonical.x,_.canonical.y)):(u=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!a,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(_=>this._source.hasTile(_)))):u=[];const d=this._updateRetainedTiles(u);if(h1(this._source.type)&&u.length!==0){const _={},b={},w=Object.keys(d);for(const I of w){const P=d[I],L=this._tiles[I];if(!L||L.fadeEndTime&&L.fadeEndTime<=wt.now())continue;const B=this.findLoadedParent(P,Math.max(P.overscaledZ-ll.maxOverzooming,this._source.minzoom));B&&(this._addTile(B.tileID),_[B.tileID.key]=B.tileID),b[I]=P}const S=u[u.length-1].overscaledZ;for(const I in this._tiles){const P=this._tiles[I];if(d[I]||!P.hasData())continue;let L=P.tileID;for(;L.overscaledZ>S;){L=L.scaledTo(L.overscaledZ-1);const B=this._tiles[L.key];if(B&&B.hasData()&&b[L.key]){d[I]=P.tileID;break}}}for(const I in _)d[I]||(this._coveredTiles[I]=!0,d[I]=_[I])}for(const _ in d)this._tiles[_].clearFadeHold();const m=function(_,b){const w=[];for(const S in _)S in b||w.push(S);return w}(this._tiles,d);for(const _ of m){const b=this._tiles[_];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(+_)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const n={};if(e.length===0)return n;const a={},u=e.reduce((w,S)=>Math.min(w,S.overscaledZ),1/0),d=e[0].overscaledZ,m=Math.max(d-ll.maxOverzooming,this._source.minzoom),_=Math.max(d+ll.maxUnderzooming,this._source.minzoom),b={};for(const w of e){const S=this._addTile(w);n[w.key]=w,S.hasData()||u<this._source.maxzoom&&(b[w.key]=w)}this._retainLoadedChildren(b,u,_,n);for(const w of e){let S=this._tiles[w.key];if(S.hasData())continue;if(w.canonical.z>=this._source.maxzoom){const P=w.children(this._source.maxzoom)[0],L=this.getTile(P);if(L&&L.hasData()){n[P.key]=P;continue}}else{const P=w.children(this._source.maxzoom);if(n[P[0].key]&&n[P[1].key]&&n[P[2].key]&&n[P[3].key])continue}let I=S.wasRequested();for(let P=w.overscaledZ-1;P>=m;--P){const L=w.scaledTo(P);if(a[L.key]||(a[L.key]=!0,S=this.getTile(L),!S&&I&&(S=this._addTile(L)),S&&(n[L.key]=L,I=S.wasRequested(),S.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let a,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){a=this._loadedParentTiles[u.key];break}n.push(u.key);const d=u.scaledTo(u.overscaledZ-1);if(a=this._getLoadedTile(d),a)break;u=d}for(const d of n)this._loadedParentTiles[d]=a}}_addTile(e){let n=this._tiles[e.key];if(n)return this._source.prepareTile&&this._source.prepareTile(n),n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const a=Boolean(n);if(!a){const u=this.map?this.map.painter:null;n=new Qg(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._source.prepareTile&&this._source.prepareTile(n)||this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,a||this._source.fire(new Gn("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const a=n.getExpiryTimeout();a&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},a))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,n,a){const u=[],d=this.transform;if(!d)return u;const m=d.projection.name==="globe",_=So(d.center.lng);for(const b in this._tiles){const w=this._tiles[b];if(a&&w.clearQueryDebugViz(),w.holdingForFade())continue;let S;if(m){const I=w.tileID.canonical;if(I.z===0){const P=[Math.abs(Pe(_,...Vh(I,-1))-_),Math.abs(Pe(_,...Vh(I,1))-_)];S=[0,2*P.indexOf(Math.min(...P))-1]}else{const P=[Math.abs(Pe(_,...Vh(I,-1))-_),Math.abs(Pe(_,...Vh(I,0))-_),Math.abs(Pe(_,...Vh(I,1))-_)];S=[P.indexOf(Math.min(...P))-1]}}else S=[0];for(const I of S){const P=e.containsTile(w,d,n,I);P&&u.push(P)}}return u}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(a=>this._tiles[a].tileID);for(const a of n)a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(h1(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=wt.now())return!0}return!1}setFeatureState(e,n,a){this._state.updateState(e=e||"_geojsonTileLayer",n,a)}removeFeatureState(e,n,a){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,a)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,a){const u=this._tiles[e];u&&u.setDependencies(n,a)}reloadTilesForDependencies(e,n){for(const a in this._tiles)this._tiles[a].hasDependency(e,n)&&this._reloadTile(+a,"reloading");this._cache.filter(a=>!a.hasDependency(e,n))}_preloadTiles(e,n){const a=new Map,u=Array.isArray(e)?e:[e],d=this.map.painter.terrain,m=this.usedForTerrain&&d?d.getScaledDemTileSize():this._source.tileSize;for(const _ of u){const b=_.coveringTiles({tileSize:m,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const w of b)a.set(w.key,w);this.usedForTerrain&&_.updateElevation(!1)}ke(Array.from(a.values()),(_,b)=>{const w=new Qg(_,this._source.tileSize*_.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(w,S=>{this._source.type==="raster-dem"&&w.dem&&this._backfillDEM(w),b(S,w)})},n)}}function u1(i,e){const n=Math.abs(2*i.wrap)-+(i.wrap<0),a=Math.abs(2*e.wrap)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||a-n||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}function h1(i){return i==="raster"||i==="image"||i==="video"}function Vh(i,e){const n=1<<i.z;return[i.x/n+e,(i.x+1)/n+e]}ll.maxOverzooming=10,ll.maxUnderzooming=3;class vp{constructor(e,n,a){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=a}static create(e,n,a){const u=a||e.findDEMTileFor(n);if(!u||!u.dem)return;const d=u.dem,m=u.tileID,_=1<<n.canonical.z-m.canonical.z;return new vp(u,u.tileSize/Qt/_,[(n.canonical.x/_-m.canonical.x)*d.dim,(n.canonical.y/_-m.canonical.y)*d.dim])}tileCoordToPixel(e,n){const a=n*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),d=Math.floor(a);return new D(u,d)}getElevationAt(e,n,a,u){const d=e*this._scale+this._offset[0],m=n*this._scale+this._offset[1],_=Math.floor(d),b=Math.floor(m),w=this._dem;return u=!!u,a?Mn(Mn(w.get(_,b,u),w.get(_,b+1,u),m-b),Mn(w.get(_+1,b,u),w.get(_+1,b+1,u),m-b),d-_):w.get(_,b,u)}getElevationAtPixel(e,n,a){return this._dem.get(e,n,!!a)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*jr(1,e)*this._dem.stride}}class f1{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Vs(Qt,16,0),this.featureIndexArray=new t0,this.promoteId=n}insert(e,n,a,u,d,m=0){const _=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,u,d,m);const b=this.grid;for(let w=0;w<n.length;w++){const S=n[w],I=[1/0,1/0,-1/0,-1/0];for(let P=0;P<S.length;P++){const L=S[P];I[0]=Math.min(I[0],L.x),I[1]=Math.min(I[1],L.y),I[2]=Math.max(I[2],L.x),I[3]=Math.max(I[3],L.y)}I[0]<Qt&&I[1]<Qt&&I[2]>=0&&I[3]>=0&&b.insert(_,I[0],I[1],I[2],I[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new sl.VectorTile(new Ph(this.rawTileData)).layers,this.sourceLayerCoder=new Yx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,a,u){this.loadVTLayers();const d=e.params||{},m=Za(d.filter),_=e.tileResult,b=e.transform,w=_.bufferedTilespaceBounds,S=this.grid.query(w.min.x,w.min.y,w.max.x,w.max.y,(B,V,Z,Q)=>x0(_.bufferedTilespaceGeometry,B,V,Z,Q));S.sort(LA);let I=null;b.elevation&&S.length>0&&(I=vp.create(b.elevation,this.tileID));const P={};let L;for(let B=0;B<S.length;B++){const V=S[B];if(V===L)continue;L=V;const Z=this.featureIndexArray.get(V);let Q=null;this.loadMatchingFeature(P,Z,m,d.layers,d.availableImages,n,a,u,(ce,ne,ae,me=0)=>(Q||(Q=ss(ce,this.tileID.canonical,e.tileTransform)),ne.queryIntersectsFeature(_,ce,ae,Q,this.z,e.transform,e.pixelPosMatrix,I,me)))}return P}loadMatchingFeature(e,n,a,u,d,m,_,b,w){const{featureIndex:S,bucketIndex:I,sourceLayerIndex:P,layoutVertexArrayOffset:L}=n,B=this.bucketLayerIDs[I];if(u&&!function(ce,ne){for(let ae=0;ae<ce.length;ae++)if(ne.indexOf(ce[ae])>=0)return!0;return!1}(u,B))return;const V=this.sourceLayerCoder.decode(P),Z=this.vtLayers[V].feature(S);if(a.needGeometry){const ce=tl(Z,!0);if(!a.filter(new H(this.tileID.overscaledZ),ce,this.tileID.canonical))return}else if(!a.filter(new H(this.tileID.overscaledZ),Z))return;const Q=this.getId(Z,V);for(let ce=0;ce<B.length;ce++){const ne=B[ce];if(u&&u.indexOf(ne)<0)continue;const ae=m[ne];if(!ae)continue;let me={};Q!==void 0&&b&&(me=b.getState(ae.sourceLayer||"_geojsonTileLayer",Q));const ue=ct({},_[ne]);ue.paint=d1(ue.paint,ae.paint,Z,me,d),ue.layout=d1(ue.layout,ae.layout,Z,me,d);const Re=!w||w(Z,ae,me,L);if(!Re)continue;const De=new Jx(Z,this.z,this.x,this.y,Q);De.layer=ue;let Ze=e[ne];Ze===void 0&&(Ze=e[ne]=[]),Ze.push({featureIndex:S,feature:De,intersectionZ:Re})}}lookupSymbolFeatures(e,n,a,u,d,m,_,b){const w={};this.loadVTLayers();const S=Za(d);for(const I of e)this.loadMatchingFeature(w,{bucketIndex:a,sourceLayerIndex:u,featureIndex:I,layoutVertexArrayOffset:0},S,m,_,b,n);return w}loadFeature(e){const{featureIndex:n,sourceLayerIndex:a}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(a),d=this.vtFeatures[u];if(d[n])return d[n];const m=this.vtLayers[u].feature(n);return d[n]=m,m}hasLayer(e){for(const n of this.bucketLayerIDs)for(const a of n)if(e===a)return!0;return!1}getId(e,n){let a=e.id;return this.promoteId&&(a=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof a=="boolean"&&(a=Number(a))),a}}function d1(i,e,n,a,u){return ht(i,(d,m)=>{const _=e instanceof de?e.get(m):null;return _&&_.evaluate?_.evaluate(n,a,u):_})}function LA(i,e){return e-i}Bt(f1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class p1{constructor(e){const n={},a=[];for(const _ in e){const b=e[_],w=n[_]={};for(const S in b.glyphs){const I=b.glyphs[+S];if(!I||I.bitmap.width===0||I.bitmap.height===0)continue;const P=I.metrics.localGlyph?2:1,L={x:0,y:0,w:I.bitmap.width+2*P,h:I.bitmap.height+2*P};a.push(L),w[S]=L}}const{w:u,h:d}=Lg(a),m=new as({width:u||1,height:d||1});for(const _ in e){const b=e[_];for(const w in b.glyphs){const S=b.glyphs[+w];if(!S||S.bitmap.width===0||S.bitmap.height===0)continue;const I=n[_][w],P=S.metrics.localGlyph?2:1;as.copy(S.bitmap,m,{x:0,y:0},{x:I.x+P,y:I.y+P},S.bitmap)}}this.image=m,this.positions=n}}Bt(p1,"GlyphAtlas");class RA{constructor(e){this.tileID=new nr(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=al(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,n,a,u,d){this.status="parsing",this.data=e,this.collisionBoxArray=new Co;const m=new Yx(Object.keys(e.layers).sort()),_=new f1(this.tileID,this.promoteId);_.bucketLayerIDs=[];const b={},w=new Jg(256,256),S={featureIndex:_,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:w,availableImages:a},I=n.familiesBySource[this.source];for(const me in I){const ue=e.layers[me];if(!ue)continue;let Re=!1,De=!1;for(const Fe of I[me])Fe[0].type==="symbol"?Re=!0:De=!0;if(this.isSymbolTile===!0&&!Re||this.isSymbolTile===!1&&!De)continue;ue.version===1&&Lt(`Vector tile source "${this.source}" layer "${me}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ze=m.encode(me),_t=[];for(let Fe=0;Fe<ue.length;Fe++){const Ke=ue.feature(Fe),nt=_.getId(Ke,me);_t.push({feature:Ke,id:nt,index:Fe,sourceLayerIndex:Ze})}for(const Fe of I[me]){const Ke=Fe[0];this.isSymbolTile!==void 0&&Ke.type==="symbol"!==this.isSymbolTile||Ke.minzoom&&this.zoom<Math.floor(Ke.minzoom)||Ke.maxzoom&&this.zoom>=Ke.maxzoom||Ke.visibility!=="none"&&(r_(Fe,this.zoom,a),(b[Ke.id]=Ke.createBucket({index:_.bucketLayerIDs.length,layers:Fe,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ze,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:a})).populate(_t,S,this.tileID.canonical,this.tileTransform),_.bucketLayerIDs.push(Fe.map(nt=>nt.id)))}}let P,L,B,V;w.trim();const Z={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Q=ht(S.glyphDependencies,me=>Object.keys(me).map(Number));Object.keys(Q).length?u.send("getGlyphs",{uid:this.uid,stacks:Q},(me,ue)=>{P||(P=me,L=ue,ae.call(this))},void 0,!1,Z):L={};const ce=Object.keys(S.iconDependencies);ce.length?u.send("getImages",{icons:ce,source:this.source,tileID:this.tileID,type:"icons"},(me,ue)=>{P||(P=me,B=ue,ae.call(this))},void 0,!1,Z):B={};const ne=Object.keys(S.patternDependencies);function ae(){if(P)return d(P);if(L&&B&&V){const me=new p1(L),ue=new mx(B,V);for(const Re in b){const De=b[Re];De instanceof Ks?(r_(De.layers,this.zoom,a),rA(De,L,me.positions,B,ue.iconPositions,this.showCollisionBoxes,a,this.tileID.canonical,this.tileZoom,this.projection)):De.hasPattern&&(De instanceof ep||De instanceof Kd||De instanceof Sh)&&(r_(De.layers,this.zoom,a),De.addFeatures(S,this.tileID.canonical,ue.patternPositions,a,this.tileTransform))}this.status="done",d(null,{buckets:We(b).filter(Re=>!Re.isEmpty()),featureIndex:_,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:me.image,lineAtlas:w,imageAtlas:ue,glyphMap:this.returnDependencies?L:null,iconMap:this.returnDependencies?B:null,glyphPositions:this.returnDependencies?me.positions:null})}}ne.length?u.send("getImages",{icons:ne,source:this.source,tileID:this.tileID,type:"patterns"},(me,ue)=>{P||(P=me,V=ue,ae.call(this))},void 0,!1,Z):V={},ae.call(this)}}function r_(i,e,n){const a=new H(e);for(const u of i)u.recalculate(a,n)}class m1{constructor(e){this.entries={},this.scheduler=e}request(e,n,a,u){const d=this.entries[e]=this.entries[e]||{callbacks:[]};if(d.result){const[m,_]=d.result;return this.scheduler?this.scheduler.add(()=>{u(m,_)},n):u(m,_),()=>{}}return d.callbacks.push(u),d.cancel||(d.cancel=a((m,_)=>{d.result=[m,_];for(const b of d.callbacks)this.scheduler?this.scheduler.add(()=>{b(m,_)},n):b(m,_);setTimeout(()=>delete this.entries[e],3e3)})),()=>{d.result||(d.callbacks=d.callbacks.filter(m=>m!==u),d.callbacks.length||(d.cancel(),delete this.entries[e]))}}}function g1(i,e,n){const a=JSON.stringify(i.request);return i.data&&(this.deduped.entries[a]={result:[null,i.data]}),this.deduped.request(a,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},u=>{const d=Ie(i.request,(m,_,b,w)=>{m?u(m):_&&u(null,{vectorTile:n?void 0:new sl.VectorTile(new Ph(_)),rawData:_,cacheControl:b,expires:w})});return()=>{d.cancel(),u()}},e)}s.ARRAY_TYPE=vr,s.AUTH_ERR_MSG=yn,s.Aabb=cr,s.Actor=class{constructor(i,e,n){this.target=i,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},rt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=be()?i:A,this.scheduler=new zA}send(i,e,n,a,u=!1,d){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=d,this.callbacks[m]=n);const _=bt(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:i,hasCallback:!!n,targetMapId:a,mustQueue:u,sourceMapId:this.mapId,data:$s(e,_)},_),{cancel:()=>{n&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(i){const e=i.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const a=this.cancelCallbacks[n];delete this.cancelCallbacks[n],a&&a.cancel()}else if(e.mustQueue||be()){const a=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),a&&a.metadata||{type:"message"})}else this.processTask(n,e)}processTask(i,e){if(e.type==="<response>"){const n=this.callbacks[i];delete this.callbacks[i],n&&(e.error?n(Ha(e.error)):n(null,Ha(e.data)))}else{const n=bt(this.globalScope)?void 0:[],a=e.hasCallback?(d,m)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:d?$s(d):null,data:$s(m,n)},n)}:d=>{},u=Ha(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,a);else if(this.parent.getWorkerSource){const d=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,d[0],u.source)[d[1]](u,a)}else a(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=Jd,s.Color=Un,s.ColorMode=ko,s.CullFaceMode=ao,s.DEMData=yp,s.DataConstantProperty=he,s.DedupedRequest=m1,s.DepthMode=Rc,s.EXTENT=Qt,s.Elevation=class{isDataAvailableAtPoint(i){const e=this._source();if(!e||i.y<0||i.y>1)return!1;const n=e.getSource().maxzoom,a=1<<n,u=Math.floor(i.x),d=Math.floor((i.x-u)*a),m=Math.floor(i.y*a),_=this.findDEMTileFor(new nr(n,u,n,d,m));return!(!_||!_.dem)}getAtPointOrZero(i,e=0){return this.getAtPoint(i,e)||0}getAtPoint(i,e,n=!0){e==null&&(e=null);const a=this._source();if(!a||i.y<0||i.y>1)return e;const u=a.getSource().maxzoom,d=1<<u,m=Math.floor(i.x),_=i.x-m,b=new nr(u,m,u,Math.floor(_*d),Math.floor(i.y*d)),w=this.findDEMTileFor(b);if(!w||!w.dem)return e;const S=w.dem,I=1<<w.tileID.canonical.z,P=(_*I-w.tileID.canonical.x)*S.dim,L=(i.y*I-w.tileID.canonical.y)*S.dim,B=Math.floor(P),V=Math.floor(L);return(n?this.exaggeration():1)*Mn(Mn(S.get(B,V),S.get(B,V+1),L-V),Mn(S.get(B+1,V),S.get(B+1,V+1),L-V),P-B)}getAtTileOffset(i,e,n){const a=1<<i.canonical.z;return this.getAtPointOrZero(new bc(i.wrap+(i.canonical.x+e/Qt)/a,(i.canonical.y+n/Qt)/a))}getAtTileOffsetFunc(i,e,n,a){return u=>{const d=this.getAtTileOffset(i,u.x,u.y),m=a.upVector(i.canonical,u.x,u.y);return io(m,m,d*a.upVectorScale(i.canonical,e,n).metersToTile),m}}getForTilePoints(i,e,n,a){const u=vp.create(this,i,a);return!!u&&(e.forEach(d=>{d[2]=this.exaggeration()*u.getElevationAt(d[0],d[1],n)}),!0)}getMinMaxForTile(i){const e=this.findDEMTileFor(i);if(!e||!e.dem)return null;const n=e.dem.tree,a=e.tileID,u=1<<i.canonical.z-a.canonical.z;let d=i.canonical.x/u-a.canonical.x,m=i.canonical.y/u-a.canonical.y,_=0;for(let b=0;b<i.canonical.z-a.canonical.z&&!n.leaves[_];b++){d*=2,m*=2;const w=2*Math.floor(m)+Math.floor(d);_=n.childOffsets[_]+w,d%=1,m%=1}return{min:this.exaggeration()*n.minimums[_],max:this.exaggeration()*n.maximums[_]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=jn,s.EvaluationParameters=H,s.Event=Gn,s.Evented=Wt,s.FillExtrusionBucket=Sh,s.Frustum=Eg,s.FrustumCorners=Tg,s.GLOBE_METERS_TO_ECEF=Gg,s.GLOBE_RADIUS=us,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=6,s.GLOBE_ZOOM_THRESHOLD_MIN=5,s.GlobeSharedBuffers=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const i of this._wireframeSegments)i.destroy()}}_createGrid(i){const e=new At,n=new gn,a=65;for(let u=0;u<a;u++)for(let d=0;d<a;d++)e.emplaceBack(d,u);this._gridSegments=[];for(let u=0,d=0;u<kc.length;u++){const m=kc[u];for(let b=0;b<m;b++)for(let w=0;w<64;w++){const S=b*a+w;n.emplaceBack(S+1,S,S+a),n.emplaceBack(S+a,S+a+1,S+1)}const _=64*m*2;this._gridSegments.push(xi.simpleSegment(0,d,(m+1)*a,_)),d+=_}this._gridBuffer=i.createVertexBuffer(e,kh.members),this._gridIndexBuffer=i.createIndexBuffer(n,!0)}_createPoles(i){const e=new gn;for(let u=0;u<=64;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=i.createIndexBuffer(e,!0);const n=new Fi,a=new Fi;this._poleSegments=[];for(let u=0,d=0;u<5;u++){const m=360/(1<<u);n.emplaceBack(0,-us,0,.5,0),a.emplaceBack(0,-us,0,.5,1);for(let _=0;_<=64;_++){const b=_/64,w=Mn(0,m,b),[S,I,P]=Dc(hA,fA,w,us);n.emplaceBack(S,I,P,b,0),a.emplaceBack(S,I,P,b,1)}this._poleSegments.push(xi.simpleSegment(d,0,66,64)),d+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(n,Lx,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(a,Lx,!1)}getGridBuffers(i){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[i]]}getPoleBuffers(i){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}getWirefameBuffers(i,e){if(!this._wireframeSegments){const n=new qi,a=64,u=a+1;this._wireframeSegments=[];for(let d=0,m=0;d<kc.length;d++){const _=kc[d];for(let w=0;w<_;w++)for(let S=0;S<a;S++){const I=w*u+S;n.emplaceBack(I,I+1),n.emplaceBack(I,I+u),n.emplaceBack(I,I+u+1)}const b=_*a*3;this._wireframeSegments.push(xi.simpleSegment(0,m,(_+1)*u,b)),m+=b}this._wireframeIndexBuffer=i.createIndexBuffer(n)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},s.GlyphManager=zc,s.ImagePosition=Rg,s.LineAtlas=Jg,s.LngLat=Ln,s.LngLatBounds=qs,s.LocalGlyphMode=Ng,s.MAX_MERCATOR_LATITUDE=Mo,s.MercatorCoordinate=bc,s.ONE_EM=Ni,s.OverscaledTileID=nr,s.Properties=He,s.RGBAImage=xr,s.Ray=wg,s.RequestManager=class{constructor(i,e,n){this._transformRequestFn=i,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const i=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Pn,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,e){return this._transformRequestFn&&this._transformRequestFn(i,e)||{url:i}}normalizeStyleURL(i,e){if(!Nn(i))return i;const n=Di(i);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(i,e){if(!Nn(i))return i;const n=Di(i);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(i,e,n,a){if(!Nn(i))return i;const u=Di(i);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),n&&u.params.push(`language=${n}`),a&&u.params.push(`worldview=${a}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(i,e,n,a){const u=Di(i);return Nn(i)?(u.path=`/styles/v1${u.path}/sprite${e}${n}`,this._makeAPIURL(u,this._customAccessToken||a)):(u.path+=`${e}${n}`,Gi(u))}normalizeTileURL(i,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!Nn(i))return i;const a=Di(i);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&a.authority!=="raster"&&n===512?"@2x":""}${dt.supported?".webp":"$1"}`),a.authority==="raster"?a.path=`/${Qe.RASTER_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${Qe.TILE_URL_VERSION}${a.path}`);const u=this._customAccessToken||function(d){for(const m of d){const _=m.match(/^access_token=(.*)$/);if(_)return _[1]}return null}(a.params)||Qe.ACCESS_TOKEN;return Qe.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,u)}canonicalizeTileURL(i,e){const n=Di(i);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return i;let a="mapbox://";n.path.match(/^\/raster\/v1\//)?a+=`raster/${n.path.replace(`/${Qe.RASTER_URL_PREFIX}/`,"")}`:a+=`tiles/${n.path.replace(`/${Qe.TILE_URL_VERSION}/`,"")}`;let u=n.params;return e&&(u=u.filter(d=>!d.match(/^access_token=/))),u.length&&(a+=`?${u.join("&")}`),a}canonicalizeTileset(i,e){const n=!!e&&Nn(e),a=[];for(const u of i.tiles||[])bi(u)?a.push(this.canonicalizeTileURL(u,n)):a.push(u);return a}_makeAPIURL(i,e){const n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",a=Di(Qe.API_URL);if(i.protocol=a.protocol,i.authority=a.authority,i.protocol==="http"){const u=i.params.indexOf("secure");u>=0&&i.params.splice(u,1)}if(a.path!=="/"&&(i.path=`${a.path}${i.path}`),!Qe.REQUIRE_ACCESS_TOKEN)return Gi(i);if(e=e||Qe.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return i.params=i.params.filter(u=>u.indexOf("access_token")===-1),i.params.push(`access_token=${e||""}`),Gi(i)}},s.ResourceType=ge,s.SegmentVector=xi,s.SourceCache=ll,s.StencilMode=t_,s.StructArrayLayout1ui2=Qo,s.StructArrayLayout2f1f2i16=eo,s.StructArrayLayout2i4=At,s.StructArrayLayout2ui4=qi,s.StructArrayLayout3f12=ni,s.StructArrayLayout3ui6=gn,s.StructArrayLayout4i8=Zt,s.StructArrayLayout5f20=Fi,s.Texture=Uh,s.Tile=Qg,s.Transitionable=te,s.Uniform1f=Bd,s.Uniform1i=class extends is{constructor(i){super(i),this.current=0}set(i,e,n){this.fetchUniformLocation(i,e)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},s.Uniform2f=class extends is{constructor(i){super(i),this.current=[0,0]}set(i,e,n){this.fetchUniformLocation(i,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}},s.Uniform3f=class extends is{constructor(i){super(i),this.current=[0,0,0]}set(i,e,n){this.fetchUniformLocation(i,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}},s.Uniform4f=l0,s.UniformColor=c0,s.UniformMatrix2f=class extends is{constructor(i){super(i),this.current=vS}set(i,e,n){if(this.fetchUniformLocation(i,e)){for(let a=0;a<4;a++)if(n[a]!==this.current[a]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}}},s.UniformMatrix3f=class extends is{constructor(i){super(i),this.current=yS}set(i,e,n){if(this.fetchUniformLocation(i,e)){for(let a=0;a<9;a++)if(n[a]!==this.current[a]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}}},s.UniformMatrix4f=class extends is{constructor(i){super(i),this.current=_S}set(i,e,n){if(this.fetchUniformLocation(i,e)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let a=1;a<16;a++)if(n[a]!==this.current[a]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}},s.UnwrappedTileID=nx,s.ValidationError=kt,s.VectorTileWorkerSource=class extends Wt{constructor(i,e,n,a,u){super(),this.actor=i,this.layerIndex=e,this.availableImages=n,this.loadVectorData=u||g1,this.loading={},this.loaded={},this.deduped=new m1(i.scheduler),this.isSpriteLoaded=a,this.scheduler=i.scheduler}loadTile(i,e){const n=i.uid,a=i&&i.request,u=a&&a.collectResourceTiming,d=this.loading[n]=new RA(i);d.abort=this.loadVectorData(i,(m,_)=>{const b=!this.loading[n];if(delete this.loading[n],b||m||!_)return d.status="done",b||(this.loaded[n]=d),e(m);const w=_.rawData,S={};_.expires&&(S.expires=_.expires),_.cacheControl&&(S.cacheControl=_.cacheControl),d.vectorTile=_.vectorTile||new sl.VectorTile(new Ph(w));const I=()=>{d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,(P,L)=>{if(P||!L)return e(P);const B={};if(u){const V=ie(a);V.length>0&&(B.resourceTiming=JSON.parse(JSON.stringify(V)))}e(null,ct({rawTileData:w.slice(0)},L,S,B))})};this.isSpriteLoaded?I():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(I,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):I()}),this.loaded=this.loaded||{},this.loaded[n]=d})}reloadTile(i,e){const n=this.loaded,a=i.uid,u=this;if(n&&n[a]){const d=n[a];d.showCollisionBoxes=i.showCollisionBoxes,d.enableTerrain=!!i.enableTerrain,d.projection=i.projection,d.tileTransform=al(i.tileID.canonical,i.projection);const m=(_,b)=>{const w=d.reloadCallback;w&&(delete d.reloadCallback,d.parse(d.vectorTile,u.layerIndex,this.availableImages,u.actor,w)),e(_,b)};d.status==="parsing"?d.reloadCallback=m:d.status==="done"&&(d.vectorTile?d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,m):m())}}abortTile(i,e){const n=i.uid,a=this.loading[n];a&&(a.abort&&a.abort(),delete this.loading[n]),e()}removeTile(i,e){const n=this.loaded,a=i.uid;n&&n[a]&&delete n[a],e()}},s.WritingMode=kr,s.ZoomHistory=wd,s.add=Ws,s.addDynamicAttributes=mp,s.adjoint=function(i,e){var n=e[0],a=e[1],u=e[2],d=e[3],m=e[4],_=e[5],b=e[6],w=e[7],S=e[8];return i[0]=m*S-_*w,i[1]=u*w-a*S,i[2]=a*_-u*m,i[3]=_*b-d*S,i[4]=n*S-u*b,i[5]=u*d-n*_,i[6]=d*w-m*b,i[7]=a*b-n*w,i[8]=n*m-a*d,i},s.asyncAll=ke,s.bezier=Ue,s.bindAll=rt,s.boundsAttributes=e1,s.bufferConvexPolygon=function(i,e){const n=[];for(let a=0;a<i.length;a++){const u=Le(a-1,-1,i.length-1),d=Le(a+1,-1,i.length-1),m=i[a],_=i[d],b=i[u].sub(m).unit(),w=_.sub(m).unit(),S=w.angleWithSep(b.x,b.y),I=b.add(w).unit().mult(-1*e/Math.sin(S/2));n.push(m.add(I))}return n},s.cacheEntryPossiblyAdded=function(i){re++,re>jl&&(i.getActor().send("enforceCacheSizeLimit",Ss),re=0)},s.calculateGlobeLabelMatrix=function(i,e){const{x:n,y:a}=i.point,u=Ux(n,a,i.worldSize/i._pixelsPerMercatorPixel,0,0);return Tc(u,u,Wg(Po(e)))},s.calculateGlobeMatrix=function(i){const{x:e,y:n}=i.point,{lng:a,lat:u}=i._center;return Ux(e,n,i.worldSize,a,u)},s.calculateGlobeMercatorMatrix=function(i){const e=i.pixelsPerMeter,n=e/jr(1,i.center.lat),a=Ao(new Float64Array(16));return _h(a,a,[i.point.x,i.point.y,0]),il(a,a,[n,n,e]),Float32Array.from(a)},s.circumferenceAtLatitude=lg,s.clamp=Pe,s.clearTileCache=function(i){const e=ee(),n=[];for(const a in Ji)e&&n.push(e.delete(a)),delete Ji[a];i&&Promise.all(n).catch(i).then(()=>i())},s.clipLine=Mx,s.clone=function(i){var e=new vr(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},s.clone$1=ln,s.collisionCircleLayout=PM,s.config=Qe,s.conjugate=function(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i},s.create=function(){var i=new vr(16);return vr!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},s.create$1=T0,s.createExpression=Bs,s.createLayout=Je,s.createStyleLayer=function(i){return i.type==="custom"?new MA(i):new IA[i.type](i)},s.cross=bg,s.degToRad=se,s.distance=function(i,e){return Math.hypot(e[0]-i[0],e[1]-i[1],e[2]-i[2])},s.div=function(i,e,n){return i[0]=e[0]/n[0],i[1]=e[1]/n[1],i[2]=e[2]/n[2],i},s.dot=Ur,s.ease=Be,s.easeCubicInOut=Te,s.emitValidationErrors=oh,s.endsWith=at,s.enforceCacheSizeLimit=function(i){for(const e in Ji)j(e),Ji[e].then(n=>{n.keys().then(a=>{for(let u=0;u<a.length-i;u++)n.delete(a[u])})})},s.evaluateSizeForFeature=tp,s.evaluateSizeForZoom=Mc,s.evaluateVariableOffset=Ox,s.evented=N,s.exactEquals=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]},s.exactEquals$1=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]},s.exported=wt,s.exported$1=dt,s.extend=ct,s.extend$1=sr,s.fillExtrusionHeightLift=Q0,s.filterObject=Ft,s.fromMat4=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i},s.fromQuat=function(i,e){var n=e[0],a=e[1],u=e[2],d=e[3],m=n+n,_=a+a,b=u+u,w=n*m,S=a*m,I=a*_,P=u*m,L=u*_,B=u*b,V=d*m,Z=d*_,Q=d*b;return i[0]=1-I-B,i[1]=S+Q,i[2]=P-Z,i[3]=0,i[4]=S-Q,i[5]=1-w-B,i[6]=L+V,i[7]=0,i[8]=P+Z,i[9]=L-V,i[10]=1-w-I,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},s.fromRotation=function(i,e){var n=Math.sin(e),a=Math.cos(e);return i[0]=a,i[1]=n,i[2]=0,i[3]=-n,i[4]=a,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},s.fromScaling=E0,s.furthestTileCorner=function(i){const e=Math.round((i+45+360)%360/90)%4;return xe[e]},s.getAABBPointSquareDist=function(i,e,n){let a=0;for(let u=0;u<2;++u){const d=n?n[u]:0;i[u]>d&&(a+=(i[u]-d)*(i[u]-d)),e[u]<d&&(a+=(d-e[u])*(d-e[u]))}return a},s.getAnchorAlignment=jg,s.getAnchorJustification=Vg,s.getBounds=function(i){let e=1/0,n=1/0,a=-1/0,u=-1/0;for(const d of i)e=Math.min(e,d.x),n=Math.min(n,d.y),a=Math.max(a,d.x),u=Math.max(u,d.y);return{min:new D(e,n),max:new D(a,u)}},s.getColumn=en,s.getGridMatrix=function(i,e,n){const a=e.getNorth(),u=e.getSouth(),d=e.getWest(),m=.015625;return[0,(e.getEast()-d)*m,1<<i.z,(u-a)/kc[n],0,i.y,a,d,m]},s.getImage=Jt,s.getJSON=function(i,e){return _e(ct(i,{type:"json"}),e)},s.getLatitudinalLod=function(i){const e=80.051129;i=Pe(i,-80.051129,e)/e*90;const n=Math.pow(Math.abs(Math.sin(se(i))),3);return Math.round(n*(kc.length-1))},s.getMapSessionAPI=_u,s.getPerformanceMeasurement=ie,s.getProjection=Xx,s.getRTLTextPluginStatus=$,s.getReferrer=Ee,s.getTilePoint=function(i,{x:e,y:n},a=0){return new D(((e-a)*i.scale-i.x)*Qt,(n*i.scale-i.y)*Qt)},s.getTileVec3=function(i,e,n=0){return Ec(((e.x-n)*i.scale-i.x)*Qt,(e.y*i.scale-i.y)*Qt,f0(e.z,e.y))},s.getVideo=function(i,e){const n=A.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let a=0;a<i.length;a++){const u=A.document.createElement("source");lt(i[a])||(n.crossOrigin="Anonymous"),u.src=i[a],n.appendChild(u)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(i){const e=[0,0,0],n=Ao(new Float64Array(16));return Tc(n,i.pixelMatrix,i.globeMatrix),Ti(e,e,n),new D(e[0],e[1])},s.globeDenormalizeECEF=Wg,s.globeECEFOrigin=function(i,e){const n=[0,0,0];return Ti(n,n,Lh(Po(e.canonical))),Ti(n,n,i),n},s.globeNormalizeECEF=Lh,s.globePixelsToTileUnits=function(i,e){return Qt/(512*Math.pow(2,i))*up(Po(e))},s.globePoleMatrixForTile=function(i,e,n){const a=Ao(new Float64Array(16)),u=(e/(1<<i)-.5)*Math.PI*2;return $d(a,n.globeMatrix,u),Float32Array.from(a)},s.globeTileBounds=Po,s.globeTiltAtLngLat=Vx,s.globeToMercatorTransition=Rh,s.globeUseCustomAntiAliasing=function(i,e,n){const a=Rh(n.zoom),u=i.style.map._antialias,d=!!e.extStandardDerivatives,m=e.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return a===0&&!u&&!m&&d},s.identity=Ao,s.identity$1=z0,s.invert=mg,s.isFullscreen=function(){return!!A.document.fullscreenElement||!!A.document.webkitFullscreenElement},s.isLngLatBehindGlobe=function(i,e){return Vx(i,e)>Math.PI/2*1.01},s.isMapAuthenticated=function(i){return go.has(i)},s.isMapboxURL=Nn,s.isSafariWithAntialiasingBug=function(i){const e=i.navigator?i.navigator.userAgent:null;return!!bt(i)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=ji,s.len=RS,s.length=yh,s.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},s.loadVectorTile=g1,s.makeRequest=_e,s.mapValue=function(i,e,n,a,u){return Pe((i-e)/(n-e)*(u-a)+a,a,u)},s.mercatorScale=d0,s.mercatorXfromLng=So,s.mercatorYfromLat=os,s.mercatorZfromAltitude=jr,s.mul=DS,s.mul$1=LS,s.multiply=Tc,s.multiply$1=function(i,e,n){var a=e[0],u=e[1],d=e[2],m=e[3],_=e[4],b=e[5],w=e[6],S=e[7],I=e[8],P=n[0],L=n[1],B=n[2],V=n[3],Z=n[4],Q=n[5],ce=n[6],ne=n[7],ae=n[8];return i[0]=P*a+L*m+B*w,i[1]=P*u+L*_+B*S,i[2]=P*d+L*b+B*I,i[3]=V*a+Z*m+Q*w,i[4]=V*u+Z*_+Q*S,i[5]=V*d+Z*b+Q*I,i[6]=ce*a+ne*m+ae*w,i[7]=ce*u+ne*_+ae*S,i[8]=ce*d+ne*b+ae*I,i},s.multiply$2=M0,s.nextPowerOfTwo=Ne,s.normalize=tr,s.normalize$1=function(i,e){var n=e[0],a=e[1],u=e[2],d=e[3],m=n*n+a*a+u*u+d*d;return m>0&&(m=1/Math.sqrt(m)),i[0]=n*m,i[1]=a*m,i[2]=u*m,i[3]=d*m,i},s.number=Mn,s.ortho=function(i,e,n,a,u,d,m){var _=1/(e-n),b=1/(a-u),w=1/(d-m);return i[0]=-2*_,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*b,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*w,i[11]=0,i[12]=(e+n)*_,i[13]=(u+a)*b,i[14]=(m+d)*w,i[15]=1,i},s.pbf=Ph,s.perspective=function(i,e,n,a,u){var d,m=1/Math.tan(e/2);return i[0]=m/n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=m,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,u!=null&&u!==1/0?(i[10]=(u+a)*(d=1/(a-u)),i[14]=2*u*a*d):(i[10]=-1,i[14]=-2*a),i},s.pick=function(i,e){const n={};for(let a=0;a<e.length;a++){const u=e[a];u in i&&(n[u]=i[u])}return n},s.plugin=W,s.pointGeometry=D,s.polygonContainsPoint=nl,s.polygonIntersectsBox=x0,s.polygonIntersectsPolygon=g0,s.polygonizeBounds=function(i,e,n=0,a=!0){const u=new D(n,n),d=i.sub(u),m=e.add(u),_=[d,new D(m.x,d.y),m,new D(d.x,m.y)];return a&&_.push(d.clone()),_},s.posAttributes=kh,s.postMapLoadEvent=Bl,s.postTurnstileEvent=mo,s.potpack=Lg,s.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},s.radToDeg=we,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(i){return i({pluginStatus:C,pluginURL:M}),N.on("pluginStateChange",i),i},s.removeAuthState=function(i){go.delete(i)},s.renderColorRamp=Sg,s.resample=p0,s.rotateX=gg,s.rotateX$1=O0,s.rotateY=$d,s.rotateY$1=k0,s.rotateZ=function(i,e,n){var a=Math.sin(n),u=Math.cos(n),d=e[0],m=e[1],_=e[2],b=e[3],w=e[4],S=e[5],I=e[6],P=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=d*u+w*a,i[1]=m*u+S*a,i[2]=_*u+I*a,i[3]=b*u+P*a,i[4]=w*u-d*a,i[5]=S*u-m*a,i[6]=I*u-_*a,i[7]=P*u-b*a,i},s.rotateZ$1=function(i,e,n){n*=.5;var a=e[0],u=e[1],d=e[2],m=e[3],_=Math.sin(n),b=Math.cos(n);return i[0]=a*b+u*_,i[1]=u*b-a*_,i[2]=d*b+m*_,i[3]=m*b-d*_,i},s.scale=il,s.scale$1=I0,s.scale$2=io,s.scaleAndAdd=Gd,s.setCacheLimits=function(i,e){Ss=i,jl=e},s.setColumn=function(i,e,n){i[4*e+0]=n[0],i[4*e+1]=n[1],i[4*e+2]=n[2],i[4*e+3]=n[3]},s.setRTLTextPlugin=function(i,e,n=!1){if(C===p||C===y||C===v)throw new Error("setRTLTextPlugin cannot be called multiple times.");M=wt.resolveURL(i),C=p,T=e,O(),n||K()},s.smoothstep=Oe,s.spec=$e,s.storeAuthState=function(i,e){e?go.add(i):go.delete(i)},s.sub=ro,s.subtract=yg,s.symbolSize=zM,s.tileAABB=function(i,e,n,a,u,d,m,_,b){if(b.name==="globe")return uA(i,e,new Jd(n,a,u));const w=al({z:n,x:a,y:u},b);return new cr([(d+w.x/w.scale)*e,e*(w.y/w.scale),m],[(d+w.x2/w.scale)*e,e*(w.y2/w.scale),_])},s.tileCornersToBounds=lp,s.tileTransform=al,s.transformMat3=function(i,e,n){var a=e[0],u=e[1],d=e[2];return i[0]=a*n[0]+u*n[3]+d*n[6],i[1]=a*n[1]+u*n[4]+d*n[7],i[2]=a*n[2]+u*n[5]+d*n[8],i},s.transformMat4=Ti,s.transformMat4$1=rl,s.transformQuat=A0,s.transitionTileAABBinECEF=Fx,s.translate=_h,s.transpose=function(i,e){if(i===e){var n=e[1],a=e[2],u=e[5];i[1]=e[3],i[2]=e[6],i[3]=n,i[5]=e[7],i[6]=a,i[7]=u}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i},s.triggerPluginCompletionEvent=z,s.uniqueId=st,s.updateGlobeVertexNormal=function(i,e,n,a,u){const d=5*e+2;i.float32[d+0]=n,i.float32[d+1]=a,i.float32[d+2]=u},s.validateCustomStyleLayer=function(i){const e=[],n=i.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},s.validateFilter=i=>Qr(Ns(i)),s.validateFog=i=>Qr(yd(i)),s.validateLayer=i=>Qr(uc(i)),s.validateLight=i=>Qr(_d(i)),s.validateSource=i=>Qr(gd(i)),s.validateStyle=dc,s.validateTerrain=i=>Qr(fc(i)),s.values=We,s.vectorTile=sl,s.version=ye,s.warnOnce=Lt,s.window=A,s.wrap=Le}),x(["./shared"],function(s){function A(ee){if(typeof ee=="number"||typeof ee=="boolean"||typeof ee=="string"||ee==null)return JSON.stringify(ee);if(Array.isArray(ee)){let U="[";for(const J of ee)U+=`${A(J)},`;return`${U}]`}let j="{";for(const U of Object.keys(ee).sort())j+=`${U}:${A(ee[U])},`;return`${j}}`}function k(ee){let j="";for(const U of s.refProperties)j+=`/${A(ee[U])}`;return j}class R{constructor(j){this.keyCache={},j&&this.replace(j)}replace(j){this._layerConfigs={},this._layers={},this.update(j,[])}update(j,U){for(const re of j)this._layerConfigs[re.id]=re,(this._layers[re.id]=s.createStyleLayer(re)).compileFilter(),this.keyCache[re.id]&&delete this.keyCache[re.id];for(const re of U)delete this.keyCache[re],delete this._layerConfigs[re],delete this._layers[re];this.familiesBySource={};const J=function(re,ge){const Se={};for(let _e=0;_e<re.length;_e++){const Ie=ge&&ge[re[_e].id]||k(re[_e]);ge&&(ge[re[_e].id]=Ie);let tt=Se[Ie];tt||(tt=Se[Ie]=[]),tt.push(re[_e])}const Ee=[];for(const _e in Se)Ee.push(Se[_e]);return Ee}(s.values(this._layerConfigs),this.keyCache);for(const re of J){const ge=re.map(zt=>this._layers[zt.id]),Se=ge[0];if(Se.visibility==="none")continue;const Ee=Se.source||"";let _e=this.familiesBySource[Ee];_e||(_e=this.familiesBySource[Ee]={});const Ie=Se.sourceLayer||"_geojsonTileLayer";let tt=_e[Ie];tt||(tt=_e[Ie]=[]),tt.push(ge)}}}class D{loadTile(j,U){const{uid:J,encoding:re,rawImageData:ge,padding:Se,buildQuadTree:Ee}=j,_e=s.window.ImageBitmap&&ge instanceof s.window.ImageBitmap?this.getImageData(ge,Se):ge;U(null,new s.DEMData(J,_e,re,Se<1,Ee))}getImageData(j,U){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(j.width,j.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=j.width,this.offscreenCanvas.height=j.height,this.offscreenCanvasContext.drawImage(j,0,0,j.width,j.height);const J=this.offscreenCanvasContext.getImageData(-U,-U,j.width+2*U,j.height+2*U);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),J}}var F=function ee(j,U){var J,re=j&&j.type;if(re==="FeatureCollection")for(J=0;J<j.features.length;J++)ee(j.features[J],U);else if(re==="GeometryCollection")for(J=0;J<j.geometries.length;J++)ee(j.geometries[J],U);else if(re==="Feature")ee(j.geometry,U);else if(re==="Polygon")G(j.coordinates,U);else if(re==="MultiPolygon")for(J=0;J<j.coordinates.length;J++)G(j.coordinates[J],U);return j};function G(ee,j){if(ee.length!==0){oe(ee[0],j);for(var U=1;U<ee.length;U++)oe(ee[U],!j)}}function oe(ee,j){for(var U=0,J=0,re=0,ge=ee.length,Se=ge-1;re<ge;Se=re++){var Ee=(ee[re][0]-ee[Se][0])*(ee[Se][1]+ee[re][1]),_e=U+Ee;J+=Math.abs(U)>=Math.abs(Ee)?U-_e+Ee:Ee-_e+U,U=_e}U+J>=0!=!!j&&ee.reverse()}const se=s.vectorTile.VectorTileFeature.prototype.toGeoJSON;class we{constructor(j){this._feature=j,this.extent=s.EXTENT,this.type=j.type,this.properties=j.tags,"id"in j&&!isNaN(j.id)&&(this.id=parseInt(j.id,10))}loadGeometry(){if(this._feature.type===1){const j=[];for(const U of this._feature.geometry)j.push([new s.pointGeometry(U[0],U[1])]);return j}{const j=[];for(const U of this._feature.geometry){const J=[];for(const re of U)J.push(new s.pointGeometry(re[0],re[1]));j.push(J)}return j}}toGeoJSON(j,U,J){return se.call(this,j,U,J)}}class xe{constructor(j){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=j.length,this._features=j}feature(j){return new we(this._features[j])}}var Te=s.vectorTile.VectorTileFeature,Ue=Be;function Be(ee,j){this.options=j||{},this.features=ee,this.length=ee.length}function Pe(ee,j){this.id=typeof ee.id=="number"?ee.id:void 0,this.type=ee.type,this.rawGeometry=ee.type===1?[ee.geometry]:ee.geometry,this.properties=ee.tags,this.extent=j||4096}Be.prototype.feature=function(ee){return new Pe(this.features[ee],this.options.extent)},Pe.prototype.loadGeometry=function(){var ee=this.rawGeometry;this.geometry=[];for(var j=0;j<ee.length;j++){for(var U=ee[j],J=[],re=0;re<U.length;re++)J.push(new s.pointGeometry(U[re][0],U[re][1]));this.geometry.push(J)}return this.geometry},Pe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ee=this.geometry,j=1/0,U=-1/0,J=1/0,re=-1/0,ge=0;ge<ee.length;ge++)for(var Se=ee[ge],Ee=0;Ee<Se.length;Ee++){var _e=Se[Ee];j=Math.min(j,_e.x),U=Math.max(U,_e.x),J=Math.min(J,_e.y),re=Math.max(re,_e.y)}return[j,J,U,re]},Pe.prototype.toGeoJSON=Te.prototype.toGeoJSON;var Oe=ke,Le=Ue;function ke(ee){var j=new s.pbf;return function(U,J){for(var re in U.layers)J.writeMessage(3,We,U.layers[re])}(ee,j),j.finish()}function We(ee,j){var U;j.writeVarintField(15,ee.version||1),j.writeStringField(1,ee.name||""),j.writeVarintField(5,ee.extent||4096);var J={keys:[],values:[],keycache:{},valuecache:{}};for(U=0;U<ee.length;U++)J.feature=ee.feature(U),j.writeMessage(2,ct,J);var re=J.keys;for(U=0;U<re.length;U++)j.writeStringField(3,re[U]);var ge=J.values;for(U=0;U<ge.length;U++)j.writeMessage(4,vt,ge[U])}function ct(ee,j){var U=ee.feature;U.id!==void 0&&j.writeVarintField(1,U.id),j.writeMessage(2,Tt,ee),j.writeVarintField(3,U.type),j.writeMessage(4,Ne,U)}function Tt(ee,j){var U=ee.feature,J=ee.keys,re=ee.values,ge=ee.keycache,Se=ee.valuecache;for(var Ee in U.properties){var _e=U.properties[Ee],Ie=ge[Ee];if(_e!==null){Ie===void 0&&(J.push(Ee),ge[Ee]=Ie=J.length-1),j.writeVarint(Ie);var tt=typeof _e;tt!=="string"&&tt!=="boolean"&&tt!=="number"&&(_e=JSON.stringify(_e));var zt=tt+":"+_e,lt=Se[zt];lt===void 0&&(re.push(_e),Se[zt]=lt=re.length-1),j.writeVarint(lt)}}}function st(ee,j){return(j<<3)+(7&ee)}function Ge(ee){return ee<<1^ee>>31}function Ne(ee,j){for(var U=ee.loadGeometry(),J=ee.type,re=0,ge=0,Se=U.length,Ee=0;Ee<Se;Ee++){var _e=U[Ee],Ie=1;J===1&&(Ie=_e.length),j.writeVarint(st(1,Ie));for(var tt=J===3?_e.length-1:_e.length,zt=0;zt<tt;zt++){zt===1&&J!==1&&j.writeVarint(st(2,tt-1));var lt=_e[zt].x-re,Ht=_e[zt].y-ge;j.writeVarint(Ge(lt)),j.writeVarint(Ge(Ht)),re+=lt,ge+=Ht}J===3&&j.writeVarint(st(7,1))}}function vt(ee,j){var U=typeof ee;U==="string"?j.writeStringField(1,ee):U==="boolean"?j.writeBooleanField(7,ee):U==="number"&&(ee%1!=0?j.writeDoubleField(3,ee):ee<0?j.writeSVarintField(6,ee):j.writeVarintField(5,ee))}function rt(ee,j,U,J,re,ge){if(re-J<=U)return;const Se=J+re>>1;at(ee,j,Se,J,re,ge%2),rt(ee,j,U,J,Se-1,ge+1),rt(ee,j,U,Se+1,re,ge+1)}function at(ee,j,U,J,re,ge){for(;re>J;){if(re-J>600){const Ie=re-J+1,tt=U-J+1,zt=Math.log(Ie),lt=.5*Math.exp(2*zt/3),Ht=.5*Math.sqrt(zt*lt*(Ie-lt)/Ie)*(tt-Ie/2<0?-1:1);at(ee,j,U,Math.max(J,Math.floor(U-tt*lt/Ie+Ht)),Math.min(re,Math.floor(U+(Ie-tt)*lt/Ie+Ht)),ge)}const Se=j[2*U+ge];let Ee=J,_e=re;for(ht(ee,j,J,U),j[2*re+ge]>Se&&ht(ee,j,J,re);Ee<_e;){for(ht(ee,j,Ee,_e),Ee++,_e--;j[2*Ee+ge]<Se;)Ee++;for(;j[2*_e+ge]>Se;)_e--}j[2*J+ge]===Se?ht(ee,j,J,_e):(_e++,ht(ee,j,_e,re)),_e<=U&&(J=_e+1),U<=_e&&(re=_e-1)}}function ht(ee,j,U,J){Ft(ee,U,J),Ft(j,2*U,2*J),Ft(j,2*U+1,2*J+1)}function Ft(ee,j,U){const J=ee[j];ee[j]=ee[U],ee[U]=J}function ln(ee,j,U,J){const re=ee-U,ge=j-J;return re*re+ge*ge}Oe.fromVectorTileJs=ke,Oe.fromGeojsonVt=function(ee,j){j=j||{};var U={};for(var J in ee)U[J]=new Ue(ee[J].features,j),U[J].name=J,U[J].version=j.version,U[J].extent=j.extent;return ke({layers:U})},Oe.GeoJSONWrapper=Le;const pn=ee=>ee[0],Lt=ee=>ee[1];class nn{constructor(j,U=pn,J=Lt,re=64,ge=Float64Array){this.nodeSize=re,this.points=j;const Se=j.length<65536?Uint16Array:Uint32Array,Ee=this.ids=new Se(j.length),_e=this.coords=new ge(2*j.length);for(let Ie=0;Ie<j.length;Ie++)Ee[Ie]=Ie,_e[2*Ie]=U(j[Ie]),_e[2*Ie+1]=J(j[Ie]);rt(Ee,_e,re,0,Ee.length-1,0)}range(j,U,J,re){return function(ge,Se,Ee,_e,Ie,tt,zt){const lt=[0,ge.length-1,0],Ht=[];let Kt,Vt;for(;lt.length;){const Jt=lt.pop(),mn=lt.pop(),Fn=lt.pop();if(mn-Fn<=zt){for(let Wt=Fn;Wt<=mn;Wt++)Kt=Se[2*Wt],Vt=Se[2*Wt+1],Kt>=Ee&&Kt<=Ie&&Vt>=_e&&Vt<=tt&&Ht.push(ge[Wt]);continue}const Gn=Math.floor((Fn+mn)/2);Kt=Se[2*Gn],Vt=Se[2*Gn+1],Kt>=Ee&&Kt<=Ie&&Vt>=_e&&Vt<=tt&&Ht.push(ge[Gn]);const jn=(Jt+1)%2;(Jt===0?Ee<=Kt:_e<=Vt)&&(lt.push(Fn),lt.push(Gn-1),lt.push(jn)),(Jt===0?Ie>=Kt:tt>=Vt)&&(lt.push(Gn+1),lt.push(mn),lt.push(jn))}return Ht}(this.ids,this.coords,j,U,J,re,this.nodeSize)}within(j,U,J){return function(re,ge,Se,Ee,_e,Ie){const tt=[0,re.length-1,0],zt=[],lt=_e*_e;for(;tt.length;){const Ht=tt.pop(),Kt=tt.pop(),Vt=tt.pop();if(Kt-Vt<=Ie){for(let jn=Vt;jn<=Kt;jn++)ln(ge[2*jn],ge[2*jn+1],Se,Ee)<=lt&&zt.push(re[jn]);continue}const Jt=Math.floor((Vt+Kt)/2),mn=ge[2*Jt],Fn=ge[2*Jt+1];ln(mn,Fn,Se,Ee)<=lt&&zt.push(re[Jt]);const Gn=(Ht+1)%2;(Ht===0?Se-_e<=mn:Ee-_e<=Fn)&&(tt.push(Vt),tt.push(Jt-1),tt.push(Gn)),(Ht===0?Se+_e>=mn:Ee+_e>=Fn)&&(tt.push(Jt+1),tt.push(Kt),tt.push(Gn))}return zt}(this.ids,this.coords,j,U,J,this.nodeSize)}}const xt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ee=>ee},be=Math.fround||(Xe=new Float32Array(1),ee=>(Xe[0]=+ee,Xe[0]));var Xe;class ut{constructor(j){this.options=qe(Object.create(xt),j),this.trees=new Array(this.options.maxZoom+1)}load(j){const{log:U,minZoom:J,maxZoom:re,nodeSize:ge}=this.options;U&&console.time("total time");const Se=`prepare ${j.length} points`;U&&console.time(Se),this.points=j;let Ee=[];for(let _e=0;_e<j.length;_e++)j[_e].geometry&&Ee.push(Yt(j[_e],_e));this.trees[re+1]=new nn(Ee,ot,Et,ge,Float32Array),U&&console.timeEnd(Se);for(let _e=re;_e>=J;_e--){const Ie=+Date.now();Ee=this._cluster(Ee,_e),this.trees[_e]=new nn(Ee,ot,Et,ge,Float32Array),U&&console.log("z%d: %d clusters in %dms",_e,Ee.length,+Date.now()-Ie)}return U&&console.timeEnd("total time"),this}getClusters(j,U){let J=((j[0]+180)%360+360)%360-180;const re=Math.max(-90,Math.min(90,j[1]));let ge=j[2]===180?180:((j[2]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,j[3]));if(j[2]-j[0]>=360)J=-180,ge=180;else if(J>ge){const tt=this.getClusters([J,re,180,Se],U),zt=this.getClusters([-180,re,ge,Se],U);return tt.concat(zt)}const Ee=this.trees[this._limitZoom(U)],_e=Ee.range(ie(J),ye(Se),ie(ge),ye(re)),Ie=[];for(const tt of _e){const zt=Ee.points[tt];Ie.push(zt.numPoints?en(zt):this.points[zt.index])}return Ie}getChildren(j){const U=this._getOriginId(j),J=this._getOriginZoom(j),re="No cluster with the specified id.",ge=this.trees[J];if(!ge)throw new Error(re);const Se=ge.points[U];if(!Se)throw new Error(re);const Ee=this.options.radius/(this.options.extent*Math.pow(2,J-1)),_e=ge.within(Se.x,Se.y,Ee),Ie=[];for(const tt of _e){const zt=ge.points[tt];zt.parentId===j&&Ie.push(zt.numPoints?en(zt):this.points[zt.index])}if(Ie.length===0)throw new Error(re);return Ie}getLeaves(j,U,J){const re=[];return this._appendLeaves(re,j,U=U||10,J=J||0,0),re}getTile(j,U,J){const re=this.trees[this._limitZoom(j)],ge=Math.pow(2,j),{extent:Se,radius:Ee}=this.options,_e=Ee/Se,Ie=(J-_e)/ge,tt=(J+1+_e)/ge,zt={features:[]};return this._addTileFeatures(re.range((U-_e)/ge,Ie,(U+1+_e)/ge,tt),re.points,U,J,ge,zt),U===0&&this._addTileFeatures(re.range(1-_e/ge,Ie,1,tt),re.points,ge,J,ge,zt),U===ge-1&&this._addTileFeatures(re.range(0,Ie,_e/ge,tt),re.points,-1,J,ge,zt),zt.features.length?zt:null}getClusterExpansionZoom(j){let U=this._getOriginZoom(j)-1;for(;U<=this.options.maxZoom;){const J=this.getChildren(j);if(U++,J.length!==1)break;j=J[0].properties.cluster_id}return U}_appendLeaves(j,U,J,re,ge){const Se=this.getChildren(U);for(const Ee of Se){const _e=Ee.properties;if(_e&&_e.cluster?ge+_e.point_count<=re?ge+=_e.point_count:ge=this._appendLeaves(j,_e.cluster_id,J,re,ge):ge<re?ge++:j.push(Ee),j.length===J)break}return ge}_addTileFeatures(j,U,J,re,ge,Se){for(const Ee of j){const _e=U[Ee],Ie=_e.numPoints;let tt,zt,lt;if(Ie)tt=qt(_e),zt=_e.x,lt=_e.y;else{const Vt=this.points[_e.index];tt=Vt.properties,zt=ie(Vt.geometry.coordinates[0]),lt=ye(Vt.geometry.coordinates[1])}const Ht={type:1,geometry:[[Math.round(this.options.extent*(zt*ge-J)),Math.round(this.options.extent*(lt*ge-re))]],tags:tt};let Kt;Ie?Kt=_e.id:this.options.generateId?Kt=_e.index:this.points[_e.index].id&&(Kt=this.points[_e.index].id),Kt!==void 0&&(Ht.id=Kt),Se.features.push(Ht)}}_limitZoom(j){return Math.max(this.options.minZoom,Math.min(+j,this.options.maxZoom+1))}_cluster(j,U){const J=[],{radius:re,extent:ge,reduce:Se,minPoints:Ee}=this.options,_e=re/(ge*Math.pow(2,U));for(let Ie=0;Ie<j.length;Ie++){const tt=j[Ie];if(tt.zoom<=U)continue;tt.zoom=U;const zt=this.trees[U+1],lt=zt.within(tt.x,tt.y,_e),Ht=tt.numPoints||1;let Kt=Ht;for(const Vt of lt){const Jt=zt.points[Vt];Jt.zoom>U&&(Kt+=Jt.numPoints||1)}if(Kt>Ht&&Kt>=Ee){let Vt=tt.x*Ht,Jt=tt.y*Ht,mn=Se&&Ht>1?this._map(tt,!0):null;const Fn=(Ie<<5)+(U+1)+this.points.length;for(const Gn of lt){const jn=zt.points[Gn];if(jn.zoom<=U)continue;jn.zoom=U;const Wt=jn.numPoints||1;Vt+=jn.x*Wt,Jt+=jn.y*Wt,jn.parentId=Fn,Se&&(mn||(mn=this._map(tt,!0)),Se(mn,this._map(jn)))}tt.parentId=Fn,J.push(bt(Vt/Kt,Jt/Kt,Fn,Kt,mn))}else if(J.push(tt),Kt>1)for(const Vt of lt){const Jt=zt.points[Vt];Jt.zoom<=U||(Jt.zoom=U,J.push(Jt))}}return J}_getOriginId(j){return j-this.points.length>>5}_getOriginZoom(j){return(j-this.points.length)%32}_map(j,U){if(j.numPoints)return U?qe({},j.properties):j.properties;const J=this.points[j.index].properties,re=this.options.map(J);return U&&re===J?qe({},re):re}}function bt(ee,j,U,J,re){return{x:be(ee),y:be(j),zoom:1/0,id:U,parentId:-1,numPoints:J,properties:re}}function Yt(ee,j){const[U,J]=ee.geometry.coordinates;return{x:be(ie(U)),y:be(ye(J)),zoom:1/0,index:j,parentId:-1}}function en(ee){return{type:"Feature",id:ee.id,properties:qt(ee),geometry:{type:"Point",coordinates:[(j=ee.x,360*(j-.5)),Ae(ee.y)]}};var j}function qt(ee){const j=ee.numPoints,U=j>=1e4?`${Math.round(j/1e3)}k`:j>=1e3?Math.round(j/100)/10+"k":j;return qe(qe({},ee.properties),{cluster:!0,cluster_id:ee.id,point_count:j,point_count_abbreviated:U})}function ie(ee){return ee/360+.5}function ye(ee){const j=Math.sin(ee*Math.PI/180),U=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return U<0?0:U>1?1:U}function Ae(ee){const j=(180-360*ee)*Math.PI/180;return 360*Math.atan(Math.exp(j))/Math.PI-90}function qe(ee,j){for(const U in j)ee[U]=j[U];return ee}function ot(ee){return ee.x}function Et(ee){return ee.y}function wt(ee,j,U,J){for(var re,ge=J,Se=U-j>>1,Ee=U-j,_e=ee[j],Ie=ee[j+1],tt=ee[U],zt=ee[U+1],lt=j+3;lt<U;lt+=3){var Ht=ft(ee[lt],ee[lt+1],_e,Ie,tt,zt);if(Ht>ge)re=lt,ge=Ht;else if(Ht===ge){var Kt=Math.abs(lt-Se);Kt<Ee&&(re=lt,Ee=Kt)}}ge>J&&(re-j>3&&wt(ee,j,re,J),ee[re+2]=ge,U-re>3&&wt(ee,re,U,J))}function ft(ee,j,U,J,re,ge){var Se=re-U,Ee=ge-J;if(Se!==0||Ee!==0){var _e=((ee-U)*Se+(j-J)*Ee)/(Se*Se+Ee*Ee);_e>1?(U=re,J=ge):_e>0&&(U+=Se*_e,J+=Ee*_e)}return(Se=ee-U)*Se+(Ee=j-J)*Ee}function Qe(ee,j,U,J){var re={id:ee===void 0?null:ee,type:j,geometry:U,tags:J,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ge){var Se=ge.geometry,Ee=ge.type;if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")dt(ge,Se);else if(Ee==="Polygon"||Ee==="MultiLineString")for(var _e=0;_e<Se.length;_e++)dt(ge,Se[_e]);else if(Ee==="MultiPolygon")for(_e=0;_e<Se.length;_e++)for(var Ie=0;Ie<Se[_e].length;Ie++)dt(ge,Se[_e][Ie])}(re),re}function dt(ee,j){for(var U=0;U<j.length;U+=3)ee.minX=Math.min(ee.minX,j[U]),ee.minY=Math.min(ee.minY,j[U+1]),ee.maxX=Math.max(ee.maxX,j[U]),ee.maxY=Math.max(ee.maxY,j[U+1])}function Rt(ee,j,U,J){if(j.geometry){var re=j.geometry.coordinates,ge=j.geometry.type,Se=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2),Ee=[],_e=j.id;if(U.promoteId?_e=j.properties[U.promoteId]:U.generateId&&(_e=J||0),ge==="Point")Ct(re,Ee);else if(ge==="MultiPoint")for(var Ie=0;Ie<re.length;Ie++)Ct(re[Ie],Ee);else if(ge==="LineString")jt(re,Ee,Se,!1);else if(ge==="MultiLineString"){if(U.lineMetrics){for(Ie=0;Ie<re.length;Ie++)jt(re[Ie],Ee=[],Se,!1),ee.push(Qe(_e,"LineString",Ee,j.properties));return}Xt(re,Ee,Se,!1)}else if(ge==="Polygon")Xt(re,Ee,Se,!0);else{if(ge!=="MultiPolygon"){if(ge==="GeometryCollection"){for(Ie=0;Ie<j.geometry.geometries.length;Ie++)Rt(ee,{id:_e,geometry:j.geometry.geometries[Ie],properties:j.properties},U,J);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ie=0;Ie<re.length;Ie++){var tt=[];Xt(re[Ie],tt,Se,!0),Ee.push(tt)}}ee.push(Qe(_e,ge,Ee,j.properties))}}function Ct(ee,j){j.push(sn(ee[0])),j.push(Pn(ee[1])),j.push(0)}function jt(ee,j,U,J){for(var re,ge,Se=0,Ee=0;Ee<ee.length;Ee++){var _e=sn(ee[Ee][0]),Ie=Pn(ee[Ee][1]);j.push(_e),j.push(Ie),j.push(0),Ee>0&&(Se+=J?(re*Ie-_e*ge)/2:Math.sqrt(Math.pow(_e-re,2)+Math.pow(Ie-ge,2))),re=_e,ge=Ie}var tt=j.length-3;j[2]=1,wt(j,0,tt,U),j[tt+2]=1,j.size=Math.abs(Se),j.start=0,j.end=j.size}function Xt(ee,j,U,J){for(var re=0;re<ee.length;re++){var ge=[];jt(ee[re],ge,U,J),j.push(ge)}}function sn(ee){return ee/360+.5}function Pn(ee){var j=Math.sin(ee*Math.PI/180),U=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return U<0?0:U>1?1:U}function yn(ee,j,U,J,re,ge,Se,Ee){if(J/=j,ge>=(U/=j)&&Se<J)return ee;if(Se<U||ge>=J)return null;for(var _e=[],Ie=0;Ie<ee.length;Ie++){var tt=ee[Ie],zt=tt.geometry,lt=tt.type,Ht=re===0?tt.minX:tt.minY,Kt=re===0?tt.maxX:tt.maxY;if(Ht>=U&&Kt<J)_e.push(tt);else if(!(Kt<U||Ht>=J)){var Vt=[];if(lt==="Point"||lt==="MultiPoint")Nn(zt,Vt,U,J,re);else if(lt==="LineString")bi(zt,Vt,U,J,re,!1,Ee.lineMetrics);else if(lt==="MultiLineString")Di(zt,Vt,U,J,re,!1);else if(lt==="Polygon")Di(zt,Vt,U,J,re,!0);else if(lt==="MultiPolygon")for(var Jt=0;Jt<zt.length;Jt++){var mn=[];Di(zt[Jt],mn,U,J,re,!0),mn.length&&Vt.push(mn)}if(Vt.length){if(Ee.lineMetrics&&lt==="LineString"){for(Jt=0;Jt<Vt.length;Jt++)_e.push(Qe(tt.id,lt,Vt[Jt],tt.tags));continue}lt!=="LineString"&&lt!=="MultiLineString"||(Vt.length===1?(lt="LineString",Vt=Vt[0]):lt="MultiLineString"),lt!=="Point"&&lt!=="MultiPoint"||(lt=Vt.length===3?"Point":"MultiPoint"),_e.push(Qe(tt.id,lt,Vt,tt.tags))}}}return _e.length?_e:null}function Nn(ee,j,U,J,re){for(var ge=0;ge<ee.length;ge+=3){var Se=ee[ge+re];Se>=U&&Se<=J&&(j.push(ee[ge]),j.push(ee[ge+1]),j.push(ee[ge+2]))}}function bi(ee,j,U,J,re,ge,Se){for(var Ee,_e,Ie=Sr(ee),tt=re===0?Wo:wi,zt=ee.start,lt=0;lt<ee.length-3;lt+=3){var Ht=ee[lt],Kt=ee[lt+1],Vt=ee[lt+2],Jt=ee[lt+3],mn=ee[lt+4],Fn=re===0?Ht:Kt,Gn=re===0?Jt:mn,jn=!1;Se&&(Ee=Math.sqrt(Math.pow(Ht-Jt,2)+Math.pow(Kt-mn,2))),Fn<U?Gn>U&&(_e=tt(Ie,Ht,Kt,Jt,mn,U),Se&&(Ie.start=zt+Ee*_e)):Fn>J?Gn<J&&(_e=tt(Ie,Ht,Kt,Jt,mn,J),Se&&(Ie.start=zt+Ee*_e)):Gi(Ie,Ht,Kt,Vt),Gn<U&&Fn>=U&&(_e=tt(Ie,Ht,Kt,Jt,mn,U),jn=!0),Gn>J&&Fn<=J&&(_e=tt(Ie,Ht,Kt,Jt,mn,J),jn=!0),!ge&&jn&&(Se&&(Ie.end=zt+Ee*_e),j.push(Ie),Ie=Sr(ee)),Se&&(zt+=Ee)}var Wt=ee.length-3;Ht=ee[Wt],Kt=ee[Wt+1],Vt=ee[Wt+2],(Fn=re===0?Ht:Kt)>=U&&Fn<=J&&Gi(Ie,Ht,Kt,Vt),Wt=Ie.length-3,ge&&Wt>=3&&(Ie[Wt]!==Ie[0]||Ie[Wt+1]!==Ie[1])&&Gi(Ie,Ie[0],Ie[1],Ie[2]),Ie.length&&j.push(Ie)}function Sr(ee){var j=[];return j.size=ee.size,j.start=ee.start,j.end=ee.end,j}function Di(ee,j,U,J,re,ge){for(var Se=0;Se<ee.length;Se++)bi(ee[Se],j,U,J,re,ge,!1)}function Gi(ee,j,U,J){ee.push(j),ee.push(U),ee.push(J)}function Wo(ee,j,U,J,re,ge){var Se=(ge-j)/(J-j);return ee.push(ge),ee.push(U+(re-U)*Se),ee.push(1),Se}function wi(ee,j,U,J,re,ge){var Se=(ge-U)/(re-U);return ee.push(j+(J-j)*Se),ee.push(ge),ee.push(1),Se}function Li(ee,j){for(var U=[],J=0;J<ee.length;J++){var re,ge=ee[J],Se=ge.type;if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")re=mo(ge.geometry,j);else if(Se==="MultiLineString"||Se==="Polygon"){re=[];for(var Ee=0;Ee<ge.geometry.length;Ee++)re.push(mo(ge.geometry[Ee],j))}else if(Se==="MultiPolygon")for(re=[],Ee=0;Ee<ge.geometry.length;Ee++){for(var _e=[],Ie=0;Ie<ge.geometry[Ee].length;Ie++)_e.push(mo(ge.geometry[Ee][Ie],j));re.push(_e)}U.push(Qe(ge.id,Se,re,ge.tags))}return U}function mo(ee,j){var U=[];U.size=ee.size,ee.start!==void 0&&(U.start=ee.start,U.end=ee.end);for(var J=0;J<ee.length;J+=3)U.push(ee[J]+j,ee[J+1],ee[J+2]);return U}function wa(ee,j){if(ee.transformed)return ee;var U,J,re,ge=1<<ee.z,Se=ee.x,Ee=ee.y;for(U=0;U<ee.features.length;U++){var _e=ee.features[U],Ie=_e.geometry,tt=_e.type;if(_e.geometry=[],tt===1)for(J=0;J<Ie.length;J+=2)_e.geometry.push(Bl(Ie[J],Ie[J+1],j,ge,Se,Ee));else for(J=0;J<Ie.length;J++){var zt=[];for(re=0;re<Ie[J].length;re+=2)zt.push(Bl(Ie[J][re],Ie[J][re+1],j,ge,Se,Ee));_e.geometry.push(zt)}}return ee.transformed=!0,ee}function Bl(ee,j,U,J,re,ge){return[Math.round(U*(ee*J-re)),Math.round(U*(j*J-ge))]}function Fl(ee,j,U,J,re){for(var ge=j===re.maxZoom?0:re.tolerance/((1<<j)*re.extent),Se={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:U,y:J,z:j,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ee=0;Ee<ee.length;Ee++){Se.numFeatures++,_u(Se,ee[Ee],ge,re);var _e=ee[Ee].minX,Ie=ee[Ee].minY,tt=ee[Ee].maxX,zt=ee[Ee].maxY;_e<Se.minX&&(Se.minX=_e),Ie<Se.minY&&(Se.minY=Ie),tt>Se.maxX&&(Se.maxX=tt),zt>Se.maxY&&(Se.maxY=zt)}return Se}function _u(ee,j,U,J){var re=j.geometry,ge=j.type,Se=[];if(ge==="Point"||ge==="MultiPoint")for(var Ee=0;Ee<re.length;Ee+=3)Se.push(re[Ee]),Se.push(re[Ee+1]),ee.numPoints++,ee.numSimplified++;else if(ge==="LineString")go(Se,re,ee,U,!1,!1);else if(ge==="MultiLineString"||ge==="Polygon")for(Ee=0;Ee<re.length;Ee++)go(Se,re[Ee],ee,U,ge==="Polygon",Ee===0);else if(ge==="MultiPolygon")for(var _e=0;_e<re.length;_e++){var Ie=re[_e];for(Ee=0;Ee<Ie.length;Ee++)go(Se,Ie[Ee],ee,U,!0,Ee===0)}if(Se.length){var tt=j.tags||null;if(ge==="LineString"&&J.lineMetrics){for(var zt in tt={},j.tags)tt[zt]=j.tags[zt];tt.mapbox_clip_start=re.start/re.size,tt.mapbox_clip_end=re.end/re.size}var lt={geometry:Se,type:ge==="Polygon"||ge==="MultiPolygon"?3:ge==="LineString"||ge==="MultiLineString"?2:1,tags:tt};j.id!==null&&(lt.id=j.id),ee.features.push(lt)}}function go(ee,j,U,J,re,ge){var Se=J*J;if(J>0&&j.size<(re?Se:J))U.numPoints+=j.length/3;else{for(var Ee=[],_e=0;_e<j.length;_e+=3)(J===0||j[_e+2]>Se)&&(U.numSimplified++,Ee.push(j[_e]),Ee.push(j[_e+1])),U.numPoints++;re&&function(Ie,tt){for(var zt=0,lt=0,Ht=Ie.length,Kt=Ht-2;lt<Ht;Kt=lt,lt+=2)zt+=(Ie[lt]-Ie[Kt])*(Ie[lt+1]+Ie[Kt+1]);if(zt>0===tt)for(lt=0,Ht=Ie.length;lt<Ht/2;lt+=2){var Vt=Ie[lt],Jt=Ie[lt+1];Ie[lt]=Ie[Ht-2-lt],Ie[lt+1]=Ie[Ht-1-lt],Ie[Ht-2-lt]=Vt,Ie[Ht-1-lt]=Jt}}(Ee,ge),ee.push(Ee)}}function Kr(ee,j){var U=(j=this.options=function(re,ge){for(var Se in ge)re[Se]=ge[Se];return re}(Object.create(this.options),j)).debug;if(U&&console.time("preprocess data"),j.maxZoom<0||j.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(j.promoteId&&j.generateId)throw new Error("promoteId and generateId cannot be used together.");var J=function(re,ge){var Se=[];if(re.type==="FeatureCollection")for(var Ee=0;Ee<re.features.length;Ee++)Rt(Se,re.features[Ee],ge,Ee);else Rt(Se,re.type==="Feature"?re:{geometry:re},ge);return Se}(ee,j);this.tiles={},this.tileCoords=[],U&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",j.indexMaxZoom,j.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(J=function(re,ge){var Se=ge.buffer/ge.extent,Ee=re,_e=yn(re,1,-1-Se,Se,0,-1,2,ge),Ie=yn(re,1,1-Se,2+Se,0,-1,2,ge);return(_e||Ie)&&(Ee=yn(re,1,-Se,1+Se,0,-1,2,ge)||[],_e&&(Ee=Li(_e,1).concat(Ee)),Ie&&(Ee=Ee.concat(Li(Ie,-1)))),Ee}(J,j)).length&&this.splitTile(J,0,0,0),U&&(J.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ss(ee,j,U){return 32*((1<<ee)*U+j)+ee}function jl(ee,j){const U=ee.tileID.canonical;if(!this._geoJSONIndex)return j(null,null);const J=this._geoJSONIndex.getTile(U.z,U.x,U.y);if(!J)return j(null,null);const re=new xe(J.features);let ge=Oe(re);ge.byteOffset===0&&ge.byteLength===ge.buffer.byteLength||(ge=new Uint8Array(ge)),j(null,{vectorTile:re,rawData:ge.buffer})}Kr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Kr.prototype.splitTile=function(ee,j,U,J,re,ge,Se){for(var Ee=[ee,j,U,J],_e=this.options,Ie=_e.debug;Ee.length;){J=Ee.pop(),U=Ee.pop(),j=Ee.pop(),ee=Ee.pop();var tt=1<<j,zt=Ss(j,U,J),lt=this.tiles[zt];if(!lt&&(Ie>1&&console.time("creation"),lt=this.tiles[zt]=Fl(ee,j,U,J,_e),this.tileCoords.push({z:j,x:U,y:J}),Ie)){Ie>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",j,U,J,lt.numFeatures,lt.numPoints,lt.numSimplified),console.timeEnd("creation"));var Ht="z"+j;this.stats[Ht]=(this.stats[Ht]||0)+1,this.total++}if(lt.source=ee,re){if(j===_e.maxZoom||j===re)continue;var Kt=1<<re-j;if(U!==Math.floor(ge/Kt)||J!==Math.floor(Se/Kt))continue}else if(j===_e.indexMaxZoom||lt.numPoints<=_e.indexMaxPoints)continue;if(lt.source=null,ee.length!==0){Ie>1&&console.time("clipping");var Vt,Jt,mn,Fn,Gn,jn,Wt=.5*_e.buffer/_e.extent,$e=.5-Wt,sr=.5+Wt,ci=1+Wt;Vt=Jt=mn=Fn=null,Gn=yn(ee,tt,U-Wt,U+sr,0,lt.minX,lt.maxX,_e),jn=yn(ee,tt,U+$e,U+ci,0,lt.minX,lt.maxX,_e),ee=null,Gn&&(Vt=yn(Gn,tt,J-Wt,J+sr,1,lt.minY,lt.maxY,_e),Jt=yn(Gn,tt,J+$e,J+ci,1,lt.minY,lt.maxY,_e),Gn=null),jn&&(mn=yn(jn,tt,J-Wt,J+sr,1,lt.minY,lt.maxY,_e),Fn=yn(jn,tt,J+$e,J+ci,1,lt.minY,lt.maxY,_e),jn=null),Ie>1&&console.timeEnd("clipping"),Ee.push(Vt||[],j+1,2*U,2*J),Ee.push(Jt||[],j+1,2*U,2*J+1),Ee.push(mn||[],j+1,2*U+1,2*J),Ee.push(Fn||[],j+1,2*U+1,2*J+1)}}},Kr.prototype.getTile=function(ee,j,U){var J=this.options,re=J.extent,ge=J.debug;if(ee<0||ee>24)return null;var Se=1<<ee,Ee=Ss(ee,j=(j%Se+Se)%Se,U);if(this.tiles[Ee])return wa(this.tiles[Ee],re);ge>1&&console.log("drilling down to z%d-%d-%d",ee,j,U);for(var _e,Ie=ee,tt=j,zt=U;!_e&&Ie>0;)Ie--,tt=Math.floor(tt/2),zt=Math.floor(zt/2),_e=this.tiles[Ss(Ie,tt,zt)];return _e&&_e.source?(ge>1&&console.log("found parent tile z%d-%d-%d",Ie,tt,zt),ge>1&&console.time("drilling down"),this.splitTile(_e.source,Ie,tt,zt,ee,j,U),ge>1&&console.timeEnd("drilling down"),this.tiles[Ee]?wa(this.tiles[Ee],re):null):null};class Ji extends s.VectorTileWorkerSource{constructor(j,U,J,re,ge){super(j,U,J,re,jl),ge&&(this.loadGeoJSON=ge)}loadData(j,U){const J=j&&j.request,re=J&&J.collectResourceTiming;this.loadGeoJSON(j,(ge,Se)=>{if(ge||!Se)return U(ge);if(typeof Se!="object")return U(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`));{F(Se,!0);try{if(j.filter){const _e=s.createExpression(j.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(_e.result==="error")throw new Error(_e.value.map(tt=>`${tt.key}: ${tt.message}`).join(", "));const Ie=Se.features.filter(tt=>_e.value.evaluate({zoom:0},tt));Se={type:"FeatureCollection",features:Ie}}this._geoJSONIndex=j.cluster?new ut(function({superclusterOptions:_e,clusterProperties:Ie}){if(!Ie||!_e)return _e;const tt={},zt={},lt={accumulated:null,zoom:0},Ht={properties:null},Kt=Object.keys(Ie);for(const Vt of Kt){const[Jt,mn]=Ie[Vt],Fn=s.createExpression(mn),Gn=s.createExpression(typeof Jt=="string"?[Jt,["accumulated"],["get",Vt]]:Jt);tt[Vt]=Fn.value,zt[Vt]=Gn.value}return _e.map=Vt=>{Ht.properties=Vt;const Jt={};for(const mn of Kt)Jt[mn]=tt[mn].evaluate(lt,Ht);return Jt},_e.reduce=(Vt,Jt)=>{Ht.properties=Jt;for(const mn of Kt)lt.accumulated=Vt[mn],Vt[mn]=zt[mn].evaluate(lt,Ht)},_e}(j)).load(Se.features):function(_e,Ie){return new Kr(_e,Ie)}(Se,j.geojsonVtOptions)}catch(_e){return U(_e)}this.loaded={};const Ee={};if(re){const _e=s.getPerformanceMeasurement(J);_e&&(Ee.resourceTiming={},Ee.resourceTiming[j.source]=JSON.parse(JSON.stringify(_e)))}U(null,Ee)}})}reloadTile(j,U){const J=this.loaded;return J&&J[j.uid]?super.reloadTile(j,U):this.loadTile(j,U)}loadGeoJSON(j,U){if(j.request)s.getJSON(j.request,U);else{if(typeof j.data!="string")return U(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`));try{return U(null,JSON.parse(j.data))}catch{return U(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(j,U){try{U(null,this._geoJSONIndex.getClusterExpansionZoom(j.clusterId))}catch(J){U(J)}}getClusterChildren(j,U){try{U(null,this._geoJSONIndex.getChildren(j.clusterId))}catch(J){U(J)}}getClusterLeaves(j,U){try{U(null,this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset))}catch(J){U(J)}}}class Ta{constructor(j){this.self=j,this.actor=new s.Actor(j,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:Ji},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(U,J)=>{if(this.workerSourceTypes[U])throw new Error(`Worker source with name "${U}" already registered.`);this.workerSourceTypes[U]=J},this.self.registerRTLTextPlugin=U=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=U.applyArabicShaping,s.plugin.processBidirectionalText=U.processBidirectionalText,s.plugin.processStyledBidirectionalText=U.processStyledBidirectionalText}}clearCaches(j,U,J){delete this.layerIndexes[j],delete this.availableImages[j],delete this.workerSources[j],delete this.demWorkerSources[j],J()}checkIfReady(j,U,J){J()}setReferrer(j,U){this.referrer=U}spriteLoaded(j,U){this.isSpriteLoaded[j]=U;for(const J in this.workerSources[j]){const re=this.workerSources[j][J];for(const ge in re)re[ge]instanceof s.VectorTileWorkerSource&&(re[ge].isSpriteLoaded=U,re[ge].fire(new s.Event("isSpriteLoaded")))}}setImages(j,U,J){this.availableImages[j]=U;for(const re in this.workerSources[j]){const ge=this.workerSources[j][re];for(const Se in ge)ge[Se].availableImages=U}J()}enableTerrain(j,U,J){this.terrain=U,J()}setProjection(j,U){this.projections[j]=s.getProjection(U)}setLayers(j,U,J){this.getLayerIndex(j).replace(U),J()}updateLayers(j,U,J){this.getLayerIndex(j).update(U.layers,U.removedIds),J()}loadTile(j,U,J){const re=this.enableTerrain?s.extend({enableTerrain:this.terrain},U):U;re.projection=this.projections[j]||this.defaultProjection,this.getWorkerSource(j,U.type,U.source).loadTile(re,J)}loadDEMTile(j,U,J){const re=this.enableTerrain?s.extend({buildQuadTree:this.terrain},U):U;this.getDEMWorkerSource(j,U.source).loadTile(re,J)}reloadTile(j,U,J){const re=this.enableTerrain?s.extend({enableTerrain:this.terrain},U):U;re.projection=this.projections[j]||this.defaultProjection,this.getWorkerSource(j,U.type,U.source).reloadTile(re,J)}abortTile(j,U,J){this.getWorkerSource(j,U.type,U.source).abortTile(U,J)}removeTile(j,U,J){this.getWorkerSource(j,U.type,U.source).removeTile(U,J)}removeSource(j,U,J){if(!this.workerSources[j]||!this.workerSources[j][U.type]||!this.workerSources[j][U.type][U.source])return;const re=this.workerSources[j][U.type][U.source];delete this.workerSources[j][U.type][U.source],re.removeSource!==void 0?re.removeSource(U,J):J()}loadWorkerSource(j,U,J){try{this.self.importScripts(U.url),J()}catch(re){J(re.toString())}}syncRTLPluginState(j,U,J){try{s.plugin.setState(U);const re=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&re!=null){this.self.importScripts(re);const ge=s.plugin.isParsed();J(ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${re}`),ge)}}catch(re){J(re.toString())}}getAvailableImages(j){let U=this.availableImages[j];return U||(U=[]),U}getLayerIndex(j){let U=this.layerIndexes[j];return U||(U=this.layerIndexes[j]=new R),U}getWorkerSource(j,U,J){return this.workerSources[j]||(this.workerSources[j]={}),this.workerSources[j][U]||(this.workerSources[j][U]={}),this.workerSources[j][U][J]||(this.workerSources[j][U][J]=new this.workerSourceTypes[U]({send:(re,ge,Se,Ee,_e,Ie)=>{this.actor.send(re,ge,Se,j,_e,Ie)},scheduler:this.actor.scheduler},this.getLayerIndex(j),this.getAvailableImages(j),this.isSpriteLoaded[j])),this.workerSources[j][U][J]}getDEMWorkerSource(j,U){return this.demWorkerSources[j]||(this.demWorkerSources[j]={}),this.demWorkerSources[j][U]||(this.demWorkerSources[j][U]=new D),this.demWorkerSources[j][U]}enforceCacheSizeLimit(j,U){s.enforceCacheSizeLimit(U)}getWorkerPerformanceMetrics(j,U,J){J(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ta(self)),Ta}),x(["./shared"],function(s){function A(h,r){if(Array.isArray(h)){if(!Array.isArray(r)||h.length!==r.length)return!1;for(let c=0;c<h.length;c++)if(!A(h[c],r[c]))return!1;return!0}if(typeof h=="object"&&h!==null&&r!==null){if(typeof r!="object"||Object.keys(h).length!==Object.keys(r).length)return!1;for(const c in h)if(!A(h[c],r[c]))return!1;return!0}return h===r}var k=R;function R(h){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,y,v=new Blob([""],{type:"text/javascript"}),T=URL.createObjectURL(v);try{y=new Worker(T),p=!0}catch{p=!1}return y&&y.terminate(),URL.revokeObjectURL(T),p}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var p=document.createElement("canvas");p.width=p.height=1;var y=p.getContext("2d");if(!y)return!1;var v=y.getImageData(0,0,1,1);return v&&v.width===p.width}()?(D[c=r&&r.failIfMajorPerformanceCaveat]===void 0&&(D[c]=function(p){var y,v=function(T){var C=document.createElement("canvas"),M=Object.create(R.webGLContextAttributes);return M.failIfMajorPerformanceCaveat=T,C.getContext("webgl",M)||C.getContext("experimental-webgl",M)}(p);if(!v)return!1;try{y=v.createShader(v.VERTEX_SHADER)}catch{return!1}return!(!y||v.isContextLost())&&(v.shaderSource(y,"void main() {}"),v.compileShader(y),v.getShaderParameter(y,v.COMPILE_STATUS)===!0)}(c)),D[c]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var c}(h)}var D={};function F(h,r,c){const p=s.window.document.createElement(h);return r!==void 0&&(p.className=r),c&&c.appendChild(p),p}function G(h,r,c){const p=s.window.document.createElementNS("http://www.w3.org/2000/svg",h);for(const y of Object.keys(r))p.setAttributeNS(null,y,r[y]);return c&&c.appendChild(p),p}R.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const oe=s.window.document&&s.window.document.documentElement.style,se=oe&&oe.userSelect!==void 0?"userSelect":"WebkitUserSelect";let we;function xe(){oe&&se&&(we=oe[se],oe[se]="none")}function Te(){oe&&se&&(oe[se]=we)}function Ue(h){h.preventDefault(),h.stopPropagation(),s.window.removeEventListener("click",Ue,!0)}function Be(){s.window.addEventListener("click",Ue,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",Ue,!0)},0)}function Pe(h,r){const c=h.getBoundingClientRect();return ke(h,c,r)}function Oe(h,r){const c=h.getBoundingClientRect(),p=[];for(let y=0;y<r.length;y++)p.push(ke(h,c,r[y]));return p}function Le(h){return s.window.InstallTrigger!==void 0&&h.button===2&&h.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button}function ke(h,r,c){const p=h.offsetWidth===r.width?1:h.offsetWidth/r.width;return new s.pointGeometry((c.clientX-r.left)*p,(c.clientY-r.top)*p)}function We(h,r){var c=r[0],p=r[1],y=r[2],v=r[3],T=c*v-y*p;return T?(h[0]=v*(T=1/T),h[1]=-p*T,h[2]=-y*T,h[3]=c*T,h):null}function ct(h){const{userImage:r}=h;return!!(r&&r.render&&r.render())&&(h.data.replace(new Uint8Array(r.data.buffer)),!0)}class Tt extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:c,callback:p}of this.requestors)this._notify(c,p);this.requestors=[]}}hasImage(r){return!!this.getImage(r)}getImage(r){return this.images[r]}addImage(r,c){this._validate(r,c)&&(this.images[r]=c)}_validate(r,c){let p=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),p=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),p=!1),this._validateContent(c.content,c)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),p=!1),p}_validateStretch(r,c){if(!r)return!0;let p=0;for(const y of r){if(y[0]<p||y[1]<y[0]||c<y[1])return!1;p=y[1]}return!0}_validateContent(r,c){return!(r&&(r.length!==4||r[0]<0||c.data.width<r[0]||r[1]<0||c.data.height<r[1]||r[2]<0||c.data.width<r[2]||r[3]<0||c.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,c){c.version=this.images[r].version+1,this.images[r]=c,this.updatedImages[r]=!0}removeImage(r){const c=this.images[r];delete this.images[r],delete this.patterns[r],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,c){let p=!0;if(!this.isLoaded())for(const y of r)this.images[y]||(p=!1);this.isLoaded()||p?this._notify(r,c):this.requestors.push({ids:r,callback:c})}_notify(r,c){const p={};for(const y of r){this.images[y]||this.fire(new s.Event("styleimagemissing",{id:y}));const v=this.images[y];v?p[y]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,hasRenderCallback:Boolean(v.userImage&&v.userImage.render)}:s.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,p)}getPixelSize(){const{width:r,height:c}=this.atlasImage;return{width:r,height:c}}getPattern(r){const c=this.patterns[r],p=this.getImage(r);if(!p)return null;if(c&&c.position.version===p.version)return c.position;if(c)c.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},v=new s.ImagePosition(y,p);this.patterns[r]={bin:y,position:v}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const c=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(r,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const v in this.patterns)r.push(this.patterns[v].bin);const{w:c,h:p}=s.potpack(r),y=this.atlasImage;y.resize({width:c||1,height:p||1});for(const v in this.patterns){const{bin:T}=this.patterns[v],C=T.x+1,M=T.y+1,z=this.images[v].data,O=z.width,N=z.height;s.RGBAImage.copy(z,y,{x:0,y:0},{x:C,y:M},{width:O,height:N}),s.RGBAImage.copy(z,y,{x:0,y:N-1},{x:C,y:M-1},{width:O,height:1}),s.RGBAImage.copy(z,y,{x:0,y:0},{x:C,y:M+N},{width:O,height:1}),s.RGBAImage.copy(z,y,{x:O-1,y:0},{x:C-1,y:M},{width:1,height:N}),s.RGBAImage.copy(z,y,{x:0,y:0},{x:C+O,y:M},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const c of r){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const p=this.images[c];ct(p)&&this.updateImage(c,p)}}}const st=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(h,r){return function([c,p,y]){const v=s.degToRad(p+90),T=s.degToRad(y);return{x:c*Math.cos(v)*Math.sin(T),y:c*Math.sin(v)*Math.sin(T),z:c*Math.cos(T),azimuthal:p,polar:y}}(h.expression.evaluate(r))}interpolate(h,r,c){return{x:s.number(h.x,r.x,c),y:s.number(h.y,r.y,c),z:s.number(h.z,r.z,c),azimuthal:s.number(h.azimuthal,r.azimuthal,c),polar:s.number(h.polar,r.polar,c)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),Ge="-transition";class Ne extends s.Evented{constructor(r){super(),this._transitionable=new s.Transitionable(st),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,c={}){if(!this._validate(s.validateLight,r,c))for(const p in r){const y=r[p];s.endsWith(p,Ge)?this._transitionable.setTransition(p.slice(0,-Ge.length),y):this._transitionable.setValue(p,y)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,p){return(!p||p.validate!==!1)&&s.emitValidationErrors(this,r.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const vt=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)}),rt="-transition";class at extends s.Evented{constructor(r,c){super(),this._transitionable=new s.Transitionable(vt),this.set(r),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(r){for(const c in r){const p=r[c];s.endsWith(c,rt)?this._transitionable.setTransition(c.slice(0,-rt.length),p):this._transitionable.setValue(c,p)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}}function ht(h,r,c,p){const y=s.smoothstep(45,65,c),[v,T]=Ft(h,p),C=s.length(r);let M=1-Math.min(1,Math.exp((C-v)/(T-v)*-6));return M*=M*M,M=Math.min(1,1.00747*M),M*y*h.alpha}function Ft(h,r){const c=.5/Math.tan(.5*r);return[h.range[0]+c,h.range[1]+c]}const ln=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])}),pn="-transition";class Lt extends s.Evented{constructor(r,c){super(),this._transitionable=new s.Transitionable(ln),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const r=this._transform,c=r.projection.name==="globe",p=s.globeToMercatorTransition(r.zoom),y=this.properties.get("range"),v=[.5,3];return{range:c?[s.number(v[0],y[0],p),s.number(v[1],y[1],p)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,c={}){if(!this._validate(s.validateFog,r,c)){for(const p of Object.keys(s.spec.fog))r&&r[p]===void 0&&(r[p]=s.spec.fog[p].default);for(const p in r){const y=r[p];s.endsWith(p,pn)?this._transitionable.setTransition(p.slice(0,-pn.length),y):this._transitionable.setValue(p,y)}}}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,r))*c.a}getOpacityAtLatLng(r,c){return this._transform.projection.supportsFog?function(p,y,v){const T=s.MercatorCoordinate.fromLngLat(y),C=v.elevation?v.elevation.getAtPointOrZero(T):0,M=[T.x,T.y,C];return s.transformMat4(M,M,v.mercatorFogMatrix),ht(p,M,v.pitch,v._fov)}(this.state,r,c):0}getFovAdjustedRange(r){return this._transform.projection.supportsFog?Ft(this.state,r):[0,1]}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,p){return(!p||p.validate!==!1)&&s.emitValidationErrors(this,r.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class nn{constructor(r,c){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const p=this.workerPool.acquire(this.id);for(let y=0;y<p.length;y++){const v=new nn.Actor(p[y],c,this.id);v.name=`Worker ${y}`,this.actors.push(v)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,c,p){s.asyncAll(this.actors,(y,v)=>{y.send(r,c,v)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function xt(h,r,c){return r*(s.EXTENT/(h.tileSize*Math.pow(2,c-h.tileID.overscaledZ)))}nn.Actor=s.Actor;class be{constructor(r,c,p,y){this.screenBounds=r,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(r,c){let p,y;if(r instanceof s.pointGeometry||typeof r[0]=="number"){const v=s.pointGeometry.convert(r);p=[s.pointGeometry.convert(r)],y=c.isPointAboveHorizon(v)}else{const v=s.pointGeometry.convert(r[0]),T=s.pointGeometry.convert(r[1]);p=[v,T],y=s.polygonizeBounds(v,T).every(C=>c.isPointAboveHorizon(C))}return new be(p,c.getCameraPoint(),y,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const c=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],y=s.polygonizeBounds(c,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<p.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?y[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(y[3]=this.cameraPoint)),s.bufferConvexPolygon(y,r)}bufferedCameraGeometryGlobe(r){const c=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],y=s.polygonizeBounds(c,p,r),v=this.cameraPoint.clone();switch(3*((v.y>c.y)+(v.y>p.y))+((v.x>c.x)+(v.x>p.x))){case 0:y[0]=v,y[4]=v.clone();break;case 1:y.splice(1,0,v);break;case 2:y[1]=v;break;case 3:y.splice(4,0,v);break;case 5:y.splice(2,0,v);break;case 6:y[3]=v;break;case 7:y.splice(3,0,v);break;case 8:y[2]=v}return y}containsTile(r,c,p,y=0){const v=r.queryPadding/c._pixelsPerMercatorPixel+1,T=p?this._bufferedCameraMercator(v,c):this._bufferedScreenMercator(v,c);let C=r.tileID.wrap+(T.unwrapped?y:0);const M=T.polygon.map(X=>s.getTilePoint(r.tileTransform,X,C));if(!s.polygonIntersectsBox(M,0,0,s.EXTENT,s.EXTENT))return;C=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);const z=this.screenGeometryMercator.polygon.map(X=>s.getTileVec3(r.tileTransform,X,C)),O=z.map(X=>new s.pointGeometry(X[0],X[1])),N=c.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),$=s.getTileVec3(r.tileTransform,N,C),K=z.map(X=>{const q=s.sub(X,X,$);return s.normalize(q,q),new s.Ray($,q)}),W=xt(r,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:O,tilespaceRays:K,bufferedTilespaceGeometry:M,bufferedTilespaceBounds:(H=s.getBounds(M),H.min.x=s.clamp(H.min.x,0,s.EXTENT),H.min.y=s.clamp(H.min.y,0,s.EXTENT),H.max.x=s.clamp(H.max.x,0,s.EXTENT),H.max.y=s.clamp(H.max.y,0,s.EXTENT),H),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:W};var H}_bufferedScreenMercator(r,c){const p=bt(r);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let y;return y=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),c):{polygon:this.bufferedScreenGeometry(r).map(v=>c.pointCoordinate3D(v)),unwrapped:!0},this._screenRaycastCache[p]=y,y}}_bufferedCameraMercator(r,c){const p=bt(r);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let y;return y=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),c):{polygon:this.bufferedCameraGeometry(r).map(v=>c.pointCoordinate3D(v)),unwrapped:!0},this._cameraRaycastCache[p]=y,y}}_projectAndResample(r,c){const p=function(v,T){const C=s.multiply([],T.pixelMatrix,T.globeMatrix),M=[0,-s.GLOBE_RADIUS,0,1],z=[0,s.GLOBE_RADIUS,0,1],O=[0,0,0,1];s.transformMat4$1(M,M,C),s.transformMat4$1(z,z,C),s.transformMat4$1(O,O,C);const N=new s.pointGeometry(M[0]/M[3],M[1]/M[3]),$=new s.pointGeometry(z[0]/z[3],z[1]/z[3]),K=s.polygonContainsPoint(v,N)&&M[3]<O[3],W=s.polygonContainsPoint(v,$)&&z[3]<O[3];if(!K&&!W)return null;const H=function(de,he,ve){for(let ze=1;ze<de.length;ze++){const pt=ut(he.pointCoordinate3D(de[ze-1]).x),Ce=ut(he.pointCoordinate3D(de[ze]).x);if(ve<0){if(pt<Ce)return{idx:ze,t:-pt/(Ce-1-pt)}}else if(Ce<pt)return{idx:ze,t:(1-pt)/(Ce+1-pt)}}return null}(v,T,K?-1:1);if(!H)return null;const{idx:X,t:q}=H;let te=X>1?Xe(v.slice(0,X),T):[],Y=X<v.length?Xe(v.slice(X),T):[];te=te.map(de=>new s.pointGeometry(ut(de.x),de.y)),Y=Y.map(de=>new s.pointGeometry(ut(de.x),de.y));const pe=[...te];pe.length===0&&pe.push(Y[Y.length-1]);const fe=s.number(pe[pe.length-1].y,(Y.length===0?te[0]:Y[0]).y,q);let le;return le=K?[new s.pointGeometry(0,fe),new s.pointGeometry(0,0),new s.pointGeometry(1,0),new s.pointGeometry(1,fe)]:[new s.pointGeometry(1,fe),new s.pointGeometry(1,1),new s.pointGeometry(0,1),new s.pointGeometry(0,fe)],pe.push(...le),Y.length===0?pe.push(te[0]):pe.push(...Y),{polygon:pe.map(de=>new s.MercatorCoordinate(de.x,de.y)),unwrapped:!1}}(r,c);if(p)return p;const y=function(v,T){let C=!1,M=-1/0,z=0;for(let N=0;N<v.length-1;N++)v[N].x>M&&(M=v[N].x,z=N);for(let N=0;N<v.length-1;N++){const $=(z+N)%(v.length-1),K=v[$],W=v[$+1];Math.abs(K.x-W.x)>.5&&(K.x<W.x?(K.x+=1,$===0&&(v[v.length-1].x+=1)):(W.x+=1,$+1===v.length-1&&(v[0].x+=1)),C=!0)}const O=s.mercatorXfromLng(T.center.lng);return C&&O<Math.abs(O-1)&&v.forEach(N=>{N.x-=1}),{polygon:v,unwrapped:C}}(Xe(r,c).map(v=>new s.pointGeometry(ut(v.x),v.y)),c);return{polygon:y.polygon.map(v=>new s.MercatorCoordinate(v.x,v.y)),unwrapped:y.unwrapped}}}function Xe(h,r){return s.resample(h,c=>{const p=r.pointCoordinate3D(c);c.x=p.x,c.y=p.y},1/256)}function ut(h){return h<0?1+h%1:h%1}function bt(h){return 100*h|0}function Yt(h,r,c,p,y){const v=function(T,C){if(T)return y(T);if(C){const M=s.pick(s.extend(C,h),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(M.vectorLayers=C.vector_layers,M.vectorLayerIds=M.vectorLayers.map(z=>z.id)),C.language_options&&(M.languageOptions=C.language_options),C.language&&C.language[C.id]&&(M.language=C.language[C.id]),C.worldview_options&&(M.worldviewOptions=C.worldview_options),C.worldview?M.worldview=C.worldview[C.id]:C.worldview_default&&(M.worldview=C.worldview_default),M.tiles=r.canonicalizeTileset(M,h.url),y(null,M)}};return h.url?s.getJSON(r.transformRequest(r.normalizeSourceURL(h.url,null,c,p),s.ResourceType.Source),v):s.exported.frame(()=>v(null,h))}class en{constructor(r,c,p){this.bounds=s.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=c||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const c=Math.pow(2,r.z),p=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*c),y=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*c),v=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*c),T=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*c);return r.x>=p&&r.x<v&&r.y>=y&&r.y<T}}class qt{constructor(r,c,p){this.context=r;const y=r.gl;this.buffer=y.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ie={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ye{constructor(r,c,p,y){this.length=c.length,this.attributes=p,this.itemSize=c.bytesPerElement,this.dynamicDraw=y,this.context=r;const v=r.gl;this.buffer=v.createBuffer(),r.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,c){for(let p=0;p<this.attributes.length;p++){const y=c.attributes[this.attributes[p].name];y!==void 0&&r.enableVertexAttribArray(y)}}setVertexAttribPointers(r,c,p){for(let y=0;y<this.attributes.length;y++){const v=this.attributes[y],T=c.attributes[v.name];T!==void 0&&r.vertexAttribPointer(T,v.components,r[ie[v.type]],!1,this.itemSize,v.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ae{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qe extends Ae{getDefault(){return s.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class ot extends Ae{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Et extends Ae{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class wt extends Ae{getDefault(){return[!0,!0,!0,!0]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class ft extends Ae{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Qe extends Ae{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class dt extends Ae{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const c=this.current;(r.func!==c.func||r.ref!==c.ref||r.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Rt extends Ae{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Ct extends Ae{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=r,this.dirty=!1}}class jt extends Ae{getDefault(){return[0,1]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Xt extends Ae{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=r,this.dirty=!1}}class sn extends Ae{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Pn extends Ae{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.BLEND):c.disable(c.BLEND),this.current=r,this.dirty=!1}}class yn extends Ae{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Nn extends Ae{getDefault(){return s.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class bi extends Ae{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Sr extends Ae{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=r,this.dirty=!1}}class Di extends Ae{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Gi extends Ae{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class Wo extends Ae{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class wi extends Ae{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Li extends Ae{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class mo extends Ae{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class wa extends Ae{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Bl extends Ae{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Fl extends Ae{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class _u extends Ae{getDefault(){return null}set(r){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class go extends Ae{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class Kr extends Ae{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Ss extends Ae{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class jl extends Ae{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Ji extends Ae{constructor(r,c){super(r),this.context=r,this.parent=c}getDefault(){return null}}class Ta extends Ji{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class ee extends Ji{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class j extends ee{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class U{constructor(r,c,p,y){this.context=r,this.width=c,this.height=p;const v=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new Ta(r,v),y&&(this.depthAttachment=new ee(r,v))}destroy(){const r=this.context.gl,c=this.colorAttachment.get();if(c&&r.deleteTexture(c),this.depthAttachment){const p=this.depthAttachment.get();p&&r.deleteRenderbuffer(p)}r.deleteFramebuffer(this.framebuffer)}}class J{constructor(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new qe(this),this.clearDepth=new ot(this),this.clearStencil=new Et(this),this.colorMask=new wt(this),this.depthMask=new ft(this),this.stencilMask=new Qe(this),this.stencilFunc=new dt(this),this.stencilOp=new Rt(this),this.stencilTest=new Ct(this),this.depthRange=new jt(this),this.depthTest=new Xt(this),this.depthFunc=new sn(this),this.blend=new Pn(this),this.blendFunc=new yn(this),this.blendColor=new Nn(this),this.blendEquation=new bi(this),this.cullFace=new Sr(this),this.cullFaceSide=new Di(this),this.frontFace=new Gi(this),this.program=new Wo(this),this.activeTexture=new wi(this),this.viewport=new Li(this),this.bindFramebuffer=new mo(this),this.bindRenderbuffer=new wa(this),this.bindTexture=new Bl(this),this.bindVertexBuffer=new Fl(this),this.bindElementBuffer=new _u(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new go(this),this.pixelStoreUnpack=new Kr(this),this.pixelStoreUnpackPremultiplyAlpha=new Ss(this),this.pixelStoreUnpackFlipY=new jl(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(r.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=r.getExtension("OES_standard_derivatives"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,c){return new qt(this,r,c)}createVertexBuffer(r,c,p){return new ye(this,r,c,p)}createRenderbuffer(r,c,p){const y=this.gl,v=y.createRenderbuffer();return this.bindRenderbuffer.set(v),y.renderbufferStorage(y.RENDERBUFFER,r,c,p),this.bindRenderbuffer.set(null),v}createFramebuffer(r,c,p){return new U(this,r,c,p)}clear({color:r,depth:c,stencil:p}){const y=this.gl;let v=0;r&&(v|=y.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(v|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),p!==void 0&&(v|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),y.clear(v)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){A(r.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class re extends s.Evented{constructor(r,c,p,y){super(),this.id=r,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},c),s.extend(this,s.pick(c,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Yt(this._options,this.map._requestManager,null,null,(r,c)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new s.ErrorEvent(r)):c&&(s.extend(this,c),c.bounds&&(this.tileBounds=new en(c.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(c.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,c){const p=s.exported.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);r.request=s.getImage(this.map._requestManager.transformRequest(y,s.ResourceType.Tile),(v,T,C,M)=>(delete r.request,r.aborted?(r.state="unloaded",c(null)):v?(r.state="errored",c(v)):T?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:C,expires:M}),r.setTexture(T,this.map.painter),r.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(r,c,p){r.setTexture(c,p)}static unloadTileData(r,c){r.texture&&c.saveTileTexture(r.texture)}abortTile(r,c){r.request&&(r.request.cancel(),delete r.request),c()}unloadTile(r,c){r.texture&&this.map.painter.saveTileTexture(r.texture),c()}hasTransition(){return!1}}let ge;function Se(h,r,c,p,y,v,T,C){const M=[h,c,y,r,p,v,1,1,1],z=[T,C,1],O=s.adjoint([],M),[N,$,K]=s.transformMat3(z,z,s.transpose(O,O));return s.multiply$1(M,[N,0,0,0,$,0,0,0,K],M)}class Ee extends s.Evented{constructor(r,c,p,y){super(),this.id=r,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=c}load(r,c){this._loaded=c||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(p,y)=>{if(this._loaded=!0,p)this.fire(new s.ErrorEvent(p));else if(y){const{HTMLImageElement:v}=s.window;this.image=y instanceof v?s.exported.getImageData(y):y,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading()}})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(r){this.coordinates=r,this._boundsArray=void 0;const c=r.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let y=1/0,v=1/0,T=-1/0,C=-1/0;for(const N of p)y=Math.min(y,N.x),v=Math.min(v,N.y),T=Math.max(T,N.x),C=Math.max(C,N.y);const M=Math.max(T-y,C-v),z=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),O=Math.pow(2,z);return new s.CanonicalTileID(z,Math.floor((y+T)/2*O),Math.floor((v+C)/2*O))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(r){for(const M in this.tiles){const z=this.tiles[M];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture)}if(this._boundsArray)return;const c=s.tileTransform(this.tileID,this.map.transform.projection),[p,y,v,T]=this.coordinates.map(M=>{const z=c.projection.project(M[0],M[1]);return s.getTilePoint(c,z)._round()});this.perspectiveTransform=function(M,z,O,N,$,K,W,H,X,q){const te=Se(0,0,M,0,0,z,M,z),Y=Se(O,N,$,K,W,H,X,q);return s.multiply$1(Y,s.adjoint(te,te),Y),[Y[6]/Y[8]*M/s.EXTENT,Y[7]/Y[8]*z/s.EXTENT]}(this.width,this.height,p.x,p.y,y.x,y.y,T.x,T.y,v.x,v.y);const C=this._boundsArray=new s.StructArrayLayout4i8;C.emplaceBack(p.x,p.y,0,0),C.emplaceBack(y.x,y.y,s.EXTENT,0),C.emplaceBack(T.x,T.y,0,s.EXTENT),C.emplaceBack(v.x,v.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=r.createVertexBuffer(C,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,c=r.gl;this.texture?this.texture.update(this.image):(this.texture=new s.Texture(r,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._prepareData(r)}loadTile(r,c){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},c(null)):(r.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const _e={vector:class extends s.Evented{constructor(h,r,c,p){if(super(),this.id=h,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(r,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(h){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const r=this.language||this.map._language,c=this.worldview||this.map._worldview;this._tileJSONRequest=Yt(this._options,this.map._requestManager,r,c,(p,y)=>{this._tileJSONRequest=null,this._loaded=!0,p?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code. Found: ${r}`),c&&c.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${c}`),this.fire(new s.ErrorEvent(p))):y&&(s.extend(this,y),y.bounds&&(this.tileBounds=new en(y.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(y.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(p)})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}setSourceProperty(h){this._tileJSONRequest&&this._tileJSONRequest.cancel(),h(),this.load(()=>{const r=this.map.style._getSourceCaches(this.id);for(const c of r)c.clearTiles()})}setTiles(h){return this.setSourceProperty(()=>{this._options.tiles=h}),this}setUrl(h){return this.setSourceProperty(()=>{this.url=h,this._options.url=h}),this}_setLanguage(h){return h===this.language||this.setSourceProperty(()=>{this.language=h}),this}_setWorldview(h){return h===this.worldview?this:this.worldviewOptions&&h&&!this.worldviewOptions[h]?(console.warn(`Vector tile source "${this.id}" does not support worldview "${h}".`),this):(this.setSourceProperty(()=>{this.worldview=h}),this)}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}loadTile(h,r){const c=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(c,s.ResourceType.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile};if(p.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired")h.state==="loading"?h.reloadCallback=r:h.request=h.actor.send("reloadTile",p,y.bind(this));else if(h.actor=this._tileWorkers[c]=this._tileWorkers[c]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",p,y.bind(this),void 0,!0);else{const v=s.loadVectorTile.call({deduped:this._deduped},p,(T,C)=>{T||!C?y.call(this,T):(p.data={cacheControl:C.cacheControl,expires:C.expires,rawData:C.rawData.slice(0)},h.actor&&h.actor.send("loadTile",p,y.bind(this),void 0,!0))},!0);h.request={cancel:v}}function y(v,T){return delete h.request,h.aborted?r(null):v&&v.status!==404?r(v):(T&&T.resourceTiming&&(h.resourceTiming=T.resourceTiming),this.map._refreshExpiredTiles&&T&&h.setExpiryData(T),h.loadVectorData(T,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id})}unloadTile(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:re,"raster-dem":class extends re{constructor(h,r,c,p){super(h,r,c,p),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(h,r){const c=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(y,v){y&&(h.state="errored",r(y)),v&&(h.dem=v,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",r(null))}h.request=s.getImage(this.map._requestManager.transformRequest(c,s.ResourceType.Tile),function(y,v,T,C){if(delete h.request,h.aborted)h.state="unloaded",r(null);else if(y)h.state="errored",r(y);else if(v){this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:T,expires:C});const M=s.window.ImageBitmap&&v instanceof s.window.ImageBitmap&&(ge==null&&(ge=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),ge),z=1-(v.width-s.prevPowerOfTwo(v.width))/2;z<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const O=M?v:s.exported.getImageData(v,z),N={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:O,encoding:this.encoding,padding:z};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",N,p.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(h){const r=h.canonical,c=Math.pow(2,r.z),p=(r.x-1+c)%c,y=r.x===0?h.wrap-1:h.wrap,v=(r.x+1+c)%c,T=r.x+1===c?h.wrap+1:h.wrap,C={};return C[new s.OverscaledTileID(h.overscaledZ,y,r.z,p,r.y).key]={backfilled:!1},C[new s.OverscaledTileID(h.overscaledZ,T,r.z,v,r.y).key]={backfilled:!1},r.y>0&&(C[new s.OverscaledTileID(h.overscaledZ,y,r.z,p,r.y-1).key]={backfilled:!1},C[new s.OverscaledTileID(h.overscaledZ,h.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},C[new s.OverscaledTileID(h.overscaledZ,T,r.z,v,r.y-1).key]={backfilled:!1}),r.y+1<c&&(C[new s.OverscaledTileID(h.overscaledZ,y,r.z,p,r.y+1).key]={backfilled:!1},C[new s.OverscaledTileID(h.overscaledZ,h.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},C[new s.OverscaledTileID(h.overscaledZ,T,r.z,v,r.y+1).key]={backfilled:!1}),C}unloadTile(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded"}},geojson:class extends s.Evented{constructor(h,r,c,p){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(p),this._data=r.data,this._options=s.extend({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const y=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*y,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*y,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:s.EXTENT,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*y,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}getClusterExpansionZoom(h,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},r),this}getClusterChildren(h,r){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},r),this}getClusterLeaves(h,r,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:r,offset:c},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const h=s.extend({},this.workerOptions),r=this._data;typeof r=="string"?(h.request=this.map._requestManager.transformRequest(s.exported.resolveURL(r),s.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,h,(c,p)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new s.ErrorEvent(c));else{const y={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(y.resourceTiming=p.resourceTiming[this.id]),this.fire(new s.Event("data",y)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(h,r){const c=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(c,{type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,y)=>(delete h.request,h.unloadVectorData(),h.aborted?r(null):p?r(p):(h.loadVectorData(y,this.map.painter,c==="reloadTile"),r(null))),void 0,c==="loadTile")}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ee{constructor(h,r,c,p){super(h,r,c,p),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const r of h.urls)this.urls.push(this.map._requestManager.transformRequest(r,s.ResourceType.Source).url);s.getVideo(this.urls,(r,c)=>{this._loaded=!0,r?this.fire(new s.ErrorEvent(r)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const r=this.video.seekable;h<r.start(0)||h>r.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const h=this.map.painter.context,r=h.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(h,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(h)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ee,canvas:class extends Ee{constructor(h,r,c,p){super(h,r,c,p),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(v=>typeof v!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${h}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${h}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}},custom:class extends s.Evented{constructor(h,r,c,p){super(),this.id=h,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=r,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new en(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(h){this._map=h,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(h),this.load()}onRemove(h){this._implementation.onRemove&&this._implementation.onRemove(h)}hasTile(h){if(this._implementation.hasTile){const{x:r,y:c,z:p}=h.canonical;return this._implementation.hasTile({x:r,y:c,z:p})}return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,r){const{x:c,y:p,z:y}=h.tileID.canonical,v=new s.window.AbortController,T=this._implementation.loadTile({x:c,y:p,z:y},{signal:v.signal});if(!T)return this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",r(null);T.cancel=()=>v.abort(),h.request=T.then(function(C){return delete h.request,h.aborted?(h.state="unloaded",r(null)):C?function(M){return M instanceof s.window.ImageData||M instanceof s.window.ImageBitmap||M instanceof s.window.HTMLCanvasElement}(C)?(this.loadTileData(h,C),h.state="loaded",void r(null)):(h.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",r(null))}.bind(this)).catch(C=>{C.code!==20&&(h.state="errored",r(C))})}loadTileData(h,r){re.loadTileData(h,r,this._map.painter)}unloadTileData(h){re.unloadTileData(h,this._map.painter)}prepareTile(h){if(!this._implementation.prepareTile)return null;const{x:r,y:c,z:p}=h.tileID.canonical,y=this._implementation.prepareTile({x:r,y:c,z:p});return y?(this.loadTileData(h,y),h.state="loaded",y):null}unloadTile(h,r){if(this.unloadTileData(h),this._implementation.unloadTile){const{x:c,y:p,z:y}=h.tileID.canonical;this._implementation.unloadTile({x:c,y:p,z:y})}r()}abortTile(h,r){h.request&&h.request.cancel&&(h.request.cancel(),delete h.request),r()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(h=>({x:h.canonical.x,y:h.canonical.y,z:h.canonical.z}))}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Ie=function(h,r,c,p){const y=new _e[r.type](h,r,c,p);if(y.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${y.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],y),y};function tt(h,r){const c=s.identity([]);return s.scale(c,c,[.5*h.width,.5*-h.height,1]),s.translate(c,c,[1,-1,0]),s.multiply(c,c,h.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(c)}function zt(h,r,c,p,y,v,T,C=!1){const M=h.tilesIn(p,T,C);M.sort(Ht);const z=[];for(const N of M)z.push({wrappedTileID:N.tile.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(r,c,h._state,N,y,v,tt(h.transform,N.tile.tileID),C)});const O=function(N){const $={},K={};for(const W of N){const H=W.queryResults,X=W.wrappedTileID,q=K[X]=K[X]||{};for(const te in H){const Y=H[te],pe=q[te]=q[te]||{},fe=$[te]=$[te]||[];for(const le of Y)pe[le.featureIndex]||(pe[le.featureIndex]=!0,fe.push(le))}}return $}(z);for(const N in O)O[N].forEach($=>{const K=$.feature,W=K.layer;W&&W.type!=="background"&&W.type!=="sky"&&(K.source=W.source,W["source-layer"]&&(K.sourceLayer=W["source-layer"]),K.state=K.id!==void 0?h.getFeatureState(W["source-layer"],K.id):{})});return O}function lt(h,r){const c=h.getRenderableIds().map(v=>h.getTileByID(v)),p=[],y={};for(let v=0;v<c.length;v++){const T=c[v],C=T.tileID.canonical.key;y[C]||(y[C]=!0,T.querySourceFeatures(p,r))}return p}function Ht(h,r){const c=h.tileID,p=r.tileID;return c.overscaledZ-p.overscaledZ||c.canonical.y-p.canonical.y||c.wrap-p.wrap||c.canonical.x-p.canonical.x}function Kt(){return Ja.workerClass!=null?new Ja.workerClass:new s.window.Worker(Ja.workerUrl)}const Vt="mapboxgl_preloaded_worker_pool";class Jt{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Jt.workerCount;)this.workers.push(new Kt);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Vt]}numActive(){return Object.keys(this.active).length}}let mn;function Fn(){return mn||(mn=new Jt),mn}function Gn(h,r){const c={};for(const p in h)p!=="ref"&&(c[p]=h[p]);return s.refProperties.forEach(p=>{p in r&&(c[p]=r[p])}),c}function jn(h){h=h.slice();const r=Object.create(null);for(let c=0;c<h.length;c++)r[h[c].id]=h[c];for(let c=0;c<h.length;c++)"ref"in h[c]&&(h[c]=Gn(h[c],r[h[c].ref]));return h}Jt.workerCount=2;const Wt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function $e(h,r,c){c.push({command:Wt.addSource,args:[h,r[h]]})}function sr(h,r,c){r.push({command:Wt.removeSource,args:[h]}),c[h]=!0}function ci(h,r,c,p){sr(h,c,p),$e(h,r,c)}function _o(h,r,c){let p;for(p in h[c])if(h[c].hasOwnProperty(p)&&p!=="data"&&!A(h[c][p],r[c][p]))return!1;for(p in r[c])if(r[c].hasOwnProperty(p)&&p!=="data"&&!A(h[c][p],r[c][p]))return!1;return!0}function Nl(h,r,c,p,y,v){let T;for(T in r=r||{},h=h||{})h.hasOwnProperty(T)&&(A(h[T],r[T])||c.push({command:v,args:[p,T,r[T],y]}));for(T in r)r.hasOwnProperty(T)&&!h.hasOwnProperty(T)&&(A(h[T],r[T])||c.push({command:v,args:[p,T,r[T],y]}))}function Mr(h){return h.id}function Ul(h,r){return h[r.id]=r,h}class jm{constructor(r,c){this.reset(r,c)}reset(r,c){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=s.clamp(r,0,1);let c=1,p=this._distances[c];const y=r*this.paddedLength+this.padding;for(;p<y&&c<this._distances.length;)p=this._distances[++c];const v=c-1,T=this._distances[v],C=p-T,M=C>0?(y-T)/C:0;return this.points[v].mult(1-M).add(this.points[c].mult(M))}}class Ms{constructor(r,c,p){const y=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(c/p);for(let T=0;T<this.xCellCount*this.yCellCount;T++)y.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=c,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,c,p,y,v){this._forEachCell(c,p,y,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(v)}insertCircle(r,c,p,y){this._forEachCell(c-y,p-y,c+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(c),this.circles.push(p),this.circles.push(y)}_insertBoxCell(r,c,p,y,v,T){this.boxCells[v].push(T)}_insertCircleCell(r,c,p,y,v,T){this.circleCells[v].push(T)}_query(r,c,p,y,v,T){if(p<0||r>this.width||y<0||c>this.height)return!v&&[];const C=[];if(r<=0&&c<=0&&this.width<=p&&this.height<=y){if(v)return!0;for(let M=0;M<this.boxKeys.length;M++)C.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const z=this.circles[3*M],O=this.circles[3*M+1],N=this.circles[3*M+2];C.push({key:this.circleKeys[M],x1:z-N,y1:O-N,x2:z+N,y2:O+N})}return T?C.filter(T):C}return this._forEachCell(r,c,p,y,this._queryCell,C,{hitTest:v,seenUids:{box:{},circle:{}}},T),v?C.length>0:C}_queryCircle(r,c,p,y,v){const T=r-p,C=r+p,M=c-p,z=c+p;if(C<0||T>this.width||z<0||M>this.height)return!y&&[];const O=[];return this._forEachCell(T,M,C,z,this._queryCellCircle,O,{hitTest:y,circle:{x:r,y:c,radius:p},seenUids:{box:{},circle:{}}},v),y?O.length>0:O}query(r,c,p,y,v){return this._query(r,c,p,y,!1,v)}hitTest(r,c,p,y,v){return this._query(r,c,p,y,!0,v)}hitTestCircle(r,c,p,y){return this._queryCircle(r,c,p,!0,y)}_queryCell(r,c,p,y,v,T,C,M){const z=C.seenUids,O=this.boxCells[v];if(O!==null){const $=this.bboxes;for(const K of O)if(!z.box[K]){z.box[K]=!0;const W=4*K;if(r<=$[W+2]&&c<=$[W+3]&&p>=$[W+0]&&y>=$[W+1]&&(!M||M(this.boxKeys[K]))){if(C.hitTest)return T.push(!0),!0;T.push({key:this.boxKeys[K],x1:$[W],y1:$[W+1],x2:$[W+2],y2:$[W+3]})}}}const N=this.circleCells[v];if(N!==null){const $=this.circles;for(const K of N)if(!z.circle[K]){z.circle[K]=!0;const W=3*K;if(this._circleAndRectCollide($[W],$[W+1],$[W+2],r,c,p,y)&&(!M||M(this.circleKeys[K]))){if(C.hitTest)return T.push(!0),!0;{const H=$[W],X=$[W+1],q=$[W+2];T.push({key:this.circleKeys[K],x1:H-q,y1:X-q,x2:H+q,y2:X+q})}}}}}_queryCellCircle(r,c,p,y,v,T,C,M){const z=C.circle,O=C.seenUids,N=this.boxCells[v];if(N!==null){const K=this.bboxes;for(const W of N)if(!O.box[W]){O.box[W]=!0;const H=4*W;if(this._circleAndRectCollide(z.x,z.y,z.radius,K[H+0],K[H+1],K[H+2],K[H+3])&&(!M||M(this.boxKeys[W])))return T.push(!0),!0}}const $=this.circleCells[v];if($!==null){const K=this.circles;for(const W of $)if(!O.circle[W]){O.circle[W]=!0;const H=3*W;if(this._circlesCollide(K[H],K[H+1],K[H+2],z.x,z.y,z.radius)&&(!M||M(this.circleKeys[W])))return T.push(!0),!0}}}_forEachCell(r,c,p,y,v,T,C,M){const z=this._convertToXCellCoord(r),O=this._convertToYCellCoord(c),N=this._convertToXCellCoord(p),$=this._convertToYCellCoord(y);for(let K=z;K<=N;K++)for(let W=O;W<=$;W++)if(v.call(this,r,c,p,y,this.xCellCount*W+K,T,C,M))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,c,p,y,v,T){const C=y-r,M=v-c,z=p+T;return z*z>C*C+M*M}_circleAndRectCollide(r,c,p,y,v,T,C){const M=(T-y)/2,z=Math.abs(r-(y+M));if(z>M+p)return!1;const O=(C-v)/2,N=Math.abs(c-(v+O));if(N>O+p)return!1;if(z<=M||N<=O)return!0;const $=z-M,K=N-O;return $*$+K*K<=p*p}}const Ot=Math.tan(85*Math.PI/180);function vn(h,r,c,p,y,v,T){const C=s.create();if(c)if(v.name==="globe"){const M=s.calculateGlobeLabelMatrix(y,r);s.multiply(C,C,M)}else{const M=We([],T);C[0]=M[0],C[1]=M[1],C[4]=M[2],C[5]=M[3],p||s.rotateZ(C,C,y.angle)}else s.multiply(C,y.labelPlaneMatrix,h);return C}function xn(h,r,c,p,y,v,T){const C=vn(h,r,c,p,y,v,T);return v.name==="globe"&&c||(C[2]=C[6]=C[10]=C[14]=0),C}function Ar(h,r,c,p,y,v,T){if(c){if(v.name==="globe"){const C=vn(h,r,c,p,y,v,T);return s.invert(C,C),s.multiply(C,h,C),C}{const C=s.clone(h),M=s.identity([]);return M[0]=T[0],M[1]=T[1],M[4]=T[2],M[5]=T[3],s.multiply(C,C,M),p||s.rotateZ(C,C,-y.angle),C}}return y.glCoordMatrix}function Ir(h,r,c=0){const p=[h.x,h.y,c,1];c?s.transformMat4$1(p,p,r):Zi(p,p,r);const y=p[3];return{point:[p[0]/y,p[1]/y,p[2]/y],signedDistanceFromCamera:y}}function un(h,r){const c=[h[0],h[1],h[2],1];s.transformMat4$1(c,c,r);const p=c[3];return{point:[c[0]/p,c[1]/p,c[2]/p],signedDistanceFromCamera:p}}function Ea(h,r){return Math.min(.5+h/r*.5,1.5)}function Ca(h,r){const c=h[0]/h[3],p=h[1]/h[3];return c>=-r[0]&&c<=r[0]&&p>=-r[1]&&p<=r[1]}function Sa(h,r,c,p,y,v,T,C,M,z){const O=c.transform,N=p?h.textSizeData:h.iconSizeData,$=s.evaluateSizeForZoom(N,c.transform.zoom),K=O.projection.name==="globe",W=[256/c.width*2+1,256/c.height*2+1],H=p?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;H.clear();let X=null;K&&(X=p?h.text.globeExtVertexArray:h.icon.globeExtVertexArray);const q=h.lineVertexArray,te=p?h.text.placedSymbolArray:h.icon.placedSymbolArray,Y=c.transform.width/c.transform.height;let pe=!1;for(let fe=0;fe<te.length;fe++){const le=te.get(fe);if(le.writingMode!==s.WritingMode.vertical||pe||fe!==0&&te.get(fe-1).writingMode===s.WritingMode.horizontal||(pe=!0),(le.hidden||le.writingMode===s.WritingMode.vertical)&&!pe){vo(le.numGlyphs,H);continue}pe=!1;const de=new s.pointGeometry(le.tileAnchorX,le.tileAnchorY),he=M?M(de):[0,0,0],ve=O.projection.projectTilePoint(de.x,de.y,z.canonical),ze=[ve.x+he[0],ve.y+he[1],ve.z+he[2]],pt=[...ze,1];if(s.transformMat4$1(pt,pt,r),!Ca(pt,W)){vo(le.numGlyphs,H);continue}const Ce=Ea(c.transform.cameraToCenterDistance,pt[3]),He=s.evaluateSizeForFeature(N,$,le),et=T?He/Ce:He*Ce,St=Ir(new s.pointGeometry(ze[0],ze[1]),y,ze[2]);if(St.signedDistanceFromCamera<=0){vo(le.numGlyphs,H);continue}let je={};const gt=T?null:M,Je=qf(le,et,!1,C,r,y,v,h.glyphOffsetArray,q,H,X,St.point,de,je,Y,gt,O.projection,z,T);pe=Je.useVertical,gt&&Je.needsFlipping&&(je={}),(Je.notEnoughRoom||pe||Je.needsFlipping&&qf(le,et,!0,C,r,y,v,h.glyphOffsetArray,q,H,X,St.point,de,je,Y,gt,O.projection,z,T).notEnoughRoom)&&vo(le.numGlyphs,H)}p?(h.text.dynamicLayoutVertexBuffer.updateData(H),X&&h.text.globeExtVertexBuffer.updateData(X)):(h.icon.dynamicLayoutVertexBuffer.updateData(H),X&&h.icon.globeExtVertexBuffer.updateData(X))}function ar(h,r,c,p,y,v,T,C,M,z,O,N,$,K,W,H){const X=C.glyphStartIndex+C.numGlyphs,q=C.lineStartIndex,te=C.lineStartIndex+C.lineLength,Y=r.getoffsetX(C.glyphStartIndex),pe=r.getoffsetX(X-1),fe=yo(h*Y,c,p,y,v,T,C.segment,q,te,M,z,O,N,$,!0,K,W,H);if(!fe)return null;const le=yo(h*pe,c,p,y,v,T,C.segment,q,te,M,z,O,N,$,!0,K,W,H);return le?{first:fe,last:le}:null}function oi(h,r,c,p){return h.writingMode===s.WritingMode.horizontal&&Math.abs(c.y-r.y)>Math.abs(c.x-r.x)*p?{useVertical:!0}:h.writingMode===s.WritingMode.vertical?r.y<c.y?{needsFlipping:!0}:null:h.flipState!==0&&function(y,v,T){const C=(v.x-y.x)*T;return C===0||Math.abs((v.y-y.y)/C)>Ot}(r,c,p)?h.flipState===1?{needsFlipping:!0}:null:r.x>c.x?{needsFlipping:!0}:null}function qf(h,r,c,p,y,v,T,C,M,z,O,N,$,K,W,H,X,q,te){const Y=r/24,pe=h.lineOffsetX*Y,fe=h.lineOffsetY*Y;let le;if(h.numGlyphs>1){const de=h.glyphStartIndex+h.numGlyphs,he=h.lineStartIndex,ve=h.lineStartIndex+h.lineLength,ze=ar(Y,C,pe,fe,c,N,$,h,M,v,K,H,!1,X,q,te);if(!ze)return{notEnoughRoom:!0};const pt=un(ze.first.point,T).point,Ce=un(ze.last.point,T).point,He=new s.pointGeometry(pt[0],pt[1]),et=new s.pointGeometry(Ce[0],Ce[1]);if(p&&!c){const St=oi(h,He,et,W);if(h.flipState=St&&St.needsFlipping?1:2,St)return St}le=[ze.first];for(let St=h.glyphStartIndex+1;St<de-1;St++)le.push(yo(Y*C.getoffsetX(St),pe,fe,c,N,$,h.segment,he,ve,M,v,K,H,!1,!1,X,q,te));le.push(ze.last)}else{if(p&&!c){const he=Ir($,y).point,ve=h.lineStartIndex+h.segment+1,ze=new s.pointGeometry(M.getx(ve),M.gety(ve)),pt=Ir(ze,y),Ce=pt.signedDistanceFromCamera>0?pt.point:Vl($,ze,he,1,y,void 0,X,q.canonical),He=oi(h,new s.pointGeometry(he[0],he[1]),new s.pointGeometry(Ce[0],Ce[1]),W);if(h.flipState=He&&He.needsFlipping?1:2,He)return He}const de=yo(Y*C.getoffsetX(h.glyphStartIndex),pe,fe,c,N,$,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,M,v,K,H,!1,!1,X,q,te);if(!de)return{notEnoughRoom:!0};le=[de]}if(O)for(const de of le)s.updateGlobeVertexNormal(O,z.length+0,de.up[0],de.up[1],de.up[2]),s.updateGlobeVertexNormal(O,z.length+1,de.up[0],de.up[1],de.up[2]),s.updateGlobeVertexNormal(O,z.length+2,de.up[0],de.up[1],de.up[2]),s.updateGlobeVertexNormal(O,z.length+3,de.up[0],de.up[1],de.up[2]),s.addDynamicAttributes(z,de.point[0],de.point[1],de.point[2],de.angle);else for(const de of le)s.addDynamicAttributes(z,de.point[0],de.point[1],de.point[2],de.angle);return{}}function As(h,r,c,p,y){const v=p.projectTilePoint(h.x,h.y,r);if(!y)return Ir(v,c,v.z);const T=y(h);return Ir(new s.pointGeometry(v.x+T[0],v.y+T[1]),c,v.z+T[2])}function Vl(h,r,c,p,y,v,T,C){const M=As(h.add(h.sub(r)._unit()),C,y,T,v).point,z=s.sub([],c,M);return s.scaleAndAdd([],c,z,p/s.length(z))}function yo(h,r,c,p,y,v,T,C,M,z,O,N,$,K,W,H,X,q){const te=p?h-r:h+r;let Y=te>0?1:-1,pe=0;p&&(Y*=-1,pe=Math.PI),Y<0&&(pe+=Math.PI);let fe=Y>0?C+T:C+T+1,le=y,de=y,he=0,ve=0;const ze=Math.abs(te),pt=[],Ce=[];let He=v;const et=()=>{const Ut=fe-Y;return he===0?v:new s.pointGeometry(z.getx(Ut),z.gety(Ut))},St=()=>Vl(et(),He,de,ze-he+1,O,$,H,X.canonical);for(;he+ve<=ze;){if(fe+=Y,fe<C||fe>=M)return null;if(de=le,pt.push(le),K&&Ce.push(He||et()),le=N[fe],le===void 0){He=new s.pointGeometry(z.getx(fe),z.gety(fe));const Ut=As(He,X.canonical,O,H,$);le=Ut.signedDistanceFromCamera>0?N[fe]=Ut.point:St()}else He=null;he+=ve,ve=s.distance(de,le)}He=He||new s.pointGeometry(z.getx(fe),z.gety(fe));const je=et();W&&$&&(N[fe]=le=N[fe]===void 0?le:St(),ve=s.distance(de,le));const gt=(ze-he)/ve,Je=He.sub(je).mult(gt)._add(je),It=s.sub([],le,de),At=s.scaleAndAdd([],de,It,gt);let Nt=[0,0,1],Zt=It[0],tn=It[1];if(q&&(Nt=H.upVector(X.canonical,Je.x,Je.y),Nt[0]!==0||Nt[1]!==0||Nt[2]!==1)){const Ut=[1,0,0],an=[0,1,0];Ut[0]=Nt[2],Ut[1]=0,Ut[2]=-Nt[0],s.cross(an,Nt,Ut),s.normalize(Ut,Ut),s.normalize(an,an),Zt=s.dot(It,Ut),tn=s.dot(It,an)}if(c){const Ut=s.cross([],Nt,It);s.normalize(Ut,Ut),s.scaleAndAdd(At,At,Ut,c*Y)}const bn=pe+Math.atan2(tn,Zt);return pt.push(At),K&&Ce.push(Je),{point:At,angle:bn,path:pt,tilePath:Ce,up:Nt}}const yu=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function vo(h,r){for(let c=0;c<h;c++){const p=r.length;r.resize(p+4),r.float32.set(yu,4*p)}}function Zi(h,r,c){const p=r[0],y=r[1];return h[0]=c[0]*p+c[4]*y+c[12],h[1]=c[1]*p+c[5]*y+c[13],h[3]=c[3]*p+c[7]*y+c[15],h}const Un=100;class vu{constructor(r,c,p=new Ms(r.width+200,r.height+200,25),y=new Ms(r.width+200,r.height+200,25)){this.transform=r,this.grid=p,this.ignoredGrid=y,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Un,this.screenBottomBoundary=r.height+Un,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=c}placeCollisionBox(r,c,p,y,v,T,C,M){let z=p.projectedAnchorX,O=p.projectedAnchorY,N=p.projectedAnchorZ;const $=p.elevation,K=p.tileID;if($&&K){const fe=r.getProjection().upVector(K.canonical,p.tileAnchorX,p.tileAnchorY),le=r.getProjection().upVectorScale(K.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;z+=fe[0]*$*le,O+=fe[1]*$*le,N+=fe[2]*$*le}const W=this.projectAndGetPerspectiveRatio(C,[z,O,N],p.tileID,r.projection.name==="globe"||!!$||this.transform.pitch>0,r.getProjection()),H=T*W.perspectiveRatio,X=(p.x1*c+y.x-p.padding)*H+W.point.x,q=(p.y1*c+y.y-p.padding)*H+W.point.y,te=(p.x2*c+y.x+p.padding)*H+W.point.x,Y=(p.y2*c+y.y+p.padding)*H+W.point.y,pe=W.perspectiveRatio<=.55||W.occluded;return!this.isInsideGrid(X,q,te,Y)||!v&&this.grid.hitTest(X,q,te,Y,M)||pe?{box:[],offscreen:!1,occluded:W.occluded}:{box:[X,q,te,Y],offscreen:this.isOffscreen(X,q,te,Y),occluded:!1}}placeCollisionCircles(r,c,p,y,v,T,C,M,z,O,N,$,K,W,H){const X=[],q=this.transform.elevation,te=q?q.getAtTileOffsetFunc(H,this.transform.center.lat,this.transform.worldSize,r.getProjection()):je=>[0,0,0],Y=new s.pointGeometry(p.tileAnchorX,p.tileAnchorY),pe=r.getProjection().projectTilePoint(p.tileAnchorX,p.tileAnchorY,H.canonical),fe=te(Y),le=[pe.x+fe[0],pe.y+fe[1],pe.z+fe[2]],de=r.projection.name==="globe",he=this.projectAndGetPerspectiveRatio(C,[le[0],le[1],le[2]],H,de||!!q||this.transform.pitch>0,r.getProjection()),{perspectiveRatio:ve}=he,ze=(N?T/ve:T*ve)/s.ONE_EM,pt=Ir(new s.pointGeometry(le[0],le[1]),M,le[2]).point,Ce=he.signedDistanceFromCamera>0?ar(ze,v,p.lineOffsetX*ze,p.lineOffsetY*ze,!1,pt,Y,p,y,M,{},q&&!N?te:null,N&&!!q,r.getProjection(),H,N):null;let He=!1,et=!1,St=!0;if(Ce&&!he.occluded){const je=.5*K*ve+W,gt=new s.pointGeometry(-100,-100),Je=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),It=new jm,At=Ce.first,Nt=Ce.last;let Zt=[];for(let Ut=At.path.length-1;Ut>=1;Ut--)Zt.push(At.path[Ut]);for(let Ut=1;Ut<Nt.path.length;Ut++)Zt.push(Nt.path[Ut]);const tn=2.5*je;if(z){const Ut=Zt.map(q&&!de?(an,An)=>{const Jn=te(An<At.path.length-1?At.tilePath[At.path.length-1-An]:Nt.tilePath[An-At.path.length+2]);return an[2]=Jn[2],un(an,z)}:an=>un(an,z));Zt=Ut.some(an=>an.signedDistanceFromCamera<=0)?[]:Ut.map(an=>an.point)}let bn=[];if(Zt.length>0){const Ut=Zt.map(Vn=>new s.pointGeometry(Vn[0],Vn[1]));let an=1/0,An=-1/0,Jn=1/0,ui=-1/0;for(let Vn=0;Vn<Ut.length;Vn++)an=Math.min(an,Ut[Vn].x),Jn=Math.min(Jn,Ut[Vn].y),An=Math.max(An,Ut[Vn].x),ui=Math.max(ui,Ut[Vn].y);bn=an>=gt.x&&An<=Je.x&&Jn>=gt.y&&ui<=Je.y?[Ut]:An<gt.x||an>Je.x||ui<gt.y||Jn>Je.y?[]:s.clipLine([Ut],gt.x,gt.y,Je.x,Je.y)}for(const Ut of bn){It.reset(Ut,.25*je);let an=0;an=It.length<=.5*je?1:Math.ceil(It.paddedLength/tn)+1;for(let An=0;An<an;An++){const Jn=An/Math.max(an-1,1),ui=It.lerp(Jn),Vn=ui.x+Un,Ai=ui.y+Un;X.push(Vn,Ai,je,0);const Or=Vn-je,eo=Ai-je,Qn=Vn+je,ni=Ai+je;if(St=St&&this.isOffscreen(Or,eo,Qn,ni),et=et||this.isInsideGrid(Or,eo,Qn,ni),!c&&this.grid.hitTestCircle(Vn,Ai,je,$)&&(He=!0,!O))return{circles:[],offscreen:!1,collisionDetected:He,occluded:!1}}}}return{circles:!O&&He||!et?[]:X,offscreen:St,collisionDetected:He,occluded:he.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let p=1/0,y=1/0,v=-1/0,T=-1/0;for(const O of r){const N=new s.pointGeometry(O.x+Un,O.y+Un);p=Math.min(p,N.x),y=Math.min(y,N.y),v=Math.max(v,N.x),T=Math.max(T,N.y),c.push(N)}const C=this.grid.query(p,y,v,T).concat(this.ignoredGrid.query(p,y,v,T)),M={},z={};for(const O of C){const N=O.key;if(M[N.bucketInstanceId]===void 0&&(M[N.bucketInstanceId]={}),M[N.bucketInstanceId][N.featureIndex])continue;const $=[new s.pointGeometry(O.x1,O.y1),new s.pointGeometry(O.x2,O.y1),new s.pointGeometry(O.x2,O.y2),new s.pointGeometry(O.x1,O.y2)];s.polygonIntersectsPolygon(c,$)&&(M[N.bucketInstanceId][N.featureIndex]=!0,z[N.bucketInstanceId]===void 0&&(z[N.bucketInstanceId]=[]),z[N.bucketInstanceId].push(N.featureIndex))}return z}insertCollisionBox(r,c,p,y,v){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:y,collisionGroupID:v},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,c,p,y,v){const T=c?this.ignoredGrid:this.grid,C={bucketInstanceId:p,featureIndex:y,collisionGroupID:v};for(let M=0;M<r.length;M+=4)T.insertCircle(C,r[M],r[M+1],r[M+2])}projectAndGetPerspectiveRatio(r,c,p,y,v){const T=[c[0],c[1],c[2],1];let C=!1;if(c[2]||this.transform.pitch>0){s.transformMat4$1(T,T,r);const M=v.name==="globe";this.fogState&&p&&!M&&(C=function(z,O,N,$,K,W){const H=W.calculateFogTileMatrix(K),X=[O,N,$];return s.transformMat4(X,X,H),ht(z,X,W.pitch,W._fov)}(this.fogState,c[0],c[1],c[2],p.toUnwrapped(),this.transform)>.9)}else Zi(T,T,r);return{point:new s.pointGeometry((T[0]/T[3]+1)/2*this.transform.width+Un,(-T[1]/T[3]+1)/2*this.transform.height+Un),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(v)/T[3]*.5,1.5),signedDistanceFromCamera:T[3],occluded:y&&T[2]>T[3]||C}}isOffscreen(r,c,p,y){return p<Un||r>=this.screenRightBoundary||y<Un||c>this.screenBottomBoundary}isInsideGrid(r,c,p,y){return p>=0&&r<this.gridRightBoundary&&y>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const r=s.identity([]);return s.translate(r,r,[-100,-100,0]),r}}function Ma(h,r,c){const p=r.createTileMatrix(h,h.worldSize,c.toUnwrapped());return s.multiply(new Float32Array(16),h.projMatrix,p)}function Qi(h,r,c){if(r.projection.name===c.projection.name)return h.projMatrix;const p=c.clone();return p.setProjection(r.projection),Ma(p,r.getProjection(),h)}function er(h,r,c){return r.name===c.projection.name?h.projMatrix:Ma(c,r,h)}class xu{constructor(r,c,p,y){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?c:-c))):y&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class xo{constructor(r,c,p,y,v,T=!1){this.text=new xu(r?r.text:null,c,p,v),this.icon=new xu(r?r.icon:null,c,y,v),this.clipped=T}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class pi{constructor(r,c,p,y=!1){this.text=r,this.icon=c,this.skipFade=p,this.clipped=y}}class Aa{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class bu{constructor(r,c,p,y,v){this.bucketInstanceId=r,this.featureIndex=c,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=v}}class Ia{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const c=++this.maxGroupID;this.collisionGroups[r]={ID:c,predicate:p=>p.collisionGroupID===c}}return this.collisionGroups[r]}}function Ci(h,r,c,p,y){const{horizontalAlign:v,verticalAlign:T}=s.getAnchorAlignment(h),C=-(v-.5)*r,M=-(T-.5)*c,z=s.evaluateVariableOffset(h,p);return new s.pointGeometry(C+z[0]*y,M+z[1]*y)}function Pa(h,r,c,p,y){const v=new s.pointGeometry(h,r);return c&&v._rotate(p?y:-y),v}class wu{constructor(r,c,p,y,v){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new vu(this.transform,v),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Ia(p),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,c,p,y){const v=p.getBucket(c),T=p.latestFeatureIndex;if(!v||!T||c.id!==v.layerIds[0])return;const C=v.layers[0].layout,M=p.collisionBoxArray,z=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),O=p.tileSize/s.EXTENT,N=p.tileID.toUnwrapped();this.transform.setProjection(v.projection);const $=(K=p.tileID,W=v.getProjection(),H=this.transform,W.name===this.projection?H.calculateProjMatrix(K.toUnwrapped()):Ma(H,W,K));var K,W,H;const X=C.get("text-pitch-alignment")==="map",q=C.get("text-rotation-alignment")==="map";c.compileFilter();const te=c.dynamicFilter(),Y=c.dynamicFilterNeedsFeature(),pe=this.transform.calculatePixelsToTileUnitsMatrix(p),fe=xn($,p.tileID.canonical,X,q,this.transform,v.getProjection(),pe);let le=null;if(X){const ve=Ar($,p.tileID.canonical,X,q,this.transform,v.getProjection(),pe);le=s.multiply([],this.transform.labelPlaneMatrix,ve)}let de=null;te&&p.latestFeatureIndex&&(de={unwrappedTileID:N,dynamicFilter:te,dynamicFilterNeedsFeature:Y,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[v.bucketInstanceId]=new bu(v.bucketInstanceId,T,v.sourceLayerIndex,v.index,p.tileID);const he={bucket:v,layout:C,posMatrix:$,textLabelPlaneMatrix:fe,labelToScreenMatrix:le,clippingData:de,scale:z,textPixelRatio:O,holdingForFade:p.holdingForFade(),collisionBoxArray:M,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(v.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(v.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(y)for(const ve of v.sortKeyRanges){const{sortKey:ze,symbolInstanceStart:pt,symbolInstanceEnd:Ce}=ve;r.push({sortKey:ze,symbolInstanceStart:pt,symbolInstanceEnd:Ce,parameters:he})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:he})}attemptAnchorPlacement(r,c,p,y,v,T,C,M,z,O,N,$,K,W,H,X,q,te){const Y=[$.textOffset0,$.textOffset1],pe=Ci(r,p,y,Y,v),fe=this.collisionIndex.placeCollisionBox(W,v,c,Pa(pe.x,pe.y,T,C,this.transform.angle),N,M,z,O.predicate);if((!X||this.collisionIndex.placeCollisionBox(W,W.getSymbolInstanceIconSize(te,this.transform.zoom,K),X,Pa(pe.x,pe.y,T,C,this.transform.angle),N,M,z,O.predicate).box.length!==0)&&fe.box.length>0){let le;return this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(le=this.prevPlacement.variableOffsets[$.crossTileID].anchor),this.variableOffsets[$.crossTileID]={textOffset:Y,width:p,height:y,anchor:r,textScale:v,prevAnchor:le},this.markUsedJustification(W,r,$,H),W.allowVerticalPlacement&&(this.markUsedOrientation(W,H,$),this.placedOrientations[$.crossTileID]=H),{shift:pe,placedGlyphBoxes:fe}}}placeLayerBucketPart(r,c,p,y){const{bucket:v,layout:T,posMatrix:C,textLabelPlaneMatrix:M,labelToScreenMatrix:z,clippingData:O,textPixelRatio:N,holdingForFade:$,collisionBoxArray:K,partiallyEvaluatedTextSize:W,partiallyEvaluatedIconSize:H,collisionGroup:X}=r.parameters,q=T.get("text-optional"),te=T.get("icon-optional"),Y=T.get("text-allow-overlap"),pe=T.get("icon-allow-overlap"),fe=T.get("text-rotation-alignment")==="map",le=T.get("text-pitch-alignment")==="map",de=T.get("icon-text-fit")!=="none",he=T.get("symbol-z-order")==="viewport-y";this.transform.setProjection(v.projection);let ve=Y&&(pe||!v.hasIconData()||te),ze=pe&&(Y||!v.hasTextData()||q);!v.collisionArrays&&K&&v.deserializeCollisionBoxes(K),p&&y&&v.updateCollisionDebugBuffers(this.transform.zoom,K);const pt=(Ce,He,et)=>{if(O){const Qn={zoom:this.transform.zoom,pitch:this.transform.pitch};let ni=null;if(O.dynamicFilterNeedsFeature){const gn=this.retainedQueryData[v.bucketInstanceId];ni=O.featureIndex.loadFeature({featureIndex:Ce.featureIndex,bucketIndex:gn.bucketIndex,sourceLayerIndex:gn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,O.dynamicFilter)(Qn,ni,this.retainedQueryData[v.bucketInstanceId].tileID.canonical,new s.pointGeometry(Ce.tileAnchorX,Ce.tileAnchorY),this.transform.calculateDistanceTileData(O.unwrappedTileID)))return this.placements[Ce.crossTileID]=new pi(!1,!1,!1,!0),void(c[Ce.crossTileID]=!0)}if(c[Ce.crossTileID])return;if($)return void(this.placements[Ce.crossTileID]=new pi(!1,!1,!1));let St=!1,je=!1,gt=!0,Je=!1,It=!1,At=null,Nt={box:null,offscreen:null,occluded:null},Zt={box:null,offscreen:null,occluded:null},tn=null,bn=null,Ut=null,an=0,An=0,Jn=0;et.textFeatureIndex?an=et.textFeatureIndex:Ce.useRuntimeCollisionCircles&&(an=Ce.featureIndex),et.verticalTextFeatureIndex&&(An=et.verticalTextFeatureIndex);const ui=Qn=>{Qn.tileID=this.retainedQueryData[v.bucketInstanceId].tileID,(this.transform.elevation||Qn.elevation)&&(Qn.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[v.bucketInstanceId].tileID,Qn.tileAnchorX,Qn.tileAnchorY):0)},Vn=et.textBox;if(Vn){ui(Vn);const Qn=gn=>{let gi=s.WritingMode.horizontal;if(v.allowVerticalPlacement&&!gn&&this.prevPlacement){const Bi=this.prevPlacement.placedOrientations[Ce.crossTileID];Bi&&(this.placedOrientations[Ce.crossTileID]=Bi,gi=Bi,this.markUsedOrientation(v,gi,Ce))}return gi},ni=(gn,gi)=>{if(v.allowVerticalPlacement&&Ce.numVerticalGlyphVertices>0&&et.verticalTextBox){for(const Bi of v.writingModes)if(Bi===s.WritingMode.vertical?(Nt=gi(),Zt=Nt):Nt=gn(),Nt&&Nt.box&&Nt.box.length)break}else Nt=gn()};if(T.get("text-variable-anchor")){let gn=T.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ce.crossTileID]){const Hn=this.prevPlacement.variableOffsets[Ce.crossTileID];gn.indexOf(Hn.anchor)>0&&(gn=gn.filter(Fi=>Fi!==Hn.anchor),gn.unshift(Hn.anchor))}const gi=(Hn,Fi,Jo)=>{const qi=v.getSymbolInstanceTextSize(W,Ce,this.transform.zoom,He),Qo=(Hn.x2-Hn.x1)*qi+2*Hn.padding,es=(Hn.y2-Hn.y1)*qi+2*Hn.padding,ts=de&&!pe?Fi:null;ts&&ui(ts);let Wi={box:[],offscreen:!1,occluded:!1};const ns=Y?2*gn.length:gn.length;for(let Co=0;Co<ns;++Co){const Qa=this.attemptAnchorPlacement(gn[Co%gn.length],Hn,Qo,es,qi,fe,le,N,C,X,Co>=gn.length,Ce,He,v,Jo,ts,W,H);if(Qa&&(Wi=Qa.placedGlyphBoxes,Wi&&Wi.box&&Wi.box.length)){St=!0,At=Qa.shift;break}}return Wi};ni(()=>gi(Vn,et.iconBox,s.WritingMode.horizontal),()=>{const Hn=et.verticalTextBox;return Hn&&ui(Hn),v.allowVerticalPlacement&&!(Nt&&Nt.box&&Nt.box.length)&&Ce.numVerticalGlyphVertices>0&&Hn?gi(Hn,et.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Nt&&(St=Nt.box,gt=Nt.offscreen,Je=Nt.occluded);const Bi=Qn(Nt&&Nt.box);if(!St&&this.prevPlacement){const Hn=this.prevPlacement.variableOffsets[Ce.crossTileID];Hn&&(this.variableOffsets[Ce.crossTileID]=Hn,this.markUsedJustification(v,Hn.anchor,Ce,Bi))}}else{const gn=(gi,Bi)=>{const Hn=v.getSymbolInstanceTextSize(W,Ce,this.transform.zoom,He),Fi=this.collisionIndex.placeCollisionBox(v,Hn,gi,new s.pointGeometry(0,0),Y,N,C,X.predicate);return Fi&&Fi.box&&Fi.box.length&&(this.markUsedOrientation(v,Bi,Ce),this.placedOrientations[Ce.crossTileID]=Bi),Fi};ni(()=>gn(Vn,s.WritingMode.horizontal),()=>{const gi=et.verticalTextBox;return v.allowVerticalPlacement&&Ce.numVerticalGlyphVertices>0&&gi?(ui(gi),gn(gi,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Qn(Nt&&Nt.box&&Nt.box.length)}}if(tn=Nt,St=tn&&tn.box&&tn.box.length>0,gt=tn&&tn.offscreen,Je=tn&&tn.occluded,Ce.useRuntimeCollisionCircles){const Qn=v.text.placedSymbolArray.get(Ce.centerJustifiedTextSymbolIndex>=0?Ce.centerJustifiedTextSymbolIndex:Ce.verticalPlacedTextSymbolIndex),ni=s.evaluateSizeForFeature(v.textSizeData,W,Qn),gn=T.get("text-padding");bn=this.collisionIndex.placeCollisionCircles(v,Y,Qn,v.lineVertexArray,v.glyphOffsetArray,ni,C,M,z,p,le,X.predicate,Ce.collisionCircleDiameter*ni/s.ONE_EM,gn,this.retainedQueryData[v.bucketInstanceId].tileID),St=Y||bn.circles.length>0&&!bn.collisionDetected,gt=gt&&bn.offscreen,Je=bn.occluded}if(et.iconFeatureIndex&&(Jn=et.iconFeatureIndex),et.iconBox){const Qn=ni=>{ui(ni);const gn=de&&At?Pa(At.x,At.y,fe,le,this.transform.angle):new s.pointGeometry(0,0),gi=v.getSymbolInstanceIconSize(H,this.transform.zoom,He);return this.collisionIndex.placeCollisionBox(v,gi,ni,gn,pe,N,C,X.predicate)};Zt&&Zt.box&&Zt.box.length&&et.verticalIconBox?(Ut=Qn(et.verticalIconBox),je=Ut.box.length>0):(Ut=Qn(et.iconBox),je=Ut.box.length>0),gt=gt&&Ut.offscreen,It=Ut.occluded}const Ai=q||Ce.numHorizontalGlyphVertices===0&&Ce.numVerticalGlyphVertices===0,Or=te||Ce.numIconVertices===0;if(Ai||Or?Or?Ai||(je=je&&St):St=je&&St:je=St=je&&St,St&&tn&&tn.box&&this.collisionIndex.insertCollisionBox(tn.box,T.get("text-ignore-placement"),v.bucketInstanceId,Zt&&Zt.box&&An?An:an,X.ID),je&&Ut&&this.collisionIndex.insertCollisionBox(Ut.box,T.get("icon-ignore-placement"),v.bucketInstanceId,Jn,X.ID),bn&&(St&&this.collisionIndex.insertCollisionCircles(bn.circles,T.get("text-ignore-placement"),v.bucketInstanceId,an,X.ID),p)){const Qn=v.bucketInstanceId;let ni=this.collisionCircleArrays[Qn];ni===void 0&&(ni=this.collisionCircleArrays[Qn]=new Aa);for(let gn=0;gn<bn.circles.length;gn+=4)ni.circles.push(bn.circles[gn+0]),ni.circles.push(bn.circles[gn+1]),ni.circles.push(bn.circles[gn+2]),ni.circles.push(bn.collisionDetected?1:0)}const eo=v.projection.name!=="globe";ve=ve&&(eo||!Je),ze=ze&&(eo||!It),this.placements[Ce.crossTileID]=new pi(St||ve,je||ze,gt||v.justReloaded),c[Ce.crossTileID]=!0};if(he){const Ce=v.getSortedSymbolIndexes(this.transform.angle);for(let He=Ce.length-1;He>=0;--He){const et=Ce[He];pt(v.symbolInstances.get(et),et,v.collisionArrays[et])}}else for(let Ce=r.symbolInstanceStart;Ce<r.symbolInstanceEnd;Ce++)pt(v.symbolInstances.get(Ce),Ce,v.collisionArrays[Ce]);if(p&&v.bucketInstanceId in this.collisionCircleArrays){const Ce=this.collisionCircleArrays[v.bucketInstanceId];s.invert(Ce.invProjMatrix,C),Ce.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}markUsedJustification(r,c,p,y){let v;v=y===s.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(c)];const T=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const C of T)C>=0&&(r.text.placedSymbolArray.get(C).crossTileID=v>=0&&C!==v?0:p.crossTileID)}markUsedOrientation(r,c,p){const y=c===s.WritingMode.horizontal||c===s.WritingMode.horizontalOnly?c:0,v=c===s.WritingMode.vertical?c:0,T=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const C of T)r.text.placedSymbolArray.get(C).placedOrientation=y;p.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let p=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const y=c?c.symbolFadeChange(r):1,v=c?c.opacities:{},T=c?c.variableOffsets:{},C=c?c.placedOrientations:{};for(const M in this.placements){const z=this.placements[M],O=v[M];O?(this.opacities[M]=new xo(O,y,z.text,z.icon,null,z.clipped),p=p||z.text!==O.text.placed||z.icon!==O.icon.placed):(this.opacities[M]=new xo(null,y,z.text,z.icon,z.skipFade,z.clipped),p=p||z.text||z.icon)}for(const M in v){const z=v[M];if(!this.opacities[M]){const O=new xo(z,y,!1,!1);O.isHidden()||(this.opacities[M]=O,p=p||z.text.placed||z.icon.placed)}}for(const M in T)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=T[M]);for(const M in C)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=C[M]);p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:r)}updateLayerOpacities(r,c){const p={};for(const y of c){const v=y.getBucket(r);v&&y.latestFeatureIndex&&r.id===v.layerIds[0]&&this.updateBucketOpacities(v,p,y.collisionBoxArray)}}updateBucketOpacities(r,c,p){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const y=r.layers[0].layout,v=!!r.layers[0].dynamicFilter(),T=new xo(null,0,!1,!1,!0),C=y.get("text-allow-overlap"),M=y.get("icon-allow-overlap"),z=y.get("text-variable-anchor"),O=y.get("text-rotation-alignment")==="map",N=y.get("text-pitch-alignment")==="map",$=y.get("icon-text-fit")!=="none",K=new xo(null,0,C&&(M||!r.hasIconData()||y.get("icon-optional")),M&&(C||!r.hasTextData()||y.get("text-optional")),!0);!r.collisionArrays&&p&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(p);const W=(X,q,te)=>{for(let Y=0;Y<q/4;Y++)X.opacityVertexArray.emplaceBack(te)};let H=0;for(let X=0;X<r.symbolInstances.length;X++){const q=r.symbolInstances.get(X),{numHorizontalGlyphVertices:te,numVerticalGlyphVertices:Y,crossTileID:pe}=q;let fe=this.opacities[pe];c[pe]?fe=T:fe||(fe=K,this.opacities[pe]=fe),c[pe]=!0;const le=te>0||Y>0,de=q.numIconVertices>0,he=this.placedOrientations[q.crossTileID],ve=he===s.WritingMode.vertical,ze=he===s.WritingMode.horizontal||he===s.WritingMode.horizontalOnly;if(!le&&!de||fe.isHidden()||H++,le){const pt=Ho(fe.text);W(r.text,te,ve?Pr:pt),W(r.text,Y,ze?Pr:pt);const Ce=fe.text.isHidden();[q.rightJustifiedTextSymbolIndex,q.centerJustifiedTextSymbolIndex,q.leftJustifiedTextSymbolIndex].forEach(St=>{St>=0&&(r.text.placedSymbolArray.get(St).hidden=Ce||ve?1:0)}),q.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(q.verticalPlacedTextSymbolIndex).hidden=Ce||ze?1:0);const He=this.variableOffsets[q.crossTileID];He&&this.markUsedJustification(r,He.anchor,q,he);const et=this.placedOrientations[q.crossTileID];et&&(this.markUsedJustification(r,"left",q,et),this.markUsedOrientation(r,et,q))}if(de){const pt=Ho(fe.icon);q.placedIconSymbolIndex>=0&&(W(r.icon,q.numIconVertices,ve?Pr:pt),r.icon.placedSymbolArray.get(q.placedIconSymbolIndex).hidden=fe.icon.isHidden()),q.verticalPlacedIconSymbolIndex>=0&&(W(r.icon,q.numVerticalIconVertices,ze?Pr:pt),r.icon.placedSymbolArray.get(q.verticalPlacedIconSymbolIndex).hidden=fe.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const pt=r.collisionArrays[X];if(pt){let Ce=new s.pointGeometry(0,0),He=!0;if(pt.textBox||pt.verticalTextBox){if(z){const St=this.variableOffsets[pe];St?(Ce=Ci(St.anchor,St.width,St.height,St.textOffset,St.textScale),O&&Ce._rotate(N?this.transform.angle:-this.transform.angle)):He=!1}v&&(He=!fe.clipped),pt.textBox&&gr(r.textCollisionBox.collisionVertexArray,fe.text.placed,!He||ve,Ce.x,Ce.y),pt.verticalTextBox&&gr(r.textCollisionBox.collisionVertexArray,fe.text.placed,!He||ze,Ce.x,Ce.y)}const et=He&&Boolean(!ze&&pt.verticalIconBox);pt.iconBox&&gr(r.iconCollisionBox.collisionVertexArray,fe.icon.placed,et,$?Ce.x:0,$?Ce.y:0),pt.verticalIconBox&&gr(r.iconCollisionBox.collisionVertexArray,fe.icon.placed,!et,$?Ce.x:0,$?Ce.y:0)}}}if(r.fullyClipped=H===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const X=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=X.invProjMatrix,r.placementViewportMatrix=X.viewportMatrix,r.collisionCircleArray=X.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,c){const p=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function gr(h,r,c,p,y){h.emplaceBack(r?1:0,c?1:0,p||0,y||0),h.emplaceBack(r?1:0,c?1:0,p||0,y||0),h.emplaceBack(r?1:0,c?1:0,p||0,y||0),h.emplaceBack(r?1:0,c?1:0,p||0,y||0)}const za=Math.pow(2,25),$l=Math.pow(2,24),Nm=Math.pow(2,17),Tu=Math.pow(2,16),Is=Math.pow(2,9),Um=Math.pow(2,8),Wf=Math.pow(2,1);function Ho(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const r=h.placed?1:0,c=Math.floor(127*h.opacity);return c*za+r*$l+c*Nm+r*Tu+c*Is+r*Um+c*Wf+r}const Pr=0;class Gl{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,c,p,y,v){const T=this._bucketParts;for(;this._currentTileIndex<r.length;)if(c.getBucketParts(T,y,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((C,M)=>C.sortKey-M.sortKey));this._currentPartIndex<T.length;){const C=T[this._currentPartIndex];if(c.placeLayerBucketPart(C,this._seenCrossTileIDs,p,C.symbolInstanceStart===0),this._currentPartIndex++,v())return!0}return!1}}class bo{constructor(r,c,p,y,v,T,C,M){this.placement=new wu(r,v,T,C,M),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(r,c,p){const y=s.exported.now(),v=()=>{const T=s.exported.now()-y;return!this._forceFullPlacement&&T>2};for(;this._currentPlacementIndex>=0;){const T=c[r[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(T.type==="symbol"&&(!T.minzoom||T.minzoom<=C)&&(!T.maxzoom||T.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new Gl(T)),this._inProgressLayer.continuePlacement(p[T.source],this.placement,this._showCollisionBoxes,T,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Eu=512/s.EXTENT/2;class Zl{constructor(r,c,p){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(let y=0;y<c.length;y++){const v=c.get(y),T=v.key;this.indexedSymbolInstances[T]||(this.indexedSymbolInstances[T]=[]),this.indexedSymbolInstances[T].push({crossTileID:v.crossTileID,coord:this.getScaledCoordinates(v,r)})}}getScaledCoordinates(r,c){const p=Eu/Math.pow(2,c.canonical.z-this.tileID.canonical.z);return{x:Math.floor((c.canonical.x*s.EXTENT+r.tileAnchorX)*p),y:Math.floor((c.canonical.y*s.EXTENT+r.tileAnchorY)*p)}}findMatches(r,c,p){const y=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let v=0;v<r.length;v++){const T=r.get(v);if(T.crossTileID)continue;const C=this.indexedSymbolInstances[T.key];if(!C)continue;const M=this.getScaledCoordinates(T,c);for(const z of C)if(Math.abs(z.coord.x-M.x)<=y&&Math.abs(z.coord.y-M.y)<=y&&!p[z.crossTileID]){p[z.crossTileID]=!0,T.crossTileID=z.crossTileID;break}}}}class Vm{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $m{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const c=Math.round((r-this.lng)/360);if(c!==0)for(const p in this.indexes){const y=this.indexes[p],v={};for(const T in y){const C=y[T];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+c),v[C.tileID.key]=C}this.indexes[p]=v}this.lng=r}addBucket(r,c,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let v=0;v<c.symbolInstances.length;v++)c.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const y=this.usedCrossTileIDs[r.overscaledZ];for(const v in this.indexes){const T=this.indexes[v];if(Number(v)>r.overscaledZ)for(const C in T){const M=T[C];M.tileID.isChildOf(r)&&M.findMatches(c.symbolInstances,r,y)}else{const C=T[r.scaledTo(Number(v)).key];C&&C.findMatches(c.symbolInstances,r,y)}}for(let v=0;v<c.symbolInstances.length;v++){const T=c.symbolInstances.get(v);T.crossTileID||(T.crossTileID=p.generate(),y[T.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Zl(r,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(r,c){for(const p in c.indexedSymbolInstances)for(const y of c.indexedSymbolInstances[p])delete this.usedCrossTileIDs[r][y.crossTileID]}removeStaleBuckets(r){let c=!1;for(const p in this.indexes){const y=this.indexes[p];for(const v in y)r[y[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[v]),delete y[v],c=!0)}return c}}class ql{constructor(){this.layerIndexes={},this.crossTileIDs=new Vm,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,c,p,y){let v=this.layerIndexes[r.id];v===void 0&&(v=this.layerIndexes[r.id]=new $m);let T=!1;const C={};y.name!=="globe"&&v.handleWrapJump(p);for(const M of c){const z=M.getBucket(r);z&&r.id===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(M.tileID,z,this.crossTileIDs)&&(T=!0),C[z.bucketInstanceId]=!0)}return v.removeStaleBuckets(C)&&(T=!0),T}pruneUnusedLayers(r){const c={};r.forEach(p=>{c[p]=!0});for(const p in this.layerIndexes)c[p]||delete this.layerIndexes[p]}}const Wl=(h,r)=>s.emitValidationErrors(h,r&&r.filter(c=>c.identifier!=="source.canvas")),Hf=s.pick(Wt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Gm=s.pick(Wt,["setCenter","setZoom","setBearing","setPitch"]),Xf={version:8,layers:[],sources:{}},Zm={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class _r extends s.Evented{constructor(r,c={}){super(),this.map=r,this.dispatcher=new nn(Fn(),this),this.imageManager=new Tt,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(r._requestManager,c.localFontFamily?s.LocalGlyphMode.all:c.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.lineAtlas=new s.LineAtlas(256,512),this.crossTileSymbolIndex=new ql,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const p=this;this._rtlTextPluginCallback=_r.registerForPluginStateChange(y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(v,T)=>{if(s.triggerPluginCompletionEvent(v),T&&T.every(C=>C))for(const C in p._sourceCaches){const M=p._sourceCaches[C],z=M.getSource().type;z!=="vector"&&z!=="geojson"||M.reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const v=this.getSource(y.sourceId);if(v&&v.vectorLayerIds)for(const T in this._layers){const C=this._layers[T];C.source===v.id&&this._validateLayer(C)}})}loadURL(r,c={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const p=typeof c.validate=="boolean"?c.validate:!s.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,c.accessToken);const y=this.map._requestManager.transformRequest(r,s.ResourceType.Style);this._request=s.getJSON(y,(v,T)=>{this._request=null,v?this.fire(new s.ErrorEvent(v)):T&&this._load(T,p)})}loadJSON(r,c={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(r,c.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Xf,!1)}_updateLayerCount(r,c){const p=c?1:-1;r.is3D()&&(this._num3DLayers+=p),r.type==="circle"&&(this._numCircleLayers+=p),r.type==="symbol"&&(this._numSymbolLayers+=p)}_load(r,c){if(c&&Wl(this,s.validateStyle(r)))return;this._loaded=!0,this.stylesheet=s.clone$1(r),this._updateMapProjection();for(const y in r.sources)this.addSource(y,r.sources[y],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const p=jn(this.stylesheet.layers);this._order=p.map(y=>y.id),this._layers={},this._serializedLayers={};for(let y of p)y=s.createStyleLayer(y),y.setEventedParent(this,{layer:{id:y.id}}),this._layers[y.id]=y,this._serializedLayers[y.id]=y.serialize(),this._updateLayerCount(y,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ne(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(r){this._spriteRequest=function(c,p,y){let v,T,C;const M=s.exported.devicePixelRatio>1?"@2x":"";let z=s.getJSON(p.transformRequest(p.normalizeSpriteURL(c,M,".json"),s.ResourceType.SpriteJSON),($,K)=>{z=null,C||(C=$,v=K,N())}),O=s.getImage(p.transformRequest(p.normalizeSpriteURL(c,M,".png"),s.ResourceType.SpriteImage),($,K)=>{O=null,C||(C=$,T=K,N())});function N(){if(C)y(C);else if(v&&T){const $=s.exported.getImageData(T),K={};for(const W in v){const{width:H,height:X,x:q,y:te,sdf:Y,pixelRatio:pe,stretchX:fe,stretchY:le,content:de}=v[W],he=new s.RGBAImage({width:H,height:X});s.RGBAImage.copy($,he,{x:q,y:te},{x:0,y:0},{width:H,height:X}),K[W]={data:he,pixelRatio:pe,sdf:Y,stretchX:fe,stretchY:le,content:de}}y(null,K)}}return{cancel(){z&&(z.cancel(),z=null),O&&(O.cancel(),O=null)}}}(r,this.map._requestManager,(c,p)=>{if(this._spriteRequest=null,c)this.fire(new s.ErrorEvent(c));else if(p)for(const y in p)this.imageManager.addImage(y,p[y]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(r){const c=this.getSource(r.source);if(!c)return;const p=r.sourceLayer;p&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(p)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${c.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const c=[];for(const p of r){const y=this._layers[p];y.type!=="custom"&&c.push(y.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&Zm[r.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const c=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(y.length||v.length)&&this._updateWorkerLayers(y,v);for(const T in this._updatedSources){const C=this._updatedSources[T];C==="reload"?this._reloadSource(T):C==="clear"&&this._clearSource(T)}this._updateTilesForChangedImages();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const p={};for(const y in this._sourceCaches){const v=this._sourceCaches[y];p[y]=v.used,v.used=!1}for(const y of this._order){const v=this._layers[y];if(v.recalculate(r,this._availableImages),!v.isHidden(r.zoom)){const C=this._getLayerSourceCache(v);C&&(C.used=!0)}const T=this.map.painter;if(T){const C=v.getProgramIds();if(!C)continue;const M=v.getProgramConfiguration(r.zoom);for(const z of C)T.useProgram(z,M)}}for(const y in p){const v=this._sourceCaches[y];p[y]!==v.used&&v.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:v.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),Wl(this,s.validateStyle(r)))return!1;(r=s.clone$1(r)).layers=jn(r.layers);const c=function(y,v){if(!y)return[{command:Wt.setStyle,args:[v]}];let T=[];try{if(!A(y.version,v.version))return[{command:Wt.setStyle,args:[v]}];A(y.center,v.center)||T.push({command:Wt.setCenter,args:[v.center]}),A(y.zoom,v.zoom)||T.push({command:Wt.setZoom,args:[v.zoom]}),A(y.bearing,v.bearing)||T.push({command:Wt.setBearing,args:[v.bearing]}),A(y.pitch,v.pitch)||T.push({command:Wt.setPitch,args:[v.pitch]}),A(y.sprite,v.sprite)||T.push({command:Wt.setSprite,args:[v.sprite]}),A(y.glyphs,v.glyphs)||T.push({command:Wt.setGlyphs,args:[v.glyphs]}),A(y.transition,v.transition)||T.push({command:Wt.setTransition,args:[v.transition]}),A(y.light,v.light)||T.push({command:Wt.setLight,args:[v.light]}),A(y.fog,v.fog)||T.push({command:Wt.setFog,args:[v.fog]}),A(y.projection,v.projection)||T.push({command:Wt.setProjection,args:[v.projection]});const C={},M=[];(function(N,$,K,W){let H;for(H in $=$||{},N=N||{})N.hasOwnProperty(H)&&($.hasOwnProperty(H)||sr(H,K,W));for(H in $)$.hasOwnProperty(H)&&(N.hasOwnProperty(H)?A(N[H],$[H])||(N[H].type==="geojson"&&$[H].type==="geojson"&&_o(N,$,H)?K.push({command:Wt.setGeoJSONSourceData,args:[H,$[H].data]}):ci(H,$,K,W)):$e(H,$,K))})(y.sources,v.sources,M,C);const z=[];y.layers&&y.layers.forEach(N=>{N.source&&C[N.source]?T.push({command:Wt.removeLayer,args:[N.id]}):z.push(N)});let O=y.terrain;O&&C[O.source]&&(T.push({command:Wt.setTerrain,args:[void 0]}),O=void 0),T=T.concat(M),A(O,v.terrain)||T.push({command:Wt.setTerrain,args:[v.terrain]}),function(N,$,K){$=$||[];const W=(N=N||[]).map(Mr),H=$.map(Mr),X=N.reduce(Ul,{}),q=$.reduce(Ul,{}),te=W.slice(),Y=Object.create(null);let pe,fe,le,de,he,ve,ze;for(pe=0,fe=0;pe<W.length;pe++)le=W[pe],q.hasOwnProperty(le)?fe++:(K.push({command:Wt.removeLayer,args:[le]}),te.splice(te.indexOf(le,fe),1));for(pe=0,fe=0;pe<H.length;pe++)le=H[H.length-1-pe],te[te.length-1-pe]!==le&&(X.hasOwnProperty(le)?(K.push({command:Wt.removeLayer,args:[le]}),te.splice(te.lastIndexOf(le,te.length-fe),1)):fe++,ve=te[te.length-pe],K.push({command:Wt.addLayer,args:[q[le],ve]}),te.splice(te.length-pe,0,le),Y[le]=!0);for(pe=0;pe<H.length;pe++)if(le=H[pe],de=X[le],he=q[le],!Y[le]&&!A(de,he))if(A(de.source,he.source)&&A(de["source-layer"],he["source-layer"])&&A(de.type,he.type)){for(ze in Nl(de.layout,he.layout,K,le,null,Wt.setLayoutProperty),Nl(de.paint,he.paint,K,le,null,Wt.setPaintProperty),A(de.filter,he.filter)||K.push({command:Wt.setFilter,args:[le,he.filter]}),A(de.minzoom,he.minzoom)&&A(de.maxzoom,he.maxzoom)||K.push({command:Wt.setLayerZoomRange,args:[le,he.minzoom,he.maxzoom]}),de)de.hasOwnProperty(ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?Nl(de[ze],he[ze],K,le,ze.slice(6),Wt.setPaintProperty):A(de[ze],he[ze])||K.push({command:Wt.setLayerProperty,args:[le,ze,he[ze]]}));for(ze in he)he.hasOwnProperty(ze)&&!de.hasOwnProperty(ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?Nl(de[ze],he[ze],K,le,ze.slice(6),Wt.setPaintProperty):A(de[ze],he[ze])||K.push({command:Wt.setLayerProperty,args:[le,ze,he[ze]]}))}else K.push({command:Wt.removeLayer,args:[le]}),ve=te[te.lastIndexOf(le)+1],K.push({command:Wt.addLayer,args:[he,ve]})}(z,v.layers,T)}catch(C){console.warn("Unable to compute style diff:",C),T=[{command:Wt.setStyle,args:[v]}]}return T}(this.serialize(),r).filter(y=>!(y.command in Gm));if(c.length===0)return!1;const p=c.filter(y=>!(y.command in Hf));if(p.length>0)throw new Error(`Unimplemented: ${p.map(y=>y.command).join(", ")}.`);return c.forEach(y=>{y.command!=="setTransition"&&y.command!=="setProjection"&&this[y.command].apply(this,y.args)}),this.stylesheet=r,this._updateMapProjection(),!0}addImage(r,c){return this.getImage(r)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,c),this._afterImageUpdated(r),this)}updateImage(r,c){this.imageManager.updateImage(r,c)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r),this._afterImageUpdated(r),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,c,p={}){if(this._checkLoaded(),this.getSource(r)!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(s.validateSource,`sources.${r}`,c,null,p))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const y=Ie(r,c,this.dispatcher,this);y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(r),source:y.serialize(),sourceId:r}));const v=T=>{const C=(T?"symbol:":"other:")+r,M=this._sourceCaches[C]=new s.SourceCache(C,y,T);(T?this._symbolSourceCaches:this._otherSourceCaches)[r]=M,M.style=this,M.onAdd(this.map)};v(!1),c.type!=="vector"&&c.type!=="geojson"||v(!0),y.onAdd&&y.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const c=this.getSource(r);if(!c)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===r)return this.fire(new s.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new s.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(r);for(const y of p)delete this._sourceCaches[y.id],delete this._updatedSources[y.id],y.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles();return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(r,c){this._checkLoaded(),this.getSource(r).setData(c),this._changed=!0}getSource(r){const c=this._getSourceCache(r);return c&&c.getSource()}addLayer(r,c,p={}){this._checkLoaded();const y=r.id;if(this.getLayer(y))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${y}" already exists on this map`)));let v;if(r.type==="custom"){if(Wl(this,s.validateCustomStyleLayer(r)))return;v=s.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(y,r.source),r=s.clone$1(r),r=s.extend(r,{source:y})),this._validate(s.validateLayer,`layers.${y}`,r,{arrayIndex:-1},p))return;v=s.createStyleLayer(r),this._validateLayer(v),v.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[v.id]=v.serialize(),this._updateLayerCount(v,!0)}const T=c?this._order.indexOf(c):this._order.length;if(c&&T===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(T,0,y),this._layerOrderChanged=!0,this._layers[y]=v;const C=this._getLayerSourceCache(v);if(this._removedLayers[y]&&v.source&&C&&v.type!=="custom"){const M=this._removedLayers[y];delete this._removedLayers[y],M.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",C.pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,c){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===c)return;const p=this._order.indexOf(r);this._order.splice(p,1);const y=c?this._order.indexOf(c):this._order.length;c&&y===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(y,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const c=this._layers[r];if(!c)return void this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const p=this._order.indexOf(r);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=c,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const c in this._layers)if(this._layers[c].type===r)return!0;return!1}setLayerZoomRange(r,c,p){this._checkLoaded();const y=this.getLayer(r);y?y.minzoom===c&&y.maxzoom===p||(c!=null&&(y.minzoom=c),p!=null&&(y.maxzoom=p),this._updateLayer(y)):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,c,p={}){this._checkLoaded();const y=this.getLayer(r);if(y){if(!A(y.filter,c))return c==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(s.validateFilter,`layers.${y.id}.filter`,c,{layerType:y.type},p)||(y.filter=s.clone$1(c),this._updateLayer(y)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){const c=this.getLayer(r);return c&&s.clone$1(c.filter)}setLayoutProperty(r,c,p,y={}){this._checkLoaded();const v=this.getLayer(r);v?A(v.getLayoutProperty(c),p)||(v.setLayoutProperty(c,p,y),this._updateLayer(v)):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,c){const p=this.getLayer(r);if(p)return p.getLayoutProperty(c);this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,c,p,y={}){this._checkLoaded();const v=this.getLayer(r);v?A(v.getPaintProperty(c),p)||(v.setPaintProperty(c,p,y)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,c){const p=this.getLayer(r);return p&&p.getPaintProperty(c)}setFeatureState(r,c){this._checkLoaded();const p=r.source,y=r.sourceLayer,v=this.getSource(p);if(!v)return void this.fire(new s.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const T=v.type;if(T==="geojson"&&y)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(T==="vector"&&!y)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const C=this._getSourceCaches(p);for(const M of C)M.setFeatureState(y,r.id,c)}removeFeatureState(r,c){this._checkLoaded();const p=r.source,y=this.getSource(p);if(!y)return void this.fire(new s.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const v=y.type,T=v==="vector"?r.sourceLayer:void 0;if(v==="vector"&&!T)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const C=this._getSourceCaches(p);for(const M of C)M.removeFeatureState(T,r.id,c)}getFeatureState(r){this._checkLoaded();const c=r.source,p=r.sourceLayer,y=this.getSource(c);if(y){if(y.type!=="vector"||p)return r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(p,r.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const c in this._sourceCaches){const p=this._sourceCaches[c].getSource();r[p.id]||(r[p.id]=p.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0;const c=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&c&&c.getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",c.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const c=T=>this._layers[T].type==="fill-extrusion",p={},y=[];for(let T=this._order.length-1;T>=0;T--){const C=this._order[T];if(c(C)){p[C]=T;for(const M of r){const z=M[C];if(z)for(const O of z)y.push(O)}}}y.sort((T,C)=>C.intersectionZ-T.intersectionZ);const v=[];for(let T=this._order.length-1;T>=0;T--){const C=this._order[T];if(c(C))for(let M=y.length-1;M>=0;M--){const z=y[M].feature;if(p[z.layer.id]<T)break;v.push(z),y.pop()}else for(const M of r){const z=M[C];if(z)for(const O of z)v.push(O.feature)}}return v}queryRenderedFeatures(r,c,p){c&&c.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const y={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const M of c.layers){const z=this._layers[M];if(!z)return this.fire(new s.ErrorEvent(new Error(`The layer '${M}' does not exist in the map's style and cannot be queried for features.`))),[];y[z.source]=!0}}const v=[];c.availableImages=this._availableImages;const T=c&&c.layers?c.layers.some(M=>{const z=this.getLayer(M);return z&&z.is3D()}):this.has3DLayers(),C=be.createFromScreenPoints(r,p);for(const M in this._sourceCaches){const z=this._sourceCaches[M].getSource().id;c.layers&&!y[z]||v.push(zt(this._sourceCaches[M],this._layers,this._serializedLayers,C,c,p,T,!!this.map._showQueryGeometry))}return this.placement&&v.push(function(M,z,O,N,$,K,W){const H={},X=K.queryRenderedSymbols(N),q=[];for(const te of Object.keys(X).map(Number))q.push(W[te]);q.sort(Ht);for(const te of q){const Y=te.featureIndex.lookupSymbolFeatures(X[te.bucketInstanceId],z,te.bucketIndex,te.sourceLayerIndex,$.filter,$.layers,$.availableImages,M);for(const pe in Y){const fe=H[pe]=H[pe]||[],le=Y[pe];le.sort((de,he)=>{const ve=te.featureSortOrder;if(ve){const ze=ve.indexOf(de.featureIndex);return ve.indexOf(he.featureIndex)-ze}return he.featureIndex-de.featureIndex});for(const de of le)fe.push(de)}}for(const te in H)H[te].forEach(Y=>{const pe=Y.feature,fe=O(M[te]).getFeatureState(pe.layer["source-layer"],pe.id);pe.source=pe.layer.source,pe.layer["source-layer"]&&(pe.sourceLayer=pe.layer["source-layer"]),pe.state=fe});return H}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),C.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(r,c){c&&c.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const p=this._getSourceCaches(r);let y=[];for(const v of p)y=y.concat(lt(v,c));return y}addSourceType(r,c,p){return _r.getSourceType(r)?p(new Error(`A source type called "${r}" already exists.`)):(_r.setSourceType(r,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:c.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(r,c={}){this._checkLoaded();const p=this.light.getLight();let y=!1;for(const T in r)if(!A(r[T],p[T])){y=!0;break}if(!y)return;const v=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(r,c),this.light.updateTransitions(v)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,c=1){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(c===1){if(typeof r.source=="object"){const p="terrain-dem-src";this.addSource(p,r.source),r=s.clone$1(r),r=s.extend(r,{source:p})}if(this._validate(s.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode)this._createTerrain(r,c);else{const p=this.terrain,y=p.get();for(const v of Object.keys(s.spec.terrain))!r.hasOwnProperty(v)&&s.spec.terrain[v].default&&(r[v]=s.spec.terrain[v].default);for(const v in r)if(!A(r[v],y[v])){p.set(r),this.stylesheet.terrain=r;const T=this._setTransitionParameters({duration:0});p.updateTransitions(T);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const c=this.fog=new Lt(r,this.map.transform);this.stylesheet.fog=r;const p=this._setTransitionParameters({duration:0});c.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,p=c.get();Object.keys(r).length===0&&c.set(r);for(const y in r)if(!A(r[y],p[y])){c.set(r),this.stylesheet.fog=r;const v=this._setTransitionParameters({duration:0});c.updateTransitions(v);break}}else this._createFog(r);this._markersNeedUpdate=!0}_setTransitionParameters(r){return{now:s.exported.now(),transition:s.extend(r,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(p=>this.isLayerDraped(this._layers[p])),c=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...c)}_createTerrain(r,c){const p=this.terrain=new at(r,c);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const y=this._setTransitionParameters({duration:0});p.updateTransitions(y)}_force3DLayerUpdate(){for(const r in this._layers){const c=this._layers[r];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const c=this._layers[r];c.type==="symbol"&&this._updateLayer(c)}}_validate(r,c,p,y,v={}){return(!v||v.validate!==!1)&&Wl(this,r.call(s.validateStyle,s.extend({key:c,style:this.serialize(),value:p,styleSpec:s.spec},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const c=this._getSourceCaches(r);for(const p of c)p.clearTiles()}_reloadSource(r){const c=this._getSourceCaches(r);for(const p of c)p.resume(),p.reload()}_updateSources(r){for(const c in this._sourceCaches)this._sourceCaches[c].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const c=this._sourceCaches[r];c.resume(),c.reload()}}_updatePlacement(r,c,p,y,v=!1){let T=!1,C=!1;const M={};for(const z of this._order){const O=this._layers[z];if(O.type!=="symbol")continue;if(!M[O.source]){const $=this._getLayerSourceCache(O);if(!$)continue;M[O.source]=$.getRenderableIds(!0).map(K=>$.getTileByID(K)).sort((K,W)=>W.tileID.overscaledZ-K.tileID.overscaledZ||(K.tileID.isLessThan(W.tileID)?-1:1))}const N=this.crossTileSymbolIndex.addLayer(O,M[O.source],r.center.lng,r.projection);T=T||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),v=v||this._layerOrderChanged||p===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(v||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),r.zoom))&&(this.pauseablePlacement=new bo(r,this._order,v,c,p,y,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),C=!0),T&&this.pauseablePlacement.placement.setStale()),C||T)for(const z of this._order){const O=this._layers[z];O.type==="symbol"&&this.placement.updateLayerOpacities(O,M[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,c,p){this.imageManager.getImages(c.icons,p),this._updateTilesForChangedImages();const y=v=>{v&&v.setDependencies(c.tileID.key,c.type,c.icons)};y(this._otherSourceCaches[c.source]),y(this._symbolSourceCaches[c.source])}getGlyphs(r,c,p){this.glyphManager.getGlyphs(c.stacks,p)}getResource(r,c,p){return s.makeRequest(c,p)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const c=[];return this._otherSourceCaches[r]&&c.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&c.push(this._symbolSourceCaches[r]),c}_isSourceCacheLoaded(r){const c=this._getSourceCaches(r);return c.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${r}'`))),!1):c.every(p=>p.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}_r.getSourceType=function(h){return _e[h]},_r.setSourceType=function(h,r){_e[h]=r},_r.registerForPluginStateChange=s.registerForPluginStateChange;var Cu=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Su="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Mu=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Au=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Ps=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Hl={},Xo={};const wo=[];Ko(Cu,wo),Ko(Mu,wo),Ko(Au,wo),Ko(Ps,wo),Hl=zn("",Mu),Xo=zn(Ps,Au);const Oa=zn(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Xl=Cu,Kl=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Yl={background:zn(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:zn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:zn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:zn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:zn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:zn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:zn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:zn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:zn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:zn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:zn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:zn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:zn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:zn(`uniform lowp vec3 u_lightpos;varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
void main() {vec4 color=v_color;
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color_normal(color.xyz,normalize(v_normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying highp vec3 v_normal;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;vec3 pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_normal=normal;v_depth=gl_Position.w;
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:zn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:zn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:zn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
highp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);
#else
vec4 out_color=color;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:zn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:zn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:zn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
vec4 offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:zn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
vec4 offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:zn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:zn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:zn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:zn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Su),skyboxGradient:zn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Su),skyboxCapture:zn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:zn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);vec4 color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
vec4 color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;
#ifdef GLOBE_POLES
vec3 up_vector=normalize(globe_pos)*u_tile_up_scale;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:zn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);
#ifdef PROJECTION_GLOBE_VIEW
float globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));float horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
float horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Ko(h,r){const c=h.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of c)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const y=p.split(" ");for(const v of y)r.includes(v)||r.push(v)}}function zn(h,r){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),y={},v=[...wo];return Ko(h,v),Ko(r,v),{fragmentSource:h=h.replace(c,(T,C,M,z,O)=>(y[O]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${O}
varying ${M} ${z} ${O};
#else
uniform ${M} ${z} u_${O};
#endif
`:`
#ifdef HAS_UNIFORM_u_${O}
    ${M} ${z} ${O} = u_${O};
#endif
`)),vertexSource:r=r.replace(c,(T,C,M,z,O)=>{const N=z==="float"?"vec2":"vec4",$=O.match(/color/)?"color":N;return y[O]?C==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${M} ${N} a_${O};
varying ${M} ${z} ${O};
#else
uniform ${M} ${z} u_${O};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = a_${O};
#else
    ${M} ${z} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = unpack_mix_${$}(a_${O}, u_${O}_t);
#else
    ${M} ${z} ${O} = u_${O};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${M} ${N} a_${O};
#else
uniform ${M} ${z} u_${O};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${M} ${z} ${O} = a_${O};
#else
    ${M} ${z} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${M} ${z} ${O} = unpack_mix_${$}(a_${O}, u_${O}_t);
#else
    ${M} ${z} ${O} = u_${O};
#endif
`}),staticAttributes:p,usedDefines:v}}class Jl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,c,p,y,v,T,C){this.context=r;let M=this.boundPaintVertexBuffers.length!==y.length;for(let O=0;!M&&O<y.length;O++)this.boundPaintVertexBuffers[O]!==y[O]&&(M=!0);let z=this.boundDynamicVertexBuffers.length!==C.length;for(let O=0;!z&&O<C.length;O++)this.boundDynamicVertexBuffers[O]!==C[O]&&(z=!0);if(!r.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==p||M||z||this.boundIndexBuffer!==v||this.boundVertexOffset!==T)this.freshBind(c,p,y,v,T,C);else{r.bindVertexArrayOES.set(this.vao);for(const O of C)O&&O.bind();v&&v.dynamicDraw&&v.bind()}}freshBind(r,c,p,y,v,T){let C;const M=r.numAttributes,z=this.context,O=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),C=0,this.boundProgram=r,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=v,this.boundDynamicVertexBuffers=T;else{C=z.currentNumAttributes||0;for(let N=M;N<C;N++)O.disableVertexAttribArray(N)}c.enableAttributes(O,r),c.bind(),c.setVertexAttribPointers(O,r,v);for(const N of p)N.enableAttributes(O,r),N.bind(),N.setVertexAttribPointers(O,r,v);for(const N of T)N&&(N.enableAttributes(O,r),N.bind(),N.setVertexAttribPointers(O,r,v));y&&y.bind(),z.currentNumAttributes=M}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Iu(h,r){const c=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new s.MercatorCoordinate(0,p/c).toLngLat().lat,new s.MercatorCoordinate(0,(p+1)/c).toLngLat().lat]}function Pu(h,r,c,p,y,v,T){const C=h.context,M=C.gl,z=c.fbo;if(!z)return;h.prepareDrawTile();const O=h.useProgram("hillshade");C.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,z.colorAttachment.get());const N=((H,X,q,te)=>{const Y=q.paint.get("hillshade-shadow-color"),pe=q.paint.get("hillshade-highlight-color"),fe=q.paint.get("hillshade-accent-color");let le=q.paint.get("hillshade-illumination-direction")*(Math.PI/180);q.paint.get("hillshade-illumination-anchor")==="viewport"&&(le-=H.transform.angle);const de=!H.options.moving;return{u_matrix:te||H.transform.calculateProjMatrix(X.tileID.toUnwrapped(),de),u_image:0,u_latrange:Iu(0,X.tileID),u_light:[q.paint.get("hillshade-exaggeration"),le],u_shadow:Y,u_highlight:pe,u_accent:fe}})(h,c,p,h.terrain?r.projMatrix:null);h.prepareDrawProgram(C,O,r.toUnwrapped());const{tileBoundsBuffer:$,tileBoundsIndexBuffer:K,tileBoundsSegments:W}=h.getTileBoundsBuffers(c);O.draw(C,M.TRIANGLES,y,v,T,s.CullFaceMode.disabled,N,p.id,$,K,W)}function Mn(h,r,c){if(!r.needsDEMTextureUpload)return;const p=h.context,y=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||h.getTileTexture(c.stride);const v=c.getPixels();r.demTexture?r.demTexture.update(v,{premultiply:!1}):r.demTexture=new s.Texture(p,v,y.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function zs(h,r,c,p,y,v){const T=h.context,C=T.gl;if(!r.dem)return;const M=r.dem;if(T.activeTexture.set(C.TEXTURE1),Mn(h,r,M),!r.demTexture)return;r.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);const z=M.dim;T.activeTexture.set(C.TEXTURE0);let O=r.fbo;if(!O){const W=new s.Texture(T,{width:z,height:z,data:null},C.RGBA);W.bind(C.LINEAR,C.CLAMP_TO_EDGE),O=r.fbo=T.createFramebuffer(z,z,!0),O.colorAttachment.set(W.texture)}T.bindFramebuffer.set(O.framebuffer),T.viewport.set([0,0,z,z]);const{tileBoundsBuffer:N,tileBoundsIndexBuffer:$,tileBoundsSegments:K}=h.getMercatorTileBoundsBuffers();h.useProgram("hillshadePrepare").draw(T,C.TRIANGLES,p,y,v,s.CullFaceMode.disabled,((W,H)=>{const X=H.stride,q=s.create();return s.ortho(q,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(q,q,[0,-s.EXTENT,0]),{u_matrix:q,u_image:1,u_dimension:[X,X],u_zoom:W.overscaledZ,u_unpack:H.unpackVector}})(r.tileID,M),c.id,N,$,K),r.needsHillshadePrepare=!1}const ka=h=>({u_matrix:new s.UniformMatrix4f(h),u_image0:new s.Uniform1i(h),u_skirt_height:new s.Uniform1f(h)}),zu=(h,r)=>({u_matrix:h,u_image0:0,u_skirt_height:r}),Ou=(h,r,c,p,y,v,T,C,M,z,O,N,$,K)=>({u_proj_matrix:Float32Array.from(h),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:c,u_zoom_transition:y,u_merc_center:v,u_image0:0,u_frustum_tl:T,u_frustum_tr:C,u_frustum_br:M,u_frustum_bl:z,u_globe_pos:O,u_globe_radius:N,u_viewport:$,u_grid_matrix:K?Float32Array.from(K):new Float32Array(9)});function ku(h,r){return h!=null&&r!=null&&!(!h.hasData()||!r.hasData())&&h.demTexture!=null&&r.demTexture!=null&&h.tileID.key!==r.tileID.key}const To=new class{constructor(){this.operations={}}newMorphing(h,r,c,p,y){if(h in this.operations){const v=this.operations[h];v.to.tileID.key!==c.tileID.key&&(v.queued=c)}else this.operations[h]={startTime:p,phase:0,duration:y,from:r,to:c,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const r=this.operations[h];return{from:r.from,to:r.to,phase:r.phase}}update(h){for(const r in this.operations){const c=this.operations[r];for(c.phase=(h-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,h)){delete this.operations[r];break}}}_nextOp(h,r){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=r,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},Da={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function qm(h,r){const c=1<<h.z;return!r&&(h.x===0||h.x===c-1)||h.y===0||h.y===c-1}const Du=h=>({u_matrix:h});function Ql(h,r,c,p,y){if(y>0){const v=s.exported.now(),T=(v-h.timeAdded)/y,C=r?(v-r.timeAdded)/y:-1,M=c.getSource(),z=p.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),O=!r||Math.abs(r.tileID.overscaledZ-z)>Math.abs(h.tileID.overscaledZ-z),N=O&&h.refreshedUponExpiration?1:s.clamp(O?T:1-C,0,1);return h.refreshedUponExpiration&&T>=1&&(h.refreshedUponExpiration=!1),r?{opacity:1,mix:1-N}:{opacity:N,mix:0}}return{opacity:1,mix:0}}class Lu extends s.SourceCache{constructor(r){const c={type:"raster-dem",maxzoom:r.transform.maxZoom},p=new nn(Fn(),null),y=Ie("mock-dem",c,p,r.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,c){r.state="loaded",c(null)}}class Ru extends s.SourceCache{constructor(r){const c=Ie("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new nn(Fn(),null),r.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,c,p){if(r.freezeTileCoverage)return;this.transform=r;const y=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((v,T)=>{if(v[T.key]="",!this._tiles[T.key]){const C=new s.Tile(T,this._source.tileSize*T.overscaleFactor(),r.tileZoom);C.state="loaded",this._tiles[T.key]=C}return v},{});for(const v in this._tiles)v in y||(this.freeFBO(v),this._tiles[v].unloadVectorData(),delete this._tiles[v])}freeFBO(r){const c=this.proxyCachedFBO[r];if(c!==void 0){const p=Object.values(c);this.renderCachePool.push(...p),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ec extends s.OverscaledTileID{constructor(r,c,p){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=c,this.projMatrix=p}}class Kf extends s.Elevation{constructor(r,c){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,y,v]=function(M){const z=new s.StructArrayLayout4i8,O=new s.StructArrayLayout3ui6,N=131;z.reserve(17161),O.reserve(33800);const $=s.EXTENT/128,K=s.EXTENT+$/2,W=K+$;for(let X=-$;X<W;X+=$)for(let q=-$;q<W;q+=$){const te=q<0||q>K||X<0||X>K?24575:0,Y=s.clamp(Math.round(q),0,s.EXTENT),pe=s.clamp(Math.round(X),0,s.EXTENT);z.emplaceBack(Y+te,pe,Y,pe)}const H=(X,q)=>{const te=q*N+X;O.emplaceBack(te+1,te,te+N),O.emplaceBack(te+N,te+N+1,te+1)};for(let X=1;X<129;X++)for(let q=1;q<129;q++)H(q,X);return[0,129].forEach(X=>{for(let q=0;q<130;q++)H(q,X),H(X,q)}),[z,O,32768]}(),T=r.context;this.gridBuffer=T.createVertexBuffer(p,s.boundsAttributes.members),this.gridIndexBuffer=T.createIndexBuffer(y),this.gridSegments=s.SegmentVector.simpleSegment(0,0,p.length,y.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,p.length,v),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ru(c.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,0,s.EXTENT,0,s.EXTENT,0,1);const C=T.gl;this._overlapStencilMode=new s.StencilMode({func:C.GEQUAL,mask:255},0,255,C.KEEP,C.KEEP,C.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Lu(c.map)}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency()}update(r,c,p){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const y=r.terrain.properties;this.sourceCache=r.terrain.drapeRenderMode===0?this._mockSourceCache:r._getSourceCache(y.get("source")),this._exaggeration=y.get("exaggeration");const v=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const T=this.getScaledDemTileSize();this.sourceCache.update(c,T,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,v(),this._initializing=!0),v(),c.updateElevation(!p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||r.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=c.getIds().map(M=>{const z=c.getTileByID(M).tileID;return z.projMatrix=p.calculateProjMatrix(z.toUnwrapped()),z});(function(M,z){const O=z.transform.pointCoordinate(z.transform.getCameraPoint()),N=new s.pointGeometry(O.x,O.y);M.sort(($,K)=>{if(K.overscaledZ-$.overscaledZ)return K.overscaledZ-$.overscaledZ;const W=new s.pointGeometry($.canonical.x+(1<<$.canonical.z)*$.wrap,$.canonical.y),H=new s.pointGeometry(K.canonical.x+(1<<K.canonical.z)*K.wrap,K.canonical.y),X=N.mult(1<<$.canonical.z);return X.x-=.5,X.y-=.5,X.distSqr(W)-X.distSqr(H)})})(y,this.painter),this._previousZoom=p.zoom;const v=this.proxyToSource||{};this.proxyToSource={},y.forEach(M=>{this.proxyToSource[M.key]={}}),this.terrainTileForTile={};const T=this._style._sourceCaches;for(const M in T){const z=T[M];if(!z.used||(z!==this.sourceCache&&this.resetTileLookupCache(z.id),this._setupProxiedCoordsForOrtho(z,r[M],v),z.usedForTerrain))continue;const O=r[M];z.getSource().reparseOverscaled&&this._assignTerrainTiles(O)}this.proxiedCoords[c.id]=y.map(M=>new ec(M,M.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(v),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const C={};this._visibleDemTiles=[];for(const M of this.proxyCoords){const z=this.terrainTileForTile[M.key];if(!z)continue;const O=z.tileID.key;O in C||(this._visibleDemTiles.push(z),C[O]=O)}}_assignTerrainTiles(r){this._initializing||r.forEach(c=>{if(this.terrainTileForTile[c.key])return;const p=this._findTileCoveringTileID(c,this.sourceCache);p&&(this.terrainTileForTile[c.key]=p)})}_prepareDEMTextures(){const r=this.painter.context,c=r.gl;for(const p in this.terrainTileForTile){const y=this.terrainTileForTile[p],v=y.dem;!v||y.demTexture&&!y.needsDEMTextureUpload||(r.activeTexture.set(c.TEXTURE1),Mn(this.painter,y,v))}}_prepareDemTileUniforms(r,c,p,y){if(!c||c.demTexture==null)return!1;const v=r.tileID.canonical,T=Math.pow(2,c.tileID.canonical.z-v.z),C=y||"";return p[`u_dem_tl${C}`]=[v.x*T%1,v.y*T%1],p[`u_dem_scale${C}`]=T,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const r=this.painter.context,c=r.gl;if(!this._emptyDepthBufferTexture){const p=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(r,p,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let r=0;const c=this._visibleDemTiles.reduce((p,y)=>{if(!y.dem)return p;const v=y.dem.tree.minimums[0];return v>0&&r++,p+v},0);return r?c/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,c=r.gl;r.activeTexture.set(c.TEXTURE2);const p=this._getLoadedAreaMinimum(),y=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(p,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let v=this._emptyDEMTexture;return v?v.update(y,{premultiply:!1}):v=this._emptyDEMTexture=new s.Texture(r,y,c.RGBA,{premultiply:!1}),v}setupElevationDraw(r,c,p){const y=this.painter.context,v=y.gl,T=(C=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(C),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var C;T.u_dem_size=this.sourceCache.getSource().tileSize,T.u_exaggeration=this.exaggeration();const M=this.painter.transform,z=M.projection,O=r.tileID.canonical;T.u_tile_tl_up=z.upVector(O,0,0),T.u_tile_tr_up=z.upVector(O,s.EXTENT,0),T.u_tile_br_up=z.upVector(O,s.EXTENT,s.EXTENT),T.u_tile_bl_up=z.upVector(O,0,s.EXTENT),T.u_tile_up_scale=p&&p.useDenormalizedUpVectorScale?s.GLOBE_METERS_TO_ECEF:z.upVectorScale(O,M.center.lat,M.worldSize).metersToTile;let N=null,$=null,K=1;if(p&&p.morphing&&this._useVertexMorphing){const W=p.morphing.srcDemTile,H=p.morphing.dstDemTile;K=p.morphing.phase,W&&H&&(this._prepareDemTileUniforms(r,W,T,"_prev")&&($=W),this._prepareDemTileUniforms(r,H,T)&&(N=H))}if($&&N?(y.activeTexture.set(v.TEXTURE2),N.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE,v.NEAREST),y.activeTexture.set(v.TEXTURE4),$.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE,v.NEAREST),T.u_dem_lerp=K):(N=this.terrainTileForTile[r.tileID.key],y.activeTexture.set(v.TEXTURE2),(this._prepareDemTileUniforms(r,N,T)?N.demTexture:this.emptyDEMTexture).bind(v.NEAREST,v.CLAMP_TO_EDGE)),y.activeTexture.set(v.TEXTURE3),p&&p.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),this._depthFBO&&(T.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),T.u_depth_size_inv=[1,1]),p&&p.useMeterToDem&&N){const W=(1<<N.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;T.u_meter_to_dem=W}p&&p.labelPlaneMatrixInv&&(T.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),c.setTerrainUniformValues(y,T)}renderToBackBuffer(r){const c=this.painter,p=this.painter.context;r.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,v,T,C,M){if(y.transform.projection.name==="globe")(function(z,O,N,$,K){const W=z.context,H=W.gl;let X,q;const te=z.options.showTerrainWireframe?2:0,Y=z.transform,pe=s.globeUseCustomAntiAliasing(z,W,Y),fe=(St,je)=>{if(q===St)return;const gt=[Da[St],"PROJECTION_GLOBE_VIEW"];pe&&gt.push("CUSTOM_ANTIALIASING"),je&&gt.push(Da[te]),X=z.useProgram("globeRaster",null,gt),q=St},le=z.colorModeForRenderPass(),de=new s.DepthMode(H.LEQUAL,s.DepthMode.ReadWrite,z.depthRangeFor3D);To.update(K);const he=s.calculateGlobeMercatorMatrix(Y),ve=[s.mercatorXfromLng(Y.center.lng),s.mercatorYfromLat(Y.center.lat)],ze=te?[!1,!0]:[!1],pt=z.globeSharedBuffers,Ce=[Y.width*s.exported.devicePixelRatio,Y.height*s.exported.devicePixelRatio],He=Float32Array.from(Y.globeMatrix),et={useDenormalizedUpVectorScale:!0};if(ze.forEach(St=>{q=-1;const je=St?H.LINES:H.TRIANGLES;for(const gt of $){const Je=N.getTile(gt),It=s.StencilMode.disabled,At=O.prevTerrainTileForTile[gt.key],Nt=O.terrainTileForTile[gt.key];ku(At,Nt)&&To.newMorphing(gt.key,At,Nt,K,250),W.activeTexture.set(H.TEXTURE0),Je.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const Zt=To.getMorphValuesForProxy(gt.key),tn=Zt?1:0;Zt&&s.extend$1(et,{morphing:{srcDemTile:Zt.from,dstDemTile:Zt.to,phase:s.easeCubicInOut(Zt.phase)}});const bn=s.tileCornersToBounds(gt.canonical),Ut=s.getLatitudinalLod(bn.getCenter().lat),an=s.getGridMatrix(gt.canonical,bn,Ut),An=s.globeNormalizeECEF(s.globeTileBounds(gt.canonical)),Jn=Ou(Y.projMatrix,He,he,An,s.globeToMercatorTransition(Y.zoom),ve,Y.frustumCorners.TL,Y.frustumCorners.TR,Y.frustumCorners.BR,Y.frustumCorners.BL,Y.globeCenterInViewSpace,Y.globeRadius,Ce,an);if(fe(tn,St),O.setupElevationDraw(Je,X,et),z.prepareDrawProgram(W,X,gt.toUnwrapped()),pt){const[ui,Vn,Ai]=St?pt.getWirefameBuffers(z.context,Ut):pt.getGridBuffers(Ut);X.draw(W,je,de,It,le,s.CullFaceMode.backCCW,Jn,"globe_raster",ui,Vn,Ai)}}}),pt){const St=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];pe&&St.push("CUSTOM_ANTIALIASING"),X=z.useProgram("globeRaster",null,St);for(const je of $){const{x:gt,y:Je,z:It}=je.canonical,At=Je===0,Nt=Je===(1<<It)-1,[Zt,tn,bn,Ut]=pt.getPoleBuffers(It);if(Ut&&(At||Nt)){const an=N.getTile(je);W.activeTexture.set(H.TEXTURE0),an.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE);let An=s.globePoleMatrixForTile(It,gt,Y);const Jn=s.globeNormalizeECEF(s.globeTileBounds(je.canonical)),ui=(Vn,Ai)=>Vn.draw(W,H.TRIANGLES,de,s.StencilMode.disabled,le,s.CullFaceMode.disabled,Ou(Y.projMatrix,An,An,Jn,0,ve,Y.frustumCorners.TL,Y.frustumCorners.TR,Y.frustumCorners.BR,Y.frustumCorners.BL,Y.globeCenterInViewSpace,Y.globeRadius,Ce),"globe_pole_raster",Ai,bn,Ut);O.setupElevationDraw(an,X,et),z.prepareDrawProgram(W,X,je.toUnwrapped()),At&&ui(X,Zt),Nt&&(An=s.scale(s.create(),An,[1,-1,1]),ui(X,tn))}}}})(y,v,T,C,M);else{const z=y.context,O=z.gl;let N,$;const K=y.options.showTerrainWireframe?2:0,W=(Y,pe)=>{if($===Y)return;const fe=[Da[Y]];pe&&fe.push(Da[K]),N=y.useProgram("terrainRaster",null,fe),$=Y},H=y.colorModeForRenderPass(),X=new s.DepthMode(O.LEQUAL,s.DepthMode.ReadWrite,y.depthRangeFor3D);To.update(M);const q=y.transform,te=6*Math.pow(1.5,22-q.zoom)*v.exaggeration();(K?[!1,!0]:[!1]).forEach(Y=>{$=-1;const pe=Y?O.LINES:O.TRIANGLES,[fe,le]=Y?v.getWirefameBuffer():[v.gridIndexBuffer,v.gridSegments];for(const de of C){const he=T.getTile(de),ve=s.StencilMode.disabled,ze=v.prevTerrainTileForTile[de.key],pt=v.terrainTileForTile[de.key];ku(ze,pt)&&To.newMorphing(de.key,ze,pt,M,250),z.activeTexture.set(O.TEXTURE0),he.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST);const Ce=To.getMorphValuesForProxy(de.key),He=Ce?1:0;let et;Ce&&(et={morphing:{srcDemTile:Ce.from,dstDemTile:Ce.to,phase:s.easeCubicInOut(Ce.phase)}});const St=zu(de.projMatrix,qm(de.canonical,q.renderWorldCopies)?te/10:te);W(He,Y),v.setupElevationDraw(he,N,et),y.prepareDrawProgram(z,N,de.toUnwrapped()),N.draw(z,pe,X,ve,H,s.CullFaceMode.backCCW,St,"terrain_raster",v.gridBuffer,fe,le)}})}}(c,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const c=this.painter,p=this.painter.context,y=this.proxySourceCache,v=this.proxiedCoords[y.id],T=this._drapedRenderBatches.shift(),C=[],M=c.style.order;let z=0;for(const O of v){const N=y.getTileByID(O.proxyTileKey),$=y.proxyCachedFBO[O.key]?y.proxyCachedFBO[O.key][r]:void 0,K=$!==void 0?y.renderCache[$]:this.pool[z++],W=$!==void 0;if(N.texture=K.tex,W&&!K.dirty){C.push(N.tileID);continue}let H;p.bindFramebuffer.set(K.fb.framebuffer),this.renderedToTile=!1,K.dirty&&(p.clear({color:s.Color.transparent,stencil:0}),K.dirty=!1);for(let X=T.start;X<=T.end;++X){const q=c.style._layers[M[X]];if(q.isHidden(c.transform.zoom))continue;const te=c.style._getLayerSourceCache(q),Y=te?this.proxyToSource[O.key][te.id]:[O];if(!Y)continue;const pe=Y;p.viewport.set([0,0,K.fb.width,K.fb.height]),H!==(te?te.id:null)&&(this._setupStencil(K,Y,q,te),H=te?te.id:null),c.renderLayer(c,te,q,pe)}this.renderedToTile?(K.dirty=!0,C.push(N.tileID)):W||--z,z===5&&(z=0,this.renderToBackBuffer(C))}return this.renderToBackBuffer(C),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),T.end+1}postRender(){}renderCacheEfficiency(r){const c=r.order.length;if(c===0)return{efficiency:100};let p,y=0,v=0,T=!1;for(let C=0;C<c;++C){const M=r._layers[r.order[C]];this._style.isLayerDraped(M)?(T&&++y,++v):T||(T=!0,p=M.id)}return v===0?{efficiency:100}:{efficiency:100*(1-y/v),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{r=Math.min(r,c.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,c,p){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter(v=>v.dem).map(v=>{const T=v.tileID,C=1<<T.overscaledZ,{x:M,y:z}=T.canonical,O=M/C,N=(M+1)/C,$=z/C,K=(z+1)/C;return{minx:O,miny:$,maxx:N,maxy:K,t:v.dem.tree.raycastRoot(O,$,N,K,r,c,p),tile:v}});y.sort((v,T)=>(v.t!==null?v.t:Number.MAX_VALUE)-(T.t!==null?T.t:Number.MAX_VALUE));for(const v of y){if(v.t==null)return null;const T=v.tile.dem.tree.raycast(v.minx,v.miny,v.maxx,v.maxy,r,c,p);if(T!=null)return T}return null}_createFBO(){const r=this.painter.context,c=r.gl,p=this.drapeBufferSize;r.activeTexture.set(c.TEXTURE0);const y=new s.Texture(r,{width:p[0],height:p[1],data:null},c.RGBA);y.bind(c.LINEAR,c.CLAMP_TO_EDGE);const v=r.createFramebuffer(p[0],p[1],!1);return v.colorAttachment.set(y.texture),v.depthAttachment=new j(r,v.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,v.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):v.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:v,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const c=this._style._layers[r],p=c.isHidden(this.painter.transform.zoom),y=c.getCrossfadeParameters(),v=!!y&&y.t!==1,T=c.hasTransition();return c.type!=="custom"&&!p&&(v||T)})}_clearRasterFadeFromRenderCache(){let r=!1;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c]._source instanceof re){r=!0;break}if(r)for(let c=0;c<this._style.order.length;++c){const p=this._style._layers[this._style.order[c]],y=p.isHidden(this.painter.transform.zoom),v=this._style._getLayerSourceCache(p);if(p.type!=="raster"||y||!v)continue;const T=p.paint.get("raster-fade-duration");for(const C of this.proxyCoords){const M=this.proxyToSource[C.key][v.id];if(M)for(const z of M){const O=Ql(v.getTile(z),v.findLoadedParent(z,0),v,this.painter.transform,T);(O.opacity!==1||O.mix!==0)&&this._clearRenderCacheForTile(v.id,z)}}}}_setupDrapedRenderBatches(){const r=this._style.order,c=r.length;if(c===0)return;const p=[];let y,v=0,T=this._style._layers[r[v]];for(;!this._style.isLayerDraped(T)&&T.isHidden(this.painter.transform.zoom)&&++v<c;)T=this._style._layers[r[v]];for(;v<c;++v){const C=this._style._layers[r[v]];C.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(C)?y===void 0&&(y=v):y!==void 0&&(p.push({start:y,end:v-1}),y=void 0))}y!==void 0&&p.push({start:y,end:v-1}),this._drapedRenderBatches=p}_setupRenderCache(r){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const T=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let C=0;C<T.length;++C){const M=Object.values(T[C]);c.renderCachePool.push(...M)}}return}this._clearRasterFadeFromRenderCache();const p=this.proxyCoords,y=this._tilesDirty;for(let T=p.length-1;T>=0;T--){const C=p[T];if(c.getTileByID(C.key),c.proxyCachedFBO[C.key]!==void 0){const M=r[C.key],z=this.proxyToSource[C.key];let O=0;for(const N in z){const $=z[N],K=M[N];if(!K||K.length!==$.length||$.some((W,H)=>W!==K[H]||y[N]&&y[N].hasOwnProperty(W.key))){O=-1;break}++O}for(const N in c.proxyCachedFBO[C.key])c.renderCache[c.proxyCachedFBO[C.key][N]].dirty=O<0||O!==Object.values(M).length}}const v=[...this._drapedRenderBatches];v.sort((T,C)=>C.end-C.start-(T.end-T.start));for(const T of v)for(const C of p){if(c.proxyCachedFBO[C.key])continue;let M=c.renderCachePool.pop();M===void 0&&c.renderCache.length<50&&(M=c.renderCache.length,c.renderCache.push(this._createFBO())),M!==void 0&&(c.proxyCachedFBO[C.key]={},c.proxyCachedFBO[C.key][T.start]=M,c.renderCache[M].dirty=!0)}this._tilesDirty={}}_setupStencil(r,c,p,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const v=this.painter.context,T=v.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let C;if(p.isTileClipped())C=c.length,this._overlapStencilMode.test={func:T.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);C=1,this._overlapStencilMode.test={func:T.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+C>255&&(v.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=C,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(r,c){const p=this.painter,y=this.painter.context,v=y.gl;p._tileClippingMaskIDs={},y.setColorMode(s.ColorMode.disabled),y.setDepthMode(s.DepthMode.disabled);const T=p.useProgram("clippingMask");for(const C of r){const M=p._tileClippingMaskIDs[C.key]=--c;T.draw(y,v.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:v.ALWAYS,mask:0},M,255,v.KEEP,v.KEEP,v.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Du(C.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(r){const c=this.painter.transform;if(r.x<0||r.x>c.width||r.y<0||r.y>c.height)return null;const p=[r.x,r.y,1,1];s.transformMat4$1(p,p,c.pixelMatrixInverse),s.scale$1(p,p,1/p[3]),p[0]/=c.worldSize,p[1]/=c.worldSize;const y=c._camera.position,v=s.mercatorZfromAltitude(1,c.center.lat),T=[y[0],y[1],y[2]/v,0],C=s.subtract([],p.slice(0,3),T);s.normalize(C,C);const M=this.raycast(T,C,this._exaggeration);return M!==null&&M?(s.scaleAndAdd(T,T,C,M),T[3]=T[2],T[2]*=v,T):null}drawDepth(){const r=this.painter,c=r.context,p=this.proxySourceCache,y=Math.ceil(r.width),v=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===y&&this._depthFBO.height===v||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const T=c.gl,C=c.createFramebuffer(y,v,!0);c.activeTexture.set(T.TEXTURE0);const M=new s.Texture(c,{width:y,height:v,data:null},T.RGBA);M.bind(T.NEAREST,T.CLAMP_TO_EDGE),C.colorAttachment.set(M.texture);const z=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,y,v);C.depthAttachment.set(z),this._depthFBO=C,this._depthTexture=M}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,y,v]),function(T,C,M,z){if(T.transform.projection.name==="globe")return;const O=T.context,N=O.gl;O.clear({depth:1});const $=T.useProgram("terrainDepth"),K=new s.DepthMode(N.LESS,s.DepthMode.ReadWrite,T.depthRangeFor3D);for(const W of z){const H=M.getTile(W),X=zu(W.projMatrix,0);C.setupElevationDraw(H,$),$.draw(O,N.TRIANGLES,K,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,X,"terrain_depth",C.gridBuffer,C.gridIndexBuffer,C.gridNoSkirtSegments)}}(r,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,c,p){if(r.getSource()instanceof Ee)return this._setupProxiedCoordsForImageSource(r,c,p);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const y=this.proxiedCoords[r.id]=[],v=this.proxyCoords;for(let C=0;C<v.length;C++){const M=v[C],z=this._findTileCoveringTileID(M,r);if(z){const O=this._createProxiedId(M,z,p[M.key]&&p[M.key][r.id]);y.push(O),this.proxyToSource[M.key][r.id]=[O]}}let T=!1;for(let C=0;C<c.length;C++){const M=r.getTile(c[C]);if(!M||!M.hasData())continue;const z=this._findTileCoveringTileID(M.tileID,this.proxySourceCache);if(z&&z.tileID.canonical.z!==M.tileID.canonical.z){const O=this.proxyToSource[z.tileID.key][r.id],N=this._createProxiedId(z.tileID,M,p[z.tileID.key]&&p[z.tileID.key][r.id]);O?O.splice(O.length-1,0,N):this.proxyToSource[z.tileID.key][r.id]=[N],y.push(N),T=!0}}this._sourceTilesOverlap[r.id]=T}_setupProxiedCoordsForImageSource(r,c,p){if(!r.getSource().loaded())return;const y=this.proxiedCoords[r.id]=[],v=this.proxyCoords,T=r.getSource(),C=new s.pointGeometry(T.tileID.x,T.tileID.y)._div(1<<T.tileID.z),M=T.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((O,N)=>(O.min.x=Math.min(O.min.x,N.x-C.x),O.min.y=Math.min(O.min.y,N.y-C.y),O.max.x=Math.max(O.max.x,N.x-C.x),O.max.y=Math.max(O.max.y,N.y-C.y),O),{min:new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),z=(O,N)=>{const $=O.wrap+O.canonical.x/(1<<O.canonical.z),K=O.canonical.y/(1<<O.canonical.z),W=s.EXTENT/(1<<O.canonical.z),H=N.wrap+N.canonical.x/(1<<N.canonical.z),X=N.canonical.y/(1<<N.canonical.z);return $+W<H+M.min.x||$>H+M.max.x||K+W<X+M.min.y||K>X+M.max.y};for(let O=0;O<v.length;O++){const N=v[O];for(let $=0;$<c.length;$++){const K=r.getTile(c[$]);if(!K||!K.hasData()||z(N,K.tileID))continue;const W=this._createProxiedId(N,K,p[N.key]&&p[N.key][r.id]),H=this.proxyToSource[N.key][r.id];H?H.push(W):this.proxyToSource[N.key][r.id]=[W],y.push(W)}}}_createProxiedId(r,c,p){let y=this.orthoMatrix;if(p){const v=p.find(T=>T.key===c.tileID.key);if(v)return v}if(c.tileID.key!==r.key){const v=r.canonical.z-c.tileID.canonical.z;let T,C,M;y=s.create();const z=c.tileID.wrap-r.wrap<<r.overscaledZ;v>0?(T=s.EXTENT>>v,C=T*((c.tileID.canonical.x<<v)-r.canonical.x+z),M=T*((c.tileID.canonical.y<<v)-r.canonical.y)):(T=s.EXTENT<<-v,C=s.EXTENT*(c.tileID.canonical.x-(r.canonical.x+z<<-v)),M=s.EXTENT*(c.tileID.canonical.y-(r.canonical.y<<-v))),s.ortho(y,0,T,0,T,0,1),s.translate(y,y,[C,M,0])}return new ec(c.tileID,r.key,y)}_findTileCoveringTileID(r,c){let p=c.getTile(r);if(p&&p.hasData())return p;const y=this._findCoveringTileCache[c.id],v=y[r.key];if(p=v?c.getTileByID(v):null,p&&p.hasData()||v===null)return p;let T=p?p.tileID:r,C=T.overscaledZ;const M=c.getSource().minzoom,z=[];if(!v){const N=c.getSource().maxzoom;if(r.canonical.z>=N){const $=r.canonical.z-N;c.getSource().reparseOverscaled?(C=Math.max(r.canonical.z+2,c.transform.tileZoom),T=new s.OverscaledTileID(C,r.wrap,N,r.canonical.x>>$,r.canonical.y>>$)):$!==0&&(C=N,T=new s.OverscaledTileID(C,r.wrap,N,r.canonical.x>>$,r.canonical.y>>$))}T.key!==r.key&&(z.push(T.key),p=c.getTile(T))}const O=N=>{z.forEach($=>{y[$]=N}),z.length=0};for(C-=1;C>=M&&(!p||!p.hasData());C--){p&&O(p.tileID.key);const N=T.calculateScaledKey(C);if(p=c.getTileByID(N),p&&p.hasData())break;const $=y[N];if($===null)break;$===void 0?z.push(N):p=c.getTileByID($)}return O(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,c){let p=this._tilesDirty[r];p||(p=this._tilesDirty[r]={}),p[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(c){let p=0;const y=new s.StructArrayLayout2ui4,v=131;for(let T=1;T<129;T++){for(let C=1;C<129;C++)p=T*v+C,y.emplaceBack(p,p+1),y.emplaceBack(p,p+v),y.emplaceBack(p+1,p+v),T===128&&y.emplaceBack(p+v,p+v+1);y.emplaceBack(p+1,p+1+v)}return y}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Bu{static cacheKey(r,c,p,y){let v=`${c}${y?y.cacheKey:""}`;for(const T of p)r.usedDefines.includes(T)&&(v+=`/${T}`);return v}constructor(r,c,p,y,v,T){const C=r.gl;this.program=C.createProgram();const M=function(X){const q=[];for(let te=0;te<X.length;te++){if(X[te]===null)continue;const Y=X[te].split(" ");q.push(Y.pop())}return q}(p.staticAttributes),z=y?y.getBinderAttributes():[],O=M.concat(z);let N=y?y.defines():[];N=N.concat(T.map(X=>`#define ${X}`));const $=N.concat(r.extStandardDerivatives?`#extension GL_OES_standard_derivatives : enable
`.concat(Kl):Kl,Kl,Xl,Oa.fragmentSource,Xo.fragmentSource,p.fragmentSource).join(`
`),K=N.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Xl,Oa.vertexSource,Xo.vertexSource,Hl.vertexSource,p.vertexSource).join(`
`),W=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(W,$),C.compileShader(W),C.attachShader(this.program,W);const H=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())this.failedToCreate=!0;else{C.shaderSource(H,K),C.compileShader(H),C.attachShader(this.program,H),this.attributes={},this.numAttributes=O.length;for(let X=0;X<this.numAttributes;X++)O[X]&&(C.bindAttribLocation(this.program,X,O[X]),this.attributes[O[X]]=X);C.linkProgram(this.program),C.deleteShader(H),C.deleteShader(W),this.fixedUniforms=v(r),this.binderUniforms=y?y.getUniforms(r):[],T.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=(X=>({u_dem:new s.Uniform1i(X),u_dem_prev:new s.Uniform1i(X),u_dem_unpack:new s.Uniform4f(X),u_dem_tl:new s.Uniform2f(X),u_dem_scale:new s.Uniform1f(X),u_dem_tl_prev:new s.Uniform2f(X),u_dem_scale_prev:new s.Uniform1f(X),u_dem_size:new s.Uniform1f(X),u_dem_lerp:new s.Uniform1f(X),u_exaggeration:new s.Uniform1f(X),u_depth:new s.Uniform1i(X),u_depth_size_inv:new s.Uniform2f(X),u_meter_to_dem:new s.Uniform1f(X),u_label_plane_matrix_inv:new s.UniformMatrix4f(X),u_tile_tl_up:new s.Uniform3f(X),u_tile_tr_up:new s.Uniform3f(X),u_tile_br_up:new s.Uniform3f(X),u_tile_bl_up:new s.Uniform3f(X),u_tile_up_scale:new s.Uniform1f(X)}))(r)),T.indexOf("FOG")!==-1&&(this.fogUniforms=(X=>({u_fog_matrix:new s.UniformMatrix4f(X),u_fog_range:new s.Uniform2f(X),u_fog_color:new s.Uniform4f(X),u_fog_horizon_blend:new s.Uniform1f(X),u_fog_temporal_offset:new s.Uniform1f(X),u_frustum_tl:new s.Uniform3f(X),u_frustum_tr:new s.Uniform3f(X),u_frustum_br:new s.Uniform3f(X),u_frustum_bl:new s.Uniform3f(X),u_globe_pos:new s.Uniform3f(X),u_globe_radius:new s.Uniform1f(X),u_globe_transition:new s.Uniform1f(X),u_is_globe:new s.Uniform1i(X),u_viewport:new s.Uniform2f(X)}))(r))}}setTerrainUniformValues(r,c){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in c)p[y].set(this.program,y,c[y])}}setFogUniformValues(r,c){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in c)p[y].set(this.program,y,c[y])}}draw(r,c,p,y,v,T,C,M,z,O,N,$,K,W,H){const X=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(p),r.setStencilMode(y),r.setColorMode(v),r.setCullFace(T);for(const te of Object.keys(this.fixedUniforms))this.fixedUniforms[te].set(this.program,te,C[te]);W&&W.setUniforms(this.program,r,this.binderUniforms,$,{zoom:K});const q={[X.LINES]:2,[X.TRIANGLES]:3,[X.LINE_STRIP]:1}[c];for(const te of N.get()){const Y=te.vaos||(te.vaos={});(Y[M]||(Y[M]=new Jl)).bind(r,this,z,W?W.getPaintVertexBuffers():[],O,te.vertexOffset,H||[]),X.drawElements(c,te.primitiveLength*q,X.UNSIGNED_SHORT,te.primitiveOffset*q*2)}}}function Yf(h,r,c){const p=1/xt(c,1,r.transform.tileZoom),y=Math.pow(2,c.tileID.overscaledZ),v=c.tileSize*Math.pow(2,r.transform.tileZoom)/y,T=v*(c.tileID.canonical.x+c.tileID.wrap*y),C=v*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[p,h.fromScale,h.toScale],u_fade:h.t,u_pixel_coord_upper:[T>>16,C>>16],u_pixel_coord_lower:[65535&T,65535&C]}}const La=s.create(),Os=(h,r,c,p,y,v,T,C,M,z,O)=>{const N=r.style.light,$=N.properties.get("position"),K=[$.x,$.y,$.z],W=s.create$1();N.properties.get("anchor")==="viewport"&&(s.fromRotation(W,-r.transform.angle),s.transformMat3(K,K,W));const H=N.properties.get("color"),X=r.transform,q={u_matrix:h,u_lightpos:K,u_lightintensity:N.properties.get("intensity"),u_lightcolor:[H.r,H.g,H.b],u_vertical_gradient:+c,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:La,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:y,u_edge_radius:v};return X.projection.name==="globe"&&(q.u_tile_id=[T.canonical.x,T.canonical.y,1<<T.canonical.z],q.u_zoom_transition=M,q.u_inv_rot_matrix=O,q.u_merc_center=z,q.u_up_dir=X.projection.upVector(new s.CanonicalTileID(0,0,0),z[0]*s.EXTENT,z[1]*s.EXTENT),q.u_height_lift=C),q},Jf=(h,r,c,p,y,v,T,C,M,z,O,N,$)=>{const K=Os(h,r,c,p,y,v,T,z,O,N,$),W={u_height_factor:-Math.pow(2,T.overscaledZ)/M.tileSize/8};return s.extend(K,Yf(C,r,M),W)},Ra=h=>({u_matrix:h}),tc=(h,r,c,p)=>s.extend(Ra(h),Yf(c,r,p)),Fr=(h,r)=>({u_matrix:h,u_world:r}),Fu=(h,r,c,p,y)=>s.extend(tc(h,r,c,p),{u_world:y}),Qf=s.create(),ju=(h,r,c,p,y,v)=>{const T=h.transform,C=T.projection.name==="globe";let M;if(v.paint.get("circle-pitch-alignment")==="map")if(C){const O=s.globePixelsToTileUnits(T.zoom,r.canonical)*T._pixelsPerMercatorPixel;M=Float32Array.from([O,0,0,O])}else M=T.calculatePixelsToTileUnitsMatrix(c);else M=new Float32Array([T.pixelsToGLUnits[0],0,0,T.pixelsToGLUnits[1]]);const z={u_camera_to_center_distance:T.cameraToCenterDistance,u_matrix:h.translatePosMatrix(r.projMatrix,c,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:M,u_inv_rot_matrix:Qf,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(C){z.u_inv_rot_matrix=p,z.u_merc_center=y,z.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],z.u_zoom_transition=s.globeToMercatorTransition(T.zoom);const O=y[0]*s.EXTENT,N=y[1]*s.EXTENT;z.u_up_dir=T.projection.upVector(new s.CanonicalTileID(0,0,0),O,N)}return z},ed=h=>{const r=[];return h.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),h.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r},Nu=(h,r,c,p)=>{const y=s.EXTENT/c.tileSize;return{u_matrix:h,u_camera_to_center_distance:r.getCameraToCenterDistance(p),u_extrude_scale:[r.pixelsToGLUnits[0]/y,r.pixelsToGLUnits[1]/y]}},td=(h,r,c=1)=>({u_matrix:h,u_color:r,u_overlay:0,u_overlay_scale:c}),Uu=s.create(),Wm=(h,r,c,p,y,v,T)=>{const C=h.transform,M=C.projection.name==="globe",z=M?s.globePixelsToTileUnits(C.zoom,r.canonical)*C._pixelsPerMercatorPixel:xt(c,1,v),O={u_matrix:r.projMatrix,u_extrude_scale:z,u_intensity:T,u_inv_rot_matrix:Uu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(M){O.u_inv_rot_matrix=p,O.u_merc_center=y,O.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],O.u_zoom_transition=s.globeToMercatorTransition(C.zoom);const N=y[0]*s.EXTENT,$=y[1]*s.EXTENT;O.u_up_dir=C.projection.upVector(new s.CanonicalTileID(0,0,0),N,$)}return O},nc=(h,r,c,p,y,v,T,C)=>{const M=h.transform,z=M.calculatePixelsToTileUnitsMatrix(r),O={u_matrix:nd(h,r,c,y),u_pixels_to_tile_units:z,u_device_pixel_ratio:T,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:C};if(rc(c)){const N=ic(r,h.transform);O.u_texsize=r.lineAtlasTexture.size,O.u_scale=[N,p.fromScale,p.toScale],O.u_mix=p.t}return O},Hm=(h,r,c,p,y,v)=>{const T=h.transform,C=ic(r,T);return{u_matrix:nd(h,r,c,y),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:v,u_image:0,u_scale:[C,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ic(h,r){return 1/xt(h,1,r.tileZoom)}function nd(h,r,c,p){return h.translatePosMatrix(p||r.tileID.projMatrix,r,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function rc(h){const r=h.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}const Xm=(h,r,c,p,y,v)=>{return{u_matrix:h,u_tl_parent:r,u_scale_parent:c,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(C=y.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(T=y.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:oc(y.paint.get("raster-hue-rotate")),u_perspective_transform:v};var T,C};function oc(h){h*=Math.PI/180;const r=Math.sin(h),c=Math.cos(h);return[(2*c+1)/3,(-Math.sqrt(3)*r-c+1)/3,(Math.sqrt(3)*r-c+1)/3]}const id=s.create(),Vu=(h,r,c,p,y,v,T,C,M,z,O,N,$,K,W,H)=>{const X=y.transform,q={u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:X.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:X.width/X.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:T,u_coord_matrix:C,u_is_text:+M,u_pitch_with_map:+p,u_texsize:z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:id,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:id,u_up_vector:[0,-1,0]};return H.name==="globe"&&(q.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],q.u_zoom_transition=N,q.u_inv_rot_matrix=K,q.u_merc_center=$,q.u_camera_forward=X._camera.forward(),q.u_ecef_origin=s.globeECEFOrigin(X.globeMatrix,O.toUnwrapped()),q.u_tile_matrix=Float32Array.from(X.globeMatrix),q.u_up_vector=W),q},$u=(h,r,c,p,y,v,T,C,M,z,O,N,$,K,W,H,X)=>s.extend(Vu(h,r,c,p,y,v,T,C,M,z,N,$,K,W,H,X),{u_gamma_scale:p?y.transform.cameraToCenterDistance*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+O}),ks=(h,r,c,p,y,v,T,C,M,z,O,N,$,K,W,H)=>s.extend($u(h,r,c,p,y,v,T,C,!0,M,!0,O,N,$,K,W,H),{u_texsize_icon:z,u_texture_icon:1}),Km=(h,r,c)=>({u_matrix:h,u_opacity:r,u_color:c}),Ym=(h,r,c,p,y,v)=>s.extend(function(T,C,M,z){const O=M.imageManager.getPattern(T.from.toString()),N=M.imageManager.getPattern(T.to.toString()),{width:$,height:K}=M.imageManager.getPixelSize(),W=Math.pow(2,z.tileID.overscaledZ),H=z.tileSize*Math.pow(2,M.transform.tileZoom)/W,X=H*(z.tileID.canonical.x+z.tileID.wrap*W),q=H*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:N.tl,u_pattern_br_b:N.br,u_texsize:[$,K],u_mix:C.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:N.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/xt(z,1,M.transform.tileZoom),u_pixel_coord_upper:[X>>16,q>>16],u_pixel_coord_lower:[65535&X,65535&q]}}(p,v,c,y),{u_matrix:h,u_opacity:r}),Jm={fillExtrusion:h=>({u_matrix:new s.UniformMatrix4f(h),u_lightpos:new s.Uniform3f(h),u_lightintensity:new s.Uniform1f(h),u_lightcolor:new s.Uniform3f(h),u_vertical_gradient:new s.Uniform1f(h),u_opacity:new s.Uniform1f(h),u_edge_radius:new s.Uniform1f(h),u_ao:new s.Uniform2f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_up_dir:new s.Uniform3f(h),u_height_lift:new s.Uniform1f(h)}),fillExtrusionPattern:h=>({u_matrix:new s.UniformMatrix4f(h),u_lightpos:new s.Uniform3f(h),u_lightintensity:new s.Uniform1f(h),u_lightcolor:new s.Uniform3f(h),u_vertical_gradient:new s.Uniform1f(h),u_height_factor:new s.Uniform1f(h),u_edge_radius:new s.Uniform1f(h),u_ao:new s.Uniform2f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_up_dir:new s.Uniform3f(h),u_height_lift:new s.Uniform1f(h),u_image:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_pixel_coord_upper:new s.Uniform2f(h),u_pixel_coord_lower:new s.Uniform2f(h),u_scale:new s.Uniform3f(h),u_fade:new s.Uniform1f(h),u_opacity:new s.Uniform1f(h)}),fill:h=>({u_matrix:new s.UniformMatrix4f(h)}),fillPattern:h=>({u_matrix:new s.UniformMatrix4f(h),u_image:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_pixel_coord_upper:new s.Uniform2f(h),u_pixel_coord_lower:new s.Uniform2f(h),u_scale:new s.Uniform3f(h),u_fade:new s.Uniform1f(h)}),fillOutline:h=>({u_matrix:new s.UniformMatrix4f(h),u_world:new s.Uniform2f(h)}),fillOutlinePattern:h=>({u_matrix:new s.UniformMatrix4f(h),u_world:new s.Uniform2f(h),u_image:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_pixel_coord_upper:new s.Uniform2f(h),u_pixel_coord_lower:new s.Uniform2f(h),u_scale:new s.Uniform3f(h),u_fade:new s.Uniform1f(h)}),circle:h=>({u_camera_to_center_distance:new s.Uniform1f(h),u_extrude_scale:new s.UniformMatrix2f(h),u_device_pixel_ratio:new s.Uniform1f(h),u_matrix:new s.UniformMatrix4f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_up_dir:new s.Uniform3f(h)}),collisionBox:h=>({u_matrix:new s.UniformMatrix4f(h),u_camera_to_center_distance:new s.Uniform1f(h),u_extrude_scale:new s.Uniform2f(h)}),collisionCircle:h=>({u_matrix:new s.UniformMatrix4f(h),u_inv_matrix:new s.UniformMatrix4f(h),u_camera_to_center_distance:new s.Uniform1f(h),u_viewport_size:new s.Uniform2f(h)}),debug:h=>({u_color:new s.UniformColor(h),u_matrix:new s.UniformMatrix4f(h),u_overlay:new s.Uniform1i(h),u_overlay_scale:new s.Uniform1f(h)}),clippingMask:h=>({u_matrix:new s.UniformMatrix4f(h)}),heatmap:h=>({u_extrude_scale:new s.Uniform1f(h),u_intensity:new s.Uniform1f(h),u_matrix:new s.UniformMatrix4f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_up_dir:new s.Uniform3f(h)}),heatmapTexture:h=>({u_image:new s.Uniform1i(h),u_color_ramp:new s.Uniform1i(h),u_opacity:new s.Uniform1f(h)}),hillshade:h=>({u_matrix:new s.UniformMatrix4f(h),u_image:new s.Uniform1i(h),u_latrange:new s.Uniform2f(h),u_light:new s.Uniform2f(h),u_shadow:new s.UniformColor(h),u_highlight:new s.UniformColor(h),u_accent:new s.UniformColor(h)}),hillshadePrepare:h=>({u_matrix:new s.UniformMatrix4f(h),u_image:new s.Uniform1i(h),u_dimension:new s.Uniform2f(h),u_zoom:new s.Uniform1f(h),u_unpack:new s.Uniform4f(h)}),line:h=>({u_matrix:new s.UniformMatrix4f(h),u_pixels_to_tile_units:new s.UniformMatrix2f(h),u_device_pixel_ratio:new s.Uniform1f(h),u_units_to_pixels:new s.Uniform2f(h),u_dash_image:new s.Uniform1i(h),u_gradient_image:new s.Uniform1i(h),u_image_height:new s.Uniform1f(h),u_texsize:new s.Uniform2f(h),u_scale:new s.Uniform3f(h),u_mix:new s.Uniform1f(h),u_alpha_discard_threshold:new s.Uniform1f(h),u_trim_offset:new s.Uniform2f(h)}),linePattern:h=>({u_matrix:new s.UniformMatrix4f(h),u_texsize:new s.Uniform2f(h),u_pixels_to_tile_units:new s.UniformMatrix2f(h),u_device_pixel_ratio:new s.Uniform1f(h),u_image:new s.Uniform1i(h),u_units_to_pixels:new s.Uniform2f(h),u_scale:new s.Uniform3f(h),u_fade:new s.Uniform1f(h),u_alpha_discard_threshold:new s.Uniform1f(h)}),raster:h=>({u_matrix:new s.UniformMatrix4f(h),u_tl_parent:new s.Uniform2f(h),u_scale_parent:new s.Uniform1f(h),u_fade_t:new s.Uniform1f(h),u_opacity:new s.Uniform1f(h),u_image0:new s.Uniform1i(h),u_image1:new s.Uniform1i(h),u_brightness_low:new s.Uniform1f(h),u_brightness_high:new s.Uniform1f(h),u_saturation_factor:new s.Uniform1f(h),u_contrast_factor:new s.Uniform1f(h),u_spin_weights:new s.Uniform3f(h),u_perspective_transform:new s.Uniform2f(h)}),symbolIcon:h=>({u_is_size_zoom_constant:new s.Uniform1i(h),u_is_size_feature_constant:new s.Uniform1i(h),u_size_t:new s.Uniform1f(h),u_size:new s.Uniform1f(h),u_camera_to_center_distance:new s.Uniform1f(h),u_rotate_symbol:new s.Uniform1i(h),u_aspect_ratio:new s.Uniform1f(h),u_fade_change:new s.Uniform1f(h),u_matrix:new s.UniformMatrix4f(h),u_label_plane_matrix:new s.UniformMatrix4f(h),u_coord_matrix:new s.UniformMatrix4f(h),u_is_text:new s.Uniform1i(h),u_pitch_with_map:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_camera_forward:new s.Uniform3f(h),u_tile_matrix:new s.UniformMatrix4f(h),u_up_vector:new s.Uniform3f(h),u_ecef_origin:new s.Uniform3f(h),u_texture:new s.Uniform1i(h)}),symbolSDF:h=>({u_is_size_zoom_constant:new s.Uniform1i(h),u_is_size_feature_constant:new s.Uniform1i(h),u_size_t:new s.Uniform1f(h),u_size:new s.Uniform1f(h),u_camera_to_center_distance:new s.Uniform1f(h),u_rotate_symbol:new s.Uniform1i(h),u_aspect_ratio:new s.Uniform1f(h),u_fade_change:new s.Uniform1f(h),u_matrix:new s.UniformMatrix4f(h),u_label_plane_matrix:new s.UniformMatrix4f(h),u_coord_matrix:new s.UniformMatrix4f(h),u_is_text:new s.Uniform1i(h),u_pitch_with_map:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_texture:new s.Uniform1i(h),u_gamma_scale:new s.Uniform1f(h),u_device_pixel_ratio:new s.Uniform1f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_camera_forward:new s.Uniform3f(h),u_tile_matrix:new s.UniformMatrix4f(h),u_up_vector:new s.Uniform3f(h),u_ecef_origin:new s.Uniform3f(h),u_is_halo:new s.Uniform1i(h)}),symbolTextAndIcon:h=>({u_is_size_zoom_constant:new s.Uniform1i(h),u_is_size_feature_constant:new s.Uniform1i(h),u_size_t:new s.Uniform1f(h),u_size:new s.Uniform1f(h),u_camera_to_center_distance:new s.Uniform1f(h),u_rotate_symbol:new s.Uniform1i(h),u_aspect_ratio:new s.Uniform1f(h),u_fade_change:new s.Uniform1f(h),u_matrix:new s.UniformMatrix4f(h),u_label_plane_matrix:new s.UniformMatrix4f(h),u_coord_matrix:new s.UniformMatrix4f(h),u_is_text:new s.Uniform1i(h),u_pitch_with_map:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_texsize_icon:new s.Uniform2f(h),u_texture:new s.Uniform1i(h),u_texture_icon:new s.Uniform1i(h),u_gamma_scale:new s.Uniform1f(h),u_device_pixel_ratio:new s.Uniform1f(h),u_is_halo:new s.Uniform1i(h)}),background:h=>({u_matrix:new s.UniformMatrix4f(h),u_opacity:new s.Uniform1f(h),u_color:new s.UniformColor(h)}),backgroundPattern:h=>({u_matrix:new s.UniformMatrix4f(h),u_opacity:new s.Uniform1f(h),u_image:new s.Uniform1i(h),u_pattern_tl_a:new s.Uniform2f(h),u_pattern_br_a:new s.Uniform2f(h),u_pattern_tl_b:new s.Uniform2f(h),u_pattern_br_b:new s.Uniform2f(h),u_texsize:new s.Uniform2f(h),u_mix:new s.Uniform1f(h),u_pattern_size_a:new s.Uniform2f(h),u_pattern_size_b:new s.Uniform2f(h),u_scale_a:new s.Uniform1f(h),u_scale_b:new s.Uniform1f(h),u_pixel_coord_upper:new s.Uniform2f(h),u_pixel_coord_lower:new s.Uniform2f(h),u_tile_units_to_pixels:new s.Uniform1f(h)}),terrainRaster:ka,terrainDepth:ka,skybox:h=>({u_matrix:new s.UniformMatrix4f(h),u_sun_direction:new s.Uniform3f(h),u_cubemap:new s.Uniform1i(h),u_opacity:new s.Uniform1f(h),u_temporal_offset:new s.Uniform1f(h)}),skyboxGradient:h=>({u_matrix:new s.UniformMatrix4f(h),u_color_ramp:new s.Uniform1i(h),u_center_direction:new s.Uniform3f(h),u_radius:new s.Uniform1f(h),u_opacity:new s.Uniform1f(h),u_temporal_offset:new s.Uniform1f(h)}),skyboxCapture:h=>({u_matrix_3f:new s.UniformMatrix3f(h),u_sun_direction:new s.Uniform3f(h),u_sun_intensity:new s.Uniform1f(h),u_color_tint_r:new s.Uniform4f(h),u_color_tint_m:new s.Uniform4f(h),u_luminance:new s.Uniform1f(h)}),globeRaster:h=>({u_proj_matrix:new s.UniformMatrix4f(h),u_globe_matrix:new s.UniformMatrix4f(h),u_normalize_matrix:new s.UniformMatrix4f(h),u_merc_matrix:new s.UniformMatrix4f(h),u_zoom_transition:new s.Uniform1f(h),u_merc_center:new s.Uniform2f(h),u_image0:new s.Uniform1i(h),u_grid_matrix:new s.UniformMatrix3f(h),u_frustum_tl:new s.Uniform3f(h),u_frustum_tr:new s.Uniform3f(h),u_frustum_br:new s.Uniform3f(h),u_frustum_bl:new s.Uniform3f(h),u_globe_pos:new s.Uniform3f(h),u_globe_radius:new s.Uniform1f(h),u_viewport:new s.Uniform2f(h)}),globeAtmosphere:h=>({u_frustum_tl:new s.Uniform3f(h),u_frustum_tr:new s.Uniform3f(h),u_frustum_br:new s.Uniform3f(h),u_frustum_bl:new s.Uniform3f(h),u_horizon:new s.Uniform1f(h),u_transition:new s.Uniform1f(h),u_fadeout_range:new s.Uniform1f(h),u_color:new s.Uniform4f(h),u_high_color:new s.Uniform4f(h),u_space_color:new s.Uniform4f(h),u_star_intensity:new s.Uniform1f(h),u_star_density:new s.Uniform1f(h),u_star_size:new s.Uniform1f(h),u_temporal_offset:new s.Uniform1f(h),u_horizon_angle:new s.Uniform1f(h),u_rotation_matrix:new s.UniformMatrix4f(h)})};let sc;function rd(h,r,c,p,y,v,T){const C=h.context,M=C.gl,z=h.transform,O=h.useProgram("collisionBox"),N=[];let $=0,K=0;for(let pe=0;pe<p.length;pe++){const fe=p[pe],le=r.getTile(fe),de=le.getBucket(c);if(!de)continue;const he=Qi(fe,de,z);let ve=he;y[0]===0&&y[1]===0||(ve=h.translatePosMatrix(he,le,y,v));const ze=T?de.textCollisionBox:de.iconCollisionBox,pt=de.collisionCircleArray;if(pt.length>0){const Ce=s.create(),He=ve;s.mul(Ce,de.placementInvProjMatrix,z.glCoordMatrix),s.mul(Ce,Ce,de.placementViewportMatrix),N.push({circleArray:pt,circleOffset:K,transform:He,invTransform:Ce,projection:de.getProjection()}),$+=pt.length/4,K=$}ze&&(h.terrain&&h.terrain.setupElevationDraw(le,O),O.draw(C,M.LINES,s.DepthMode.disabled,s.StencilMode.disabled,h.colorModeForRenderPass(),s.CullFaceMode.disabled,Nu(ve,z,le,de.getProjection()),c.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,null,z.zoom,null,[ze.collisionVertexBuffer,ze.collisionVertexBufferExt]))}if(!T||!N.length)return;const W=h.useProgram("collisionCircle"),H=new s.StructArrayLayout2f1f2i16;H.resize(4*$),H._trim();let X=0;for(const pe of N)for(let fe=0;fe<pe.circleArray.length/4;fe++){const le=4*fe,de=pe.circleArray[le+0],he=pe.circleArray[le+1],ve=pe.circleArray[le+2],ze=pe.circleArray[le+3];H.emplace(X++,de,he,ve,ze,0),H.emplace(X++,de,he,ve,ze,1),H.emplace(X++,de,he,ve,ze,2),H.emplace(X++,de,he,ve,ze,3)}(!sc||sc.length<2*$)&&(sc=function(pe){const fe=2*pe,le=new s.StructArrayLayout3ui6;le.resize(fe),le._trim();for(let de=0;de<fe;de++){const he=6*de;le.uint16[he+0]=4*de+0,le.uint16[he+1]=4*de+1,le.uint16[he+2]=4*de+2,le.uint16[he+3]=4*de+2,le.uint16[he+4]=4*de+3,le.uint16[he+5]=4*de+0}return le}($));const q=C.createIndexBuffer(sc,!0),te=C.createVertexBuffer(H,s.collisionCircleLayout.members,!0);for(const pe of N){const fe={u_matrix:pe.transform,u_inv_matrix:pe.invTransform,u_camera_to_center_distance:(Y=z).getCameraToCenterDistance(pe.projection),u_viewport_size:[Y.width,Y.height]};W.draw(C,M.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,h.colorModeForRenderPass(),s.CullFaceMode.disabled,fe,c.id,te,q,s.SegmentVector.simpleSegment(0,2*pe.circleOffset,pe.circleArray.length,pe.circleArray.length/2),null,z.zoom)}var Y;te.destroy(),q.destroy()}const od=s.create();function Gu(h,r,c,p,y,v){const{horizontalAlign:T,verticalAlign:C}=s.getAnchorAlignment(h),M=-(T-.5)*r,z=-(C-.5)*c,O=s.evaluateVariableOffset(h,p);return new s.pointGeometry((M/y+O[0])*v,(z/y+O[1])*v)}function Zu(h,r,c,p,y,v,T,C,M,z,O){const N=h.text.placedSymbolArray,$=h.text.dynamicLayoutVertexArray,K=h.icon.dynamicLayoutVertexArray,W={},H=er(C,h.getProjection(),v),X=v.elevation,q=h.getProjection().upVectorScale(C.canonical,v.center.lat,v.worldSize);$.clear();for(let te=0;te<N.length;te++){const Y=N.get(te),pe=h.allowVerticalPlacement&&!Y.placedOrientation,fe=Y.hidden||!Y.crossTileID||pe?null:p[Y.crossTileID];if(fe){const le=new s.pointGeometry(Y.tileAnchorX,Y.tileAnchorY),de=h.getProjection().upVector(C.canonical,le.x,le.y),he=X?X.getAtTileOffset(C,le.x,le.y):0,ve=un([Y.projectedAnchorX+he*de[0]*q.metersToTile,Y.projectedAnchorY+he*de[1]*q.metersToTile,Y.projectedAnchorZ+he*de[2]*q.metersToTile],c?H:T),ze=Ea(v.getCameraToCenterDistance(h.getProjection()),ve.signedDistanceFromCamera);let pt=y.evaluateSizeForFeature(h.textSizeData,z,Y)*ze/s.ONE_EM;c&&(pt*=h.tilePixelRatio/M);const{width:Ce,height:He,anchor:et,textOffset:St,textScale:je}=fe,gt=Gu(et,Ce,He,St,je,pt);let Je;if(c){const At=le.add(gt),{x:Nt,y:Zt,z:tn}=h.getProjection().projectTilePoint(At.x,At.y,C.canonical);Je=un([Nt+he*de[0]*q.metersToTile,Zt+he*de[1]*q.metersToTile,tn+he*de[2]*q.metersToTile],T).point}else{const At=r?gt.rotate(-v.angle):gt;Je=[ve.point[0]+At.x,ve.point[1]+At.y,0]}const It=h.allowVerticalPlacement&&Y.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let At=0;At<Y.numGlyphs;At++)s.addDynamicAttributes($,Je[0],Je[1],Je[2],It);O&&Y.associatedIconIndex>=0&&(W[Y.associatedIconIndex]={shiftedAnchor:Je,angle:It})}else vo(Y.numGlyphs,$)}if(O){K.clear();const te=h.icon.placedSymbolArray;for(let Y=0;Y<te.length;Y++){const pe=te.get(Y);if(pe.hidden)vo(pe.numGlyphs,K);else{const fe=W[Y];if(fe)for(let le=0;le<pe.numGlyphs;le++)s.addDynamicAttributes(K,fe.shiftedAnchor[0],fe.shiftedAnchor[1],fe.shiftedAnchor[2],fe.angle);else vo(pe.numGlyphs,K)}}h.icon.dynamicLayoutVertexBuffer.updateData(K)}h.text.dynamicLayoutVertexBuffer.updateData($)}function sd(h,r,c){return c.iconsInText&&r?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function qu(h,r,c,p,y,v,T,C,M,z,O,N){const $=h.context,K=$.gl,W=h.transform,H=C==="map",X=M==="map",q=H&&c.layout.get("symbol-placement")!=="point",te=H&&!X&&!q,Y=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let pe=!1;const fe=h.depthModeForSublayer(0,s.DepthMode.ReadOnly),le=[s.mercatorXfromLng(W.center.lng),s.mercatorYfromLat(W.center.lat)],de=c.layout.get("text-variable-anchor"),he=W.projection.name==="globe",ve=[],ze=[0,-1,0];let pt=ze;!he&&!W.mercatorFromTransition||H||(pt=function(Ce){const He=Ce._camera.getWorldToCamera(Ce.worldSize,1),et=s.multiply([],He,Ce.globeMatrix);s.invert(et,et);const St=[0,0,0],je=[0,1,0,0];return s.transformMat4$1(je,je,et),St[0]=je[0],St[1]=je[1],St[2]=je[2],s.normalize(St,St),St}(W));for(const Ce of p){const He=r.getTile(Ce),et=He.getBucket(c);if(!et||et.projection.name==="mercator"&&he)continue;const St=y?et.text:et.icon;if(!St||et.fullyClipped||!St.segments.get().length)continue;const je=St.programConfigurations.get(c.id),gt=y||et.sdfIcons,Je=y?et.textSizeData:et.iconSizeData,It=X||W.pitch!==0,At=s.evaluateSizeForZoom(Je,W.zoom);let Nt,Zt,tn,bn,Ut=[0,0],an=null;if(y){if(Zt=He.glyphAtlasTexture,tn=K.LINEAR,Nt=He.glyphAtlasTexture.size,et.iconsInText){Ut=He.imageAtlasTexture.size,an=He.imageAtlasTexture;const Wi=Je.kind==="composite"||Je.kind==="camera";bn=It||h.options.rotating||h.options.zooming||Wi?K.LINEAR:K.NEAREST}}else{const Wi=c.layout.get("icon-size").constantOr(0)!==1||et.iconsNeedLinear;Zt=He.imageAtlasTexture,tn=gt||h.options.rotating||h.options.zooming||Wi||It?K.LINEAR:K.NEAREST,Nt=He.imageAtlasTexture.size}const An=et.projection.name==="globe",Jn=An?pt:ze,ui=An?s.globeToMercatorTransition(W.zoom):0,Vn=er(Ce,et.getProjection(),W),Ai=W.calculatePixelsToTileUnitsMatrix(He),Or=vn(Vn,He.tileID.canonical,X,H,W,et.getProjection(),Ai),eo=h.terrain&&X&&q?s.invert(s.create(),Or):od,Qn=Ar(Vn,He.tileID.canonical,X,H,W,et.getProjection(),Ai),ni=de&&et.hasTextData(),gn=c.layout.get("icon-text-fit")!=="none"&&ni&&et.hasIconData();if(q){const Wi=W.elevation,ns=Wi?Wi.getAtTileOffsetFunc(Ce,W.center.lat,W.worldSize,et.getProjection()):Qa=>[0,0,0],Co=xn(Vn,He.tileID.canonical,X,H,W,et.getProjection(),Ai);Sa(et,Vn,h,y,Co,Qn,X,z,ns,Ce)}const gi=q||y&&de||gn,Bi=h.translatePosMatrix(Vn,He,v,T),Hn=gi?od:Or,Fi=h.translatePosMatrix(Qn,He,v,T,!0),Jo=et.getProjection().createInversionMatrix(W,Ce.canonical),qi=[];h.terrain&&X&&qi.push("PITCH_WITH_MAP_TERRAIN"),An&&qi.push("PROJECTION_GLOBE_VIEW"),gi&&qi.push("PROJECTED_POS_ON_VIEWPORT");const Qo=gt&&c.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let es;es=gt?et.iconsInText?ks(Je.kind,At,te,X,h,Bi,Hn,Fi,Nt,Ut,Ce,ui,le,Jo,Jn,et.getProjection()):$u(Je.kind,At,te,X,h,Bi,Hn,Fi,y,Nt,!0,Ce,ui,le,Jo,Jn,et.getProjection()):Vu(Je.kind,At,te,X,h,Bi,Hn,Fi,y,Nt,Ce,ui,le,Jo,Jn,et.getProjection());const ts={program:h.useProgram(sd(gt,y,et),je,qi),buffers:St,uniformValues:es,atlasTexture:Zt,atlasTextureIcon:an,atlasInterpolation:tn,atlasInterpolationIcon:bn,isSDF:gt,hasHalo:Qo,tile:He,labelPlaneMatrixInv:eo};if(Y&&et.canOverlap){pe=!0;const Wi=St.segments.get();for(const ns of Wi)ve.push({segments:new s.SegmentVector([ns]),sortKey:ns.sortKey,state:ts})}else ve.push({segments:St.segments,sortKey:0,state:ts})}pe&&ve.sort((Ce,He)=>Ce.sortKey-He.sortKey);for(const Ce of ve){const He=Ce.state;if(h.terrain&&h.terrain.setupElevationDraw(He.tile,He.program,{useDepthForOcclusion:!he,labelPlaneMatrixInv:He.labelPlaneMatrixInv}),$.activeTexture.set(K.TEXTURE0),He.atlasTexture.bind(He.atlasInterpolation,K.CLAMP_TO_EDGE),He.atlasTextureIcon&&($.activeTexture.set(K.TEXTURE1),He.atlasTextureIcon&&He.atlasTextureIcon.bind(He.atlasInterpolationIcon,K.CLAMP_TO_EDGE)),He.isSDF){const et=He.uniformValues;He.hasHalo&&(et.u_is_halo=1,Wu(He.buffers,Ce.segments,c,h,He.program,fe,O,N,et)),et.u_is_halo=0}Wu(He.buffers,Ce.segments,c,h,He.program,fe,O,N,He.uniformValues)}}function Wu(h,r,c,p,y,v,T,C,M){const z=p.context,O=[h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer,h.globeExtVertexBuffer];y.draw(z,z.gl.TRIANGLES,v,T,C,s.CullFaceMode.disabled,M,c.id,h.layoutVertexBuffer,h.indexBuffer,r,c.paint,p.transform.zoom,h.programConfigurations.get(c.id),O)}function ac(h,r,c,p,y,v,T){const C=h.context.gl,M=c.paint.get("fill-pattern"),z=M&&M.constantOr(1),O=c.getCrossfadeParameters();let N,$,K,W,H;T?($=z&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=C.LINES):($=z?"fillPattern":"fill",N=C.TRIANGLES);for(const X of p){const q=r.getTile(X);if(z&&!q.patternsLoaded())continue;const te=q.getBucket(c);if(!te)continue;h.prepareDrawTile();const Y=te.programConfigurations.get(c.id),pe=h.useProgram($,Y);z&&(h.context.activeTexture.set(C.TEXTURE0),q.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),Y.updatePaintBuffers(O));const fe=M.constantOr(null);if(fe&&q.imageAtlas){const de=q.imageAtlas,he=de.patternPositions[fe.to.toString()],ve=de.patternPositions[fe.from.toString()];he&&ve&&Y.setConstantPatternPositions(he,ve)}const le=h.translatePosMatrix(X.projMatrix,q,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(T){W=te.indexBuffer2,H=te.segments2;const de=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[C.drawingBufferWidth,C.drawingBufferHeight];K=$==="fillOutlinePattern"&&z?Fu(le,h,O,q,de):Fr(le,de)}else W=te.indexBuffer,H=te.segments,K=z?tc(le,h,O,q):Ra(le);h.prepareDrawProgram(h.context,pe,X.toUnwrapped()),pe.draw(h.context,N,y,h.stencilModeForClipping(X),v,s.CullFaceMode.disabled,K,c.id,te.layoutVertexBuffer,W,H,c.paint,h.transform.zoom,Y)}}function Yr(h,r,c,p,y,v,T){const C=h.context,M=C.gl,z=h.transform,O=c.paint.get("fill-extrusion-pattern"),N=O.constantOr(1),$=c.getCrossfadeParameters(),K=c.paint.get("fill-extrusion-opacity"),W=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],H=c.layout.get("fill-extrusion-edge-radius"),X=z.projection.name==="globe"?s.fillExtrusionHeightLift():0,q=z.projection.name==="globe",te=q?s.globeToMercatorTransition(z.zoom):0,Y=[s.mercatorXfromLng(z.center.lng),s.mercatorYfromLat(z.center.lat)],pe=[];q&&(pe.push("PROJECTION_GLOBE_VIEW"),h.style.terrainSetForDrapingOnly()&&pe.push("TERRAIN")),W[0]>0&&pe.push("FAUX_AO");for(const fe of p){const le=r.getTile(fe),de=le.getBucket(c);if(!de||de.projection.name!==z.projection.name)continue;const he=de.programConfigurations.get(c.id),ve=h.useProgram(N?"fillExtrusionPattern":"fillExtrusion",he,pe);if(h.terrain){const je=h.terrain;if(h.style.terrainSetForDrapingOnly())je.setupElevationDraw(le,ve,{useMeterToDem:!0});else{if(!de.enableTerrain)continue;if(je.setupElevationDraw(le,ve,{useMeterToDem:!0}),Ba(C,r,fe,de,c,je),!de.centroidVertexBuffer){const gt=ve.attributes.a_centroid_pos;gt!==void 0&&M.vertexAttrib2f(gt,0,0)}}}N&&(h.context.activeTexture.set(M.TEXTURE0),le.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),he.updatePaintBuffers($));const ze=O.constantOr(null);if(ze&&le.imageAtlas){const je=le.imageAtlas,gt=je.patternPositions[ze.to.toString()],Je=je.patternPositions[ze.from.toString()];gt&&Je&&he.setConstantPatternPositions(gt,Je)}const pt=h.translatePosMatrix(fe.projMatrix,le,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Ce=z.projection.createInversionMatrix(z,fe.canonical),He=c.paint.get("fill-extrusion-vertical-gradient"),et=N?Jf(pt,h,He,K,W,H,fe,$,le,X,te,Y,Ce):Os(pt,h,He,K,W,H,fe,X,te,Y,Ce);h.prepareDrawProgram(C,ve,fe.toUnwrapped());const St=[];h.terrain&&St.push(de.centroidVertexBuffer),q&&St.push(de.layoutVertexExtBuffer),ve.draw(C,C.gl.TRIANGLES,y,v,T,s.CullFaceMode.backCCW,et,c.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,c.paint,h.transform.zoom,he,St)}}function Ba(h,r,c,p,y,v){const T=[q=>{let te=q.canonical.x-1,Y=q.wrap;return te<0&&(te=(1<<q.canonical.z)-1,Y--),new s.OverscaledTileID(q.overscaledZ,Y,q.canonical.z,te,q.canonical.y)},q=>{let te=q.canonical.x+1,Y=q.wrap;return te===1<<q.canonical.z&&(te=0,Y++),new s.OverscaledTileID(q.overscaledZ,Y,q.canonical.z,te,q.canonical.y)},q=>new s.OverscaledTileID(q.overscaledZ,q.wrap,q.canonical.z,q.canonical.x,(q.canonical.y===0?1<<q.canonical.z:q.canonical.y)-1),q=>new s.OverscaledTileID(q.overscaledZ,q.wrap,q.canonical.z,q.canonical.x,q.canonical.y===(1<<q.canonical.z)-1?0:q.canonical.y+1)],C=q=>{const te=r.getSource().minzoom,Y=fe=>{const le=r.getTileByID(fe);if(le&&le.hasData())return le.getBucket(y)},pe=[0,-1,1];for(const fe of pe){if(q.overscaledZ+fe<te)continue;const le=Y(q.calculateScaledKey(q.overscaledZ+fe));if(le)return le}},M=[0,0,0],z=(q,te)=>(M[0]=Math.min(q.min.y,te.min.y),M[1]=Math.max(q.max.y,te.max.y),M[2]=s.EXTENT-te.min.x>q.max.x?te.min.x-s.EXTENT:q.max.x,M),O=(q,te)=>(M[0]=Math.min(q.min.x,te.min.x),M[1]=Math.max(q.max.x,te.max.x),M[2]=s.EXTENT-te.min.y>q.max.y?te.min.y-s.EXTENT:q.max.y,M),N=[(q,te)=>z(q,te),(q,te)=>z(te,q),(q,te)=>O(q,te),(q,te)=>O(te,q)],$=new s.pointGeometry(0,0);let K,W,H;const X=(q,te,Y,pe,fe)=>{const le=[[pe?Y:q,pe?q:Y,0],[pe?Y:te,pe?te:Y,0]],de=fe<0?s.EXTENT+fe:fe,he=[pe?de:(q+te)/2,pe?(q+te)/2:de,0];return Y===0&&fe<0||Y!==0&&fe>0?v.getForTilePoints(H,[he],!0,W):le.push(he),v.getForTilePoints(c,le,!0,K),Math.max(le[0][2],le[1][2],he[2])/v.exaggeration()};for(let q=0;q<4;q++){const te=(q<2?1:5)-q,Y=p.borders[q];if(Y.length===0)continue;const pe=H=T[q](c),fe=C(pe);if(!(fe&&fe instanceof s.FillExtrusionBucket&&fe.enableTerrain)||p.borderDoneWithNeighborZ[q]===fe.canonical.z&&fe.borderDoneWithNeighborZ[te]===p.canonical.z||(W=v.findDEMTileFor(pe),!W||!W.dem))continue;if(!K){const ve=v.findDEMTileFor(c);if(!ve||!ve.dem)return;K=ve}const le=fe.borders[te];let de=0;const he=fe.borderDoneWithNeighborZ[te]!==p.canonical.z;if(p.canonical.z===fe.canonical.z){for(let ve=0;ve<Y.length;ve++){const ze=p.featuresOnBorder[Y[ve]],pt=ze.borders[q];let Ce;for(;de<le.length&&(Ce=fe.featuresOnBorder[le[de]],!(Ce.borders[te][1]>pt[0]+3));)he&&fe.encodeCentroid(void 0,Ce,!1),de++;if(Ce&&de<le.length){const He=de;let et=0;for(;!(Ce.borders[te][0]>pt[1]-3)&&(et++,++de!==le.length);)Ce=fe.featuresOnBorder[le[de]];if(Ce=fe.featuresOnBorder[le[He]],ze.intersectsCount()>1||Ce.intersectsCount()>1||et!==1){et!==1&&(de=He),p.encodeCentroid(void 0,ze,!1),he&&fe.encodeCentroid(void 0,Ce,!1);continue}const St=N[q](ze,Ce),je=q%2?s.EXTENT-1:0;$.x=X(St[0],Math.min(s.EXTENT-1,St[1]),je,q<2,St[2]),$.y=0,p.encodeCentroid($,ze,!1),he&&fe.encodeCentroid($,Ce,!1)}else p.encodeCentroid(void 0,ze,!1)}p.borderDoneWithNeighborZ[q]=fe.canonical.z,p.needsCentroidUpdate=!0,he&&(fe.borderDoneWithNeighborZ[te]=p.canonical.z,fe.needsCentroidUpdate=!0)}else{for(const ve of Y)p.encodeCentroid(void 0,p.featuresOnBorder[ve],!1);if(he){for(const ve of le)fe.encodeCentroid(void 0,fe.featuresOnBorder[ve],!1);fe.borderDoneWithNeighborZ[te]=p.canonical.z,fe.needsCentroidUpdate=!0}p.borderDoneWithNeighborZ[q]=fe.canonical.z,p.needsCentroidUpdate=!0}}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(h)}const ad=new s.Color(1,0,0,1),Ds=new s.Color(0,1,0,1),Ls=new s.Color(0,0,1,1),ld=new s.Color(1,0,1,1),Hu=new s.Color(0,1,1,1);function kn(h,r,c){const p=h.context,y=h.transform,v=p.gl,T=y.projection.name==="globe",C=T?["PROJECTION_GLOBE_VIEW"]:null;let M=c.projMatrix;if(T&&s.globeToMercatorTransition(y.zoom)>0){const ze=s.transitionTileAABBinECEF(c.canonical,y),pt=s.globeDenormalizeECEF(ze);M=s.multiply(new Float32Array(16),y.globeMatrix,pt),s.multiply(M,y.projMatrix,M)}const z=h.useProgram("debug",null,C),O=r.getTileByID(c.key);h.terrain&&h.terrain.setupElevationDraw(O,z);const N=s.DepthMode.disabled,$=s.StencilMode.disabled,K=h.colorModeForRenderPass(),W="$debug";p.activeTexture.set(v.TEXTURE0),h.emptyTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),T?O._makeGlobeTileDebugBuffers(h.context,y):O._makeDebugTileBoundsBuffers(h.context,y.projection);const H=O._tileDebugBuffer||h.debugBuffer,X=O._tileDebugIndexBuffer||h.debugIndexBuffer,q=O._tileDebugSegments||h.debugSegments;z.draw(p,v.LINE_STRIP,N,$,K,s.CullFaceMode.disabled,td(M,s.Color.red),W,H,X,q,null,null,null,[O._globeTileDebugBorderBuffer]);const te=O.latestRawTileData,Y=Math.floor((te&&te.byteLength||0)/1024),pe=r.getTile(c).tileSize,fe=512/Math.min(pe,512)*(c.overscaledZ/y.zoom)*.5;let le=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(le+=` => ${c.overscaledZ}`),le+=` ${Y}kb`,function(ze,pt){ze.initDebugOverlayCanvas();const Ce=ze.debugOverlayCanvas,He=ze.context.gl,et=ze.debugOverlayCanvas.getContext("2d");et.clearRect(0,0,Ce.width,Ce.height),et.shadowColor="white",et.shadowBlur=2,et.lineWidth=1.5,et.strokeStyle="white",et.textBaseline="top",et.font="bold 36px Open Sans, sans-serif",et.fillText(pt,5,5),et.strokeText(pt,5,5),ze.debugOverlayTexture.update(Ce),ze.debugOverlayTexture.bind(He.LINEAR,He.CLAMP_TO_EDGE)}(h,le);const de=O._tileDebugTextBuffer||h.debugBuffer,he=O._tileDebugTextIndexBuffer||h.quadTriangleIndexBuffer,ve=O._tileDebugTextSegments||h.debugSegments;z.draw(p,v.TRIANGLES,N,$,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,td(M,s.Color.transparent,fe),W,de,he,ve,null,null,null,[O._globeTileDebugTextBuffer])}function Fa(h,r,c,p){ja(h,0,r+c/2,h.transform.width,c,p)}function cd(h,r,c,p){ja(h,r-c/2,0,c,h.transform.height,p)}function ja(h,r,c,p,y,v){const T=h.context,C=T.gl;C.enable(C.SCISSOR_TEST),C.scissor(r*s.exported.devicePixelRatio,c*s.exported.devicePixelRatio,p*s.exported.devicePixelRatio,y*s.exported.devicePixelRatio),T.clear({color:v}),C.disable(C.SCISSOR_TEST)}const Na=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Qm}=Na;function Eo(h,r,c,p){h.emplaceBack(r,c,p)}class Xu{constructor(r){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,Eo(this.vertexArray,-1,-1,1),Eo(this.vertexArray,1,-1,1),Eo(this.vertexArray,-1,1,1),Eo(this.vertexArray,1,1,1),Eo(this.vertexArray,-1,-1,-1),Eo(this.vertexArray,1,-1,-1),Eo(this.vertexArray,-1,1,-1),Eo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,Qm),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function Rs(h,r,c,p,y,v){const T=h.gl,C=r.paint.get("sky-atmosphere-color"),M=r.paint.get("sky-atmosphere-halo-color"),z=r.paint.get("sky-atmosphere-sun-intensity"),O=((N,$,K,W,H)=>({u_matrix_3f:N,u_sun_direction:$,u_sun_intensity:K,u_color_tint_r:[W.r,W.g,W.b,W.a],u_color_tint_m:[H.r,H.g,H.b,H.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),p),y,z,C,M);T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_CUBE_MAP_POSITIVE_X+v,r.skyboxTexture,0),c.draw(h,T.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,O,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const Ku=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class lc{constructor(r){const c=new s.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const p=new s.StructArrayLayout3ui6;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(c,Ku.members),this.indexBuffer=r.createIndexBuffer(p),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Bs={symbol:function(h,r,c,p,y){if(h.renderPass!=="translucent")return;const v=s.StencilMode.disabled,T=h.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(C,M,z,O,N,$,K){const W=M.transform,H=N==="map",X=$==="map";for(const q of C){const te=O.getTile(q),Y=te.getBucket(z);if(!Y||!Y.text||!Y.text.segments.get().length)continue;const pe=s.evaluateSizeForZoom(Y.textSizeData,W.zoom),fe=er(q,Y.getProjection(),W),le=W.calculatePixelsToTileUnitsMatrix(te),de=vn(fe,te.tileID.canonical,X,H,W,Y.getProjection(),le),he=z.layout.get("icon-text-fit")!=="none"&&Y.hasIconData();if(pe){const ve=Math.pow(2,W.zoom-te.tileID.overscaledZ);Zu(Y,H,X,K,s.symbolSize,W,de,q,ve,pe,he)}}}(p,h,c,r,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),y),c.paint.get("icon-opacity").constantOr(1)!==0&&qu(h,r,c,p,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),v,T),c.paint.get("text-opacity").constantOr(1)!==0&&qu(h,r,c,p,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),v,T),r.map.showCollisionBoxes&&(rd(h,r,c,p,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),rd(h,r,c,p,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(h,r,c,p){if(h.renderPass!=="translucent")return;const y=c.paint.get("circle-opacity"),v=c.paint.get("circle-stroke-width"),T=c.paint.get("circle-stroke-opacity"),C=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(y.constantOr(1)===0&&(v.constantOr(1)===0||T.constantOr(1)===0))return;const M=h.context,z=M.gl,O=h.transform,N=h.depthModeForSublayer(0,s.DepthMode.ReadOnly),$=s.StencilMode.disabled,K=h.colorModeForRenderPass(),W=O.projection.name==="globe",H=[s.mercatorXfromLng(O.center.lng),s.mercatorYfromLat(O.center.lat)],X=[];for(let te=0;te<p.length;te++){const Y=p[te],pe=r.getTile(Y),fe=pe.getBucket(c);if(!fe||fe.projection.name!==O.projection.name)continue;const le=fe.programConfigurations.get(c.id),de=ed(c);W&&de.push("PROJECTION_GLOBE_VIEW");const he=h.useProgram("circle",le,de),ve=fe.layoutVertexBuffer,ze=fe.globeExtVertexBuffer,pt=fe.indexBuffer,Ce=O.projection.createInversionMatrix(O,Y.canonical),He={programConfiguration:le,program:he,layoutVertexBuffer:ve,globeExtVertexBuffer:ze,indexBuffer:pt,uniformValues:ju(h,Y,pe,Ce,H,c),tile:pe};if(C){const et=fe.segments.get();for(const St of et)X.push({segments:new s.SegmentVector([St]),sortKey:St.sortKey,state:He})}else X.push({segments:fe.segments,sortKey:0,state:He})}C&&X.sort((te,Y)=>te.sortKey-Y.sortKey);const q={useDepthForOcclusion:!W};for(const te of X){const{programConfiguration:Y,program:pe,layoutVertexBuffer:fe,globeExtVertexBuffer:le,indexBuffer:de,uniformValues:he,tile:ve}=te.state,ze=te.segments;h.terrain&&h.terrain.setupElevationDraw(ve,pe,q),h.prepareDrawProgram(M,pe,ve.tileID.toUnwrapped()),pe.draw(M,z.TRIANGLES,N,$,K,s.CullFaceMode.disabled,he,c.id,fe,de,ze,c.paint,O.zoom,Y,[le])}},heatmap:function(h,r,c,p){if(c.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const y=h.context,v=y.gl,T=s.StencilMode.disabled,C=new s.ColorMode([v.ONE,v.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(K,W,H,X){const q=K.gl,te=W.width*X,Y=W.height*X;K.activeTexture.set(q.TEXTURE1),K.viewport.set([0,0,te,Y]);let pe=H.heatmapFbo;if(!pe||pe&&(pe.width!==te||pe.height!==Y)){pe&&pe.destroy();const fe=q.createTexture();q.bindTexture(q.TEXTURE_2D,fe),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.LINEAR),pe=H.heatmapFbo=K.createFramebuffer(te,Y,!1),function(le,de,he,ve,ze,pt){const Ce=le.gl;Ce.texImage2D(Ce.TEXTURE_2D,0,Ce.RGBA,ze,pt,0,Ce.RGBA,le.extRenderToTextureHalfFloat?le.extTextureHalfFloat.HALF_FLOAT_OES:Ce.UNSIGNED_BYTE,null),ve.colorAttachment.set(he)}(K,0,fe,pe,te,Y)}else q.bindTexture(q.TEXTURE_2D,pe.colorAttachment.get()),K.bindFramebuffer.set(pe.framebuffer)})(y,h,c,h.transform.projection.name==="globe"?.5:.25),y.clear({color:s.Color.transparent});const M=h.transform,z=M.projection.name==="globe",O=z?["PROJECTION_GLOBE_VIEW"]:null,N=z?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,$=[s.mercatorXfromLng(M.center.lng),s.mercatorYfromLat(M.center.lat)];for(let K=0;K<p.length;K++){const W=p[K];if(r.hasRenderableParent(W))continue;const H=r.getTile(W),X=H.getBucket(c);if(!X||X.projection.name!==M.projection.name)continue;const q=X.programConfigurations.get(c.id),te=h.useProgram("heatmap",q,O),{zoom:Y}=h.transform;h.terrain&&h.terrain.setupElevationDraw(H,te),h.prepareDrawProgram(y,te,W.toUnwrapped());const pe=M.projection.createInversionMatrix(M,W.canonical);te.draw(y,v.TRIANGLES,s.DepthMode.disabled,T,C,N,Wm(h,W,H,pe,$,Y,c.paint.get("heatmap-intensity")),c.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,c.paint,h.transform.zoom,q,z?[X.globeExtVertexBuffer]:null)}y.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(y,v){const T=y.context,C=T.gl,M=v.heatmapFbo;if(!M)return;T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,M.colorAttachment.get()),T.activeTexture.set(C.TEXTURE1);let z=v.colorRampTexture;z||(z=v.colorRampTexture=new s.Texture(T,v.colorRamp,C.RGBA)),z.bind(C.LINEAR,C.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(T,C.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,y.colorModeForRenderPass(),s.CullFaceMode.disabled,((O,N,$,K)=>({u_image:0,u_color_ramp:1,u_opacity:N.paint.get("heatmap-opacity")}))(0,v),v.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,v.paint,y.transform.zoom)}(h,c))},line:function(h,r,c,p){if(h.renderPass!=="translucent")return;const y=c.paint.get("line-opacity"),v=c.paint.get("line-width");if(y.constantOr(1)===0||v.constantOr(1)===0)return;const T=h.depthModeForSublayer(0,s.DepthMode.ReadOnly),C=h.colorModeForRenderPass(),M=h.terrain&&h.terrain.renderingToTexture?1:s.exported.devicePixelRatio,z=c.paint.get("line-dasharray"),O=z.constantOr(1),N=c.layout.get("line-cap"),$=c.paint.get("line-pattern"),K=$.constantOr(1),W=c.paint.get("line-gradient"),H=c.getCrossfadeParameters(),X=K?"linePattern":"line",q=h.context,te=q.gl,Y=(fe=>{const le=[];rc(fe)&&le.push("RENDER_LINE_DASH"),fe.paint.get("line-gradient")&&le.push("RENDER_LINE_GRADIENT");const de=fe.paint.get("line-trim-offset");de[0]===0&&de[1]===0||le.push("RENDER_LINE_TRIM_OFFSET");const he=fe.paint.get("line-pattern").constantOr(1),ve=fe.paint.get("line-opacity").constantOr(1)!==1;return!he&&ve&&le.push("RENDER_LINE_ALPHA_DISCARD"),le})(c);let pe=Y.includes("RENDER_LINE_ALPHA_DISCARD");h.terrain&&h.terrain.clipOrMaskOverlapStencilType()&&(pe=!1);for(const fe of p){const le=r.getTile(fe);if(K&&!le.patternsLoaded())continue;const de=le.getBucket(c);if(!de)continue;h.prepareDrawTile();const he=de.programConfigurations.get(c.id),ve=h.useProgram(X,he,Y),ze=$.constantOr(null);if(ze&&le.imageAtlas){const Je=le.imageAtlas,It=Je.patternPositions[ze.to.toString()],At=Je.patternPositions[ze.from.toString()];It&&At&&he.setConstantPatternPositions(It,At)}const pt=z.constantOr(null),Ce=N.constantOr(null);if(!K&&pt&&Ce&&le.lineAtlas){const Je=le.lineAtlas,It=Je.getDash(pt.to,Ce),At=Je.getDash(pt.from,Ce);It&&At&&he.setConstantPatternPositions(It,At)}let[He,et]=c.paint.get("line-trim-offset");(Ce==="round"||Ce==="square")&&He!==et&&(He===0&&(He-=1),et===1&&(et+=1));const St=h.terrain?fe.projMatrix:null,je=K?Hm(h,le,c,H,St,M):nc(h,le,c,H,St,de.lineClipsArray.length,M,[He,et]);if(W){const Je=de.gradients[c.id];let It=Je.texture;if(c.gradientVersion!==Je.version){let At=256;if(c.stepInterpolant){const Nt=r.getSource().maxzoom,Zt=fe.canonical.z===Nt?Math.ceil(1<<h.transform.maxZoom-fe.canonical.z):1;At=s.clamp(s.nextPowerOfTwo(de.maxLineLength/s.EXTENT*1024*Zt),256,q.maxTextureSize)}Je.gradient=s.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:At,image:Je.gradient||void 0,clips:de.lineClipsArray}),Je.texture?Je.texture.update(Je.gradient):Je.texture=new s.Texture(q,Je.gradient,te.RGBA),Je.version=c.gradientVersion,It=Je.texture}q.activeTexture.set(te.TEXTURE1),It.bind(c.stepInterpolant?te.NEAREST:te.LINEAR,te.CLAMP_TO_EDGE)}O&&(q.activeTexture.set(te.TEXTURE0),le.lineAtlasTexture.bind(te.LINEAR,te.REPEAT),he.updatePaintBuffers(H)),K&&(q.activeTexture.set(te.TEXTURE0),le.imageAtlasTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),he.updatePaintBuffers(H)),h.prepareDrawProgram(q,ve,fe.toUnwrapped());const gt=Je=>{ve.draw(q,te.TRIANGLES,T,Je,C,s.CullFaceMode.disabled,je,c.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,c.paint,h.transform.zoom,he,[de.layoutVertexBuffer2])};if(pe){const Je=h.stencilModeForClipping(fe).ref;Je===0&&h.terrain&&q.clear({stencil:0});const It={func:te.EQUAL,mask:255};je.u_alpha_discard_threshold=.8,gt(new s.StencilMode(It,Je,255,te.KEEP,te.KEEP,te.INVERT)),je.u_alpha_discard_threshold=0,gt(new s.StencilMode(It,Je,255,te.KEEP,te.KEEP,te.KEEP))}else gt(h.stencilModeForClipping(fe))}pe&&(h.resetStencilClippingMasks(),h.terrain&&q.clear({stencil:0}))},fill:function(h,r,c,p){const y=c.paint.get("fill-color"),v=c.paint.get("fill-opacity");if(v.constantOr(1)===0)return;const T=h.colorModeForRenderPass(),C=c.paint.get("fill-pattern"),M=h.opaquePassEnabledForLayer()&&!C.constantOr(1)&&y.constantOr(s.Color.transparent).a===1&&v.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===M){const z=h.depthModeForSublayer(1,h.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);ac(h,r,c,p,z,T,!1)}if(h.renderPass==="translucent"&&c.paint.get("fill-antialias")){const z=h.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);ac(h,r,c,p,z,T,!0)}},"fill-extrusion":function(h,r,c,p){const y=c.paint.get("fill-extrusion-opacity");if(y!==0&&h.renderPass==="translucent"){const v=new s.DepthMode(h.context.gl.LEQUAL,s.DepthMode.ReadWrite,h.depthRangeFor3D);if(y!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))Yr(h,r,c,p,v,s.StencilMode.disabled,s.ColorMode.disabled),Yr(h,r,c,p,v,h.stencilModeFor3D(),h.colorModeForRenderPass()),h.resetStencilClippingMasks();else{const T=h.colorModeForRenderPass();Yr(h,r,c,p,v,s.StencilMode.disabled,T)}}},hillshade:function(h,r,c,p){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent")return;const y=h.context,v=h.depthModeForSublayer(0,s.DepthMode.ReadOnly),T=h.colorModeForRenderPass(),C=h.terrain&&h.terrain.renderingToTexture,[M,z]=h.renderPass!=="translucent"||C?[{},p]:h.stencilConfigForOverlap(p);for(const O of z){const N=r.getTile(O);if(N.needsHillshadePrepare&&h.renderPass==="offscreen")zs(h,N,c,v,s.StencilMode.disabled,T);else if(h.renderPass==="translucent"){const $=C&&h.terrain?h.terrain.stencilModeForRTTOverlap(O):M[O.overscaledZ];Pu(h,O,N,c,v,$,T)}}y.viewport.set([0,0,h.width,h.height]),h.resetStencilClippingMasks()},raster:function(h,r,c,p,y,v){if(h.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!p.length)return;const T=h.context,C=T.gl,M=r.getSource(),z=h.useProgram("raster"),O=h.colorModeForRenderPass(),N=h.terrain&&h.terrain.renderingToTexture,[$,K]=M instanceof Ee||N?[{},p]:h.stencilConfigForOverlap(p),W=K[K.length-1].overscaledZ,H=!h.options.moving;for(const X of K){const q=N?s.DepthMode.disabled:h.depthModeForSublayer(X.overscaledZ-W,c.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,C.LESS),te=X.toUnwrapped(),Y=r.getTile(X);if(N&&(!Y||!Y.hasData()))continue;const pe=N?X.projMatrix:h.transform.calculateProjMatrix(te,H),fe=h.terrain&&N?h.terrain.stencilModeForRTTOverlap(X):$[X.overscaledZ],le=v?0:c.paint.get("raster-fade-duration");Y.registerFadeDuration(le);const de=r.findLoadedParent(X,0),he=Ql(Y,de,r,h.transform,le);let ve,ze;h.terrain&&h.terrain.prepareDrawTile();const pt=c.paint.get("raster-resampling")==="nearest"?C.NEAREST:C.LINEAR;T.activeTexture.set(C.TEXTURE0),Y.texture.bind(pt,C.CLAMP_TO_EDGE),T.activeTexture.set(C.TEXTURE1),de?(de.texture.bind(pt,C.CLAMP_TO_EDGE),ve=Math.pow(2,de.tileID.overscaledZ-Y.tileID.overscaledZ),ze=[Y.tileID.canonical.x*ve%1,Y.tileID.canonical.y*ve%1]):Y.texture.bind(pt,C.CLAMP_TO_EDGE);const Ce=Xm(pe,ze||[0,0],ve||1,he,c,M instanceof Ee?M.perspectiveTransform:[0,0]);if(h.prepareDrawProgram(T,z,te),M instanceof Ee)M.boundsBuffer&&M.boundsSegments&&z.draw(T,C.TRIANGLES,q,s.StencilMode.disabled,O,s.CullFaceMode.disabled,Ce,c.id,M.boundsBuffer,h.quadTriangleIndexBuffer,M.boundsSegments);else{const{tileBoundsBuffer:He,tileBoundsIndexBuffer:et,tileBoundsSegments:St}=h.getTileBoundsBuffers(Y);z.draw(T,C.TRIANGLES,q,fe,O,s.CullFaceMode.disabled,Ce,c.id,He,et,St)}}h.resetStencilClippingMasks()},background:function(h,r,c,p){const y=c.paint.get("background-color"),v=c.paint.get("background-opacity");if(v===0)return;const T=h.context,C=T.gl,M=h.transform,z=M.tileSize,O=c.paint.get("background-pattern");if(h.isPatternMissing(O))return;const N=!O&&y.a===1&&v===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==N)return;const $=s.StencilMode.disabled,K=h.depthModeForSublayer(0,N==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),W=h.colorModeForRenderPass(),H=h.useProgram(O?"backgroundPattern":"background");let X,q=p;q||(X=h.getBackgroundTiles(),q=Object.values(X).map(Y=>Y.tileID)),O&&(T.activeTexture.set(C.TEXTURE0),h.imageManager.bind(h.context));const te=c.getCrossfadeParameters();for(const Y of q){const pe=Y.toUnwrapped(),fe=p?Y.projMatrix:h.transform.calculateProjMatrix(pe);h.prepareDrawTile();const le=r?r.getTile(Y):X?X[Y.key]:new s.Tile(Y,z,M.zoom,h),de=O?Ym(fe,v,h,O,{tileID:Y,tileSize:z},te):Km(fe,v,y);h.prepareDrawProgram(T,H,pe);const{tileBoundsBuffer:he,tileBoundsIndexBuffer:ve,tileBoundsSegments:ze}=h.getTileBoundsBuffers(le);H.draw(T,C.TRIANGLES,K,$,W,s.CullFaceMode.disabled,de,c.id,he,ve,ze)}},sky:function(h,r,c){const p=h.transform,y=p.projection.name==="mercator"||p.projection.name==="globe"?1:s.smoothstep(7,8,p.zoom),v=c.paint.get("sky-opacity")*y;if(v===0)return;const T=h.context,C=c.paint.get("sky-type"),M=new s.DepthMode(T.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),z=h.frameCounter/1e3%1;C==="atmosphere"?h.renderPass==="offscreen"?c.needsSkyboxCapture(h)&&(function(O,N,$,K){const W=O.context,H=W.gl;let X=N.skyboxFbo;if(!X){X=N.skyboxFbo=W.createFramebuffer(32,32,!1),N.skyboxGeometry=new Xu(W),N.skyboxTexture=W.gl.createTexture(),H.bindTexture(H.TEXTURE_CUBE_MAP,N.skyboxTexture),H.texParameteri(H.TEXTURE_CUBE_MAP,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_CUBE_MAP,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_CUBE_MAP,H.TEXTURE_MIN_FILTER,H.LINEAR),H.texParameteri(H.TEXTURE_CUBE_MAP,H.TEXTURE_MAG_FILTER,H.LINEAR);for(let pe=0;pe<6;++pe)H.texImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+pe,0,H.RGBA,32,32,0,H.RGBA,H.UNSIGNED_BYTE,null)}W.bindFramebuffer.set(X.framebuffer),W.viewport.set([0,0,32,32]);const q=N.getCenter(O,!0),te=O.useProgram("skyboxCapture"),Y=new Float64Array(16);s.identity(Y),s.rotateY(Y,Y,.5*-Math.PI),Rs(W,N,te,Y,q,0),s.identity(Y),s.rotateY(Y,Y,.5*Math.PI),Rs(W,N,te,Y,q,1),s.identity(Y),s.rotateX(Y,Y,.5*-Math.PI),Rs(W,N,te,Y,q,2),s.identity(Y),s.rotateX(Y,Y,.5*Math.PI),Rs(W,N,te,Y,q,3),s.identity(Y),Rs(W,N,te,Y,q,4),s.identity(Y),s.rotateY(Y,Y,Math.PI),Rs(W,N,te,Y,q,5),W.viewport.set([0,0,O.width,O.height])}(h,c),c.markSkyboxValid(h)):h.renderPass==="sky"&&function(O,N,$,K,W){const H=O.context,X=H.gl,q=O.transform,te=O.useProgram("skybox");H.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_CUBE_MAP,N.skyboxTexture);const Y=((pe,fe,le,de,he)=>({u_matrix:pe,u_sun_direction:fe,u_cubemap:0,u_opacity:de,u_temporal_offset:he}))(q.skyboxMatrix,N.getCenter(O,!1),0,K,W);O.prepareDrawProgram(H,te),te.draw(H,X.TRIANGLES,$,s.StencilMode.disabled,O.colorModeForRenderPass(),s.CullFaceMode.backCW,Y,"skybox",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(h,c,M,v,z):C==="gradient"&&h.renderPass==="sky"&&function(O,N,$,K,W){const H=O.context,X=H.gl,q=O.transform,te=O.useProgram("skyboxGradient");N.skyboxGeometry||(N.skyboxGeometry=new Xu(H)),H.activeTexture.set(X.TEXTURE0);let Y=N.colorRampTexture;Y||(Y=N.colorRampTexture=new s.Texture(H,N.colorRamp,X.RGBA)),Y.bind(X.LINEAR,X.CLAMP_TO_EDGE);const pe=((fe,le,de,he,ve)=>({u_matrix:fe,u_color_ramp:0,u_center_direction:le,u_radius:s.degToRad(de),u_opacity:he,u_temporal_offset:ve}))(q.skyboxMatrix,N.getCenter(O,!1),N.paint.get("sky-gradient-radius"),K,W);O.prepareDrawProgram(H,te),te.draw(H,X.TRIANGLES,$,s.StencilMode.disabled,O.colorModeForRenderPass(),s.CullFaceMode.backCW,pe,"skyboxGradient",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(h,c,M,v,z)},debug:function(h,r,c){for(let p=0;p<c.length;p++)kn(h,r,c[p])},custom:function(h,r,c){const p=h.context,y=c.implementation;if(h.transform.projection.unsupportedLayers&&h.transform.projection.unsupportedLayers.includes("custom"))s.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(h.renderPass==="offscreen"){const v=y.prerender;v&&(h.setCustomLayerDefaults(),p.setColorMode(h.colorModeForRenderPass()),v.call(y,p.gl,h.transform.customLayerMatrix()),p.setDirty(),h.setBaseState())}else if(h.renderPass==="translucent"){h.setCustomLayerDefaults(),p.setColorMode(h.colorModeForRenderPass()),p.setStencilMode(s.StencilMode.disabled);const v=y.renderingMode==="3d"?new s.DepthMode(h.context.gl.LEQUAL,s.DepthMode.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,s.DepthMode.ReadOnly);p.setDepthMode(v),y.render(p.gl,h.transform.customLayerMatrix()),p.setDirty(),h.setBaseState(),p.bindFramebuffer.set(null)}}};class Yu{constructor(r,c){this.context=new J(r),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ql,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,c){const p=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Kf(this,r));const y=this._terrain;this.transform.elevation=p?y:null,y.update(r,this.transform,c)}_updateFog(r){const c=r.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,y]=c.getFovAdjustedRange(this.transform._fov);if(p>y)return void(this.transform.fogCullDistSq=null);const v=p+.78*(y-p);this.transform.fogCullDistSq=v*v}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,c){if(this.width=r*s.exported.devicePixelRatio,this.height=c*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const r=this.context,c=new s.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(s.EXTENT,0),c.emplaceBack(0,s.EXTENT),c.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(c,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const p=new s.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(s.EXTENT,0),p.emplaceBack(0,s.EXTENT),p.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=r.createVertexBuffer(p,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const y=new s.StructArrayLayout2i4;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(y,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const v=new s.StructArrayLayout4i8;v.emplaceBack(0,0,0,0),v.emplaceBack(s.EXTENT,0,s.EXTENT,0),v.emplaceBack(0,s.EXTENT,0,s.EXTENT),v.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(v,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const T=new s.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(T);const C=new s.StructArrayLayout1ui2;for(const z of[0,1,3,2,0])C.emplaceBack(z);this.debugIndexBuffer=r.createIndexBuffer(C),this.emptyTexture=new s.Texture(r,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA),this.identityMat=s.create();const M=this.context.gl;this.stencilClearMode=new s.StencilMode({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new lc(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,c=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(r,c.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,Du(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,c,p){if(!c||this.currentStencilSource===c.id||!r.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let C=!1;for(const M of p)if(this._tileClippingMaskIDs[M.key]===void 0){C=!0;break}if(!C)return}this.currentStencilSource=c.id;const y=this.context,v=y.gl;this.nextStencilID+p.length>256&&this.clearStencil(),y.setColorMode(s.ColorMode.disabled),y.setDepthMode(s.DepthMode.disabled);const T=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const C of p){const M=c.getTile(C),z=this._tileClippingMaskIDs[C.key]=this.nextStencilID++,{tileBoundsBuffer:O,tileBoundsIndexBuffer:N,tileBoundsSegments:$}=this.getTileBoundsBuffers(M);T.draw(y,v.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:v.ALWAYS,mask:0},z,255,v.KEEP,v.KEEP,v.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Du(C.projMatrix),"$clipping",O,N,$)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,c=this.context.gl;return new s.StencilMode({func:c.NOTEQUAL,mask:255},r,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const c=this.context.gl;return new s.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(r){const c=this.context.gl,p=r.sort((T,C)=>C.overscaledZ-T.overscaledZ),y=p[p.length-1].overscaledZ,v=p[0].overscaledZ-y+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const T={};for(let C=0;C<v;C++)T[C+y]=new s.StencilMode({func:c.GEQUAL,mask:255},C+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=v,[T,p]}return[{[y]:s.StencilMode.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([r.CONSTANT_COLOR,r.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(r,c,p){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new s.DepthMode(p||this.context.gl.LEQUAL,c,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,c){this.style=r,this.options=c,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const p=this.style.order,y=this.style._sourceCaches;for(const M in y){const z=y[M];z.used&&z.prepare(this.context)}const v={},T={},C={};for(const M in y){const z=y[M];v[M]=z.getVisibleCoordinates(),T[M]=v[M].slice().reverse(),C[M]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<p.length;M++)if(this.style._layers[p[M]].is3D()){this.opaquePassCutoff=M;break}if(this.terrain&&(this.terrain.updateTileBinding(C),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),s.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const M of p){const z=this.style._layers[M],O=r._getLayerSourceCache(z);if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const N=O?T[O.id]:void 0;(z.type==="custom"||z.isSky()||N&&N.length)&&this.renderLayer(this,O,z,N)}if(this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[p[this.currentLayer]],z=r._getLayerSourceCache(M);if(M.isSky())continue;const O=z?T[z.id]:void 0;this._renderTileClippingMasks(M,z,O),this.renderLayer(this,z,M,O)}if(this.style.fog&&this.transform.projection.supportsFog&&function(M,z){const O=M.context,N=O.gl,$=M.transform,K=new s.DepthMode(N.LEQUAL,s.DepthMode.ReadOnly,[0,1]),W=M.useProgram("globeAtmosphere",null,$.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),H=s.globeToMercatorTransition($.zoom),X=z.properties.get("color").toArray01(),q=z.properties.get("high-color").toArray01(),te=z.properties.get("space-color").toArray01PremultipliedAlpha(),Y=s.identity$1([]);s.rotateY$1(Y,Y,-s.degToRad($._center.lng)),s.rotateX$1(Y,Y,s.degToRad($._center.lat)),s.rotateZ$1(Y,Y,$.angle),s.rotateX$1(Y,Y,-$._pitch);const pe=s.fromQuat(new Float32Array(16),Y),fe=s.mapValue(z.properties.get("star-intensity"),0,1,0,.25),le=5e-4,de=s.mapValue(z.properties.get("horizon-blend"),0,1,le,.25),he=s.globeUseCustomAntiAliasing(M,O,$)&&de===le?$.worldSize/(2*Math.PI*1.025)-1:$.globeRadius,ve=M.frameCounter/1e3%1,ze=s.length($.globeCenterInViewSpace),pt=Math.sqrt(Math.pow(ze,2)-Math.pow(he,2)),Ce=Math.acos(pt/ze),He=((St,je,gt,Je,It,At,Nt,Zt,tn,bn,Ut,an,An,Jn)=>({u_frustum_tl:St,u_frustum_tr:je,u_frustum_br:gt,u_frustum_bl:Je,u_horizon:It,u_transition:At,u_fadeout_range:Nt,u_color:Zt,u_high_color:tn,u_space_color:bn,u_star_intensity:Ut,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:an,u_horizon_angle:An,u_rotation_matrix:Jn}))($.frustumCorners.TL,$.frustumCorners.TR,$.frustumCorners.BR,$.frustumCorners.BL,$.frustumCorners.horizon,H,de,X,q,te,fe,ve,Ce,pe);M.prepareDrawProgram(O,W);const et=M.atmosphereBuffer;et&&W.draw(O,N.TRIANGLES,K,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,He,"skybox",et.vertexBuffer,et.indexBuffer,et.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const M=this.style._layers[p[this.currentLayer]],z=r._getLayerSourceCache(M);M.isSky()&&this.renderLayer(this,z,M,z?T[z.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const M=this.style._layers[p[this.currentLayer]],z=r._getLayerSourceCache(M);if(M.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(M)){if(M.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const O=z?(M.type==="symbol"?C:T)[z.id]:void 0;this._renderTileClippingMasks(M,z,z?v[z.id]:void 0),this.renderLayer(this,z,M,O),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let M=null;s.values(this.style._layers).forEach(z=>{const O=r._getLayerSourceCache(z);O&&!z.isHidden(this.transform.zoom)&&(!M||M.getSource().maxzoom<O.getSource().maxzoom)&&(M=O)}),M&&this.options.showTileBoundaries&&Bs.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const z=M.transform.padding;Fa(M,M.transform.height-(z.top||0),3,ad),Fa(M,z.bottom||0,3,Ds),cd(M,z.left||0,3,Ls),cd(M,M.transform.width-(z.right||0),3,ld);const O=M.transform.centerPoint;(function(N,$,K,W){ja(N,$-1,K-10,2,20,W),ja(N,$-10,K-1,20,2,W)})(M,O.x,M.transform.height-O.y,Hu)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}}renderLayer(r,c,p,y){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||y&&y.length)&&(this.id=p.id,this.gpuTimingStart(p),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(p.type)||Bs[p.type](r,c,p,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let p=this.gpuTimers[r.id];p||(p=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),p.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,c=r.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),r.beginQueryEXT(r.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const c={};for(const p in r){const y=r[p],v=this.context.extTimerQuery,T=v.getQueryObjectEXT(y.query,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(y.query),c[p]=T}return c}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let p=0;for(const y of r)p+=c.getQueryObjectEXT(y,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(y);return p}translatePosMatrix(r,c,p,y,v){if(!p[0]&&!p[1])return r;const T=v?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(T){const z=Math.sin(T),O=Math.cos(T);p=[p[0]*O-p[1]*z,p[0]*z+p[1]*O]}const C=[v?p[0]:xt(c,p[0],this.transform.zoom),v?p[1]:xt(c,p[1],this.transform.zoom),0],M=new Float32Array(16);return s.translate(M,r,C),M}saveTileTexture(r){const c=this._tileTextures[r.size[0]];c?c.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const c=this._tileTextures[r];return c&&c.length>0?c.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const c=this.imageManager.getPattern(r.from.toString()),p=this.imageManager.getPattern(r.to.toString());return!c||!p}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,c=this.style&&this.style.fog,p=[];return this.terrain&&!this.terrain.renderingToTexture&&p.push("TERRAIN"),c&&!r&&c.getOpacity(this.transform.pitch)!==0&&p.push("FOG"),r&&p.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&p.push("OVERDRAW_INSPECTOR"),p}useProgram(r,c,p){this.cache=this.cache||{};const y=p||[],v=this.currentGlobalDefines().concat(y),T=Bu.cacheKey(Yl[r],r,v,c);return this.cache[T]||(this.cache[T]=new Bu(this.context,r,Yl[r],c,Jm[r],v)),this.cache[T]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(r,c,p){if(this.terrain&&this.terrain.renderingToTexture)return;const y=this.style.fog;if(y){const v=y.getOpacity(this.transform.pitch),T=((C,M,z,O,N,$,K,W,H,X,q)=>{const te=C.transform,Y=M.properties.get("color").toArray01();Y[3]=O;const pe=C.frameCounter/1e3%1;return{u_fog_matrix:z?te.calculateFogTileMatrix(z):C.identityMat,u_fog_range:M.getFovAdjustedRange(te._fov),u_fog_color:Y,u_fog_horizon_blend:M.properties.get("horizon-blend"),u_fog_temporal_offset:pe,u_frustum_tl:N,u_frustum_tr:$,u_frustum_br:K,u_frustum_bl:W,u_globe_pos:H,u_globe_radius:X,u_viewport:q,u_globe_transition:s.globeToMercatorTransition(te.zoom),u_is_globe:+(te.projection.name==="globe")}})(this,y,p,v,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);c.setFogUniformValues(r,T)}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const r=this.context.gl,c=r.createTexture();return r.bindTexture(r.TEXTURE_2D,c),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,c=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const y of p)c[y.key]=r[y.key]||new s.Tile(y,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class Ua{constructor(r=0,c=0,p=0,y=0){if(isNaN(r)||r<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=c,this.left=p,this.right=y}interpolate(r,c,p){return c.top!=null&&r.top!=null&&(this.top=s.number(r.top,c.top,p)),c.bottom!=null&&r.bottom!=null&&(this.bottom=s.number(r.bottom,c.bottom,p)),c.left!=null&&r.left!=null&&(this.left=s.number(r.left,c.left,p)),c.right!=null&&r.right!=null&&(this.right=s.number(r.right,c.right,p)),this}getCenter(r,c){const p=s.clamp((this.left+r-this.right)/2,0,r),y=s.clamp((this.top+c-this.bottom)/2,0,c);return new s.pointGeometry(p,y)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Ua(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ju(h,r){const c=s.getColumn(h,3);s.fromQuat(h,r),s.setColumn(h,3,c)}function Fs(h,r){const c=s.identity$1([]);return s.rotateZ$1(c,c,-r),s.rotateX$1(c,c,-h),c}function js(h,r){const c=[h[0],h[1],0],p=[r[0],r[1],0];if(s.length(c)>=1e-15){const T=s.normalize([],c);s.scale$2(p,T,s.dot(p,T)),r[0]=p[0],r[1]=p[1]}const y=s.cross([],r,h);if(s.len(y)<1e-15)return null;const v=Math.atan2(-y[1],y[0]);return Fs(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),v)}class kt{constructor(r,c){this.position=r,this.orientation=c}get position(){return this._position}set position(r){if(r){const c=r instanceof s.MercatorCoordinate?r:new s.MercatorCoordinate(r[0],r[1],r[2]);this._renderWorldCopies&&(c.x=s.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(r,c){if(this.orientation=null,!this.position)return;const p=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(r)):0,y=this.position,v=s.MercatorCoordinate.fromLngLat(r,p),T=[v.x-y.x,v.y-y.y,v.z-y.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=js(T,c)}setPitchBearing(r,c){this.orientation=Fs(s.degToRad(r),s.degToRad(-c))}}class lr{constructor(r,c){this._transform=s.identity([]),this.orientation=c,this.position=r}get mercatorPosition(){const r=this.position;return new s.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=s.getColumn(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var c;r&&s.setColumn(this._transform,3,[(c=r)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||s.identity$1([]),r&&Ju(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,c){this._orientation=Fs(r,c),Ju(this._transform,this._orientation)}forward(){const r=s.getColumn(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=s.getColumn(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=s.getColumn(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,c){const p=new Float64Array(16);return s.invert(p,this.getWorldToCamera(r,c)),p}getWorldToCameraPosition(r,c,p){const y=this.position;s.scale$2(y,y,-r);const v=new Float64Array(16);return s.fromScaling(v,[p,p,p]),s.translate(v,v,y),v[10]*=c,v}getWorldToCamera(r,c){const p=new Float64Array(16),y=new Float64Array(4),v=this.position;return s.conjugate(y,this._orientation),s.scale$2(v,v,-r),s.fromQuat(p,y),s.translate(p,p,v),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=c,p[9]*=c,p[10]*=c,p[11]*=c,p}getCameraToClipPerspective(r,c,p,y){const v=new Float64Array(16);return s.perspective(v,r,c,p,y),v}getDistanceToElevation(r){const c=r===0?0:s.mercatorZfromAltitude(r,this.position[1]),p=this.forward();return(c-this.position[2])/p[2]}clone(){return new lr([...this.position],[...this.orientation])}}function Qu(h,r){const c=Va(h.projection,h.zoom,h.width,h.height),p=function(v,T,C,M,z){const O=new s.LngLat(C.lng-180*zr,C.lat),N=new s.LngLat(C.lng+180*zr,C.lat),$=v.project(O.lng,O.lat),K=v.project(N.lng,N.lat),W=-Math.atan2(K.y-$.y,K.x-$.x),H=s.MercatorCoordinate.fromLngLat(C);H.y=s.clamp(H.y,-.999975,.999975);const X=H.toLngLat(),q=v.project(X.lng,X.lat),te=s.MercatorCoordinate.fromLngLat(X);te.x+=zr;const Y=te.toLngLat(),pe=v.project(Y.lng,Y.lat),fe=$a(pe.x-q.x,pe.y-q.y,W),le=s.MercatorCoordinate.fromLngLat(X);le.y+=zr;const de=le.toLngLat(),he=v.project(de.lng,de.lat),ve=$a(he.x-q.x,he.y-q.y,W),ze=Math.abs(fe.x)/Math.abs(ve.y),pt=s.identity([]);s.rotateZ(pt,pt,-W*(1-(z?0:M)));const Ce=s.identity([]);return s.scale(Ce,Ce,[1,1-(1-ze)*M,1]),Ce[4]=-ve.x/ve.y*M,s.rotateZ(Ce,Ce,W),s.multiply(Ce,pt,Ce),Ce}(h.projection,0,h.center,c,r),y=eh(h);return s.scale(p,p,[y,y,1]),p}function eh(h){const r=h.projection,c=Va(h.projection,h.zoom,h.width,h.height),p=th(r,h.center),y=th(r,s.LngLat.convert(r.center));return Math.pow(2,p*c+(1-c)*y)}function Va(h,r,c,p,y=1/0){const v=h.range;if(!v)return 0;const T=Math.min(y,Math.max(c,p)),C=Math.log(T/1024)/Math.LN2;return s.smoothstep(v[0]+C,v[1]+C,r)}const zr=1/4e4;function th(h,r){const c=s.clamp(r.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),p=new s.LngLat(r.lng-180*zr,c),y=new s.LngLat(r.lng+180*zr,c),v=h.project(p.lng,c),T=h.project(y.lng,c),C=s.MercatorCoordinate.fromLngLat(p),M=s.MercatorCoordinate.fromLngLat(y),z=T.x-v.x,O=T.y-v.y,N=M.x-C.x,$=M.y-C.y,K=Math.sqrt((N*N+$*$)/(z*z+O*O));return Math.log(K)/Math.LN2}function $a(h,r,c){const p=Math.cos(c),y=Math.sin(c);return{x:h*p-r*y,y:h*y+r*p}}class Ga{constructor(r,c,p,y,v,T,C){this.tileSize=512,this._renderWorldCopies=v===void 0||v,this._minZoom=r||0,this._maxZoom=c||22,this._minPitch=p==null?0:p,this._maxPitch=y==null?60:y,this.setProjection(T),this.setMaxBounds(C),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ua,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new lr,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const r=new Ga(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(r){const c=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||c)&&this._updateCameraOnTerrain(),(r||c)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const p=!A(c,this.getProjection());return p&&this._calcMatrices(),this.mercatorFromTransition=!1,p}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const c=r!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const c=-r*Math.PI/180;var p;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(p=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),function(y,v,T){var C=v[0],M=v[1],z=v[2],O=v[3],N=Math.sin(T),$=Math.cos(T);y[0]=C*$+z*N,y[1]=M*$+O*N,y[2]=C*-N+z*$,y[3]=M*-N+O*$}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const c=s.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const c=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const r=this._elevation;this._centerAltitude=r.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=r.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let y=0,v=0;for(let T=0;T<c.length;T++){const C=new s.pointGeometry(c[T][0]*this.width,p+c[T][1]*(this.height-p)),M=r.pointCoordinate(C);if(!M)continue;const z=1/Math.hypot(M[0]-this._camera.position[0],M[1]-this._camera.position[1]);y+=M[3]*z,v+=z}return v===0?NaN:y/v}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*c,y=this._mercatorZfromZoom(r),v=this._mercatorZfromZoom(this._maxZoom),T=Math.max(y-p,v);this._setZoom(this._zoomFromMercatorZ(T))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let p;p=r.z<this._camera.position[2]?[c.x,c.y,c.z]:[r.x,r.y,r.z];const y=s.length(s.sub([],this._camera.position,p));return s.clamp(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let c=!1;if(r.orientation&&!s.exactEquals(r.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(r.orientation)),r.position){const p=[r.position.x,r.position.y,r.position.z];s.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,c=new kt;return c.position=new s.MercatorCoordinate(r[0],r[1],r[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(r){if(!s.length$1(r))return!1;s.normalize$1(r,r);const c=s.transformQuat([],[0,0,-1],r),p=s.transformQuat([],[0,-1,0],r);if(p[2]<0)return!1;const y=js(c,p);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(r){const c=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;r[2]=s.clamp(r[2],y/p,y/c),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,c,p){this._unmodified=!1,this._edgeInsets.interpolate(r,c,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const c=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(r){const c=[new s.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const p=this.pointCoordinate(new s.pointGeometry(0,0)),y=this.pointCoordinate(new s.pointGeometry(this.width,0)),v=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),T=this.pointCoordinate(new s.pointGeometry(0,this.height)),C=Math.floor(Math.min(p.x,y.x,v.x,T.x)),M=Math.floor(Math.max(p.x,y.x,v.x,T.x)),z=1;for(let O=C-z;O<=M+z;O++)O!==0&&c.push(new s.UnwrappedTileID(O,r))}return c}coveringTiles(r){let c=this.coveringZoomLevel(r);const p=c,y=this.elevation&&!r.isTerrainDEM,v=this.projection.name==="mercator";if(r.minzoom!==void 0&&c<r.minzoom)return[];r.maxzoom!==void 0&&c>r.maxzoom&&(c=r.maxzoom);const T=this.locationCoordinate(this.center),C=this.center.lat,M=1<<c,z=[M*T.x,M*T.y,0],O=this.projection.name==="globe",N=!O,$=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,N),K=O?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),W=M*s.mercatorZfromAltitude(1,this.center.lat),H=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),X=[M*K.x,M*K.y,H*(N?1:W)],q=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),te=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,Y=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,pe=r.isTerrainDEM?-Y:this._elevation?this._elevation.getMinElevationBelowMSL():0,fe=this.projection.isReprojectedInTileSpace?eh(this):1,le=je=>{const Je=new s.MercatorCoordinate(je.x+25e-6,je.y,je.z),It=new s.MercatorCoordinate(je.x,je.y+25e-6,je.z),At=je.toLngLat(),Nt=Je.toLngLat(),Zt=It.toLngLat(),tn=this.locationCoordinate(At),bn=this.locationCoordinate(Nt),Ut=this.locationCoordinate(Zt),an=Math.hypot(bn.x-tn.x,bn.y-tn.y),An=Math.hypot(Ut.x-tn.x,Ut.y-tn.y);return Math.sqrt(an*An)*fe/25e-6},de=je=>{const gt=Y,Je=pe;return{aabb:s.tileAABB(this,M,0,0,0,je,Je,gt,this.projection),zoom:0,x:0,y:0,minZ:Je,maxZ:gt,wrap:je,fullyVisible:!1}},he=[];let ve=[];const ze=c,pt=r.reparseOverscaled?p:c,Ce=je=>je*je,He=Ce((H-this._centerAltitude)*W),et=je=>{if(!this._elevation||!je.tileID||!v)return;const gt=this._elevation.getMinMaxForTile(je.tileID),Je=je.aabb;gt?(Je.min[2]=gt.min,Je.max[2]=gt.max,Je.center[2]=(Je.min[2]+Je.max[2])/2):(je.shouldSplit=St(je),je.shouldSplit||(Je.min[2]=Je.max[2]=Je.center[2]=this._centerAltitude))},St=je=>{if(je.zoom<te)return!0;if(je.zoom===ze)return!1;if(je.shouldSplit!=null)return je.shouldSplit;const gt=je.aabb.distanceX(X),Je=je.aabb.distanceY(X);let It=He,At=1;if(O){It=Ce(je.aabb.distanceZ(X));const Zt=Math.pow(2,je.zoom),tn=s.latFromMercatorY((je.y+1)/Zt),bn=s.latFromMercatorY(je.y/Zt),Ut=Math.min(Math.max(C,tn),bn),an=s.circumferenceAtLatitude(Ut)/s.circumferenceAtLatitude(C);if(At=Ut===C?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,an/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&je.zoom===ze-1&&an>=.9)return!0}else if(y&&(It=Ce(je.aabb.distanceZ(X)*W)),this.projection.isReprojectedInTileSpace&&p<=5){const Zt=Math.pow(2,je.zoom),tn=le(new s.MercatorCoordinate((je.x+.5)/Zt,(je.y+.5)/Zt));At=tn>.85?1:tn}const Nt=gt*gt+Je*Je+It;return Nt<Ce((1<<ze-je.zoom)*q*At*((Zt,tn)=>{if(tn*Ce(.707)<Zt)return 1;const bn=Math.sqrt(tn/Zt);return bn/(1.4144271570014144+(Math.pow(1.1,bn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(It,He),Nt))};if(this.renderWorldCopies)for(let je=1;je<=3;je++)he.push(de(-je)),he.push(de(je));for(he.push(de(0));he.length>0;){const je=he.pop(),gt=je.x,Je=je.y;let It=je.fullyVisible;if(!It){const At=je.aabb.intersects($);if(At===0)continue;It=At===2}if(je.zoom!==ze&&St(je))for(let At=0;At<4;At++){const Nt=(gt<<1)+At%2,Zt=(Je<<1)+(At>>1),tn={aabb:v?je.aabb.quadrant(At):s.tileAABB(this,M,je.zoom+1,Nt,Zt,je.wrap,je.minZ,je.maxZ,this.projection),zoom:je.zoom+1,x:Nt,y:Zt,wrap:je.wrap,fullyVisible:It,tileID:void 0,shouldSplit:void 0,minZ:je.minZ,maxZ:je.maxZ};y&&!O&&(tn.tileID=new s.OverscaledTileID(je.zoom+1===ze?pt:je.zoom+1,je.wrap,je.zoom+1,Nt,Zt),et(tn)),he.push(tn)}else{const At=je.zoom===ze?pt:je.zoom;if(r.minzoom&&r.minzoom>At)continue;const Nt=z[0]-(.5+gt+(je.wrap<<je.zoom))*(1<<c-je.zoom),Zt=z[1]-.5-Je,tn=je.tileID?je.tileID:new s.OverscaledTileID(At,je.wrap,je.zoom,gt,Je);ve.push({tileID:tn,distanceSq:Nt*Nt+Zt*Zt})}}if(this.fogCullDistSq){const je=this.fogCullDistSq,gt=this.horizonLineFromTop();ve=ve.filter(Je=>{const It=[0,0,0,1],At=[s.EXTENT,s.EXTENT,0,1],Nt=this.calculateFogTileMatrix(Je.tileID.toUnwrapped());s.transformMat4$1(It,It,Nt),s.transformMat4$1(At,At,Nt);const Zt=s.getAABBPointSquareDist(It,At);if(Zt===0)return!0;let tn=!1;const bn=this._elevation;if(bn&&Zt>je&&gt!==0){const Ut=this.calculateProjMatrix(Je.tileID.toUnwrapped());let an;r.isTerrainDEM||(an=bn.getMinMaxForTile(Je.tileID)),an||(an={min:pe,max:Y});const An=s.furthestTileCorner(this.rotation),Jn=[An[0]*s.EXTENT,An[1]*s.EXTENT,an.max];s.transformMat4(Jn,Jn,Ut),tn=(1-Jn[1])*this.height*.5<gt}return Zt<je||tn})}return ve.sort((je,gt)=>je.distanceSq-gt.distanceSq).map(je=>je.tileID)}resize(r,c){this.width=r,this.height=c,this.pixelsToGLUnits=[2/r,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const c=s.clamp(r.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),p=this.projection.project(r.lng,c);return new s.pointGeometry(p.x*this.worldSize,p.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(r,c){let p,y;const v=this.centerPoint;if(this.projection.name==="globe"){const C=this.worldSize;p=(c.x-v.x)/C,y=(c.y-v.y)/C}else{const C=this.pointCoordinate(c),M=this.pointCoordinate(v);p=C.x-M.x,y=C.y-M.y}const T=this.locationCoordinate(r);this.setLocation(new s.MercatorCoordinate(T.x-p,T.y-y))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,c){const p=c?s.mercatorZfromAltitude(c,r.lat):void 0,y=this.projection.project(r.lng,r.lat);return new s.MercatorCoordinate(y.x,y.y,p)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,c){const p=c!=null?c:this._centerAltitude,y=[r.x,r.y,0,1],v=[r.x,r.y,1,1];s.transformMat4$1(y,y,this.pixelMatrixInverse),s.transformMat4$1(v,v,this.pixelMatrixInverse);const T=v[3];s.scale$1(y,y,1/y[3]),s.scale$1(v,v,1/T);const C=y[2],M=v[2];return{p0:y,p1:v,t:C===M?0:(p-C)/(M-C)}}screenPointToMercatorRay(r){const c=[r.x,r.y,0,1],p=[r.x,r.y,1,1];return s.transformMat4$1(c,c,this.pixelMatrixInverse),s.transformMat4$1(p,p,this.pixelMatrixInverse),s.scale$1(c,c,1/c[3]),s.scale$1(p,p,1/p[3]),c[2]=s.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,p[2]=s.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,s.scale$1(c,c,1/this.worldSize),s.scale$1(p,p,1/this.worldSize),new s.Ray([c[0],c[1],c[2]],s.normalize([],s.sub([],p,c)))}rayIntersectionCoordinate(r){const{p0:c,p1:p,t:y}=r,v=s.mercatorZfromAltitude(c[2],this._center.lat),T=s.mercatorZfromAltitude(p[2],this._center.lat);return new s.MercatorCoordinate(s.number(c[0],p[0],y)/this.worldSize,s.number(c[1],p[1],y)/this.worldSize,s.number(v,T,y))}pointCoordinate(r,c=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,c)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let c=this.projection.pointCoordinate3D(this,r.x,r.y);if(c)return new s.MercatorCoordinate(c[0],c[1],c[2]);let p=0,y=this.horizonLineFromTop();if(r.y>y)return this.pointCoordinate(r);const v=.02*y,T=r.clone();for(let C=0;C<10&&y-p>v;C++){T.y=s.number(p,y,.66);const M=this.projection.pointCoordinate3D(this,T.x,T.y);M?(y=T.y,c=M):p=T.y}return c?new s.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}_coordinatePoint(r,c){const p=c&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,y=[r.x*this.worldSize,r.y*this.worldSize,p+r.toAltitude(),1];return s.transformMat4$1(y,y,this.pixelMatrix),y[3]>0?new s.pointGeometry(y[0]/y[3],y[1]/y[3]):new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(r,c){const p=new s.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),y=new s.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),v=new s.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),T=new s.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let C=this.pointCoordinate(p,r),M=this.pointCoordinate(y,r);const z=this.pointCoordinate(v,c),O=this.pointCoordinate(T,c),N=($,K)=>(K.y-$.y)/(K.x-$.x);return C.y>1&&M.y>=0?C=new s.MercatorCoordinate((1-O.y)/N(O,C)+O.x,1):C.y<0&&M.y<=1&&(C=new s.MercatorCoordinate(-O.y/N(O,C)+O.x,0)),M.y>1&&C.y>=0?M=new s.MercatorCoordinate((1-z.y)/N(z,M)+z.x,1):M.y<0&&C.y<=1&&(M=new s.MercatorCoordinate(-z.y/N(z,M)+z.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(C)).extend(this.coordinateLocation(M)).extend(this.coordinateLocation(O)).extend(this.coordinateLocation(z))}_getBounds3D(){const r=this.elevation;if(!r.visibleDemTiles.length)return this._getBounds(0,0);const c=r.visibleDemTiles.reduce((p,y)=>{if(y.dem){const v=y.dem.tree;p.min=Math.min(p.min,v.minimums[0]),p.max=Math.max(p.max,v.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBounds(c.min*r.exaggeration(),c.max*r.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(r=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-c*(1-this._horizonShift);return r?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,c){return this.projection.createTileMatrix(this,c,r)}calculateDistanceTileData(r){const c=r.key,p=this._distanceTileDataCache;if(p[c])return p[c];const y=r.canonical,v=1/this.height,T=this.cameraWorldSize/this.zoomScale(y.z),C=(y.x+Math.pow(2,y.z)*r.wrap)*T,M=y.y*T,z=this.point,O=this.angle,N=Math.sin(-O),$=-Math.cos(-O);return p[c]={bearing:[N,$],center:[(z.x-C)*v,(z.y-M)*v],scale:T/s.EXTENT*v},p[c]}calculateFogTileMatrix(r){const c=r.key,p=this._fogTileMatrixCache;if(p[c])return p[c];const y=this.projection.createTileMatrix(this,this.cameraWorldSize,r);return s.multiply(y,this.worldToFogMatrix,y),p[c]=new Float32Array(y),p[c]}calculateProjMatrix(r,c=!1){const p=r.key,y=c?this._alignedProjMatrixCache:this._projMatrixCache;if(y[p])return y[p];const v=this.calculatePosMatrix(r,this.worldSize);return s.multiply(v,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,v),y[p]=new Float32Array(v),y[p]}calculatePixelsToTileUnitsMatrix(r){const c=r.tileID.key,p=this._pixelsToTileUnitsCache;if(p[c])return p[c];const y=function(v,T){const{scale:C}=v.tileTransform,M=C*s.EXTENT/(v.tileSize*Math.pow(2,T.zoom-v.tileID.overscaledZ+v.tileID.canonical.z));return z=new Float32Array(4),$=(O=T.inverseAdjustmentMatrix)[1],K=O[2],W=O[3],X=(N=[M,M])[1],z[0]=O[0]*(H=N[0]),z[1]=$*H,z[2]=K*X,z[3]=W*X,z;var z,O,N,$,K,W,H,X}(r,this);return p[c]=y,p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const c=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(c),y=this._camera.forward(),v=s.mercatorZfromAltitude(1,this._center.lat);p[2]/=v,y[2]/=v,s.normalize(y,y);const T=r.raycast(p,y,r.exaggeration());if(T){const C=s.scaleAndAdd([],p,y,T),M=new s.MercatorCoordinate(C[0],C[1],s.mercatorZfromAltitude(C[2],s.latFromMercatorY(C[1]))),z=(M.z+s.length([M.x-p[0],M.y-p[1],M.z-p[2]*v]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(z),this._centerAltitude=M.toAltitude(),this._center=this.coordinateLocation(M),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const r=this._elevation;this._updateCameraState();const c=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(c),y=r.getAtPointOrZero(new s.MercatorCoordinate(...p)),v=this._minimumHeightOverTerrain()*Math.cos(s.degToRad(this._maxPitch)),T=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*y;if(T<v){const C=this.locationCoordinate(this._center,this._centerAltitude),M=[C.x-p[0],C.y-p[1],C.z-p[2]],z=s.length(M);M[2]-=(v-T)/this._pixelsPerMercatorPixel;const O=s.length(M);if(O===0)return;s.scale$2(M,M,z/O*this._pixelsPerMercatorPixel),this._camera.position=[C.x-M[0],C.y-M[1],C.z*this._pixelsPerMercatorPixel-M[2]],this._camera.orientation=js(M,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const $=this.center;return $.lat=s.clamp($.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&($.lng=s.clamp($.lng,this.minLng,this.maxLng)),this.center=$,void(this._constraining=!1)}const c=this._unmodified,{x:p,y}=this.point;let v=0,T=p,C=y;const M=this.width/2,z=this.height/2,O=this.worldMinY*this.scale,N=this.worldMaxY*this.scale;if(y-z<O&&(C=O+z),y+z>N&&(C=N-z),N-O<this.height&&(v=Math.max(v,this.height/(N-O)),C=(N+O)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const $=this.worldMinX*this.scale,K=this.worldMaxX*this.scale,W=this.worldSize/2-($+K)/2;T=(p+W+this.worldSize)%this.worldSize-W,T-M<$&&(T=$+M),T+M>K&&(T=K-M),K-$<this.width&&(v=Math.max(v,this.width/(K-$)),T=(K+$)/2)}T===p&&C===y||(this.center=this.unproject(new s.pointGeometry(T,C))),v&&(this.zoom+=this.scaleZoom(v)),this._constrainCameraAltitude(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,c=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const p=Va(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const y=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?c:1),v=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);v[8]=2*-r.x/this.width,v[9]=2*r.y/this.height;let T=s.mul([],v,y);if(this.projection.isReprojectedInTileSpace){const fe=this.locationCoordinate(this.center),le=s.identity([]);s.translate(le,le,[fe.x*this.worldSize,fe.y*this.worldSize,0]),s.multiply(le,le,Qu(this)),s.translate(le,le,[-fe.x*this.worldSize,-fe.y*this.worldSize,0]),s.multiply(T,T,le),this.inverseAdjustmentMatrix=function(de){const he=Qu(de,!0);return We([],[he[0],he[1],he[4],he[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],T,[this.worldSize,this.worldSize,this.worldSize/c,1]),this.projMatrix=T,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const C=s.invert([],v);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(C,this.horizonLineFromTop(),this.height);const M=new Float32Array(16);s.identity(M),s.scale(M,M,[1,-1,1]),s.rotateX(M,M,this._pitch),s.rotateZ(M,M,this.angle);const z=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),O=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;z[8]=2*-r.x/this.width,z[9]=2*(r.y+O)/this.height,this.skyboxMatrix=s.multiply(M,z,M);const N=this.point,$=N.x,K=N.y,W=this.width%2/2,H=this.height%2/2,X=Math.cos(this.angle),q=Math.sin(this.angle),te=$-Math.round($)+X*W+q*H,Y=K-Math.round(K)+X*H+q*W,pe=new Float64Array(T);if(s.translate(pe,pe,[te>.5?te-1:te,Y>.5?Y-1:Y,0]),this.alignedProjMatrix=pe,T=s.create(),s.scale(T,T,[this.width/2,-this.height/2,1]),s.translate(T,T,[1,-1,0]),this.labelPlaneMatrix=T,T=s.create(),s.scale(T,T,[1,-1,1]),s.translate(T,T,[-1,-1,0]),s.scale(T,T,[2/this.width,2/this.height,1]),this.glCoordMatrix=T,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},T=s.invert(new Float64Array(16),this.pixelMatrix),!T)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=T,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const fe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(fe,fe,y),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=T;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSize,c=this.cameraPixelsPerMeter,p=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,v=[r,r,c];s.scale$2(v,v,y),s.scale$2(p,p,-1),s.multiply$2(p,p,v);const T=s.create();s.translate(T,T,p),s.scale(T,T,v),this.mercatorFogMatrix=T,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,c,y)}_computeCameraPosition(r){const c=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),y=this.point,v=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-r/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-p[0]*v,y.y/this.worldSize-p[1]*v,r/this.worldSize*this._centerAltitude-p[2]*v]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=r[2];let y=1;p>0&&(y=Math.min((c-this._camera.position[2])/p,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,r,y),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const r=this._camera.position,c=this._camera.forward(),{pitch:p,bearing:y}=this._camera.getPitchBearing(),v=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,T=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),C=Math.max((r[2]-v)/Math.cos(p),T),M=this._zoomFromMercatorZ(C);s.scaleAndAdd(r,r,c,C),this._pitch=s.clamp(p,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(y,-Math.PI,Math.PI),this._setZoom(s.clamp(M,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,c){const p=Math.min(r.x,c.x),y=Math.max(r.x,c.x),v=Math.min(r.y,c.y),T=Math.max(r.y,c.y);if(v<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const C=[new s.pointGeometry(p,v),new s.pointGeometry(y,T),new s.pointGeometry(p,T),new s.pointGeometry(y,v)],M=this.renderWorldCopies?-3:0,z=this.renderWorldCopies?4:1;for(const O of C){const N=this.pointRayIntersection(O);if(N.t<0)return!0;const $=this.rayIntersectionCoordinate(N);if($.x<M||$.y<0||$.x>z||$.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.pointGeometry(0,0),new s.pointGeometry(this.width,this.height))}zoomDeltaToMovement(r,c){const p=s.length(s.sub([],this._camera.position,r)),y=this._zoomFromMercatorZ(p)+c;return p-this._mercatorZfromZoom(y)}getCameraPoint(){if(this.projection.name==="globe"){const r=function(c,p){const y=[c[0],c[1],c[2],1];s.transformMat4$1(y,y,p);const v=Math.max(y[3],1e-6);return[y[0]/v,y[1]/v,y[2]/v,v]}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.pointGeometry(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,r))}}getCameraToCenterDistance(r){const c=Va(r,this.zoom,this.width,this.height,1024),p=r.pixelSpaceConversion(this.center.lat,this.worldSize,c);return .5/Math.tan(.5*this._fov)*this.height*p}}function Za(h,r){let c=!1,p=null;const y=()=>{p=null,c&&(h(),p=setTimeout(y,r),c=!1)};return()=>(c=!0,p||y(),p)}class ud{constructor(r){this._hashName=r&&encodeURIComponent(r),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Za(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,s.window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const c=nh(r);if(this._hashName){const p=this._hashName;let y=!1;const v=s.window.location.hash.slice(1).split("&").map(T=>{const C=T.split("=")[0];return C===p?(y=!0,`${C}=${c}`):T}).filter(T=>T);return y||v.push(`${p}=${c}`),`#${v.join("&")}`}return`#${c}`}_getCurrentHash(){const r=s.window.location.hash.replace("#","");if(this._hashName){let c;return r.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(c=p)}),(c&&c[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(p=>isNaN(p))){const p=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(c[3]||0):r.getBearing();return r.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:p,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,r)}}function nh(h,r){const c=h.getCenter(),p=Math.round(100*h.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,y),T=Math.round(c.lng*v)/v,C=Math.round(c.lat*v)/v,M=h.getBearing(),z=h.getPitch();let O=r?`/${T}/${C}/${p}`:`${p}/${C}/${T}`;return(M||z)&&(O+="/"+Math.round(10*M)/10),z&&(O+=`/${Math.round(z)}`),O}const Jr={linearity:.3,easing:s.bezier(0,0,.3,1)},eg=s.extend({deceleration:2500,maxSpeed:1400},Jr),tg=s.extend({deceleration:20,maxSpeed:1400},Jr),hd=s.extend({deceleration:1e3,maxSpeed:360},Jr),cc=s.extend({deceleration:1e3,maxSpeed:90},Jr);class ih{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,c=s.exported.now();for(;r.length>0&&c-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)c.zoom+=v.zoomDelta||0,c.bearing+=v.bearingDelta||0,c.pitch+=v.pitchDelta||0,v.panDelta&&c.pan._add(v.panDelta),v.around&&(c.around=v.around),v.pinchAround&&(c.pinchAround=v.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(c.pan.mag()){const v=Wa(c.pan.mag(),p,s.extend({},eg,r||{}));y.offset=c.pan.mult(v.amount/c.pan.mag()),y.center=this._map.transform.center,qa(y,v)}if(c.zoom){const v=Wa(c.zoom,p,tg);y.zoom=this._map.transform.zoom+v.amount,qa(y,v)}if(c.bearing){const v=Wa(c.bearing,p,hd);y.bearing=this._map.transform.bearing+s.clamp(v.amount,-179,179),qa(y,v)}if(c.pitch){const v=Wa(c.pitch,p,cc);y.pitch=this._map.transform.pitch+v.amount,qa(y,v)}if(y.zoom||y.bearing){const v=c.pinchAround===void 0?c.around:c.pinchAround;y.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function qa(h,r){(!h.duration||h.duration<r.duration)&&(h.duration=r.duration,h.easing=r.easing)}function Wa(h,r,c){const{maxSpeed:p,linearity:y,deceleration:v}=c,T=s.clamp(h*y/(r/1e3),-p,p),C=Math.abs(T)/(v*y);return{easing:c.easing,duration:1e3*C,amount:T*(C/2)}}class Ri extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,p,y={}){const v=Pe(c.getCanvasContainer(),p),T=c.unproject(v);super(r,s.extend({point:v,lngLat:T,originalEvent:p},y)),this._defaultPrevented=!1,this.target=c}}class Ns extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,p){const y=r==="touchend"?p.changedTouches:p.touches,v=Oe(c.getCanvasContainer(),y),T=v.map(M=>c.unproject(M)),C=v.reduce((M,z,O,N)=>M.add(z.div(N.length)),new s.pointGeometry(0,0));super(r,{points:v,point:C,lngLats:T,lngLat:c.unproject(C),originalEvent:p}),this._defaultPrevented=!1}}class fd extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,p){super(r,{originalEvent:p}),this._defaultPrevented=!1}}class dd{constructor(r,c){this._map=r,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new fd(r.type,this._map,r))}mousedown(r,c){return this._mousedownPos=c,this._firePreventable(new Ri(r.type,this._map,r))}mouseup(r){this._map.fire(new Ri(r.type,this._map,r))}preclick(r){const c=s.extend({},r);c.type="preclick",this._map.fire(new Ri(c.type,this._map,c))}click(r,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(r),this._map.fire(new Ri(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new Ri(r.type,this._map,r))}mouseover(r){this._map.fire(new Ri(r.type,this._map,r))}mouseout(r){this._map.fire(new Ri(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Ns(r.type,this._map,r))}touchmove(r){this._map.fire(new Ns(r.type,this._map,r))}touchend(r){this._map.fire(new Ns(r.type,this._map,r))}touchcancel(r){this._map.fire(new Ns(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class pd{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new Ri(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ri("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new Ri(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class md{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,c){this.isEnabled()&&r.shiftKey&&r.button===0&&(xe(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(r,c){if(!this._active)return;const p=c;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=p,this._box||(this._box=F("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const v=Math.min(y.x,p.x),T=Math.max(y.x,p.x),C=Math.min(y.y,p.y),M=Math.max(y.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${v}px,${C}px)`,this._box.style.width=T-v+"px",this._box.style.height=M-C+"px")})}mouseupWindow(r,c){if(!this._active||r.button!==0)return;const p=this._startPos,y=c;if(this.reset(),Be(),p.x!==y.x||p.y!==y.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:v=>v.fitScreenCoordinates(p,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Te(),delete this._startPos,delete this._lastPos}_fireEvent(r,c){return this._map.fire(new s.Event(r,{originalEvent:c}))}}function uc(h,r){const c={};for(let p=0;p<h.length;p++)c[h[p].identifier]=r[p];return c}class Us{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,c,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const v=new s.pointGeometry(0,0);for(const T of y)v._add(T);return v.div(y.length)}(c),this.touches=uc(p,c)))}touchmove(r,c,p){if(this.aborted||!this.centroid)return;const y=uc(p,c);for(const v in this.touches){const T=this.touches[v],C=y[v];(!C||C.dist(T)>30)&&(this.aborted=!0)}}touchend(r,c,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class hc{constructor(r){this.singleTap=new Us(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,c,p){this.singleTap.touchstart(r,c,p)}touchmove(r,c,p){this.singleTap.touchmove(r,c,p)}touchend(r,c,p){const y=this.singleTap.touchend(r,c,p);if(y){const v=r.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(y)<30;if(v&&T||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class gd{constructor(){this._zoomIn=new hc({numTouches:1,numTaps:2}),this._zoomOut=new hc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,c,p){this._zoomIn.touchstart(r,c,p),this._zoomOut.touchstart(r,c,p)}touchmove(r,c,p){this._zoomIn.touchmove(r,c,p),this._zoomOut.touchmove(r,c,p)}touchend(r,c,p){const y=this._zoomIn.touchend(r,c,p),v=this._zoomOut.touchend(r,c,p);return y?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(y)},{originalEvent:r})}):v?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(v)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const _d={0:1,2:2};class fc{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,c){return!1}_move(r,c){return{}}mousedown(r,c){if(this._lastPoint)return;const p=Le(r);this._correctButton(r,p)&&(this._lastPoint=c,this._eventButton=p)}mousemoveWindow(r,c){const p=this._lastPoint;if(p){if(r.preventDefault(),this._eventButton!=null&&function(y,v){const T=_d[v];return y.buttons===void 0||(y.buttons&T)!==T}(r,this._eventButton))this.reset();else if(this._moved||!(c.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(p,c)}}mouseupWindow(r){this._lastPoint&&Le(r)===this._eventButton&&(this._moved&&Be(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yd extends fc{mousedown(r,c){super.mousedown(r,c),this._lastPoint&&(this._active=!0)}_correctButton(r,c){return c===0&&!r.ctrlKey}_move(r,c){return{around:c,panDelta:c.sub(r)}}}class rh extends fc{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const p=.8*(c.x-r.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(r){r.preventDefault()}}class Mi extends fc{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const p=-.5*(c.y-r.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(r){r.preventDefault()}}class ng{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0)}touchstart(r,c,p){return this._calculateTransform(r,c,p)}touchmove(r,c,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,c,p)}}touchend(r,c,p){this._calculateTransform(r,c,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,c,p){p.length>0&&(this._active=!0);const y=uc(p,c),v=new s.pointGeometry(0,0),T=new s.pointGeometry(0,0);let C=0;for(const z in y){const O=y[z],N=this._touches[z];N&&(v._add(O),T._add(O.sub(N)),C++,y[z]=O)}if(this._touches=y,C<this._minTouches||!T.mag())return;const M=T.div(C);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(C),panDelta:M}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class dc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,c,p){return{}}touchstart(r,c,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([c[0],c[1]]))}touchmove(r,c,p){const y=this._firstTwoTouches;if(!y)return;r.preventDefault();const[v,T]=y,C=pc(p,c,v),M=pc(p,c,T);if(!C||!M)return;const z=this._aroundCenter?null:C.add(M).div(2);return this._move([C,M],z,r)}touchend(r,c,p){if(!this._firstTwoTouches)return;const[y,v]=this._firstTwoTouches,T=pc(p,c,y),C=pc(p,c,v);T&&C||(this._active&&Be(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function pc(h,r,c){for(let p=0;p<h.length;p++)if(h[p].identifier===c)return r[p]}function vd(h,r){return Math.log(h/r)/Math.LN2}class Qr extends dc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,c){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(vd(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:vd(this._distance,p),pinchAround:c}}}function oh(h,r){return 180*h.angleWith(r)/Math.PI}class Vs extends dc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,c){const p=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:oh(this._vector,p),pinchAround:c}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const c=25/(Math.PI*this._minDiameter)*360,p=oh(r,this._startVector);return Math.abs(p)<c}}function yr(h){return Math.abs(h.y)>Math.abs(h.x)}class mc extends dc{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,yr(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,c,p){const y=this._lastPoints;if(!y)return;const v=r[0].sub(y[0]),T=r[1].sub(y[1]);return this._map._cooperativeGestures&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(v,T,p.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(v.y+T.y)/2*-.5})}gestureBeginsVertically(r,c,p){if(this._valid!==void 0)return this._valid;const y=r.mag()>=2,v=c.mag()>=2;if(!y&&!v)return;if(!y||!v)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const T=r.y>0==c.y>0;return yr(r)&&yr(c)&&T}}const Bt={panStep:100,bearingStep:15,pitchStep:10};class xd{constructor(){const r=Bt;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let c=0,p=0,y=0,v=0,T=0;switch(r.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),v=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),v=1);break;case 38:r.shiftKey?y=1:(r.preventDefault(),T=-1);break;case 40:r.shiftKey?y=-1:(r.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:C=>{const M=C.getZoom();C.easeTo({duration:300,easeId:"keyboardHandler",easing:bd,zoom:c?Math.round(M)+c*(r.shiftKey?2:1):M,bearing:C.getBearing()+p*this._bearingStep,pitch:C.getPitch()+y*this._pitchStep,offset:[-v*this._panStep,-T*this._panStep],center:C.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function bd(h){return h*(2-h)}const $s=4.000244140625;class Ha{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=r.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=s.exported.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,c!==0&&c%$s==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(y*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),r.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=r,this._delta-=c,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=Pe(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform,c=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const M=this._type==="wheel"&&Math.abs(this._delta)>$s?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*M)));this._delta<0&&z!==0&&(z=1/z);const O=c(),N=Math.pow(2,O),$=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):N;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom($*z))),this._type==="wheel"&&(this._startZoom=O,this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:c(),y=this._startZoom,v=this._easing;let T,C=!1;if(this._type==="wheel"&&y&&v){const M=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),z=v(M);T=s.number(y,p,z),M<1?this._frameId||(this._frameId=!0):C=!0}else T=p,C=!0;return this._active=!0,C&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!C,zoomDelta:T-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let c=s.ease;if(this._prevEase){const p=this._prevEase,y=(s.exported.now()-p.start)/p.duration,v=p.easing(y+.01)-p.easing(y),T=.27/Math.sqrt(v*v+1e-4)*.01,C=Math.sqrt(.0729-T*T);c=s.bezier(T,C,.25,1)}return this._prevEase={start:s.exported.now(),duration:r,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class wd{constructor(r,c){this._clickZoom=r,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Td{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,c){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(r.shiftKey?-1:1),around:p.unproject(c)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ed{constructor(){this._tap=new hc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,c,p){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=c[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(r,c,p))}touchmove(r,c,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=c[0],v=y.y-this._swipePoint.y;return this._swipePoint=y,r.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(r,c,p)}touchend(r,c,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(r,c,p)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cd{constructor(r,c,p){this._el=r,this._mousePan=c,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Sd{constructor(r,c,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=c,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Md{constructor(r,c,p,y){this._el=r,this._touchZoom=c,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Xa=h=>h.zoom||h.drag||h.pitch||h.rotate;class gc extends s.Event{}class sh{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,c){const p=s.sub([],c,r);this.radius=s.length(p[2]<0?s.div([],p,this.constants):[p[0],p[1],0])}projectRay(r){s.div(r,r,this.constants),s.normalize(r,r),s.mul$1(r,r,this.constants);const c=s.scale$2([],r,this.radius);if(c[2]>0){const p=s.scale$2([],[0,0,1],s.dot(c,[0,0,1])),y=s.scale$2([],s.normalize([],[c[0],c[1],0]),this.radius),v=s.add([],c,s.scale$2([],s.sub([],s.add([],y,p),c),2));c[0]=v[0],c[1]=v[1]}return c}}function Yo(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class Ad{constructor(r,c){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ih(r),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new sh,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),s.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[y,v,T]of this._listeners)y.addEventListener(v,y===s.window.document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[r,c,p]of this._listeners)r.removeEventListener(c,r===s.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(r){const c=this._map,p=c.getCanvasContainer();this._add("mapEvent",new dd(c,r));const y=c.boxZoom=new md(c,r);this._add("boxZoom",y);const v=new gd,T=new Td;c.doubleClickZoom=new wd(T,v),this._add("tapZoom",v),this._add("clickZoom",T);const C=new Ed;this._add("tapDragZoom",C);const M=c.touchPitch=new mc(c);this._add("touchPitch",M);const z=new rh(r),O=new Mi(r);c.dragRotate=new Sd(r,z,O),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);const N=new yd(r),$=new ng(c,r);c.dragPan=new Cd(p,N,$),this._add("mousePan",N),this._add("touchPan",$,["touchZoom","touchRotate"]);const K=new Vs,W=new Qr;c.touchZoomRotate=new Md(p,W,K,C),this._add("touchRotate",K,["touchPan","touchZoom"]),this._add("touchZoom",W,["touchPan","touchRotate"]),this._add("blockableMapEvent",new pd(c));const H=c.scrollZoom=new Ha(c,this);this._add("scrollZoom",H,["mousePan"]);const X=c.keyboard=new xd;this._add("keyboard",X);for(const q of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[q]&&c[q].enable(r[q])}_add(r,c,p){this._handlers.push({handlerName:r,handler:c,allowed:p}),this._handlersById[r]=c}stop(r){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Xa(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,c,p){for(const y in r)if(y!==p&&(!c||c.indexOf(y)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const c=[];for(const p of r)this._el.contains(p.target)&&c.push(p);return c}handleEvent(r,c){this._updatingCamera=!0;const p=r.type==="renderFrame",y=p?void 0:r,v={needsRenderFrame:!1},T={},C={},M=r.touches?this._getMapTouches(r.touches):void 0,z=M?Oe(this._el,M):p?void 0:Pe(this._el,r);for(const{handlerName:$,handler:K,allowed:W}of this._handlers){if(!K.isEnabled())continue;let H;this._blockedByActive(C,W,$)?K.reset():K[c||r.type]&&(H=K[c||r.type](r,z,M),this.mergeHandlerResult(v,T,H,$,y),H&&H.needsRenderFrame&&this._triggerRenderFrame()),(H||K.isActive())&&(C[$]=K)}const O={};for(const $ in this._previousActiveHandlers)C[$]||(O[$]=y);this._previousActiveHandlers=C,(Object.keys(O).length||Yo(v))&&(this._changes.push([v,T,O]),this._triggerRenderFrame()),(Object.keys(C).length||Yo(v))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=v;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))}mergeHandlerResult(r,c,p,y,v){if(!p)return;s.extend(r,p);const T={handlerName:y,originalEvent:p.originalEvent||v};p.zoomDelta!==void 0&&(c.zoom=T),p.panDelta!==void 0&&(c.drag=T),p.pitchDelta!==void 0&&(c.pitch=T),p.bearingDelta!==void 0&&(c.rotate=T)}_applyChanges(){const r={},c={},p={};for(const[y,v,T]of this._changes)y.panDelta&&(r.panDelta=(r.panDelta||new s.pointGeometry(0,0))._add(y.panDelta)),y.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(r.around=y.around),y.aroundCoord!==void 0&&(r.aroundCoord=y.aroundCoord),y.pinchAround!==void 0&&(r.pinchAround=y.pinchAround),y.noInertia&&(r.noInertia=y.noInertia),s.extend(c,v),s.extend(p,T);this._updateMapTransform(r,c,p),this._changes=[]}_updateMapTransform(r,c,p){const y=this._map,v=y.transform,T=te=>[te.x,te.y,te.z];if((te=>{const Y=this._eventsInProgress.drag;return Y&&!this._handlersById[Y.handlerName].isActive()})()&&!Yo(r)){const te=v.zoom;v.cameraElevationReference="sea",v.recenterOnTerrain(),v.cameraElevationReference="ground",te!==v.zoom&&this._map._update(!0)}if(!Yo(r))return void this._fireEvents(c,p,!0);let{panDelta:C,zoomDelta:M,bearingDelta:z,pitchDelta:O,around:N,aroundCoord:$,pinchAround:K}=r;K!==void 0&&(N=K),(te=>c.drag&&!this._eventsInProgress.drag)()&&N&&(this._dragOrigin=T(v.pointCoordinate3D(N)),this._trackingEllipsoid.setup(v._camera.position,this._dragOrigin)),v.cameraElevationReference="sea",y._stop(!0),N=N||y.transform.centerPoint,z&&(v.bearing+=z),O&&(v.pitch+=O),v._updateCameraState();const W=[0,0,0];if(C)if(v.projection.name==="mercator"){const te=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay(N).dir),Y=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay(N.sub(C)).dir);W[0]=Y[0]-te[0],W[1]=Y[1]-te[1]}else{const te=v.pointCoordinate(N);if(v.projection.name==="globe"){C=C.rotate(-v.angle);const Y=v._pixelsPerMercatorPixel/v.worldSize;W[0]=-C.x*s.mercatorScale(s.latFromMercatorY(te.y))*Y,W[1]=-C.y*s.mercatorScale(v.center.lat)*Y}else{const Y=v.pointCoordinate(N.sub(C));te&&Y&&(W[0]=Y.x-te.x,W[1]=Y.y-te.y)}}const H=v.zoom,X=[0,0,0];if(M){const te=T($||v.pointCoordinate3D(N)),Y={dir:s.normalize([],s.sub([],te,v._camera.position))};if(Y.dir[2]<0){const pe=v.zoomDeltaToMovement(te,M);s.scale$2(X,Y.dir,pe)}}const q=s.add(W,W,X);v._translateCameraConstrained(q),M&&Math.abs(v.zoom-H)>1e-4&&v.recenterOnTerrain(),v.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(c,p,!0)}_fireEvents(r,c,p){const y=Xa(this._eventsInProgress),v=Xa(r),T={};for(const O in r){const{originalEvent:N}=r[O];this._eventsInProgress[O]||(T[`${O}start`]=N),this._eventsInProgress[O]=r[O]}!y&&v&&this._fireEvent("movestart",v.originalEvent);for(const O in T)this._fireEvent(O,T[O]);v&&this._fireEvent("move",v.originalEvent);for(const O in r){const{originalEvent:N}=r[O];this._fireEvent(O,N)}const C={};let M;for(const O in this._eventsInProgress){const{handlerName:N,originalEvent:$}=this._eventsInProgress[O];this._handlersById[N].isActive()||(delete this._eventsInProgress[O],M=c[N]||$,C[`${O}end`]=M)}for(const O in C)this._fireEvent(O,C[O]);const z=Xa(this._eventsInProgress);if(p&&(y||v)&&!z){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;O?(N(O.bearing||this._map.getBearing())&&(O.bearing=0),this._map.easeTo(O,{originalEvent:M})):(this._map.fire(new s.Event("moveend",{originalEvent:M})),N(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,c){this._map.fire(new s.Event(r,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new gc("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ah="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Id extends s.Evented{constructor(r,c){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=c.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,c){return this.jumpTo({center:r},c)}panBy(r,c,p){return r=s.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,s.extend({offset:r},c),p)}panTo(r,c,p){return this.easeTo(s.extend({center:r},c),p)}getZoom(){return this.transform.zoom}setZoom(r,c){return this.jumpTo({zoom:r},c),this}zoomTo(r,c,p){return this.easeTo(s.extend({zoom:r},c),p)}zoomIn(r,c){return this.zoomTo(this.getZoom()+1,r,c),this}zoomOut(r,c){return this.zoomTo(this.getZoom()-1,r,c),this}getBearing(){return this.transform.bearing}setBearing(r,c){return this.jumpTo({bearing:r},c),this}getPadding(){return this.transform.padding}setPadding(r,c){return this.jumpTo({padding:r},c),this}rotateTo(r,c,p){return this.easeTo(s.extend({bearing:r},c),p)}resetNorth(r,c){return this.rotateTo(0,s.extend({duration:1e3},r),c),this}resetNorthPitch(r,c){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},r),c),this}snapToNorth(r,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,c):this}getPitch(){return this.transform.pitch}setPitch(r,c){return this.jumpTo({pitch:r},c),this}cameraForBounds(r,c){this.transform.projection.name==="globe"&&s.warnOnce('Globe projection does not support cameraForBounds API, this API may behave unexpectedly."'),r=s.LngLatBounds.convert(r);const p=c&&c.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),p,c)}_extendCameraOptions(r){const c={top:0,bottom:0,right:0,left:0};if(typeof(r=s.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const p=r.padding;r.padding={top:p,bottom:p,right:p,left:p}}return r.padding=s.extend(c,r.padding),r}_cameraForBoxAndBearing(r,c,p,y){const v=this._extendCameraOptions(y),T=this.transform,C=T.padding,M=T.project(s.LngLat.convert(r)),z=T.project(s.LngLat.convert(c)),O=new s.pointGeometry(M.x,z.y),N=new s.pointGeometry(z.x,M.y),$=-s.degToRad(p),K=M.rotate($),W=z.rotate($),H=O.rotate($),X=N.rotate($),q=new s.pointGeometry(Math.max(K.x,W.x,H.x,X.x),Math.max(K.y,W.y,H.y,X.y)),te=new s.pointGeometry(Math.min(K.x,W.x,H.x,X.x),Math.min(K.y,W.y,H.y,X.y)),Y=q.sub(te),pe=(T.width-((C.left||0)+(C.right||0)+v.padding.left+v.padding.right))/Y.x,fe=(T.height-((C.top||0)+(C.bottom||0)+v.padding.top+v.padding.bottom))/Y.y;if(fe<0||pe<0)return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const le=Math.min(T.scaleZoom(T.scale*Math.min(pe,fe)),v.maxZoom),de=typeof v.offset.x=="number"&&typeof v.offset.y=="number"?new s.pointGeometry(v.offset.x,v.offset.y):s.pointGeometry.convert(v.offset),he=new s.pointGeometry((v.padding.left-v.padding.right)/2,(v.padding.top-v.padding.bottom)/2).rotate(p*Math.PI/180),ve=de.add(he).mult(T.scale/T.zoomScale(le));return{center:T.unproject(M.add(z).div(2).sub(ve)),zoom:le,bearing:p}}_cameraForBox(r,c,p,y,v){const T=this._extendCameraOptions(v);p=p||0,y=y||0,r=s.LngLat.convert(r),c=s.LngLat.convert(c);const C=this.transform.clone();C.padding=T.padding;const M=this.getFreeCameraOptions(),z=new s.LngLat(.5*(r.lng+c.lng),.5*(r.lat+c.lat)),O=.5*(p+y);if(C._camera.position[2]<s.mercatorZfromAltitude(O,z.lat))return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");M.lookAtPoint(z),C.setFreeCameraOptions(M);const N=s.MercatorCoordinate.fromLngLat(r),$=s.MercatorCoordinate.fromLngLat(c),K=C.pointRayIntersection(C.centerPoint,O),W=[(H=C.rayIntersectionCoordinate(K)).x,H.y,H.z];var H;const X=C.screenPointToMercatorRay(C.centerPoint),q=C.projection.name!=="globe";let te,Y=0;do{const pe=Math.floor(C.zoom),fe=1<<pe,le=Math.min(fe*N.x,fe*$.x),de=Math.min(fe*N.y,fe*$.y),he=Math.max(fe*N.x,fe*$.x),ve=Math.max(fe*N.y,fe*$.y),ze=new s.Aabb([le,de,p],[he,ve,y]),pt=s.Frustum.fromInvProjectionMatrix(C.invProjMatrix,C.worldSize,pe,q);if(ze.intersects(pt)!==2){te&&(C._camera.position=s.scaleAndAdd([],C._camera.position,X.dir,-te),C._updateStateFromCamera());break}const Ce=s.sub([],C._camera.position,W);te=.5*s.length(Ce),C._camera.position=s.scaleAndAdd([],C._camera.position,X.dir,te);try{C._updateStateFromCamera()}catch{return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++Y<10);return{center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch}}fitBounds(r,c,p){return this.transform.projection.name==="globe"&&s.warnOnce("Globe projection does not support fitBounds API, this API may behave unexpectedly."),this._fitInternal(this.cameraForBounds(r,c),c,p)}_raycastElevationBox(r,c){const p=this.transform.elevation;if(!p)return;const y=new s.pointGeometry(r.x,c.y),v=new s.pointGeometry(c.x,r.y),T=p.pointCoordinate(r);if(!T)return;const C=p.pointCoordinate(c);if(!C)return;const M=p.pointCoordinate(y);if(!M)return;const z=p.pointCoordinate(v);if(!z)return;const O=new s.MercatorCoordinate(T[0],T[1]).toLngLat(),N=new s.MercatorCoordinate(C[0],C[1]).toLngLat(),$=new s.MercatorCoordinate(M[0],M[1]).toLngLat(),K=new s.MercatorCoordinate(z[0],z[1]).toLngLat(),W=Math.min(O.lng,Math.min(N.lng,Math.min($.lng,K.lng))),H=Math.min(O.lat,Math.min(N.lat,Math.min($.lat,K.lat))),X=Math.max(O.lng,Math.max(N.lng,Math.max($.lng,K.lng))),q=Math.max(O.lat,Math.max(N.lat,Math.max($.lat,K.lat))),te=Math.min(T[3],Math.min(C[3],Math.min(M[3],z[3]))),Y=Math.max(T[3],Math.max(C[3],Math.max(M[3],z[3])));return{minLngLat:new s.LngLat(W,H),maxLngLat:new s.LngLat(X,q),minAltitude:te,maxAltitude:Y}}fitScreenCoordinates(r,c,p,y,v){let T,C,M,z;this.transform.projection.name==="globe"&&s.warnOnce("Globe projection does not support fitScreenCoordinates API, this API may behave unexpectedly.");const O=s.pointGeometry.convert(r),N=s.pointGeometry.convert(c),$=this._raycastElevationBox(O,N);if($)T=$.minLngLat,C=$.maxLngLat,M=$.minAltitude,z=$.maxAltitude;else{if(this.transform.anyCornerOffEdge(O,N))return this;T=this.transform.pointLocation(O),C=this.transform.pointLocation(N)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(s.pointGeometry.convert(r)),this.transform.pointLocation(s.pointGeometry.convert(c)),p,y):this._cameraForBox(T,C,M,z,y),y,v)}_fitInternal(r,c,p){return r?(delete(c=s.extend(r,c)).padding,c.linear?this.easeTo(c,p):this.flyTo(c,p)):this}jumpTo(r,c){this.stop();const p=r.preloadOnly?this.transform.clone():this.transform;let y=!1,v=!1,T=!1;return"zoom"in r&&p.zoom!==+r.zoom&&(y=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=s.LngLat.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(v=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(T=!0,p.pitch=+r.pitch),r.padding==null||p.isPaddingEqual(r.padding)||(p.padding=r.padding),r.preloadOnly?(this._preloadTiles(p),this):(this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),y&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),v&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),T&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(ah),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,c){const p=this.transform;if(!p.projection.supportsFreeCamera)return s.warnOnce(ah),this;this.stop();const y=p.zoom,v=p.pitch,T=p.bearing;p.setFreeCameraOptions(r);const C=y!==p.zoom,M=v!==p.pitch,z=T!==p.bearing;return this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),C&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),z&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),M&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)),this}easeTo(r,c){this._stop(!1,r.easeId),((r=s.extend({offset:[0,0],duration:500,easing:s.ease},r)).animate===!1||!r.essential&&s.exported.prefersReducedMotion)&&(r.duration=0);const p=this.transform,y=this.getZoom(),v=this.getBearing(),T=this.getPitch(),C=this.getPadding(),M="zoom"in r?+r.zoom:y,z="bearing"in r?this._normalizeBearing(r.bearing,v):v,O="pitch"in r?+r.pitch:T,N="padding"in r?r.padding:p.padding,$=s.pointGeometry.convert(r.offset);let K,W,H;if(p.projection.name==="globe"){const ve=s.MercatorCoordinate.fromLngLat(p.center),ze=$.rotate(-p.angle);ve.x+=ze.x/p.worldSize,ve.y+=ze.y/p.worldSize;const pt=ve.toLngLat(),Ce=s.LngLat.convert(r.center||pt);this._normalizeCenter(Ce),K=p.centerPoint.add(ze),W=new s.pointGeometry(ve.x,ve.y).mult(p.worldSize),H=new s.pointGeometry(s.mercatorXfromLng(Ce.lng),s.mercatorYfromLat(Ce.lat)).mult(p.worldSize).sub(W)}else{K=p.centerPoint.add($);const ve=p.pointLocation(K),ze=s.LngLat.convert(r.center||ve);this._normalizeCenter(ze),W=p.project(ve),H=p.project(ze).sub(W)}const X=p.zoomScale(M-y);let q,te;r.around&&(q=s.LngLat.convert(r.around),te=p.locationPoint(q));const Y=this._zooming||M!==y,pe=this._rotating||v!==z,fe=this._pitching||O!==T,le=!p.isPaddingEqual(N),de=ve=>ze=>{if(Y&&(ve.zoom=s.number(y,M,ze)),pe&&(ve.bearing=s.number(v,z,ze)),fe&&(ve.pitch=s.number(T,O,ze)),le&&(ve.interpolatePadding(C,N,ze),K=ve.centerPoint.add($)),q)ve.setLocationAtPoint(q,te);else{const pt=ve.zoomScale(ve.zoom-y),Ce=M>y?Math.min(2,X):Math.max(.5,X),He=Math.pow(Ce,1-ze),et=ve.unproject(W.add(H.mult(ze*He)).mult(pt));ve.setLocationAtPoint(ve.renderWorldCopies?et.wrap():et,K)}return r.preloadOnly||this._fireMoveEvents(c),ve};if(r.preloadOnly){const ve=this._emulate(de,r.duration,p);return this._preloadTiles(ve),this}const he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Y,this._rotating=pe,this._pitching=fe,this._padding=le,this._easeId=r.easeId,this._prepareEase(c,r.noMoveStart,he),this._ease(de(p),ve=>{p.recenterOnTerrain(),this._afterEase(c,ve)},r),this}_prepareEase(r,c,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||p.moving||this.fire(new s.Event("movestart",r)),this._zooming&&!p.zooming&&this.fire(new s.Event("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new s.Event("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new s.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new s.Event("move",r)),this._zooming&&this.fire(new s.Event("zoom",r)),this._rotating&&this.fire(new s.Event("rotate",r)),this._pitching&&this.fire(new s.Event("pitch",r))}_afterEase(r,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,y=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new s.Event("zoomend",r)),y&&this.fire(new s.Event("rotateend",r)),v&&this.fire(new s.Event("pitchend",r)),this.fire(new s.Event("moveend",r))}flyTo(r,c){if(!r.essential&&s.exported.prefersReducedMotion){const It=s.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(It,c)}this.stop(),r=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},r);const p=this.transform,y=this.getZoom(),v=this.getBearing(),T=this.getPitch(),C=this.getPadding(),M="zoom"in r?s.clamp(+r.zoom,p.minZoom,p.maxZoom):y,z="bearing"in r?this._normalizeBearing(r.bearing,v):v,O="pitch"in r?+r.pitch:T,N="padding"in r?r.padding:p.padding,$=p.zoomScale(M-y),K=s.pointGeometry.convert(r.offset);let W=p.centerPoint.add(K);const H=p.pointLocation(W),X=s.LngLat.convert(r.center||H);this._normalizeCenter(X);const q=p.project(H),te=p.project(X).sub(q);let Y=r.curve;const pe=Math.max(p.width,p.height),fe=pe/$,le=te.mag();if("minZoom"in r){const It=s.clamp(Math.min(r.minZoom,y,M),p.minZoom,p.maxZoom),At=pe/p.zoomScale(It-y);Y=Math.sqrt(At/le*2)}const de=Y*Y;function he(It){const At=(fe*fe-pe*pe+(It?-1:1)*de*de*le*le)/(2*(It?fe:pe)*de*le);return Math.log(Math.sqrt(At*At+1)-At)}function ve(It){return(Math.exp(It)-Math.exp(-It))/2}function ze(It){return(Math.exp(It)+Math.exp(-It))/2}const pt=he(0);let Ce=function(It){return ze(pt)/ze(pt+Y*It)},He=function(It){return pe*((ze(pt)*(ve(At=pt+Y*It)/ze(At))-ve(pt))/de)/le;var At},et=(he(1)-pt)/Y;if(Math.abs(le)<1e-6||!isFinite(et)){if(Math.abs(pe-fe)<1e-6)return this.easeTo(r,c);const It=fe<pe?-1:1;et=Math.abs(Math.log(fe/pe))/Y,He=function(){return 0},Ce=function(At){return Math.exp(It*Y*At)}}r.duration="duration"in r?+r.duration:1e3*et/("screenSpeed"in r?+r.screenSpeed/Y:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const St=v!==z,je=O!==T,gt=!p.isPaddingEqual(N),Je=It=>At=>{const Nt=At*et,Zt=1/Ce(Nt);It.zoom=At===1?M:y+It.scaleZoom(Zt),St&&(It.bearing=s.number(v,z,At)),je&&(It.pitch=s.number(T,O,At)),gt&&(It.interpolatePadding(C,N,At),W=It.centerPoint.add(K));const tn=At===1?X:It.unproject(q.add(te.mult(He(Nt))).mult(Zt));return It.setLocationAtPoint(It.renderWorldCopies?tn.wrap():tn,W),It._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(c),It};if(r.preloadOnly){const It=this._emulate(Je,r.duration,p);return this._preloadTiles(It),this}return this._zooming=!0,this._rotating=St,this._pitching=je,this._padding=gt,this._prepareEase(c,!1),this._ease(Je(p),()=>this._afterEase(c),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,c)}if(!r){const p=this.handlers;p&&p.stop(!1)}return this}_ease(r,c,p){p.animate===!1||p.duration===0?(r(1),c()):(this._easeStart=s.exported.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,c){r=s.wrap(r,-180,180);const p=Math.abs(r-c);return Math.abs(r-360-c)<p&&(r-=360),Math.abs(r+360-c)<p&&(r+=360),r}_normalizeCenter(r){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const p=r.lng-c.center.lng;r.lng+=p>180?-360:p<-180?360:0}_emulate(r,c,p){const y=Math.ceil(15*c/1e3),v=[],T=r(p.clone());for(let C=0;C<=y;C++){const M=T(C/y);v.push(M.clone())}return v}}class lh{constructor(r={}){this.options=r,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const c=this.options&&this.options.compact;return this._map=r,this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=F("button","mapboxgl-ctrl-attrib-button",this._container),F("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=F("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,c){const p=this._map._getUIString(`AttributionControl.${c}`);r.setAttribute("aria-label",p),r.removeAttribute("title"),r.firstElementChild&&r.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(r){const p=c.reduce((y,v,T)=>(v.value&&(y+=`${v.key}=${v.value}${T<c.length-1?"&":""}`),y),"?");r.href=`${s.config.FEEDBACK_URL}/${p}#${nh(this._map,!0)}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const c=this._map.style._sourceCaches;for(const y in c){const v=c[y];if(v.used){const T=v.getSource();T.attribution&&r.indexOf(T.attribution)<0&&r.push(T.attribution)}}r.sort((y,v)=>y.length-v.length),r=r.filter((y,v)=>{for(let T=v+1;T<r.length;T++)if(r[T].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class ch{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=F("div","mapboxgl-ctrl");const c=F("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const c in r){const p=r[c].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const c=r[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class uh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const c=++this._id;return this._queue.push({callback:r,id:c,cancelled:!1}),c}remove(r){const c=this._currentlyRunning,p=c?this._queue.concat(c):this._queue;for(const y of p)if(y.id===r)return void(y.cancelled=!0)}run(r=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const p of c)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function hh(h,r,c){if(h=new s.LngLat(h.lng,h.lat),r){const p=new s.LngLat(h.lng-360,h.lat),y=new s.LngLat(h.lng+360,h.lat),v=360*Math.ceil(Math.abs(h.lng-c.center.lng)/360),T=c.locationPoint(h).distSqr(r),C=r.x<0||r.y<0||r.x>c.width||r.y>c.height;c.locationPoint(p).distSqr(r)<T&&(C||Math.abs(p.lng-c.center.lng)<v)?h=p:c.locationPoint(y).distSqr(r)<T&&(C||Math.abs(y.lng-c.center.lng)<v)&&(h=y)}for(;Math.abs(h.lng-c.center.lng)>180;){const p=c.locationPoint(h);if(p.x>=0&&p.y>=0&&p.x<=c.width&&p.y<=c.height)break;h.lng>c.center.lng?h.lng-=360:h.lng+=360}return h}const Ka={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class _c extends s.Evented{constructor(r,c){if(super(),(r instanceof s.window.HTMLElement||c)&&(r=s.extend({element:r},c)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),r&&r.element)this._element=r.element,this._offset=s.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=F("div");const y=41,v=27,T=G("svg",{display:"block",height:y*this._scale+"px",width:v*this._scale+"px",viewBox:`0 0 ${v} ${y}`},this._element),C=G("radialGradient",{id:"shadowGradient"},G("defs",{},T));G("stop",{offset:"10%","stop-opacity":.4},C),G("stop",{offset:"100%","stop-opacity":.05},C),G("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},T),G("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},T),G("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},T),G("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},T),this._offset=s.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()});const p=this._element.classList;for(const y in Ka)p.remove(`mapboxgl-marker-anchor-${y}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=s.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const c=r.code,p=r.charCode||r.keyCode;c!=="Space"&&c!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(r){const c=r.originalEvent.target,p=this._element;this._popup&&(c===p||p.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map;if(!r)return!1;const c=r.unproject(this._pos),p=r.getFreeCameraOptions();if(!p.position)return!1;const y=p.position.toLngLat();return y.distanceTo(c)<.9*y.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const c=this._pos;if(!c||c.x<0||c.x>r.transform.width||c.y<0||c.y>r.transform.height)return void this._clearFadeTimer();const p=r.unproject(c);let y;r._showingGlobe()&&s.isLngLatBehindGlobe(r.transform,this._lngLat)?y=0:(y=1-r._queryFogOpacity(p),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(y*=.2)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Ka[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${c.x}px,${c.y}px)
        `}_calculateXYTransform(){const r=this._pos,c=this._map,p=this.getPitchAlignment();if(!c||!r||p!=="map")return"";if(!c._showingGlobe()){const M=c.getPitch();return M?`rotateX(${M}deg)`:""}const y=s.radToDeg(s.globeTiltAtLngLat(c.transform,this._lngLat)),v=r.sub(s.globeCenterToScreenPoint(c.transform)),T=Math.abs(v.x)+Math.abs(v.y);if(T===0)return"";const C=y/T;return`rotateX(${-v.y*C}deg) rotateY(${v.x*C}deg)`}_calculateZTransform(){const r=this._pos,c=this._map;if(!c||!r)return"";let p=0;const y=this.getRotationAlignment();if(y==="map")if(c._showingGlobe()){const v=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),T=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(v);p=s.radToDeg(Math.atan2(T.y,T.x))-90}else p=-c.getBearing();else if(y==="horizon"){const v=s.smoothstep(4,6,c.getZoom()),T=s.globeCenterToScreenPoint(c.transform);T.y+=v*c.transform.height;const C=r.sub(T),M=s.radToDeg(Math.atan2(C.y,C.x));p=(M>90?M-270:M+90)*(1-v)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(r){s.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=hh(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),r===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=s.pointGeometry.convert(r),this._update(),this}_onMove(r){const c=this._map;if(c){if(!this._isDragging){const p=this._clickTolerance||c._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(r){const c=this._map;c&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos),this._pointerdownPos=r.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const c=this._map;return c&&(r?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}}class Pd{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const c=s.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,c,p){this._start=this.getValue(c),this._end=r,this._startTime=c,this._endTime=c+p}}const zd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Od={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Ya(h){h.parentNode&&h.parentNode.removeChild(h)}const kd={showCompass:!0,showZoom:!0,visualizePitch:!1};class fh{constructor(r,c,p=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new rh({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,p&&(this.mousePitch=new Mi({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(r,c){this.mouseRotate.mousedown(r,c),this.mousePitch&&this.mousePitch.mousedown(r,c),xe()}move(r,c){const p=this.map,y=this.mouseRotate.mousemoveWindow(r,c),v=y&&y.bearingDelta;if(v&&p.setBearing(p.getBearing()+v),this.mousePitch){const T=this.mousePitch.mousemoveWindow(r,c),C=T&&T.pitchDelta;C&&p.setPitch(p.getPitch()+C)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Te(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(s.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Pe(this.element,r)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Pe(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Oe(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=Oe(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Dd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},dh={maxWidth:100,unit:"metric"};function ph(h,r,c){const p=yc(r),y=p/r,v={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[c];this._map._requestDomTask(()=>{this._container.style.width=h*y+"px",this._container.innerHTML=`${p}&nbsp;${v}`})}function yc(h){const r=Math.pow(10,`${Math.floor(h)}`.length-1);let c=h/r;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:c>=1?1:function(p){const y=Math.pow(10,Math.ceil(-Math.log(p)/Math.LN10));return Math.round(p*y)/y}(c),r*c}const ig={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rg=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function vc(h=new s.pointGeometry(0,0),r="bottom"){if(typeof h=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(h,2)));switch(r){case"top":return new s.pointGeometry(0,h);case"top-left":return new s.pointGeometry(c,c);case"top-right":return new s.pointGeometry(-c,c);case"bottom":return new s.pointGeometry(0,-h);case"bottom-left":return new s.pointGeometry(c,-c);case"bottom-right":return new s.pointGeometry(-c,-c);case"left":return new s.pointGeometry(h,0);case"right":return new s.pointGeometry(-h,0)}return new s.pointGeometry(0,0)}return h instanceof s.pointGeometry||Array.isArray(h)?s.pointGeometry.convert(h):s.pointGeometry.convert(h[r]||[0,0])}const Ja={version:s.version,supported:k,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends Id{constructor(h){if((h=s.extend({},Od,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(h.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(h.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ga(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),h),this._interactive=h.interactive,this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._optimizeForTerrain=h.optimizeForTerrain,this._language=h.language==="auto"?s.window.navigator.language:h.language,this._worldview=h.worldview,this._renderTaskQueue=new uh,this._domRenderTaskQueue=new uh,this._controls=[],this._markers=[],this._mapId=s.uniqueId(),this._locale=s.extend({},zd,h.locale),this._clickTolerance=h.clickTolerance,this._cooperativeGestures=h.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Pd(0),this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,typeof h.container=="string"){if(this._container=s.window.document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),h.maxBounds&&this.setMaxBounds(h.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Ad(this,h),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.projection&&this.setProjection(h.projection),this._hash=h.hash&&new ud(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,s.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),h.attributionControl&&this.addControl(new lh({customAttribution:h.customAttribution})),this._logoControl=new ch,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new s.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new s.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(h,r){if(r===void 0&&(r=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=h.onAdd(this);this._controls.push(h);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(h);return r>-1&&this._controls.splice(r,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new s.Event("movestart",h)).fire(new s.Event("move",h)),this.fire(new s.Event("resize",h)),r&&this.fire(new s.Event("moveend",h)),this}getBounds(){return this.transform.projection.name==="globe"&&s.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly."'),this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(h){return this.transform.setMaxBounds(s.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h==null?-2:h)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h?this.setZoom(h):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h==null?22:h)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h?this.setZoom(h):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h==null?0:h)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h?this.setPitch(h):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h==null?85:h)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h?this.setPitch(h):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this._update()}getLanguage(){return this._language}setLanguage(h){if(this._language=h==="auto"?s.window.navigator.language:h,this.style)for(const r in this.style._sourceCaches){const c=this.style._sourceCaches[r]._source;c._setLanguage&&c._setLanguage(this._language)}for(const r of this._controls)r._setLanguage&&r._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(h){if(this._worldview=h,this.style)for(const r in this.style._sourceCaches){const c=this.style._sourceCaches[r]._source;c._setWorldview&&c._setWorldview(h)}return this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(h){return this._lazyInitEmptyStyle(),h?typeof h=="string"&&(h={name:h}):h=null,this._useExplicitProjection=!!h,this._prioritizeAndUpdateProjection(h,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const h=this.transform,r=h.projection.name;let c;r==="globe"&&h.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(h.setMercatorFromTransition(),c=!0):r==="mercator"&&h.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(h.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(h,r){return this._updateProjection(h||r||{name:"mercator"})}_updateProjection(h){let r;if(r=h.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(h),this.style.applyProjectionUpdate(),r){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0)}return this}project(h){return this.transform.locationPoint3D(s.LngLat.convert(h))}unproject(h){return this.transform.pointLocation3D(s.pointGeometry.convert(h))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(h,r,c){if(h==="mouseenter"||h==="mouseover"){let p=!1;const y=T=>{const C=r.filter(z=>this.getLayer(z)),M=C.length?this.queryRenderedFeatures(T.point,{layers:C}):[];M.length?p||(p=!0,c.call(this,new Ri(h,this,T.originalEvent,{features:M}))):p=!1},v=()=>{p=!1};return{layers:new Set(r),listener:c,delegates:{mousemove:y,mouseout:v}}}if(h==="mouseleave"||h==="mouseout"){let p=!1;const y=T=>{const C=r.filter(M=>this.getLayer(M));(C.length?this.queryRenderedFeatures(T.point,{layers:C}):[]).length?p=!0:p&&(p=!1,c.call(this,new Ri(h,this,T.originalEvent)))},v=T=>{p&&(p=!1,c.call(this,new Ri(h,this,T.originalEvent)))};return{layers:new Set(r),listener:c,delegates:{mousemove:y,mouseout:v}}}{const p=y=>{const v=r.filter(C=>this.getLayer(C)),T=v.length?this.queryRenderedFeatures(y.point,{layers:v}):[];T.length&&(y.features=T,c.call(this,y),delete y.features)};return{layers:new Set(r),listener:c,delegates:{[h]:p}}}}on(h,r,c){if(c===void 0)return super.on(h,r);Array.isArray(r)||(r=[r]);const p=this._createDelegatedListener(h,r,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(h,r,c){if(c===void 0)return super.once(h,r);Array.isArray(r)||(r=[r]);const p=this._createDelegatedListener(h,r,c);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(h,r,c){if(c===void 0)return super.off(h,r);r=new Set(Array.isArray(r)?r:[r]);const p=(v,T)=>{if(v.size!==T.size)return!1;for(const C of v)if(!T.has(C))return!1;return!0},y=this._delegatedListeners?this._delegatedListeners[h]:void 0;return y&&(v=>{for(let T=0;T<v.length;T++){const C=v[T];if(C.listener===c&&p(C.layers,r)){for(const M in C.delegates)this.off(M,C.delegates[M]);return v.splice(T,1),this}}})(y),this}queryRenderedFeatures(h,r){return this.style?(r!==void 0||h===void 0||h instanceof s.pointGeometry||Array.isArray(h)||(r=h,h=void 0),this.style.queryRenderedFeatures(h=h||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(h,r){return this.style.querySourceFeatures(h,r)}queryTerrainElevation(h,r){const c=this.transform.elevation;return c?(r=s.extend({},{exaggerated:!0},r),c.getAtPoint(s.MercatorCoordinate.fromLngLat(h),null,r.exaggerated)):null}setStyle(h,r){return(r=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&h?(this._diffStyle(h,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(h,r))}_getUIString(h){const r=this._locale[h];if(r==null)throw new Error(`Missing UI string '${h}'`);return r}_updateStyle(h,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),h&&(this.style=new _r(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new _r(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,r){if(typeof h=="string"){const c=this._requestManager.normalizeStyleURL(h),p=this._requestManager.transformRequest(c,s.ResourceType.Style);s.getJSON(p,(y,v)=>{y?this.fire(new s.ErrorEvent(y)):v&&this._updateDiff(v,r)})}else typeof h=="object"&&this._updateDiff(h,r)}_updateDiff(h,r){try{this.style.setState(h)&&this._update(!0)}catch(c){s.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(h,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(h,r){return this._lazyInitEmptyStyle(),this.style.addSource(h,r),this._update(!0)}isSourceLoaded(h){return!!this.style&&this.style._isSourceCacheLoaded(h)}areTilesLoaded(){const h=this.style&&this.style._sourceCaches;for(const r in h){const c=h[r]._tiles;for(const p in c){const y=c[p];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}addSourceType(h,r,c){this._lazyInitEmptyStyle(),this.style.addSourceType(h,r,c)}removeSource(h){return this.style.removeSource(h),this._updateTerrain(),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,r,{pixelRatio:c=1,sdf:p=!1,stretchX:y,stretchY:v,content:T}={}){if(this._lazyInitEmptyStyle(),r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap){const{width:C,height:M,data:z}=s.exported.getImageData(r);this.style.addImage(h,{data:new s.RGBAImage({width:C,height:M},z),pixelRatio:c,stretchX:y,stretchY:v,content:T,sdf:p,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:C,height:M}=r,z=r;this.style.addImage(h,{data:new s.RGBAImage({width:C,height:M},new Uint8Array(z.data)),pixelRatio:c,stretchX:y,stretchY:v,content:T,sdf:p,version:0,userImage:z}),z.onAdd&&z.onAdd(this,h)}}updateImage(h,r){const c=this.style.getImage(h);if(!c)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap?s.exported.getImageData(r):r,{width:y,height:v}=p;y!==void 0&&v!==void 0?y===c.data.width&&v===c.data.height?(c.data.replace(p.data,!(r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap)),this.style.updateImage(h,c)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${y}, ${v})
                must be that same as the previous version of the image
                (${c.data.width}, ${c.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,r){s.getImage(this._requestManager.transformRequest(h,s.ResourceType.Image),(c,p)=>{r(c,p instanceof s.window.HTMLImageElement?s.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(h,r){return this._lazyInitEmptyStyle(),this.style.addLayer(h,r),this._update(!0)}moveLayer(h,r){return this.style.moveLayer(h,r),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,r,c){return this.style.setLayerZoomRange(h,r,c),this._update(!0)}setFilter(h,r,c={}){return this.style.setFilter(h,r,c),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,r,c,p={}){return this.style.setPaintProperty(h,r,c,p),this._update(!0)}getPaintProperty(h,r){return this.style.getPaintProperty(h,r)}setLayoutProperty(h,r,c,p={}){return this.style.setLayoutProperty(h,r,c,p),this._update(!0)}getLayoutProperty(h,r){return this.style.getLayoutProperty(h,r)}setLight(h,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(h){return this._lazyInitEmptyStyle(),!h&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(h),this.transform):0}setFeatureState(h,r){return this.style.setFeatureState(h,r),this._update()}removeFeatureState(h,r){return this.style.removeFeatureState(h,r),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}_updateContainerDimensions(){if(!this._container)return;const h=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let c,p,y,v=this._container;for(;v&&(!p||!y);){const T=s.window.getComputedStyle(v).transform;T&&T!=="none"&&(c=T.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(p=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(y=c[3])),v=v.parentElement}this._containerWidth=p?Math.abs(h/p):h,this._containerHeight=y?Math.abs(r/y):r}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=F("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=F("div","mapboxgl-canvas-container",h);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=F("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=F("div","mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{p[y]=F("div",`mapboxgl-ctrl-${y}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,r){const c=s.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(h),this._canvas.height=c*Math.ceil(r),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${r}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const r=this._markers.indexOf(h);r!==-1&&this._markers.splice(r,1)}_setupPainter(){const h=s.extend({},k.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);r?(s.storeAuthState(r,!0),this.painter=new Yu(r,this.transform),this.on("data",c=>{c.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(r)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.loaded()||this.loaded()&&!this.isMoving()?h():this._domRenderTaskQueue.add(h)}_render(h){let r;const c=this.painter.context.extTimerQuery,p=s.exported.now();if(this.listens("gpu-timing-frame")&&(r=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;this._updateProjectionTransition();let y=!1;const v=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const M=this.transform.zoom,z=this.transform.pitch,O=s.exported.now();this.style.zoomHistory.update(M,O);const N=new s.EvaluationParameters(M,{now:O,fadeDuration:v,pitch:z,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),$=N.crossFadingFactor();$===1&&$===this._crossFadingFactor||(y=!0,this._crossFadingFactor=$),this.style.update(N)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let T=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),T=this._updateAverageElevation(p),this.style._updateSources(this.transform),this._forceMarkerUpdate()):T=this._updateAverageElevation(p),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,v,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||y)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const M=s.exported.now()-p;c.endQueryEXT(c.TIME_ELAPSED_EXT,r),setTimeout(()=>{const z=c.getQueryObjectEXT(r,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(r),this.fire(new s.Event("gpu-timing-frame",{cpuTime:M,gpuTime:z})),s.window.performance.mark("frame-gpu",{startTime:p,detail:{gpuTime:z}})},50)}if(this.listens("gpu-timing-layer")){const M=this.painter.collectGpuTimers();setTimeout(()=>{const z=this.painter.queryGpuTimers(M);this.fire(new s.Event("gpu-timing-layer",{layerTimes:z}))},50)}if(this.listens("gpu-timing-deferred-render")){const M=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const z=this.painter.queryGpuTimeDeferredRender(M);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:z}))},50)}const C=this._sourcesDirty||this._styleDirty||this._placementDirty||T;if(C||this._repaint)this.triggerRepaint();else{const M=!this.isMoving()&&this.loaded();if(M&&(T=this._updateAverageElevation(p,!0)),T)this.triggerRepaint();else if(this._triggerFrame(!1),M&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const z=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||C||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const h of this._markers)h._update()}_updateAverageElevation(h,r=!1){const c=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);if((r||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const p=this.transform.averageElevation;let y=this.transform.sampleAverageElevation(),v=!1;this.transform.elevation&&(v=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(y)?y=0:this._averageElevationLastSampledAt=h;const T=Math.abs(p-y);if(T>1){if(this._isInitialLoad||v)return this._averageElevation.jumpTo(y),c(y);this._averageElevation.easeTo(y,h,300)}else if(T>1e-4)return this._averageElevation.jumpTo(y),c(y)}return!!this._averageElevation.isEasing(h)&&c(this._averageElevation.getValue(h))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,h=>{if(h&&(h.message===s.AUTH_ERR_MSG||h.status===401)){const r=this.painter.context.gl;s.storeAuthState(r,!1),this._logoControl instanceof ch&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const c=this.painter.context.gl,p=c.createFramebuffer();function y(v){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,v,0);const T=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,T),T}return c.bindFramebuffer(c.FRAMEBUFFER,p),this._canvasPixelComparison(y(h),r.canvasCopies.map(y),r.timeStamps)}_canvasPixelComparison(h,r,c){let p=c[1]-c[0];const y=h.length/4;for(let v=0;v<r.length;v++){const T=r[v];let C=0;for(let M=0;M<T.length;M+=4)T[M]===h[M]&&T[M+1]===h[M+1]&&T[M+2]===h[M+2]&&T[M+3]===h[M+3]&&(C+=1);p+=(c[v+2]-c[v+1])*(1-C/y)}return p}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),Ya(this._canvasContainer),Ya(this._controlContainer),Ya(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=s.exported.frame(r=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(r)}))}_preloadTiles(h){const r=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(r,(c,p)=>c._preloadTiles(h,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}_setCacheLimits(h,r){s.setCacheLimits(h,r)}get version(){return s.version}},NavigationControl:class{constructor(h){this.options=s.extend({},kd,h),this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),F("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),F("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:r}):c.resetNorth({},{originalEvent:r}))}),this._compassIcon=F("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map;if(!h)return;const r=h.getZoom(),c=r===h.getMaxZoom(),p=r===h.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const h=this._map;if(!h)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(h.transform.pitch*(Math.PI/180)),.5)}) rotateX(${h.transform.pitch}deg) rotateZ(${h.transform.angle*(180/Math.PI)}deg)`:`rotate(${h.transform.angle*(180/Math.PI)}deg)`;h._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),h.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&h.on("pitch",this._rotateCompassArrow),h.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new fh(h,this._compass,this.options.visualizePitch)),this._container}onRemove(){const h=this._map;h&&(this._container.remove(),this.options.showZoom&&h.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&h.off("pitch",this._rotateCompassArrow),h.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(h,r){const c=F("button",h,this._container);return c.type="button",c.addEventListener("click",r),c}_setButtonTitle(h,r){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${r}`);h.setAttribute("aria-label",c),h.firstElementChild&&h.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends s.Evented{constructor(h){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},Dd,h),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Za(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(h){return this._map=h,this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(h){this._supportsGeolocation!==void 0?h(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(r=>{this._supportsGeolocation=r.state!=="denied",h(this._supportsGeolocation)}):(this._supportsGeolocation=!!this.options.geolocation,h(this._supportsGeolocation))}_isOutOfMapMaxBounds(h){const r=this._map.getMaxBounds(),c=h.coords;return!!r&&(c.longitude<r.getWest()||c.longitude>r.getEast()||c.latitude<r.getSouth()||c.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",h)),this._finish()}}_updateCamera(h){const r=new s.LngLat(h.coords.longitude,h.coords.latitude),c=h.coords.accuracy,p=this._map.getBearing(),y=s.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(c),y,{geolocateSource:!0})}_updateMarker(h){if(h){const r=new s.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.transform,r=s.mercatorZfromAltitude(1,h._center.lat)*h.worldSize,c=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=F("button","mapboxgl-ctrl-geolocate",this._container),F("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=F("div","mapboxgl-user-location"),this._dotElement.appendChild(F("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(F("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new _c({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=F("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _c({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:h.absolute===!0&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(h={maximumAge:6e5,timeout:0},this._noTimeout=!0):(h=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&h()}).catch(console.error):h()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:lh,ScaleControl:class{constructor(h){this.options=s.extend({},dh,h),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=ph.bind(this)),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const h=this.options.maxWidth||100,r=this._map,c=r._containerHeight/2,p=r._containerWidth/2-h/2,y=r.unproject([p,c]),v=r.unproject([p+h,c]),T=y.distanceTo(v);if(this.options.unit==="imperial"){const C=3.2808*T;C>5280?this._setScale(h,C/5280,"mile"):this._setScale(h,C,"foot")}else this.options.unit==="nautical"?this._setScale(h,T/1852,"nautical-mile"):T>=1e3?this._setScale(h,T/1e3,"kilometer"):this._setScale(h,T,"meter")}_setScale(h,r,c){const p=yc(r),y=p/r;this._map._requestDomTask(()=>{this._container.style.width=h*y+"px",this._container.innerHTML=c!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:c}).format(p):`${p}&nbsp;nm`})}onAdd(h){return this._map=h,this._language=h.getLanguage(),this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(h){this._language=h,this._update()}setUnit(h){this.options.unit=h,this._update()}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof s.window.HTMLElement?this._container=h.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=F("button","mapboxgl-ctrl-fullscreen",this._controlContainer);F("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",h)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(h){super(),this.options=s.extend(Object.create(ig),h),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&h.on("preclick",this._onClose),this.options.closeOnMove&&h.on("move",this._onClose),h.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(h.on("mousemove",this._onMouseEvent),h.on("mouseup",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")):h.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const h=this._map;return h&&(h.off("move",this._update),h.off("move",this._onClose),h.off("preclick",this._onClose),h.off("click",this._onClose),h.off("remove",this.remove),h.off("mousemove",this._onMouseEvent),h.off("mouseup",this._onMouseEvent),h.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){this._lngLat=s.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const h=this._map;return h&&(h.off("move",this._update),h.on("mousemove",this._onMouseEvent),h.on("drag",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(s.window.document.createTextNode(h))}setHTML(h){const r=s.window.document.createDocumentFragment(),c=s.window.document.createElement("body");let p;for(c.innerHTML=h;p=c.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=F("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(h),this.options.closeButton){const c=this._closeButton=F("button","mapboxgl-popup-close-button",r);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let r;return this._classList.delete(h)?r=!1:(this._classList.add(h),r=!0),this._updateClassList(),r}_onMouseEvent(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const r=this._map,c=this._container,p=this._pos;if(!r||!c||!p)return"bottom";const y=c.offsetWidth,v=c.offsetHeight,T=p.x<y/2,C=p.x>r.transform.width-y/2;if(p.y+h<v)return T?"top-left":C?"top-right":"top";if(p.y>r.transform.height-v){if(T)return"bottom-left";if(C)return"bottom-right"}return T?"left":C?"right":"bottom"}_updateClassList(){const h=this._container;if(!h)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),h.className=r.join(" ")}_update(h){const r=this._map,c=this._content;if(!r||!this._lngLat&&!this._trackPointer||!c)return;let p=this._container;if(p||(p=this._container=F("div","mapboxgl-popup",r.getContainer()),this._tip=F("div","mapboxgl-popup-tip",p),p.appendChild(c)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=hh(this._lngLat,this._pos,r.transform)),!this._trackPointer||h){const y=this._pos=this._trackPointer&&h?h:r.project(this._lngLat),v=vc(this.options.offset),T=this._anchor=this._getAnchor(v.y),C=vc(this.options.offset,T),M=y.add(C).round();r._requestDomTask(()=>{this._container&&T&&(this._container.style.transform=`${Ka[T]} translate(${M.x}px,${M.y}px)`)})}if(!this._marker&&r._showingGlobe()){const y=s.isLngLatBehindGlobe(r.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(rg);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._container&&(this._container.style.opacity=`${h}`),this._content&&(this._content.style.pointerEvents=h?"auto":"none")}},Marker:_c,Style:_r,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:kt,Evented:s.Evented,config:s.config,prewarm:function(){Fn().acquire(Vt)},clearPrewarmedResources:function(){const h=mn;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(Vt),mn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(h){s.config.ACCESS_TOKEN=h},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(h){s.config.API_URL=h},get workerCount(){return Jt.workerCount},set workerCount(h){Jt.workerCount=h},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){s.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){s.clearTileCache(h)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Ja});var E=g;return E})})(hS);const I2=hS.exports,L6=On({data(){return{map:null}},mounted(){const t=this;I2.accessToken="pk.eyJ1IjoiYm9sbGF0aWFsZnJlZG8iLCJhIjoiY2xhNzdsaXk0MTdwaDNzcHF6ZWd1MTh3YSJ9.taSKUWamlEA6BuZ3UPEqGA";const o=new I2.Map({container:t.$refs.map,style:"mapbox://styles/mapbox/dark-v10",center:[-105.55443737719791,40.09393206067918],zoom:9,projection:"globe"});o.on("style.load",()=>{o.setFog({})}),this.map=o}}),R6={class:"h-full",ref:"map"};function B6(t,o,l,f,g,x){return fr(),pa("div",R6,null,512)}const F6=Zf(L6,[["render",B6]]),j6="FeatureCollection",N6=[{type:"Feature",properties:{name:"Denver area"},geometry:{coordinates:[[[-105.55443737719791,40.09393206067918],[-105.55443737719791,39.456497234557105],[-104.40850539328748,39.456497234557105],[-104.40850539328748,40.09393206067918],[-105.55443737719791,40.09393206067918]]],type:"Polygon"}},{type:"Feature",properties:{name:"BT001"},geometry:{coordinates:[-104.8412349536454,39.83905133150006],type:"Point"}},{type:"Feature",properties:{name:"BT002"},geometry:{coordinates:[-105.11369430646307,39.598659399389334],type:"Point"}},{type:"Feature",properties:{name:"BT003"},geometry:{coordinates:[-104.7771268706293,38.94729276882933],type:"Point"}}],U6={type:j6,features:N6},V6={data(){return{geoJsonElements:U6}},methods:{addFeatures(){const t=this.$refs.map.map;t.addSource("features",{type:"geojson",data:this.geoJsonElements}),t.addLayer({id:"park-boundary",type:"fill",source:"features",paint:{"fill-color":"#888888","fill-opacity":.4},filter:["==","$type","Polygon"]}),t.addLayer({id:"park-volcanoes",type:"circle",source:"features",paint:{"circle-radius":6,"circle-color":"#B42222"},filter:["==","$type","Point"]})}},mounted(){this.$refs.map.map.on("load",()=>{this.addFeatures()})}},$6={class:"h-full"};function G6(t,o,l,f,g,x){const E=F6;return fr(),pa("div",$6,[Me(E,{ref:"map"},null,512)])}const Z6=Zf(V6,[["render",G6]]),q6={},W6=la("h1",{class:"aboutclass"},"About",-1),H6=[W6];function X6(t,o,l,f,g,x){return fr(),pa("div",null,H6)}const K6=Zf(q6,[["render",X6]]),Y6=[{path:"/",component:Z6},{path:"/about",component:K6}],J6=d6({history:IF(),routes:Y6}),Q6=()=>{BC({prefix:"icon",icons:{account:{body:'<path d="M11.5 14c4.142 0 7.5 1.567 7.5 3.5V20H4v-2.5c0-1.933 3.358-3.5 7.5-3.5zm6.5 3.5c0-1.38-2.91-2.5-6.5-2.5S5 16.12 5 17.5V19h13v-1.5zM11.5 5a3.5 3.5 0 1 1 0 7a3.5 3.5 0 0 1 0-7zm0 1a2.5 2.5 0 1 0 0 5a2.5 2.5 0 0 0 0-5z" fill="currentColor"/>'},home:{body:'<path d="M16 8.414l-4.5-4.5L4.414 11H6v8h3v-6h5v6h3v-8h1.586L17 9.414V6h-1v2.414zM2 12l9.5-9.5L15 6V5h3v4l3 3h-3v7.998h-5v-6h-3v6H5V12H2z" fill="currentColor"/>'},globe:{body:'<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" viewBox="0 0 36 36"><path fill="currentColor" d="M26.58 32h-18a1 1 0 1 0 0 2h18a1 1 0 0 0 0-2Z" class="clr-i-outline clr-i-outline-path-1"/><path fill="currentColor" d="M17.75 2a14 14 0 0 0-14 14c0 .45 0 .89.07 1.33A14 14 0 1 0 17.75 2Zm0 2a12 12 0 0 1 8.44 3.48v1A18.51 18.51 0 0 0 14 8.53a2.33 2.33 0 0 0-1.14-.61h-.25c-.12-.42-.23-.84-.32-1.27s-.14-.81-.19-1.22A11.92 11.92 0 0 1 17.75 4Zm-3 5.87a17 17 0 0 1 11.17.13a16.9 16.9 0 0 1-3.11 7a2.28 2.28 0 0 0-2.58.57c-.35-.2-.7-.4-1-.63a16 16 0 0 1-4.93-5.23a2.25 2.25 0 0 0 .47-1.77Zm-4-3.6c0 .21.06.43.1.64c.09.44.21.87.33 1.3a2.28 2.28 0 0 0-1.1 2.25a18.32 18.32 0 0 0-4.18 3.76a12 12 0 0 1 4.86-7.95Zm0 15.71a2.34 2.34 0 0 0-1.55 1.76h-.64a11.94 11.94 0 0 1-2.76-6.82l.11-.19a16.9 16.9 0 0 1 4.81-4.89a2.31 2.31 0 0 0 2.28.63a17.53 17.53 0 0 0 5.35 5.65c.41.27.83.52 1.25.76a2.32 2.32 0 0 0 .18 1.12a16.94 16.94 0 0 1-6.2 3.11A2.34 2.34 0 0 0 10.76 22Zm7 6a11.92 11.92 0 0 1-5.81-1.51l.28-.06a2.34 2.34 0 0 0 1.57-1.79a18.43 18.43 0 0 0 7-3.5a2.29 2.29 0 0 0 3-.62a17.41 17.41 0 0 0 4.32.56h.53A12 12 0 0 1 17.75 28Zm6.51-8.9a2.33 2.33 0 0 0-.33-1.19a18.4 18.4 0 0 0 3.39-7.37q.75.35 1.48.78a12 12 0 0 1 .42 8.2a16 16 0 0 1-4.95-.39Z" class="clr-i-outline clr-i-outline-path-2"/><path fill="none" d="M0 0h36v36H0z"/></svg>'},sidebaropen:{body:'<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" viewBox="0 0 36 36"><g transform="rotate(90 18 18)"><path fill="currentColor" d="M31 31H5a1 1 0 0 0 0 2h26a1 1 0 0 0 0-2ZM8.81 15L17 6.83v20.65a1 1 0 0 0 2 0V6.83L27.19 15a1 1 0 0 0 1.41-1.41L18 3L7.39 13.61A1 1 0 1 0 8.81 15Z" class="clr-i-outline clr-i-outline-path-1"/><path fill="none" d="M0 0h36v36H0z"/></g></svg>'},sidebarclose:{body:'<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" viewBox="0 0 36 36"><g transform="rotate(-90 18 18)"><path fill="currentColor" d="M31 31H5a1 1 0 0 0 0 2h26a1 1 0 0 0 0-2ZM8.81 15L17 6.83v20.65a1 1 0 0 0 2 0V6.83L27.19 15a1 1 0 0 0 1.41-1.41L18 3L7.39 13.61A1 1 0 1 0 8.81 15Z" class="clr-i-outline clr-i-outline-path-1"/><path fill="none" d="M0 0h36v36H0z"/></g></svg>'},table:{body:'<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path fill="currentColor" d="M4 6h18v2H4zm0 6h18v2H4zm0 6h18v2H4zm0 6h18v2H4zM26 6h2v2h-2zm0 6h2v2h-2zm0 6h2v2h-2zm0 6h2v2h-2z"/></svg>'},settings:{body:'<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" viewBox="0 0 36 36"><path fill="currentColor" d="M18.1 11c-3.9 0-7 3.1-7 7s3.1 7 7 7s7-3.1 7-7s-3.1-7-7-7zm0 12c-2.8 0-5-2.2-5-5s2.2-5 5-5s5 2.2 5 5s-2.2 5-5 5z" class="clr-i-outline clr-i-outline-path-1"/><path fill="currentColor" d="m32.8 14.7l-2.8-.9l-.6-1.5l1.4-2.6c.3-.6.2-1.4-.3-1.9l-2.4-2.4c-.5-.5-1.3-.6-1.9-.3l-2.6 1.4l-1.5-.6l-.9-2.8C21 2.5 20.4 2 19.7 2h-3.4c-.7 0-1.3.5-1.4 1.2L14 6c-.6.1-1.1.3-1.6.6L9.8 5.2c-.6-.3-1.4-.2-1.9.3L5.5 7.9c-.5.5-.6 1.3-.3 1.9l1.3 2.5c-.2.5-.4 1.1-.6 1.6l-2.8.9c-.6.2-1.1.8-1.1 1.5v3.4c0 .7.5 1.3 1.2 1.5l2.8.9l.6 1.5l-1.4 2.6c-.3.6-.2 1.4.3 1.9l2.4 2.4c.5.5 1.3.6 1.9.3l2.6-1.4l1.5.6l.9 2.9c.2.6.8 1.1 1.5 1.1h3.4c.7 0 1.3-.5 1.5-1.1l.9-2.9l1.5-.6l2.6 1.4c.6.3 1.4.2 1.9-.3l2.4-2.4c.5-.5.6-1.3.3-1.9l-1.4-2.6l.6-1.5l2.9-.9c.6-.2 1.1-.8 1.1-1.5v-3.4c0-.7-.5-1.4-1.2-1.6zm-.8 4.7l-3.6 1.1l-.1.5l-.9 2.1l-.3.5l1.8 3.3l-2 2l-3.3-1.8l-.5.3c-.7.4-1.4.7-2.1.9l-.5.1l-1.1 3.6h-2.8l-1.1-3.6l-.5-.1l-2.1-.9l-.5-.3l-3.3 1.8l-2-2l1.8-3.3l-.3-.5c-.4-.7-.7-1.4-.9-2.1l-.1-.5L4 19.4v-2.8l3.4-1l.2-.5c.2-.8.5-1.5.9-2.2l.3-.5l-1.7-3.3l2-2l3.2 1.8l.5-.3c.7-.4 1.4-.7 2.2-.9l.5-.2L16.6 4h2.8l1.1 3.5l.5.2c.7.2 1.4.5 2.1.9l.5.3l3.3-1.8l2 2l-1.8 3.3l.3.5c.4.7.7 1.4.9 2.1l.1.5l3.6 1.1v2.8z" class="clr-i-outline clr-i-outline-path-2"/><path fill="none" d="M0 0h36v36H0z"/></svg>'},notification:{body:'<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" viewBox="0 0 36 36"><path fill="currentColor" d="M32.51 27.83A14.4 14.4 0 0 1 30 24.9a12.63 12.63 0 0 1-1.35-4.81v-4.94A10.81 10.81 0 0 0 19.21 4.4V3.11a1.33 1.33 0 1 0-2.67 0v1.31a10.81 10.81 0 0 0-9.33 10.73v4.94a12.63 12.63 0 0 1-1.35 4.81a14.4 14.4 0 0 1-2.47 2.93a1 1 0 0 0-.34.75v1.36a1 1 0 0 0 1 1h27.8a1 1 0 0 0 1-1v-1.36a1 1 0 0 0-.34-.75ZM5.13 28.94a16.17 16.17 0 0 0 2.44-3a14.24 14.24 0 0 0 1.65-5.85v-4.94a8.74 8.74 0 1 1 17.47 0v4.94a14.24 14.24 0 0 0 1.65 5.85a16.17 16.17 0 0 0 2.44 3Z" class="clr-i-outline clr-i-outline-path-1"/><path fill="currentColor" d="M18 34.28A2.67 2.67 0 0 0 20.58 32h-5.26A2.67 2.67 0 0 0 18 34.28Z" class="clr-i-outline clr-i-outline-path-2"/><path fill="none" d="M0 0h36v36H0z"/></svg>'},help:{body:'<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" viewBox="0 0 36 36"><path fill="currentColor" d="M18 2a16 16 0 1 0 16 16A16 16 0 0 0 18 2Zm0 30a14 14 0 1 1 14-14a14 14 0 0 1-14 14Z" class="clr-i-outline clr-i-outline-path-1"/><path fill="currentColor" d="M18.29 8.92a7.38 7.38 0 0 0-5.72 2.57a1 1 0 0 0-.32.71a.92.92 0 0 0 .95.92a1.08 1.08 0 0 0 .71-.29a5.7 5.7 0 0 1 4.33-2c2.36 0 3.83 1.52 3.83 3.41v.05c0 2.21-1.76 3.44-4.54 3.65a.8.8 0 0 0-.76.92s0 2.32 0 2.75a1 1 0 0 0 1 .9h.11a1 1 0 0 0 .9-1v-2.06c3-.42 5.43-2 5.43-5.28v-.05c-.03-3-2.37-5.2-5.92-5.2Z" class="clr-i-outline clr-i-outline-path-2"/><circle cx="17.78" cy="26.2" r="1.25" fill="currentColor" class="clr-i-outline clr-i-outline-path-3"/><path fill="none" d="M0 0h36v36H0z"/></svg>'}},width:24,height:24})},ej=t=>{const o=t.target,l=document.createElement("span");l.style.position="absolute",l.style.top=t.offsetY-5+"px",l.style.left=t.offsetX-5+"px",l.style.height="10px",l.style.width="10px",l.style.borderRadius="100px",l.style.opacity="1",l.style.backgroundColor="#1890ff",l.style.pointerEvents="none",l.style.zIndex="9999",o==null||o.appendChild(l);const f=setInterval(()=>{l.style.opacity=(parseFloat(l.style.opacity)-.033).toString(),l.style.top=parseInt(l.style.top)-4+"px",l.style.left=parseInt(l.style.left)-4+"px",l.style.height=parseInt(l.style.height)+8+"px",l.style.width=parseInt(l.style.width)+8+"px"},10);setTimeout(()=>{clearInterval(f),o==null||o.removeChild(l)},300)},tj=w6();Q6();const Hv=l3(D6);Hv.use(J6).use(tj);Hv.directive("wave-animation",{beforeMount(t){const o=document.createElement("div");o.classList.add("animated-button","select-none"),o.onclick=ej,t.insertBefore(o,t.firstChild)}});Hv.mount("#app")});export default nj();
